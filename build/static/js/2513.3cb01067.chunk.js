"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[2513],{62513:(e,t,a)=>{a.r(t),a.d(t,{default:()=>D});var s=a(89379),n=a(39160),r=a(83003),l=a(65043),d=a(23156),o=a(24858),i=a(15187),c=a(78227),p=a(65512),h=a(96651),x=a(4938),u=a(55971),m=a(60446),w=a.n(m),j=a(60089),v=a(549),f=a(31462),b=a(26929),N=a(94084),g=a(58302),y=a(70579);const D=function(){const{register:e,control:t,setValue:a,formState:{errors:m}}=(0,o.mN)(),D=(0,r.wA)(),S=JSON.parse(localStorage.getItem("user_info_".concat(i.AU))),{projectTaskList:A,totalProjectTaskCount:I,loading:C}=(0,r.d4)(e=>e.projectTask),[O,T]=(0,l.useState)(""),[k,Y]=(0,l.useState)({isOpen:!1,data:null}),[M,P]=(0,l.useState)({isOpen:!1,data:null}),[L,z]=(0,l.useState)(1),F=(0,o.FH)({control:t,name:"status",defaultValue:""}),U=(0,o.FH)({control:t,name:"startDate",defaultValue:w()()}),V=(0,o.FH)({control:t,name:"endDate",defaultValue:w()()}),_=[F,O,U,V].join("-"),[R,B]=(0,l.useState)(!1);(0,l.useEffect)(()=>{R?1===L?H():z(1):B(e=>!0)},[_]),(0,l.useEffect)(()=>{"employee"===(null===S||void 0===S?void 0:S.userType)&&H()},[L]);const H=()=>{const e={page:L,limit:10,reqPayload:{companyId:null===S||void 0===S?void 0:S.companyId,branchId:null===S||void 0===S?void 0:S.branchId,directorId:"",text:O,sort:!0,status:F,isPagination:!0,projectId:"",taskId:"",assignedTo:null===S||void 0===S?void 0:S._id,departmentId:null===S||void 0===S?void 0:S.departmentId,creatorId:"",followerIds:[],startDate:U?w()(U).format("YYYY-MM-DD"):"",endDate:V?w()(V).format("YYYY-MM-DD"):""}};null!==S&&void 0!==S&&S.departmentId&&D((0,j.FS)(e))},E=(e,t)=>{D((0,j.fw)({_id:t,status:e})).then(e=>{e.error||H()})},{canCreate:J,canRead:q,canUpdate:G,canDelete:K}=(0,x.A)();return"employee"!==(null===S||void 0===S?void 0:S.userType)?(0,y.jsx)(n.A,{children:(0,y.jsx)("div",{className:"bg-red-100 text-red-800 p-4 rounded-md mt-2",children:(0,y.jsx)("p",{className:"text-center font-semibold",children:"You are not an employee. This page is viewable for employees only."})})}):(0,y.jsx)(n.A,{onChange:e=>{T(e)},children:(0,y.jsxs)("section",{children:[(0,y.jsxs)("div",{className:"",children:[(0,y.jsxs)("div",{className:"grid grid-cols-1 sm:flex  gap-2 items-center justify-start py-1 text-[14px] rounded-md w-full",children:[(0,y.jsx)("div",{children:(0,y.jsx)(o.xI,{name:"status",control:t,rules:{},render:e=>{let{field:t}=e;return(0,y.jsxs)(p.A,(0,s.A)((0,s.A)({},t),{},{className:"capitalize w-32 ".concat(i.Lp," ").concat(m.status?"border-[1px] ":"border-gray-300"),placeholder:"Select Status",showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,y.jsx)(p.A.Option,{value:"",children:"Select Status"}),null===i.RU||void 0===i.RU?void 0:i.RU.map(e=>(0,y.jsxs)(p.A.Option,{className:"capitalize",value:e,children:[" ",e," "]},e))]}))}})}),(0,y.jsx)("div",{children:(0,y.jsx)(o.xI,{name:"startDate",control:t,defaultValue:w()(),render:e=>{let{field:t}=e;return(0,y.jsx)(N.A,{report:!0,disabled:C,placeholder:"Start date",size:"middle",field:t,errors:m})}})}),(0,y.jsx)("div",{children:(0,y.jsx)(o.xI,{name:"endDate",report:!0,control:t,defaultValue:w()(),render:e=>{let{field:t}=e;return(0,y.jsx)(N.A,{size:"middle",disabled:C,placeholder:"Start date",report:!0,field:t,errors:m})}})})]}),(0,y.jsxs)("div",{className:"flex justify-end items-center gap-2 my-1",children:[(0,y.jsx)("button",{onClick:()=>{a("status",""),a("PDBranchId",""),a("PdCompanyId",""),a("startDate",w()()),a("endDate",w()())},className:"bg-header   py-[5px]  rounded-md  flex px-5 justify-center items-center  text-white",children:(0,y.jsx)("span",{className:"text-[12px]",children:"Reset"})}),J&&(0,y.jsx)(h.A,{placement:"topLeft",title:"Add task",children:(0,y.jsxs)("button",{onClick:()=>{Y({isOpen:!0,data:null})},className:"bg-header px-2 py-1.5 rounded-md flex justify-center items-center space-x-2 text-white",children:[(0,y.jsx)(d.OiG,{}),(0,y.jsx)("span",{className:"text-[12px]",children:"Add Your task"})]})})]})]}),(0,y.jsx)("div",{className:"bg-[#ffffff] w-full overflow-x-auto mt-1 rounded-xl",children:q&&(0,y.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto",children:[(0,y.jsx)("thead",{className:"",children:(0,y.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] capitalize text-[12px] bg-header text-white font-[500] h-[40px]",children:[(0,y.jsx)("th",{className:"border-none p-2 whitespace-nowrap w-[5%]",children:"S.No."}),(0,y.jsx)("th",{className:"border-none p-2 whitespace-nowrap w-[20%]",children:"Title"}),(0,y.jsx)("th",{className:"border-none p-2 whitespace-nowrap w-[15%]",children:"Assigned To"}),(0,y.jsx)("th",{className:"border-none p-2 whitespace-nowrap w-[10%]",children:"Department"}),(0,y.jsx)("th",{className:"border-none p-2 whitespace-nowrap w-[10%]",children:"Time Spent"}),(0,y.jsx)("th",{className:"border-none p-2 whitespace-nowrap w-[15%]",children:"Created By"}),(0,y.jsx)("th",{className:"border-none p-2 whitespace-nowrap w-[15%]",children:"Created At"}),(0,y.jsx)("th",{className:"border-none p-2 whitespace-nowrap w-[10%]",children:"Priority"}),(0,y.jsx)("th",{className:"border-none p-2 whitespace-nowrap w-[10%]",children:"Status"}),(K||G)&&(0,y.jsx)("th",{className:"border-none p-2 whitespace-nowrap w-[10%]",children:"Action"})]})}),C?(0,y.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,y.jsx)("td",{colSpan:10,className:"px-6 py-2 whitespace-nowrap font-[600] text-sm text-gray-500",children:(0,y.jsx)(u.A,{})})}):(0,y.jsx)("tbody",{children:A&&(null===A||void 0===A?void 0:A.length)>0?null===A||void 0===A?void 0:A.map((e,t)=>{var a,s,n,r,l,d;return(0,y.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] ".concat(t%2===0?"bg-[#e9ecef]/80":"bg-white"," text-[#374151] text-[14px]"),children:[(0,y.jsx)("td",{className:"whitespace-nowrap border-none p-2 text-center",children:t+1+10*(L-1)}),(0,y.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==(a=null===e||void 0===e?void 0:e.title)&&void 0!==a?a:"-"}),(0,y.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==(s=null===e||void 0===e||null===(n=e.assignedToData)||void 0===n?void 0:n.fullName)&&void 0!==s?s:"-"}),(0,y.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==(r=null===e||void 0===e?void 0:e.departmentName)&&void 0!==r?r:"-"}),(0,y.jsx)("td",{className:"whitespace-nowrap border-none text-teal-600 p-2",children:void 0!==(null===e||void 0===e?void 0:e.totalTimeSpentInMin)?"".concat(Math.floor(e.totalTimeSpentInMin/60),"h ").concat(e.totalTimeSpentInMin%60,"m"):"-"}),(0,y.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==(l=null===e||void 0===e?void 0:e.createdBy)&&void 0!==l?l:"-"}),(0,y.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==(d=w()(null===e||void 0===e?void 0:e.createdAt).format("DD-MM-YYYY hh:mm a"))&&void 0!==d?d:"-"}),(0,y.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:(0,y.jsx)("span",{className:"px-2 py-1 rounded-lg text-white text-[12px] ".concat("high"===(null===e||void 0===e?void 0:e.priority)?"bg-red-500":"medium"===(null===e||void 0===e?void 0:e.priority)?"bg-yellow-500":"bg-green-500"),children:null!==e&&void 0!==e&&e.priority?e.priority.charAt(0).toUpperCase()+e.priority.slice(1):"-"})}),(0,y.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:(0,y.jsx)(g.A,{element:e,handleStatusChange:E,employeePortal:!0})}),(K||G)&&(0,y.jsx)("td",{className:"whitespace-nowrap border-none p-2",children:(0,y.jsx)("span",{className:"py-1.5 flex justify-start items-center space-x-2",children:G&&(0,y.jsx)(h.A,{placement:"topLeft",title:"view",children:(0,y.jsx)("button",{onClick:()=>{P({isOpen:!0,data:e})},className:"px-2 py-1.5 text-xs rounded-md bg-transparent border border-muted",type:"button",children:(0,y.jsx)(f.JPe,{className:" hover:text-[#337ab7] text-[#3c8dbc]",size:16})})})})})]})}):(0,y.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,y.jsx)("td",{colSpan:10,className:"px-6 py-2 whitespace-nowrap font-[600] text-center text-sm text-gray-500",children:"No Tasks Found"})})})]})}),(0,y.jsx)(c.A,{totalCount:I,pageSize:10,currentPage:L,onChange:e=>{z(e)}}),(0,y.jsx)(v.A,{isOpen:null===k||void 0===k?void 0:k.isOpen,data:null===k||void 0===k?void 0:k.data,fetchListAfterSuccess:H,closeModalFunc:()=>Y({isOpen:!1,data:null}),handlingPerson:"employee"}),(0,y.jsx)(b.A,{isOpen:null===M||void 0===M?void 0:M.isOpen,data:null===M||void 0===M?void 0:M.data,fetchListAfterSuccess:H,closeModalFunc:()=>{P({isOpen:!1,data:null}),H()}})]})})}}}]);
//# sourceMappingURL=2513.3cb01067.chunk.js.map