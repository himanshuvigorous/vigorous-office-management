"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[9384],{69384:(e,a,t)=>{t.r(a),t.d(a,{default:()=>g});var s=t(89379),n=t(24858),d=t(39160),o=t(83003),l=t(73216),i=t(65043),r=t(15187),c=t(31744),m=t(78729),u=(t(36105),t(30575),t(84480),t(66015)),p=(t(42837),t(31536)),x=t(88967),v=t(27810),h=t(94084),y=t(60446),f=t.n(y),j=t(17995),b=(t(89427),t(60184)),N=t(70579);const g=()=>{const{register:e,handleSubmit:a,control:t,watch:y,formState:{errors:g},setValue:A}=(0,n.mN)(),I=(0,o.wA)(),S=(0,l.Zp)(),T=JSON.parse(localStorage.getItem("user_info_".concat(r.AU))),{expenseTypeList:O}=(0,o.d4)(e=>e.expenceHead),_=(0,n.FH)({control:t,name:"PDCompanyId",defaultValue:""}),D=(0,n.FH)({control:t,name:"PDBranchId",defaultValue:""}),{loading:E}=(0,o.d4)(e=>e.cashbook),[P,w]=(0,i.useState)(!1),[k,q]=(0,i.useState)({attachment:[]});(0,i.useEffect)(()=>{(_||"company"===(null===T||void 0===T?void 0:T.userType)||"companyDirector"===(null===T||void 0===T?void 0:T.userType))&&I((0,c.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===T||void 0===T?void 0:T.userType)?_:"company"===(null===T||void 0===T?void 0:T.userType)?null===T||void 0===T?void 0:T._id:null===T||void 0===T?void 0:T.companyId}))},[_]),(0,i.useEffect)(()=>{"admin"===(null===T||void 0===T?void 0:T.userType)&&I((0,m.Ar)({text:"",sort:!0,status:!0,isPagination:!1}))},[]);return(0,i.useEffect)(()=>{A("totalAmount",Number(y("amount"))+Number(y("gstAmount")))},[y("amount"),y("gstAmount")]),(0,N.jsx)(d.A,{children:(0,N.jsx)("div",{className:"gap-4",children:(0,N.jsxs)("form",{autoComplete:"off",className:"mt-2 md:px-1",onSubmit:a(e=>{var a;const t={companyId:null===T||void 0===T?void 0:T.companyId,directorId:null===T||void 0===T?void 0:T.directorId,branchId:null===T||void 0===T?void 0:T.branchId,employeId:"employee"===(null===T||void 0===T?void 0:T.userType)?null===T||void 0===T?void 0:T._id:null,expenseTypeId:null===e||void 0===e||null===(a=e.expencehead)||void 0===a?void 0:a.value,expenseFor:"Employe",amount:+(null===e||void 0===e?void 0:e.amount),naration:null===e||void 0===e?void 0:e.naration,GSTamount:0,totalAmount:+(null===e||void 0===e?void 0:e.amount),date:null===e||void 0===e?void 0:e.date,status:"Pending",attachment:null===k||void 0===k?void 0:k.attachment};I((0,v.pn)(t)).then(e=>{e.error||S(-1)})}),children:[(0,N.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 md:gap-4 gap-2 md:my-1 px-3 md:mt-4",children:[(0,N.jsxs)("div",{className:"w-full",children:[(0,N.jsx)("label",{className:"".concat(r.Q0),children:"Expence Head"}),(0,N.jsx)(n.xI,{name:"expencehead",control:t,rules:{required:"Expence Head is required"},render:e=>{let{field:a}=e;return(0,N.jsx)(u.Ay,(0,s.A)((0,s.A)({onFocus:()=>{const e={directorId:"",companyId:"admin"===(null===T||void 0===T?void 0:T.userType)?_:"company"===(null===T||void 0===T?void 0:T.userType)?null===T||void 0===T?void 0:T._id:null===T||void 0===T?void 0:T.companyId,branchId:"company"===(null===T||void 0===T?void 0:T.userType)||"admin"===(null===T||void 0===T?void 0:T.userType)||"companyDirector"===(null===T||void 0===T?void 0:T.userType)?D:"companyBranch"===(null===T||void 0===T?void 0:T.userType)?null===T||void 0===T?void 0:T._id:null===T||void 0===T?void 0:T.branchId,text:"",sort:!0,status:"",isPagination:!1};I((0,p.dV)(e))}},a),{},{options:null===O||void 0===O?void 0:O.map(e=>({value:null===e||void 0===e?void 0:e._id,label:null===e||void 0===e?void 0:e.name})),classNamePrefix:"react-select",className:"".concat(r.Ph," ").concat(g.expencehead?"border-[1px] ":"border-gray-300"),placeholder:"Select Expence Head"}))}}),g.expencehead&&(0,N.jsx)("p",{className:"text-red-500 text-sm",children:g.expencehead.message})]}),(0,N.jsxs)("div",{className:"",children:[(0,N.jsxs)("label",{className:"".concat(r.Q0),children:["Amount ",(0,N.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,N.jsx)("input",(0,s.A)((0,s.A)({type:"number",step:"0.01"},e("amount",{required:"Amount is required"})),{},{className:" ".concat(r.Ol," ").concat(g.amount?"border-[1px] ":"border-gray-300"),placeholder:"Enter Amount"})),g.amount&&(0,N.jsx)("p",{className:"text-red-500 text-sm",children:g.amount.message})]}),(0,N.jsxs)("div",{className:"",children:[(0,N.jsxs)("label",{className:"".concat(r.Q0),children:["Naration ",(0,N.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,N.jsx)("textarea",(0,s.A)((0,s.A)({},e("naration",{required:"Naration is required"})),{},{className:" ".concat(r.Ol," ").concat(g.naration?"border-[1px] ":"border-gray-300"),placeholder:"Enter Naration"})),g.naration&&(0,N.jsx)("p",{className:"text-red-500 text-sm",children:g.naration.message})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"".concat(r.Q0),children:"Bill Date"}),(0,N.jsx)(n.xI,{name:"date",control:t,render:e=>{let{field:a}=e;return(0,N.jsx)(h.A,{field:a,errors:g,disabledDate:e=>{if(!e)return!0;const a=f()().startOf("day"),t=e.startOf("day");if(a.date()<=5){const e=a.subtract(1,"month"),s=e.endOf("month").startOf("day"),n=e.date(s.date()-4).startOf("day"),d=(t.isAfter(n)||t.isSame(n))&&(t.isBefore(s)||t.isSame(s)),o=a.startOf("month"),l=(t.isAfter(o)||t.isSame(o))&&(t.isBefore(a)||t.isSame(a));return!(d||l)}{const e=a.startOf("month");return!((t.isAfter(e)||t.isSame(e))&&(t.isBefore(a)||t.isSame(a)))}}})}}),g.date&&(0,N.jsx)("p",{className:"text-red-500 text-sm",children:"Date is required"})]}),(0,N.jsxs)("div",{className:"",children:[(0,N.jsx)("label",{className:"".concat(r.Q0),children:"Documents"}),P?(0,N.jsx)("div",{className:"space-y-2"}):(0,N.jsxs)("div",{className:"space-y-4",children:[(0,N.jsx)("input",{type:"file",onChange:e=>{const a={filePath:e.target.files[0],isVideo:!1,isMultiple:!1};I((0,x.Sg)(a)).then(e=>{var a;null!==e&&void 0!==e&&null!==(a=e.payload)&&void 0!==a&&a.data&&q(a=>{var t;return(0,s.A)((0,s.A)({},a),{},{attachment:[...a.attachment,null===(t=e.payload)||void 0===t?void 0:t.data]})})})},className:"hidden",id:"file-upload"}),(0,N.jsxs)("label",{htmlFor:"file-upload",className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-600 bg-white cursor-pointer",children:[(0,N.jsx)(b.chT,{className:"mr-2"})," Add Documents"]}),(0,N.jsx)("div",{className:"space-y-2",children:k.attachment.map((e,a)=>(0,N.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-md",children:[(0,N.jsxs)("a",{href:"".concat("https://vigapi.vigorousit.com","/public/").concat(e),className:"flex items-center space-x-2",target:"_blank",rel:"noopener noreferrer",children:[(0,N.jsx)(b.chT,{className:"text-gray-500"}),(0,N.jsx)("span",{className:"text-sm text-gray-600",children:e})]}),(0,N.jsx)("button",{type:"button",onClick:()=>(e=>{q(a=>{const t=a.attachment.filter((a,t)=>t!==e);return(0,s.A)((0,s.A)({},a),{},{attachment:t})})})(a),className:"text-red-500 hover:text-red-700",children:(0,N.jsx)(b.QCr,{})})]},a))})]})]})]}),(0,N.jsx)("div",{className:"flex justify-end",children:(0,N.jsx)("button",{type:"submit",disabled:E,className:"".concat(E?"bg-gray-400":"bg-header"," text-white p-2 px-4 rounded"),children:E?(0,N.jsx)(j.A,{}):"Submit"})})]})})})}}}]);
//# sourceMappingURL=9384.2c2412a2.chunk.js.map