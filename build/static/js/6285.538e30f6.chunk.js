"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[6285],{86285:(e,l,d)=>{d.r(l),d.d(l,{default:()=>x});var n=d(24858),o=d(83003),i=d(73216),a=d(65043),s=(d(15187),d(39160)),t=d(28249),r=d(41914),c=d(16998),u=d(31174),v=d(65512),m=(d(17995),d(89427),d(70579));const x=()=>{var e,l,d,x,h,p,f;const{register:g,handleSubmit:j,control:N,reset:y,watch:b,formState:{errors:w},setValue:I}=(0,n.mN)(),L=(0,o.wA)(),S=(0,i.Zp)(),{standardPayrollIdEnc:P}=(0,i.g)(),C=(0,u.Yc)(P),{standardPayrollDetailsData:D}=(0,o.d4)(e=>e.standardPayroll),{allowanceListData:k,loading:A}=(0,o.d4)(e=>e.allowance),{deductionsListData:_,loading:F}=(0,o.d4)(e=>e.deductions),[E,Y]=(0,a.useState)(!1),[V,M]=(0,a.useState)([]),{fields:z,append:B,remove:H}=(0,n.jz)({control:N,name:"allowanceDetails"}),{fields:T,append:O,remove:W}=(0,n.jz)({control:N,name:"deductionDetails"}),U=((0,n.FH)({control:N,name:"employee",defaultValue:""}),(0,n.FH)({control:N,name:"deductionDetails",defaultValue:""})),Z=(0,n.FH)({control:N,name:"allowanceDetails",defaultValue:""});(0,a.useEffect)(()=>(C&&L((0,t.p_)({_id:C})),()=>{L((0,t.vu)())}),[C,L]),(0,a.useEffect)(()=>{if(D){if(!D)return null;let e=[];const l=Number(null===D||void 0===D?void 0:D.basicSalary)||0;Array.isArray(Z)&&Z.forEach(d=>{const n=null===d||void 0===d?void 0:d.allowance,o=null===k||void 0===k?void 0:k.find(e=>(null===e||void 0===e?void 0:e._id)===n),i=(null===o||void 0===o?void 0:o.name)||"-",a=null===d||void 0===d?void 0:d.isPercentage,s=Number(null===d||void 0===d?void 0:d.amount)||0,t="Yes"===a?l*s/100:s;e.push({name:i,isPercentage:a,_id:n,amount:t,type:"allowance"})}),Array.isArray(U)&&U.forEach(d=>{const n=null===d||void 0===d?void 0:d.deduction,o=null===_||void 0===_?void 0:_.find(e=>(null===e||void 0===e?void 0:e._id)===n),i=(null===o||void 0===o?void 0:o.name)||"-",a=null===d||void 0===d?void 0:d.isPercentage,s=Number(null===d||void 0===d?void 0:d.amount)||0,t="Yes"===a?l*s/100:s;e.push({name:i,isPercentage:a,_id:n,amount:t,type:"deduction"})}),M(e)}},[D,Z,U,k,_]);const{loading:q}=(0,o.d4)(e=>e.standardPayroll);(0,a.useEffect)(()=>{D&&null!==D&&void 0!==D&&D.companyId&&null!==D&&void 0!==D&&D.branchId&&!E&&(Y(!0),y(),I("allowanceDetails",[]),I("deductionDetails",[]),I("employee",null===D||void 0===D?void 0:D.employeName),L((0,c.bz)({text:"",sort:!0,status:!0,isPagination:!1,directorId:"",companyId:null===D||void 0===D?void 0:D.companyId,branchId:null===D||void 0===D?void 0:D.branchId})).then(e=>{var l;null!==e&&void 0!==e&&e.error||(null===D||void 0===D||null===(l=D.allowances)||void 0===l||l.forEach(e=>{const l={allowance:null===e||void 0===e?void 0:e.allowanceId,isPercentage:null!==e&&void 0!==e&&e.isPercentage?"Yes":"No",amount:null===e||void 0===e?void 0:e.value};B(l)}))}),L((0,r.VO)({text:"",sort:!0,status:!0,isPagination:!1,directorId:"",companyId:null===D||void 0===D?void 0:D.companyId,branchId:null===D||void 0===D?void 0:D.branchId})).then(e=>{var l;null!==e&&void 0!==e&&e.error||(null===D||void 0===D||null===(l=D.deductions)||void 0===l||l.forEach(e=>{const l={deduction:null===e||void 0===e?void 0:e.deductionId,isPercentage:null!==e&&void 0!==e&&e.isPercentage?"Yes":"No",amount:null===e||void 0===e?void 0:e.value};O(l)}))}))},[D,E,L,y,I]);const{Option:G}=v.A;return(0,m.jsx)(s.A,{children:(0,m.jsx)("div",{className:"gap-4",children:(0,m.jsx)("form",{autoComplete:"off",className:"mt-2 md:px-1",onSubmit:j(e=>{var l,d;const n={_id:C,companyId:null===D||void 0===D?void 0:D.companyId,directorId:"",branchId:null===D||void 0===D?void 0:D.branchId,employeId:null===D||void 0===D?void 0:D.employeId,allowances:null===e||void 0===e||null===(l=e.allowanceDetails)||void 0===l?void 0:l.map(e=>{var l;return{allowanceId:null===e||void 0===e?void 0:e.allowance,name:null===k||void 0===k||null===(l=k.find(l=>(null===l||void 0===l?void 0:l._id)===(null===e||void 0===e?void 0:e.allowance)))||void 0===l?void 0:l.name,isPercentage:"Yes"===(null===e||void 0===e?void 0:e.isPercentage),value:null===e||void 0===e?void 0:e.amount}}),deductions:null===e||void 0===e||null===(d=e.deductionDetails)||void 0===d?void 0:d.map(e=>{var l;return{deductionId:null===e||void 0===e?void 0:e.deduction,name:null===_||void 0===_||null===(l=_.find(l=>(null===l||void 0===l?void 0:l._id)===(null===e||void 0===e?void 0:e.deduction)))||void 0===l?void 0:l.name,isPercentage:"Yes"===(null===e||void 0===e?void 0:e.isPercentage),value:null===e||void 0===e?void 0:e.amount}})};L((0,t.Oi)(n)).then(e=>{e.error||S(-1)})}),children:(0,m.jsx)("div",{className:"space-y-4 px-4 py-4",children:(0,m.jsxs)("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 overflow-hidden",children:[(0,m.jsx)("div",{className:"bg-header text-white p-4",children:(0,m.jsxs)("div",{className:"flex flex-col md:flex-row items-center gap-4",children:[(0,m.jsx)("div",{className:"w-16 h-16 rounded-full bg-white flex items-center justify-center shrink-0",children:null!==D&&void 0!==D&&D.profileImage?(0,m.jsx)("img",{src:"".concat("https://vigapi.vigorousit.com","/public/").concat(D.profileImage),alt:"Profile",className:"w-full h-full rounded-full object-cover"}):(0,m.jsx)("span",{className:"text-3xl font-bold text-header",children:null===D||void 0===D||null===(e=D.fullName)||void 0===e?void 0:e.charAt(0).toUpperCase()})}),(0,m.jsxs)("div",{className:"flex-1",children:[(0,m.jsx)("h2",{className:"text-lg font-bold",children:null===D||void 0===D?void 0:D.employeName}),(0,m.jsxs)("div",{className:"grid grid-cols-3 gap-2 mt-2 text-sm",children:[(0,m.jsxs)("div",{className:"bg-white/10 p-1 rounded text-center",children:[(0,m.jsx)("p",{className:"font-medium",children:"Basic"}),(0,m.jsxs)("p",{className:"font-semibold",children:["\u20b9",(null===D||void 0===D||null===(l=D.basicSalary)||void 0===l?void 0:l.toLocaleString("en-IN"))||"0"]})]}),(0,m.jsxs)("div",{className:"bg-white/10 p-1 rounded text-center",children:[(0,m.jsx)("p",{className:"font-medium",children:"Monthly"}),(0,m.jsxs)("p",{className:"font-semibold",children:["\u20b9",(null===D||void 0===D||null===(d=D.baseSalary)||void 0===d?void 0:d.toLocaleString("en-IN"))||"0"]})]}),(0,m.jsxs)("div",{className:"bg-white/10 p-1 rounded text-center",children:[(0,m.jsx)("p",{className:"font-medium",children:"Yearly"}),(0,m.jsxs)("p",{className:"font-semibold",children:["\u20b9",(null===D||void 0===D||null===(x=D.ctc)||void 0===x?void 0:x.toLocaleString("en-IN"))||"0"]})]})]})]})]})}),(0,m.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 divide-y md:divide-y-0 md:divide-x divide-gray-200",children:[(0,m.jsxs)("div",{className:"p-4",children:[(0,m.jsxs)("h3",{className:"text-md font-semibold text-green-700 mb-3 flex items-center gap-2",children:[(0,m.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,m.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Allowances"]}),(null===V||void 0===V||null===(h=V.filter(e=>{var l;return"allowance"===(null===e||void 0===e||null===(l=e.type)||void 0===l?void 0:l.toLowerCase())}))||void 0===h?void 0:h.length)>0?(0,m.jsxs)("div",{className:"space-y-2",children:[V.filter(e=>{var l;return"allowance"===(null===e||void 0===e||null===(l=e.type)||void 0===l?void 0:l.toLowerCase())}).map((e,l)=>(0,m.jsxs)("div",{className:"flex justify-between items-center p-2 bg-green-50 rounded border border-green-100",children:[(0,m.jsx)("span",{className:"font-medium text-gray-700",children:e.name}),(0,m.jsxs)("span",{className:"font-semibold text-green-600",children:["+ \u20b9",e.amount]})]},"allowance-".concat(l))),(0,m.jsxs)("div",{className:"flex justify-between items-center p-2 bg-green-100 rounded font-semibold mt-2",children:[(0,m.jsx)("span",{children:"Total Allowances"}),(0,m.jsxs)("span",{className:"text-green-700",children:["+ \u20b9",V.filter(e=>{var l;return"allowance"===(null===e||void 0===e||null===(l=e.type)||void 0===l?void 0:l.toLowerCase())}).reduce((e,l)=>e+(parseFloat(l.amount)||0),0).toLocaleString("en-IN")]})]})]}):(0,m.jsx)("div",{className:"text-gray-500 bg-green-50 p-2 rounded text-center",children:"No allowances this period"})]}),(0,m.jsxs)("div",{className:"p-4",children:[(0,m.jsxs)("h3",{className:"text-md font-semibold text-red-700 mb-3 flex items-center gap-2",children:[(0,m.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,m.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})}),"Deductions"]}),(null===V||void 0===V||null===(p=V.filter(e=>{var l;return"deduction"===(null===e||void 0===e||null===(l=e.type)||void 0===l?void 0:l.toLowerCase())}))||void 0===p?void 0:p.length)>0?(0,m.jsxs)("div",{className:"space-y-2",children:[V.filter(e=>{var l;return"deduction"===(null===e||void 0===e||null===(l=e.type)||void 0===l?void 0:l.toLowerCase())}).map((e,l)=>(0,m.jsxs)("div",{className:"flex justify-between items-center p-2 bg-red-50 rounded border border-red-100",children:[(0,m.jsx)("span",{className:"font-medium text-gray-700",children:e.name}),(0,m.jsxs)("span",{className:"font-semibold text-red-600",children:["- \u20b9",e.amount]})]},"deduction-".concat(l))),(0,m.jsxs)("div",{className:"flex justify-between items-center p-2 bg-red-100 rounded font-semibold mt-2",children:[(0,m.jsx)("span",{children:"Total Deductions"}),(0,m.jsxs)("span",{className:"text-red-700",children:["- \u20b9",V.filter(e=>{var l;return"deduction"===(null===e||void 0===e||null===(l=e.type)||void 0===l?void 0:l.toLowerCase())}).reduce((e,l)=>e+(parseFloat(l.amount)||0),0).toLocaleString("en-IN")]})]})]}):(0,m.jsx)("div",{className:"text-gray-500 bg-red-50 p-2 rounded text-center",children:"No deductions this period"})]})]}),(0,m.jsx)("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:(0,m.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,m.jsx)("h3",{className:"text-md font-semibold text-center mb-3 text-gray-700",children:"Salary Calculation"}),(0,m.jsxs)("div",{className:"space-y-2",children:[(0,m.jsxs)("div",{className:"flex justify-between",children:[(0,m.jsx)("span",{children:"Basic Salary:"}),(0,m.jsxs)("span",{className:"font-medium",children:["\u20b9",(null===D||void 0===D||null===(f=D.basicSalary)||void 0===f?void 0:f.toLocaleString("en-IN"))||"0"]})]}),(0,m.jsxs)("div",{className:"flex justify-between text-green-600",children:[(0,m.jsx)("span",{children:"Total Allowances:"}),(0,m.jsxs)("span",{children:["+ \u20b9",V.filter(e=>{var l;return"allowance"===(null===e||void 0===e||null===(l=e.type)||void 0===l?void 0:l.toLowerCase())}).reduce((e,l)=>e+(parseFloat(l.amount)||0),0).toLocaleString("en-IN")]})]}),(0,m.jsxs)("div",{className:"flex justify-between text-red-600",children:[(0,m.jsx)("span",{children:"Total Deductions:"}),(0,m.jsxs)("span",{children:["- \u20b9",V.filter(e=>{var l;return"deduction"===(null===e||void 0===e||null===(l=e.type)||void 0===l?void 0:l.toLowerCase())}).reduce((e,l)=>e+(parseFloat(l.amount)||0),0).toLocaleString("en-IN")]})]}),(0,m.jsx)("div",{className:"border-t border-gray-300 my-2"}),(0,m.jsxs)("div",{className:"flex justify-between text-lg font-bold text-header",children:[(0,m.jsx)("span",{children:"Net Salary Payable:"}),(0,m.jsxs)("span",{children:["\u20b9",(parseFloat((null===D||void 0===D?void 0:D.basicSalary)||0)+V.filter(e=>{var l;return"allowance"===(null===e||void 0===e||null===(l=e.type)||void 0===l?void 0:l.toLowerCase())}).reduce((e,l)=>e+(parseFloat(l.amount)||0),0)-V.filter(e=>{var l;return"deduction"===(null===e||void 0===e||null===(l=e.type)||void 0===l?void 0:l.toLowerCase())}).reduce((e,l)=>e+(parseFloat(l.amount)||0),0)).toLocaleString("en-IN")]})]})]})]})})]})})})})})}}}]);
//# sourceMappingURL=6285.538e30f6.chunk.js.map