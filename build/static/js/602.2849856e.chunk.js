"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[602],{30602:(e,t,l)=>{l.r(t),l.d(t,{default:()=>Y});var a=l(89379),n=l(24858),o=l(83003),d=l(15187),i=l(65043),r=l(31744),s=l(39160),c=l(97326),u=l(53913),p=l(65512),v=(l(86178),l(60446)),m=l.n(v),h=l(78227),x=l(12106),y=l(42837),f=l(94084),w=l(69223),N=l(55971),j=l(50822),D=l(6720),b=l(37762),g=l(64857),A=l(11906),C=l(33007),I=l(89427),S=l(70337),k=l(40088),T=l(12208),O=l(35475),F=l(70579);const Y=function(){const{control:e,formState:{errors:t},setValue:l,watch:v}=(0,n.mN)();function Y(e){if(!e)return null;const t=e.trim(),l=m()(t);return l.isValid()?l:null}const[_,L]=(0,i.useState)(10),[P,R]=(0,O.ok)(),M=P.get("filterDate"),V=Y(P.get("toDateNew")),B=Y(P.get("fromDateNew")),z=function(e){const t=m()();if(!e)return{startDate:null,endDate:null};let l=null,a=null;switch(e.trim().toLowerCase()){case"today":l=t.startOf("day"),a=t.endOf("day");break;case"last week":{const e=t.subtract(1,"week"),n=e.day();l=e.subtract(n,"day").startOf("day"),a=l.add(6,"day").endOf("day");break}case"last month":l=t.subtract(1,"month").startOf("month"),a=t.subtract(1,"month").endOf("month");break;case"last year":l=t.subtract(1,"year").startOf("year"),a=t.subtract(1,"year").endOf("year");break;default:return{startDate:null,endDate:null}}return{startDate:l,endDate:a}}(M),H=(0,o.wA)(),{overAllTaskReportList:E,overAllTaskReportFunc_loading:U,totaloverAllTaskCount:J}=(0,o.d4)(e=>e.reports),{departmentListData:K,loading:Q}=(0,o.d4)(e=>e.department),{taskTypeList:q,loading:G}=(0,o.d4)(e=>e.taskType),{clientGroupList:W,groupSearchLoading:X}=(0,o.d4)(e=>e.clientGroup),{clientList:Z,loading:$}=(0,o.d4)(e=>e.client),{employeList:ee}=(0,o.d4)(e=>e.employe),[te,le]=(0,i.useState)(""),ae=JSON.parse(localStorage.getItem("user_info_".concat(d.AU))),[ne,oe]=(0,i.useState)(1),[de,ie]=(0,i.useState)(""),{branchList:re}=(0,o.d4)(e=>e.branch),se=(0,n.FH)({control:e,name:"PDCompanyId",defaultValue:""}),ce=(0,n.FH)({control:e,name:"PDBranchId",defaultValue:""}),ue=(0,n.FH)({control:e,name:"status",defaultValue:""}),pe=(0,n.FH)({control:e,name:"daterange",defaultValue:""}),ve=(0,n.FH)({control:e,name:"employeeId",defaultValue:""}),me=(0,n.FH)({control:e,name:"startDate",defaultValue:"Custom Date"!==M?null===z||void 0===z?void 0:z.startDate:"Custom Date"==M?B:m()().subtract(1,"month")}),he=(0,n.FH)({control:e,name:"endDate",defaultValue:"Custom Date"!==M?null===z||void 0===z?void 0:z.endDate:"Custom Date"==M?V:m()()}),xe=(0,n.FH)({control:e,name:"priority",defaultValue:""}),ye=(0,n.FH)({control:e,name:"financialYear",defaultValue:""}),fe=(0,n.FH)({control:e,name:"month",defaultValue:""}),we=(0,n.FH)({control:e,name:"department",defaultValue:""}),Ne=(0,n.FH)({control:e,name:"client",defaultValue:""}),je=(0,n.FH)({control:e,name:"task",defaultValue:""}),De=(0,n.FH)({control:e,name:"groupName",defaultValue:""});(0,i.useEffect)(()=>{const e=setTimeout(()=>{ie(te)},500);return()=>{clearTimeout(e)}},[te]);const[be,ge]=(0,i.useState)([]),[Ae,Ce]=(0,i.useState)(!1),Ie=(()=>{const e=[];for(let t=2005;t<=2034;t++)e.push("".concat(t,"-").concat(t+1));return e})(),Se=["January","February","March","April","May","June","July","August","September","October","November","December"],ke=["Jan-Mar","Apr-Jun","Jul-Sep","Oct-Dec"],Te=[...Se,...ke],Oe=function(){return{currentPage:ne,pageSize:_,reqPayload:{text:de,sort:!0,isPagination:!(arguments.length>0&&void 0!==arguments[0])||arguments[0],companyId:"admin"===(null===ae||void 0===ae?void 0:ae.userType)?se:"company"===(null===ae||void 0===ae?void 0:ae.userType)?null===ae||void 0===ae?void 0:ae._id:null===ae||void 0===ae?void 0:ae.companyId,directorId:"",branchId:"company"===(null===ae||void 0===ae?void 0:ae.userType)||"admin"===(null===ae||void 0===ae?void 0:ae.userType)||"companyDirector"===(null===ae||void 0===ae?void 0:ae.userType)?ce:"companyBranch"===(null===ae||void 0===ae?void 0:ae.userType)?null===ae||void 0===ae?void 0:ae._id:null===ae||void 0===ae?void 0:ae.branchId,departmentIds:[],clientIds:[],employeIds:[],taskTypeIds:[],groupIds:[],startDate:me?m()(me).format("YYYY-MM-DD"):"",endDate:he?m()(he).format("YYYY-MM-DD"):"",dateRange:pe,status:ue,priority:xe,monthName:Se.find(e=>e==fe)?fe:"",monthQuaters:ke.find(e=>e==fe)?fe:"",financialYear:ye,departmentId:we,clientId:Ne,employeId:ve,taskTypeId:je,groupId:De}}};(0,i.useEffect)(()=>{Ye(de)},[ne,de,_]);const Fe=()=>{H((0,y.qV)({companyId:"admin"===(null===ae||void 0===ae?void 0:ae.userType)?se:"company"===(null===ae||void 0===ae?void 0:ae.userType)?null===ae||void 0===ae?void 0:ae._id:null===ae||void 0===ae?void 0:ae.companyId,branchId:["admin","company","companyDirector"].includes(null===ae||void 0===ae?void 0:ae.userType)?ce:"companyBranch"===(null===ae||void 0===ae?void 0:ae.userType)?null===ae||void 0===ae?void 0:ae._id:null===ae||void 0===ae?void 0:ae.branchId,departmentId:"",directorId:"",text:"",sort:!0,status:!0,isPagination:!1,isBranch:!0,isDirector:!1}))},Ye=()=>{H((0,x.H0)(Oe(!0)))};(0,i.useEffect)(()=>{l("startDate","Custom Date"!==M?null===z||void 0===z?void 0:z.startDate:"Custom Date"==M?B:m()().subtract(1,"month")),l("endDate","Custom Date"!==M?null===z||void 0===z?void 0:z.endDate:"Custom Date"==M?V:m()())},[]),(0,i.useEffect)(()=>{"company"!==(null===ae||void 0===ae?void 0:ae.userType)&&"companyDirector"!==(null===ae||void 0===ae?void 0:ae.userType)||H((0,r.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===ae||void 0===ae?void 0:ae.userType)?se:"company"===(null===ae||void 0===ae?void 0:ae.userType)?null===ae||void 0===ae?void 0:ae._id:null===ae||void 0===ae?void 0:ae.companyId}))},[]);const _e=async()=>{Ye()},Le=[{key:"1",label:(0,F.jsx)("span",{className:"text-white",children:"Advance Filters"}),children:(0,F.jsxs)("div",{className:"bg-[#ececec] space-y-1",children:[(0,F.jsxs)("div",{className:"sm:flex  grid grid-cols-1  gap-2 sm:flex-wrap text-[14px]",children:[("admin"===(null===ae||void 0===ae?void 0:ae.userType)||"company"===(null===ae||void 0===ae?void 0:ae.userType)||"companyDirector"===(null===ae||void 0===ae?void 0:ae.userType))&&(0,F.jsxs)("div",{className:"",children:[(0,F.jsx)(n.xI,{name:"PDBranchId",control:e,render:e=>{let{field:t}=e;return(0,F.jsxs)(p.A,(0,a.A)((0,a.A)({},t),{},{className:"inputAntdSelectClassNameFilterReport ",placeholder:"Select Branch",showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,F.jsx)(p.A.Option,{value:"",children:"Select Branch"}),null===re||void 0===re?void 0:re.map(e=>(0,F.jsxs)(p.A.Option,{value:null===e||void 0===e?void 0:e._id,children:[" ",null===e||void 0===e?void 0:e.fullName," "]}))]}))}}),t.PDBranchId&&(0,F.jsx)("p",{className:"text-red-500 text-sm",children:t.PDBranchId.message})]}),(0,F.jsx)("div",{className:"",children:(0,F.jsx)(n.xI,{name:"groupName",control:e,render:e=>{var t;let{field:l}=e;return(0,F.jsxs)(p.A,(0,a.A)((0,a.A)({},l),{},{className:"inputAntdSelectClassNameFilterReport",showSearch:!0,placeholder:"Select Group",onFocus:()=>{H((0,T.J_)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===ae||void 0===ae?void 0:ae.userType)?se:"company"===(null===ae||void 0===ae?void 0:ae.userType)?null===ae||void 0===ae?void 0:ae._id:null===ae||void 0===ae?void 0:ae.companyId,branchId:["admin","company","companyDirector"].includes(null===ae||void 0===ae?void 0:ae.userType)?ce:"companyBranch"===(null===ae||void 0===ae?void 0:ae.userType)?null===ae||void 0===ae?void 0:ae._id:null===ae||void 0===ae?void 0:ae.branchId,groupId:""}))},onChange:e=>l.onChange(e),filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,F.jsx)(p.A.Option,{value:"",children:"Select Group"}),X?(0,F.jsx)(p.A.Option,{disabled:!0,children:(0,F.jsx)(I.A,{})}):null===(t=(0,d._o)(W))||void 0===t?void 0:t.map(e=>(0,F.jsxs)(p.A.Option,{value:null===e||void 0===e?void 0:e._id,children:[null===e||void 0===e?void 0:e.fullName," (",null===e||void 0===e?void 0:e.groupName,")"]},null===e||void 0===e?void 0:e._id))]}))}})}),(0,F.jsx)("div",{children:(0,F.jsx)(n.xI,{name:"department",control:e,render:e=>{var t;let{field:l}=e;return(0,F.jsxs)(p.A,(0,a.A)((0,a.A)({},l),{},{className:"inputAntdSelectClassNameFilterReport",showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),onFocus:()=>{H((0,C.UU)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===ae||void 0===ae?void 0:ae.userType)?se:"company"===(null===ae||void 0===ae?void 0:ae.userType)?null===ae||void 0===ae?void 0:ae._id:null===ae||void 0===ae?void 0:ae.companyId,branchId:["admin","company","companyDirector"].includes(null===ae||void 0===ae?void 0:ae.userType)?ce:"companyBranch"===(null===ae||void 0===ae?void 0:ae.userType)?null===ae||void 0===ae?void 0:ae._id:null===ae||void 0===ae?void 0:ae.branchId}))},onChange:e=>{l.onChange(e)},placeholder:"Select Department",children:[(0,F.jsx)(p.A.Option,{value:"",children:"Select Department"}),Q?(0,F.jsx)(p.A.Option,{disabled:!0,children:(0,F.jsx)(I.A,{})}):null===(t=(0,d._o)(K))||void 0===t?void 0:t.map(e=>(0,F.jsx)(p.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.name},null===e||void 0===e?void 0:e._id))]}))}})}),(0,F.jsx)("div",{children:(0,F.jsx)(n.xI,{name:"client",control:e,render:e=>{var t;let{field:l}=e;return(0,F.jsxs)(p.A,(0,a.A)((0,a.A)({},l),{},{className:"inputAntdSelectClassNameFilterReport",showSearch:!0,placeholder:"Select Client",filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),onFocus:()=>{H((0,S.Aq)({companyId:"company"===(null===ae||void 0===ae?void 0:ae.userType)?null===ae||void 0===ae?void 0:ae._id:null===ae||void 0===ae?void 0:ae.companyId,branchId:"company"===(null===ae||void 0===ae?void 0:ae.userType)||"admin"===(null===ae||void 0===ae?void 0:ae.userType)||"companyDirector"===(null===ae||void 0===ae?void 0:ae.userType)?v("PDBranchId"):"companyBranch"===(null===ae||void 0===ae?void 0:ae.userType)?null===ae||void 0===ae?void 0:ae._id:null===ae||void 0===ae?void 0:ae.branchId,groupId:De,directorId:"",organizationId:"",industryId:"",text:"",sort:!0,status:!0,isPagination:!1}))},onChange:e=>{l.onChange(e)},children:[(0,F.jsx)(p.A.Option,{value:"",children:" Select Client"}),$?(0,F.jsx)(p.A.Option,{disabled:!0,children:(0,F.jsx)(I.A,{})}):null===(t=(0,d._o)(Z))||void 0===t?void 0:t.map((e,t)=>(0,F.jsx)(p.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}})}),(0,F.jsxs)("div",{className:"",children:[(0,F.jsx)(n.xI,{name:"employeeId",control:e,render:e=>{let{field:t}=e;return(0,F.jsx)(p.A,{allowClear:!0,className:"inputAntdMultiSelectClassNameFilterReport ",placeholder:"Select Employee",onFocus:Fe,options:null===ee||void 0===ee?void 0:ee.map(e=>({value:e._id,label:e.fullName})),value:t.value||[],onChange:e=>t.onChange(e)})}}),t.employeeId&&(0,F.jsx)("p",{className:"text-red-500 text-sm",children:t.employeeId.message})]}),(0,F.jsx)("div",{children:(0,F.jsx)(n.xI,{control:e,name:"task",render:e=>{var t;let{field:l}=e;return(0,F.jsxs)(p.A,(0,a.A)((0,a.A)({},l),{},{defaultValue:"",onFocus:()=>{H((0,k.mY)({companyId:"admin"===(null===ae||void 0===ae?void 0:ae.userType)?v("PDCompanyId"):"company"===(null===ae||void 0===ae?void 0:ae.userType)?null===ae||void 0===ae?void 0:ae._id:null===ae||void 0===ae?void 0:ae.companyId,branchId:"company"===(null===ae||void 0===ae?void 0:ae.userType)||"admin"===(null===ae||void 0===ae?void 0:ae.userType)||"companyDirector"===(null===ae||void 0===ae?void 0:ae.userType)?v("PDBranchId"):"companyBranch"===(null===ae||void 0===ae?void 0:ae.userType)?null===ae||void 0===ae?void 0:ae._id:null===ae||void 0===ae?void 0:ae.branchId,departmentId:"",directorId:"",text:"",sort:!0,status:!0,isPagination:!1}))},className:"inputAntdSelectClassNameFilterReport",showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,F.jsx)(p.A.Option,{value:"",children:" Select Task Name"}),G?(0,F.jsx)(p.A.Option,{disabled:!0,children:(0,F.jsx)(I.A,{})}):null===(t=(0,d._o)(q))||void 0===t?void 0:t.map((e,t)=>(0,F.jsx)(p.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.name}))]}))}})}),(0,F.jsx)("div",{children:(0,F.jsx)(n.xI,{name:"status",control:e,rules:{},render:e=>{let{field:t}=e;return(0,F.jsx)(p.A,(0,a.A)((0,a.A)({},t),{},{mode:"multiple",allowClear:!0,className:"inputAntdMultiSelectClassNameFilterReport",placeholder:"Please select Task Status",options:null===A.l0||void 0===A.l0?void 0:A.l0.map(e=>({value:e,label:e})),value:t.value||[],onChange:e=>t.onChange(e)}))}})}),(0,F.jsx)("div",{children:(0,F.jsx)(n.xI,{name:"priority",control:e,rules:{},render:e=>{let{field:t}=e;return(0,F.jsxs)(p.A,(0,a.A)((0,a.A)({},t),{},{className:"inputAntdSelectClassNameFilterReport ",placeholder:"Select Priority",showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,F.jsx)(p.A.Option,{value:"",children:"Select Priority"}),null===A.FQ||void 0===A.FQ?void 0:A.FQ.map(e=>(0,F.jsx)(p.A.Option,{value:e,children:e}))]}))}})}),(0,F.jsx)("div",{children:(0,F.jsx)(n.xI,{control:e,name:"financialYear",rules:{required:"Financial year is required"},render:e=>{let{field:t}=e;return(0,F.jsxs)(p.A,(0,a.A)((0,a.A)({},t),{},{defaultValue:M?"":(0,d.Yz)(),placeholder:"Select Financial year",className:"inputAntdSelectClassNameFilterReport",showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,F.jsx)(p.A.Option,{value:"",children:"Select Financial year"}),null===Ie||void 0===Ie?void 0:Ie.map((e,t)=>(0,F.jsx)(p.A.Option,{value:e,children:e},t))]}))}})}),(0,F.jsx)("div",{children:(0,F.jsx)(n.xI,{control:e,name:"month",render:e=>{let{field:t}=e;return(0,F.jsxs)(p.A,(0,a.A)((0,a.A)({},t),{},{placeholder:"Select month ",className:"inputAntdSelectClassNameFilterReport",showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,F.jsx)(p.A.Option,{value:"",children:"Select month "}),null===Te||void 0===Te?void 0:Te.map((e,t)=>(0,F.jsx)(p.A.Option,{value:e,children:e},t))]}))}})}),(0,F.jsx)("div",{children:(0,F.jsx)(n.xI,{name:"startDate",control:e,render:e=>{let{field:l}=e;return(0,F.jsx)(f.A,{report:!0,defaultValue:m()().subtract(1,"month"),size:"middle",field:l,errors:t})}})}),(0,F.jsx)("div",{children:(0,F.jsx)(n.xI,{name:"endDate",control:e,render:e=>{let{field:l}=e;return(0,F.jsx)(f.A,{report:!0,defaultValue:m()(),size:"middle",field:l,errors:t})}})})]}),(0,F.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,F.jsx)("button",{onClick:()=>{l("PDBranchId",""),l("PDCompanyId",""),l("status",""),l("employeeId",""),l("daterange",""),l("shift",""),l("workType",""),l("startDate",null),l("endDate",null),l("priority",""),l("financialYear",""),l("month",""),l("department",""),l("client",""),l("task",""),l("groupName",""),_e()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,F.jsx)("span",{className:"text-[12px]",children:"Reset"})}),(0,F.jsx)("button",{onClick:()=>{_e()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,F.jsx)("span",{className:"text-[12px]",children:"Submit"})})]})]})}];return(0,F.jsx)(s.A,{onChange:e=>{le(e)},children:(0,F.jsxs)("div",{className:"bg-grey-100 w-full p-1",children:[(0,F.jsxs)("div",{className:"space-y-1",children:[(0,F.jsx)(c.A,{className:"custom-collapse",items:Le,defaultActiveKey:[1],expandIcon:e=>{let{isActive:t}=e;return(0,F.jsx)(D.WnU,{size:20,style:{color:"white",transform:t?"rotate(-90deg)":"rotate(0deg)",transition:"transform 0.3s ease"}})}}),(0,F.jsxs)("div",{className:"space-y-1.5 sm:flex grid grid-cols-1 justify-between items-center",children:[(0,F.jsxs)("div",{className:"flex py-1 items-center gap-2",children:[(0,F.jsx)("span",{htmlFor:"pageSize",className:"text-sm font-light text-gray-500",children:"Rows per page:"}),(0,F.jsx)(p.A,{id:"pageSize",value:_,onChange:e=>{L(Number(e)),oe(Number(1))},className:"text-sm font-light text-gray-700 bg-white border border-gray-200 rounded-md px-3 py-1.5 shadow-sm focus:outline-none focus:ring-1 focus:ring-gray-300 transition",children:d.qc.map(e=>(0,F.jsx)(p.A.Option,{value:e,children:e},e))})]}),(0,F.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,F.jsx)("button",{onClick:()=>{(async()=>{var e,t;const l=new b.uE({orientation:"landscape",unit:"pt"});l.setFontSize(16);const a=await(null===j.K||void 0===j.K?void 0:j.K.overAllTaskReportFunc(Oe(!1)));if(!E&&!a)return;const n=null===a||void 0===a||null===(e=a.data)||void 0===e||null===(t=e.docs)||void 0===t?void 0:t.map((e,t)=>{var l,a,n,o;return[t+1,null!==e&&void 0!==e&&e.createdAt?m()(e.createdAt).format("DD-MM-YYYY"):"N/A",(null===e||void 0===e?void 0:e.code)||(null===e||void 0===e||null===(l=e._id)||void 0===l?void 0:l.substring(0,8))+"..."||0,(null===e||void 0===e||null===(a=e.clientData)||void 0===a?void 0:a.fullName)||"N/A",(null===e||void 0===e||null===(n=e.departmentData)||void 0===n?void 0:n.name)||"N/A",(null===e||void 0===e?void 0:e.taskName)||"N/A",Array.isArray(null===e||void 0===e?void 0:e.employeData)?e.employeData.map(e=>(null===e||void 0===e?void 0:e.fullName)||"-").join(", "):(null===e||void 0===e?void 0:e.employeData)||"N/A",(null===e||void 0===e?void 0:e.financialYear)||"N/A",null!==e&&void 0!==e&&e.monthName?"".concat(e.monthName," (").concat((null===e||void 0===e?void 0:e.monthQuaters)||"",")"):(null===e||void 0===e?void 0:e.type)||"N/A",null!==e&&void 0!==e&&e.dueDate?m()(e.dueDate).format("DD-MM-YYYY"):"N/A",null!==e&&void 0!==e&&e.isOverDue?null!==e&&void 0!==e&&e.dueDate?"".concat(m()().diff(m()(e.dueDate),"days")," days"):"Overdue":null!==e&&void 0!==e&&e.dueDate?m()().isAfter(m()(e.dueDate))?"".concat(m()().diff(m()(e.dueDate),"days")," days"):"Not Overdue":"N/A",(null===e||void 0===e||null===(o=e.status)||void 0===o?void 0:o.replace(/_/g," ").toLowerCase().replace(/\b\w/g,e=>e.toUpperCase()))||"N/A"]});(0,g.Ay)(l,{startY:40,head:[["S.No.","Date","Task ID","Client Name","Department Name","Task Name","Assigned To","F.Y.","Period","Due Date","Overdue Period","Latest Status"]],body:n,margin:{horizontal:10},styles:{cellPadding:8,fontSize:10,valign:"middle",halign:"left"},headStyles:{fillColor:[211,211,211],textColor:[0,0,0],fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]}}),l.save("AllTaskReport.pdf")})()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,F.jsx)("span",{className:"text-[12px]",children:"Export PDF"})}),(0,F.jsx)("button",{onClick:()=>{(async()=>{var e,t;const l=new w.Workbook,a=l.addWorksheet("AllTaskReport");a.columns=[{header:"S.No.",key:"sno",width:10},{header:"Date",key:"date",width:15},{header:"Task ID",key:"taskId",width:20},{header:"Client Name",key:"clientName",width:30},{header:"Department Name",key:"department",width:25},{header:"Task Name",key:"taskName",width:30},{header:"Assigned To",key:"assignedTo",width:30},{header:"F.Y.",key:"financialYear",width:15},{header:"Period",key:"period",width:25},{header:"Due Date",key:"dueDate",width:15},{header:"Overdue Period",key:"overduePeriod",width:20},{header:"Latest Status",key:"status",width:20}],a.getRow(1).eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFB6D7A8"}},e.font={bold:!0},e.alignment={vertical:"middle",horizontal:"center"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});const n=await(null===j.K||void 0===j.K?void 0:j.K.overAllTaskReportFunc(Oe(!1)));if(!E&&!n)return;const o=null===n||void 0===n||null===(e=n.data)||void 0===e||null===(t=e.docs)||void 0===t?void 0:t.map((e,t)=>{var l,a,n,o;return{sno:t+1,date:null!==e&&void 0!==e&&e.createdAt?m()(e.createdAt).format("DD-MM-YYYY"):"-",taskId:(null===e||void 0===e?void 0:e.code)||(null===e||void 0===e||null===(l=e._id)||void 0===l?void 0:l.substring(0,8))+"..."||0,clientName:(null===e||void 0===e||null===(a=e.clientData)||void 0===a?void 0:a.fullName)||"-",department:(null===e||void 0===e||null===(n=e.departmentData)||void 0===n?void 0:n.name)||"-",taskName:(null===e||void 0===e?void 0:e.taskName)||"-",assignedTo:Array.isArray(null===e||void 0===e?void 0:e.employeData)?e.employeData.map(e=>(null===e||void 0===e?void 0:e.fullName)||"-").join(", "):(null===e||void 0===e?void 0:e.employeData)||"-",financialYear:(null===e||void 0===e?void 0:e.financialYear)||"-",period:null!==e&&void 0!==e&&e.monthName?"".concat(e.monthName," (").concat((null===e||void 0===e?void 0:e.monthQuaters)||"",")"):(null===e||void 0===e?void 0:e.type)||"-",dueDate:null!==e&&void 0!==e&&e.dueDate?m()(e.dueDate).format("DD-MM-YYYY"):"-",overduePeriod:null!==e&&void 0!==e&&e.isOverDue?null!==e&&void 0!==e&&e.dueDate?"".concat(m()().diff(m()(e.dueDate),"days")," days"):"Overdue":null!==e&&void 0!==e&&e.dueDate?m()().isAfter(m()(e.dueDate))?"".concat(m()().diff(m()(e.dueDate),"days")," days"):"Not Overdue":"-",status:(null===e||void 0===e||null===(o=e.status)||void 0===o?void 0:o.replace(/_/g," ").toLowerCase().replace(/\b\w/g,e=>e.toUpperCase()))||"-"}});null===o||void 0===o||o.forEach(e=>{a.addRow(e).eachCell(e=>{e.alignment={vertical:"middle",horizontal:"left"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),a.autoFilter={from:"A1",to:"I1"},l.xlsx.writeBuffer().then(e=>{const t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=document.createElement("a");l.href=URL.createObjectURL(t),l.download="AllTaskReport.xlsx",l.click()})})()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,F.jsx)("span",{className:"text-[12px]",children:"Export Excel"})})]})]})]}),(0,F.jsxs)("div",{className:"bg-[#ffffff]  w-full overflow-x-auto mt-1 rounded-xl",children:[(0,F.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto",children:[(0,F.jsx)("thead",{children:(0,F.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] capitalize text-[12px] bg-header text-white font-[500] h-[40px]",children:[(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap text-center w-[5%]",children:"S.No."}),(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap text-center",children:"Date"}),(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap text-center",children:"Task ID"}),(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap text-center",children:"Client Name"}),(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap text-center",children:"Department Name"}),(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap text-center",children:"Task Name"}),(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap text-center",children:"Assigned To"}),(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap text-center",children:"F.Y."}),(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap text-center",children:"Period"}),(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap text-center",children:"Due Date"}),(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap text-center",children:"Overdue Period"}),(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap text-center",children:"Latest Status"})]})}),U?(0,F.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,F.jsx)("td",{colSpan:12,className:"px-6 py-2 whitespace-nowrap text-center font-[600] text-sm text-gray-500",children:(0,F.jsx)(N.A,{})})}):(0,F.jsx)("tbody",{children:E&&(null===E||void 0===E?void 0:E.length)>0?null===E||void 0===E?void 0:E.map((e,t)=>{var l,a,n,o,d,i,r,s,c,u,p,v;return(0,F.jsxs)("tr",{className:"border-b-[1px] ".concat(t%2===0?"bg-[#e9ecef]/80":"bg-white"," border-[#DDDDDD] text-[#374151] text-[14px]"),children:[(0,F.jsx)("td",{className:"whitespace-nowrap text-center border-none p-2",children:t+1+(ne-1)*_}),(0,F.jsx)("td",{className:"whitespace-nowrap text-center border-none p-2",children:null!==e&&void 0!==e&&e.createdAt?m()(e.createdAt).format("DD-MM-YYYY"):"-"}),(0,F.jsx)("td",{className:"whitespace-nowrap text-center border-none p-2",children:(null===e||void 0===e?void 0:e.code)||(null===e||void 0===e||null===(l=e._id)||void 0===l?void 0:l.substring(0,8))+"..."||0}),(0,F.jsx)("td",{className:"whitespace-nowrap text-center border-none p-2",children:(null===e||void 0===e||null===(a=e.clientData)||void 0===a?void 0:a.fullName)||"-"}),(0,F.jsx)("td",{className:"whitespace-nowrap text-center border-none p-2",children:(null===e||void 0===e||null===(n=e.departmentData)||void 0===n?void 0:n.name)||"-"}),(0,F.jsx)("td",{className:"whitespace-nowrap text-center border-none p-2",children:(null===e||void 0===e?void 0:e.taskName)||"-"}),(0,F.jsx)("td",{className:"whitespace-nowrap text-center border-none p-2",children:(0,F.jsxs)("div",{className:"flex gap-2",children:[(0,F.jsxs)("div",{children:[" ",(null===e||void 0===e||null===(o=e.employeData)||void 0===o||null===(d=o[0])||void 0===d?void 0:d.fullName)||"-"]}),(null===e||void 0===e||null===(i=e.employeData)||void 0===i?void 0:i.length)>1?(0,F.jsxs)("div",{className:"text-header flex justify-center items-center gap-1 rounded-full text-semibold text-sm",children:["+ ",(0,F.jsx)("div",{onClick:()=>{(e=>{ge(e||[]),Ce(!0)})(null===e||void 0===e?void 0:e.employeData)},className:"border justify-center items-center flex h-5 w-5 bg-header text-white text-[12px] rounded-full cursor-pointer",children:(null===e||void 0===e||null===(r=e.employeData)||void 0===r?void 0:r.length)-1})]}):""]})}),(0,F.jsx)("td",{className:"whitespace-nowrap text-center border-none p-2",children:(null===e||void 0===e?void 0:e.financialYear)||"-"}),(0,F.jsx)("td",{className:"whitespace-nowrap text-center border-none p-2",children:null!==e&&void 0!==e&&e.monthName?"".concat(e.monthName," (").concat((null===e||void 0===e?void 0:e.monthQuaters)||"",")"):(null===e||void 0===e?void 0:e.type)||"-"}),(0,F.jsx)("td",{className:"whitespace-nowrap text-center border-none p-2",children:null!==e&&void 0!==e&&e.dueDate?m()(e.dueDate).format("DD-MM-YYYY"):"-"}),(0,F.jsx)("td",{className:"whitespace-nowrap text-center border-none p-2",children:null!==e&&void 0!==e&&e.isOverDue?null!==e&&void 0!==e&&e.dueDate?"".concat(m()().diff(m()(e.dueDate),"days")," days"):"Overdue":null!==e&&void 0!==e&&e.dueDate?m()().isAfter(m()(e.dueDate))?"".concat(m()().diff(m()(e.dueDate),"days")," days"):"Not Overdue":"-"}),(0,F.jsx)("td",{className:"whitespace-nowrap text-center border-none p-2",children:(0,F.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("completed"===(null===e||void 0===e||null===(s=e.status)||void 0===s?void 0:s.toLowerCase())?"bg-green-100 text-green-800":"pending"===(null===e||void 0===e||null===(c=e.status)||void 0===c?void 0:c.toLowerCase())?"bg-yellow-100 text-yellow-800":"in_progress"===(null===e||void 0===e||null===(u=e.status)||void 0===u?void 0:u.toLowerCase())?"bg-blue-100 text-blue-800":"in_review"===(null===e||void 0===e||null===(p=e.status)||void 0===p?void 0:p.toLowerCase())?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"),children:(null===e||void 0===e||null===(v=e.status)||void 0===v?void 0:v.replace(/_/g," ").toLowerCase().replace(/\b\w/g,e=>e.toUpperCase()))||"-"})})]})}):(0,F.jsx)("tr",{className:"bg-white bg-opacity-5",children:(0,F.jsx)("td",{colSpan:12,className:"px-6 py-2 whitespace-nowrap text-center font-[600] text-sm text-gray-500",children:"Record Not Found"})})})]}),(0,F.jsx)(u.A,{className:"antmodalclassName !w-[60%] !h-[50%]",title:"Employees",open:Ae,onCancel:()=>Ce(!1),footer:null,children:(0,F.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto",children:[(0,F.jsx)("thead",{children:(0,F.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] capitalize text-[12px] bg-header text-white font-[500] h-[40px]",children:[(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap  w-[5%]",children:"S.No."}),(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Employee Name"}),(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Email"}),(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Mobile"})]})}),0==be.length?(0,F.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,F.jsx)("td",{colSpan:12,className:"px-6 py-2 whitespace-nowrap  font-[600] text-sm text-gray-500",children:(0,F.jsx)(N.A,{})})}):(0,F.jsx)("tbody",{children:be&&(null===be||void 0===be?void 0:be.length)>0?null===be||void 0===be?void 0:be.map((e,t)=>{var l,a;return(0,F.jsxs)("tr",{className:"border-b-[1px] ".concat(t%2===0?"bg-[#e9ecef]/80":"bg-white"," border-[#DDDDDD] text-[#374151] text-[14px]"),children:[(0,F.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:t+1}),(0,F.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:null===e||void 0===e?void 0:e.fullName}),(0,F.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:(null===e||void 0===e?void 0:e.email)||"-"}),(0,F.jsxs)("td",{className:"whitespace-nowrap  border-none p-2",children:[(null===e||void 0===e||null===(l=e.mobile)||void 0===l?void 0:l.code)||"-"," ",(null===e||void 0===e||null===(a=e.mobile)||void 0===a?void 0:a.number)||"-"]})]})}):(0,F.jsx)("tr",{className:"bg-white bg-opacity-5",children:(0,F.jsx)("td",{colSpan:12,className:"px-6 py-2 whitespace-nowrap  font-[600] text-sm text-gray-500",children:"Record Not Found"})})})]})})]}),(0,F.jsx)(h.A,{totalCount:J,pageSize:_,currentPage:ne,onChange:e=>{oe(e)}})]})})}}}]);
//# sourceMappingURL=602.2849856e.chunk.js.map