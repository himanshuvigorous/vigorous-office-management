"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[9287],{9287:(e,s,l)=>{l.r(s),l.d(s,{default:()=>C});var a=l(89379),d=l(65043),t=l(24858),r=l(83003),n=l(73216),i=l(15187),o=l(735),c=l(78729),m=l(39160),u=l(31744),x=l(51957),v=l(65512),p=(l(36105),l(30575),l(84480),l(42837)),h=(l(70337),l(56659)),N=(l(86178),l(17995)),j=l(84448),g=l(89427),b=l(33007),y=l(31174),f=l(58215),D=l(94084),I=l(60446),A=l.n(I),P=l(70579);const C=function(){const{register:e,handleSubmit:s,setValue:l,getValues:I,unregister:C,watch:w,control:S,formState:{errors:q}}=(0,t.mN)(),{userCompanyId:O,userDirectorId:M,userBranchId:L,userEmployeId:T,userDepartmentId:E,userDesignationId:H,userType:Y}=(0,o.A)(),{clientIdEnc:_}=(0,n.g)(),{companyList:Q,companyListLoading:V}=((0,y.Yc)(_),(0,r.d4)(e=>e.company)),{countryListData:F}=(0,r.d4)(e=>e.country),{stateListData:k}=(0,r.d4)(e=>e.states),{cityListData:B}=(0,r.d4)(e=>e.city),{employeList:U,loading:R}=(0,r.d4)(e=>e.employe),{clientList:z}=(0,r.d4)(e=>e.client),{departmentListData:J,loading:K}=(0,r.d4)(e=>e.department),Z=(0,n.Zp)(),$=(0,r.wA)(),{branchList:G,branchListloading:W}=(0,r.d4)(e=>e.branch),{VisitReasonList:X,loading:ee}=(0,r.d4)(e=>e.visitReason),[se,le]=(0,d.useState)([]),[ae,de]=(0,d.useState)(""),[te,re]=(0,d.useState)(""),ne=(0,t.FH)({control:S,name:"companyId",defaultValue:O}),ie=(0,t.FH)({control:S,name:"branchId",defaultValue:""}),oe=(0,t.FH)({control:S,name:"PDPinCode",defaultValue:""}),ce=(0,t.FH)({control:S,name:"PDDepartmentId",defaultValue:""}),me=((0,t.FH)({control:S,name:"PDState",defaultValue:""}),(0,t.FH)({control:S,name:"PDCountry",defaultValue:""}),(0,t.FH)({control:S,name:"PDDepartmentId",defaultValue:[]})),ue=(0,t.FH)({control:S,name:"category",defaultValue:""}),xe=(0,t.FH)({control:S,name:"clientId",defaultValue:""}),[ve,pe]=(0,d.useState)();(0,d.useEffect)(()=>{},[se]),(0,d.useEffect)(()=>{$((0,j.Ih)({companyId:ne,directorId:"",branchId:ie,text:"",sort:!0,status:!0,isPagination:!1}))},[ie,ne]),(0,d.useEffect)(()=>{var e,s,a,d,t,r,n,i,o,c,m,u;const x=null===z||void 0===z?void 0:z.find(e=>e._id===xe);l("PDAddress",null===x||void 0===x||null===(e=x.addresses)||void 0===e||null===(s=e.primary)||void 0===s?void 0:s.street),l("PDState",null===x||void 0===x||null===(a=x.addresses)||void 0===a||null===(d=a.primary)||void 0===d?void 0:d.state),l("PDCountry",null===x||void 0===x||null===(t=x.addresses)||void 0===t||null===(r=t.primary)||void 0===r?void 0:r.country),l("PDCity",null===x||void 0===x||null===(n=x.addresses)||void 0===n||null===(i=n.primary)||void 0===i?void 0:i.city),l("PDPinCode",null===x||void 0===x||null===(o=x.addresses)||void 0===o||null===(c=o.primary)||void 0===c?void 0:c.pinCode),l("PDMobileCode",null===x||void 0===x||null===(m=x.mobile)||void 0===m?void 0:m.code),l("PDMobileNo",null===x||void 0===x||null===(u=x.mobile)||void 0===u?void 0:u.number)},[xe]),(0,d.useEffect)(()=>{"admin"===Y&&$((0,c.Ar)({text:"",sort:!0,status:!0,isPagination:!1}))},[]),(0,d.useEffect)(()=>{(ne||"company"===Y||"companyDirector"===Y)&&$((0,u.d0)({text:"",sort:!0,status:!0,companyId:ne,isPagination:!1}))},[ne]),(0,d.useEffect)(()=>{$((0,b.UU)({text:"",sort:!0,status:!0,isPagination:!1,companyId:ne,branchId:ie}))},[ie]),(0,d.useEffect)(()=>{oe&&oe.length>=4&&oe.length<=6&&/^\d{6}$/.test(oe)&&(0,i.jh)(oe).then(e=>{e&&(l("PDCity",e.city),l("PDState",e.state),l("PDCountry",e.country),l("PDMobileCode","+91"))}).catch(e=>{console.error("Error fetching data:",e)})},[oe]),JSON.parse(localStorage.getItem("user_info_".concat(i.AU)));const{loading:he}=(0,r.d4)(e=>e.visitor),[Ne,je]=(0,d.useState)([]),[ge,be]=(0,d.useState)([]),[ye,fe]=(0,d.useState)([]),[De,Ie]=(0,d.useState)(!1),[Ae,Pe]=(0,d.useState)(!1),Ce=null===Ne||void 0===Ne?void 0:Ne.map(e=>e.value),we=null===ge||void 0===ge?void 0:ge.map(e=>e.value),Se="__all__",qe="__all__",Oe=[{label:"Select All",value:Se},...Ne],Me=[{label:"Select All",value:qe},...Array.isArray(ge)?ge:[]],Le=()=>{$((0,b.UU)({text:"",sort:!0,status:!0,isPagination:!1,companyId:ne,branchId:ie})).then(e=>{var s,l,a;const d=null===e||void 0===e||null===(s=e.payload)||void 0===s||null===(l=s.data)||void 0===l||null===(a=l.docs)||void 0===a?void 0:a.map(e=>{var s;return{label:null===e||void 0===e?void 0:e.name,value:null===e||void 0===e?void 0:e._id,searchText:null===e||void 0===e||null===(s=e.name)||void 0===s?void 0:s.toLowerCase()}});je(d)})},Te=()=>{const e={directorId:"",companyId:ne,branchId:ie,departmentId:ae,text:"",sort:!0,status:"",isPagination:!1,multipleDepartmentId:me};$((0,p.qV)(e)).then(e=>{var s,l,a;const d=null===e||void 0===e||null===(s=e.payload)||void 0===s||null===(l=s.data)||void 0===l||null===(a=l.docs)||void 0===a?void 0:a.map(e=>{var s;return{label:null===e||void 0===e?void 0:e.fullName,value:null===e||void 0===e?void 0:e._id,searchText:null===e||void 0===e||null===(s=e.fullName)||void 0===s?void 0:s.toLowerCase()}});be(d)})};return(0,P.jsx)(m.A,{children:(0,P.jsx)("div",{className:"gap-4",children:(0,P.jsxs)("form",{autoComplete:"off",className:"mt-5",onSubmit:s(e=>{var s,l,a;const d={companyId:ne,directorId:"",branchId:ie,departmentIds:null===e||void 0===e?void 0:e.PDDepartmentId,name:null===e||void 0===e?void 0:e.visitorName,employeIds:null===e||void 0===e?void 0:e.contactPersonId,reason:null===e||void 0===e?void 0:e.reason,numberOfPerson:Number(null===e||void 0===e?void 0:e.numberOfPerson),clientId:null===e||void 0===e?void 0:e.clientId,employeId:null===e||void 0===e?void 0:e.employeId,category:"general",timeDurationStart:null===e||void 0===e?void 0:e.startTime,timeDurationEnd:null===e||void 0===e?void 0:e.endTime,date:null===e||void 0===e?void 0:e.date,address:{street:null!==(s=null===e||void 0===e?void 0:e.PDAddress)&&void 0!==s?s:""},mobile:{number:null!==(l=null===e||void 0===e?void 0:e.PDMobileNo)&&void 0!==l?l:"",code:null!==(a=null===e||void 0===e?void 0:e.PDMobileCode)&&void 0!==a?a:""}};$((0,f.fw)(d)).then(e=>{e.error||Z(-1)})}),children:[(0,P.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 md:my-2",children:["admin"===Y&&(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsxs)("label",{className:"".concat(i.Q0),children:["Company ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)(t.xI,{control:S,name:"companyId",rules:{required:"Company is required"},render:e=>{let{field:s}=e;return(0,P.jsxs)(v.A,(0,a.A)((0,a.A)({},s),{},{defaultValue:"",className:" ".concat(i.Hy," ").concat(q.companyId?"border-[1px] ":"border-gray-300"),showSearch:!0,filterOption:(e,s)=>String(null===s||void 0===s?void 0:s.children).toLowerCase().includes(e.toLowerCase()),onFocus:()=>{$((0,c.Ar)({text:"",sort:!0,status:"",isPagination:!1}))},children:[(0,P.jsx)(v.A.Option,{value:"",children:"Select Company"}),V?(0,P.jsx)(v.A.Option,{disabled:!0,children:(0,P.jsx)(g.A,{})}):null===Q||void 0===Q?void 0:Q.map(e=>(0,P.jsx)(v.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),q.companyId&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:q.companyId.message})]}),("admin"===Y||"company"===Y||"companyDirector"===Y)&&(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsxs)("label",{className:"".concat(i.Q0),children:["Branch ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)(t.xI,{control:S,name:"branchId",rules:{required:"Branch is required"},render:e=>{let{field:s}=e;return(0,P.jsxs)(v.A,(0,a.A)((0,a.A)({},s),{},{defaultValue:"",className:" ".concat(i.Hy," "),showSearch:!0,filterOption:(e,s)=>String(null===s||void 0===s?void 0:s.children).toLowerCase().includes(e.toLowerCase()),onFocus:()=>{const e={text:"",sort:!0,status:"",companyId:ne,isPagination:!1};$((0,u.d0)(e))},children:[(0,P.jsx)(v.A.Option,{value:"",children:"Select Branch"}),W?(0,P.jsx)(v.A.Option,{disabled:!0,children:(0,P.jsx)(g.A,{})}):null===G||void 0===G?void 0:G.map(e=>(0,P.jsx)(v.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),q.branchId&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:q.branchId.message})]}),(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsxs)("label",{className:"".concat(i.Q0),children:["Name ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)("input",(0,a.A)((0,a.A)({type:"text"},e("visitorName",{required:"Name is required"})),{},{className:"placeholder: ".concat(i.Ol," ").concat(q.visitorName?"border-[1px] ":"border-gray-300"),placeholder:"Enter Name"})),q.visitorName&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:q.visitorName.message})]}),(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsxs)("label",{className:"".concat(i.Q0),children:["Department ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)(t.xI,{name:"PDDepartmentId",control:S,rules:{required:"At least one Department is required"},render:e=>{let{field:s}=e;return(0,P.jsx)(v.A,{mode:"multiple",placeholder:"Assign To",value:s.value||[],onChange:e=>{e.includes(Se)?De?(s.onChange([]),Ie(!1)):(s.onChange(Ce),Ie(!0)):(s.onChange(e),Ie(e.length===Ce.length))},onFocus:Le,size:"large",style:{width:"100%"},options:Oe,className:i.Hy,showSearch:!0,filterOption:(e,s)=>String(null===s||void 0===s?void 0:s.children).toLowerCase().includes(e.toLowerCase())})}}),q.PDDepartmentId&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:q.PDDepartmentId.message})]}),"employe"===ue&&(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsxs)("label",{className:"".concat(i.Q0),children:["Employe ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsxs)("select",(0,a.A)((0,a.A)({onFocus:()=>{const e={directorId:"",companyId:ne,branchId:ie,departmentId:ce,text:"",sort:!0,status:"",isPagination:!1};$((0,p.qV)(e))}},e("employeId",{required:"Employe is required"})),{},{className:" ".concat(i.Ol," ").concat(q.employeId?"border-[1px] ":"border-gray-300"),showSearch:!0,filterOption:(e,s)=>String(null===s||void 0===s?void 0:s.children).toLowerCase().includes(e.toLowerCase()),children:[(0,P.jsx)("option",{className:"",value:"",children:"Select Employe"}),null===U||void 0===U?void 0:U.map(e=>(0,P.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName}))]})),q.employeId&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:q.employeId.message})]}),(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsxs)("label",{className:"".concat(i.Q0),children:["Contact Person ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)(t.xI,{name:"contactPersonId",control:S,rules:{required:"At least one Contact Person is required"},render:e=>{let{field:s}=e;return(0,P.jsx)(v.A,{mode:"multiple",placeholder:"Assign To",value:s.value||[],onChange:e=>{e.includes(qe)?qe?(s.onChange([]),Pe(!1)):(s.onChange(we),Pe(!0)):(s.onChange(e),Pe(e.length===we.length))},onFocus:Te,size:"large",style:{width:"100%"},options:Me||[],className:i.Hy,showSearch:!0,filterOption:(e,s)=>String(null===s||void 0===s?void 0:s.children).toLowerCase().includes(e.toLowerCase())})}}),q.contactPersonId&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:q.contactPersonId.message})]}),(0,P.jsxs)("div",{className:"",children:[(0,P.jsxs)("label",{className:"".concat(i.Q0),children:["Start Time ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)(t.xI,{name:"startTime",control:S,showTime:!0,rules:{required:"Start Time  is required"},format:"DD/MM/YYYY HH:mm",render:e=>{let{field:s}=e;return(0,P.jsx)(D.A,{field:s,showTime:!0,format:"DD/MM/YYYY HH:mm",errors:q,disabledDate:e=>e&&e.isBefore(A()().endOf("day"),"day")})}}),q.startTime&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:q.startTime.message})]}),(0,P.jsxs)("div",{className:"",children:[(0,P.jsxs)("label",{className:"".concat(i.Q0),children:["End Time ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)(t.xI,{name:"endTime",control:S,showTime:!0,rules:{required:"ENd Time  is required"},format:"DD/MM/YYYY HH:mm",render:e=>{let{field:s}=e;return(0,P.jsx)(D.A,{field:s,showTime:!0,format:"DD/MM/YYYY HH:mm",errors:q,disabledDate:e=>e&&e.isBefore(A()().endOf("day"),"day")})}}),q.endTime&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:q.endTime.message})]}),(0,P.jsxs)("div",{className:"",children:[(0,P.jsxs)("label",{className:"".concat(i.Q0),children:["Date ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)(t.xI,{name:"date",control:S,showTime:!0,rules:{required:"ENd Time  is required"},format:"DD/MM/YYYY",render:e=>{let{field:s}=e;return(0,P.jsx)(D.A,{field:s,errors:q,disabledDate:e=>e&&e.isBefore(A()().endOf("day"),"day")})}}),q.endTime&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:q.endTime.message})]}),"employe"!==ue&&(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsxs)("label",{className:"".concat(i.Q0),children:["Number Of Person ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)("input",(0,a.A)((0,a.A)({type:"number"},e("numberOfPerson",{required:"Number Of Person is required"})),{},{className:"placeholder: ".concat(i.Ol," ").concat(q.numberOfPerson?"border-[1px] ":"border-gray-300"),placeholder:"Enter Number Of Person"})),q.numberOfPerson&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:q.numberOfPerson.message})]}),(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsxs)("label",{className:"".concat(i.Q0),children:["Reason ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)(t.xI,{control:S,name:"reason",rules:{required:"reason is required"},render:e=>{var s;let{field:l}=e;return(0,P.jsx)(x.A,(0,a.A)((0,a.A)({className:"w-full"},l),{},{onChange:e=>{l.onChange(e)},options:null===(s=(0,i._o)(X))||void 0===s?void 0:s.map(e=>({value:null===e||void 0===e?void 0:e.title})),notFoundContent:(0,P.jsx)(g.A,{}),children:(0,P.jsx)("input",{placeholder:"Enter Country",className:"".concat(i.Ol)})}))}}),q.reason&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:q.reason.message})]}),"employe"===ue&&(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsxs)("label",{className:"".concat(i.Q0),children:["KM ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)("input",(0,a.A)((0,a.A)({type:"number"},e("kilometer",{required:"Number kilometer is required"})),{},{className:"placeholder: ".concat(i.Ol," ").concat(q.kilometer?"border-[1px] ":"border-gray-300"),placeholder:"Enter Number kilometer"})),q.designationName&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:q.kilometer.message})]}),"employe"===ue&&(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsxs)("label",{className:"".concat(i.Q0),children:["Date ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)("input",(0,a.A)((0,a.A)({type:"date",min:(new Date).toISOString().split("T")[0]},e("date",{required:"Date is required"})),{},{className:" ".concat(i.Ol," ").concat(q.date?"border-[1px] ":"border-gray-300"),placeholder:"Enter Date of Birth"})),q.date&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:q.date.message})]})]}),(0,P.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 md:gap-8 md:my-1 md:mt-4",children:(0,P.jsxs)("div",{className:"col-span-2",children:[(0,P.jsxs)("label",{className:"".concat(i.Q0),children:["Address"," ","general"!==ue&&(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)("input",(0,a.A)((0,a.A)({type:"text"},e("PDAddress",{required:"general"!==ue&&"Address is required"})),{},{className:"".concat(i.Ol," ").concat(q.PDAddress?"border-[1px] ":"border-gray-300"),placeholder:"Enter Address "})),q.PDAddress&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:q.PDAddress.message})]})}),(0,P.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 md:gap-8 gap-3 md:my-1 ",children:(0,P.jsxs)("div",{className:"flex gap-3",children:[(0,P.jsxs)("div",{className:"w-[150px]",children:[(0,P.jsxs)("label",{className:"".concat(i.Q0),children:["Code ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)(t.xI,{control:S,name:"PDMobileCode",rules:{required:"code is required"},render:e=>{let{field:s}=e;return(0,P.jsx)(h.A,{field:s,errors:q})}}),q.PDMobileCode&&(0,P.jsx)("p",{className:"".concat(i.ci),children:q.PDMobileCode.message})]}),(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsxs)("label",{className:"".concat(i.Q0),children:["Mobile No ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)("input",(0,a.A)((0,a.A)({type:"number"},e("PDMobileNo",{required:"Mobile No is required",minLength:{value:10,message:"Must be exactly 10 digits"},maxLength:{value:10,message:"Must be exactly 10 digits"}})),{},{className:" ".concat(i.Ol," ").concat(q.PDMobileNo?"border-[1px] ":"border-gray-300"),placeholder:"Enter Mobile No",maxLength:10,onInput:e=>{e.target.value.length>10&&(e.target.value=e.target.value.slice(0,10))}})),q.PDMobileNo&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:q.PDMobileNo.message})]})]})}),(0,P.jsx)("div",{className:"flex justify-end ",children:(0,P.jsx)("button",{type:"submit",disabled:he,className:"".concat(he?"bg-gray-400":"bg-header"," text-white p-2 px-4 rounded mt-3"),children:he?(0,P.jsx)(N.A,{}):"Submit"})})]})})})}}}]);
//# sourceMappingURL=9287.8b1aba04.chunk.js.map