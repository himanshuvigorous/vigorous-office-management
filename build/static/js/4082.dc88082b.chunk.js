"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[4082],{549:(e,s,t)=>{t.d(s,{A:()=>A});var i=t(89379),l=t(65043),a=t(24858),r=t(13382),n=t(53913),d=t(65512),o=t(83003),c=t(735),m=t(15187),x=t(31744),u=(t(17995),t(89427)),h=t(60089),p=t(57944),v=t(60184),j=t(42837),g=t(88967),f=t(86178),y=t.n(f),N=(t(60446),t(94084)),b=t(70579);const A=function(e){let{isOpen:s,data:t,fetchListAfterSuccess:f,closeModalFunc:A,handlingPerson:w="manager",isDirector:T=!1}=e;const{loading:k}=(0,o.d4)(e=>e.projectTask),{register:S,handleSubmit:C,setValue:I,control:D,watch:_,reset:P,formState:{errors:O}}=(0,a.mN)(),{userCompanyId:M,userDirectorId:Y,userBranchId:B,userType:L}=(0,c.A)(),q=(0,o.wA)(),[H,z]=(0,l.useState)([]),{branchList:R,branchListloading:E}=(0,o.d4)(e=>e.branch),F=JSON.parse(localStorage.getItem("user_info_".concat(m.AU))),{employeList:Q,loading:V}=(0,o.d4)(e=>e.employe),{projectmanagementList:K}=(0,o.d4)(e=>e.projectManagement),U=(0,a.FH)({control:D,name:"PDCompanyId",defaultValue:M}),W=(0,a.FH)({control:D,name:"relatedTo",defaultValue:""}),J=(0,a.FH)({control:D,name:"PDBranchId",defaultValue:B});(0,l.useEffect)(()=>{s&&("company"!==L&&"companyDirector"!==L||q((0,x.d0)({text:"",sort:!0,status:!0,companyId:U,isPagination:!1})))},[s,U]),(0,l.useEffect)(()=>{s&&(!U&&"admin"===(null===F||void 0===F?void 0:F.userType)||!J&&"companBranch"===(null===F||void 0===F?void 0:F.userType)&&"employee"!==(null===F||void 0===F?void 0:F.userType)||("manager"===w&&G(),q((0,p.vH)({directorId:"",companyId:"admin"===(null===F||void 0===F?void 0:F.userType)?U:"company"===(null===F||void 0===F?void 0:F.userType)?null===F||void 0===F?void 0:F._id:null===F||void 0===F?void 0:F.companyId,branchId:"company"===(null===F||void 0===F?void 0:F.userType)||"admin"===(null===F||void 0===F?void 0:F.userType)||"companyDirector"===(null===F||void 0===F?void 0:F.userType)?J:"companyBranch"===(null===F||void 0===F?void 0:F.userType)?null===F||void 0===F?void 0:F._id:null===F||void 0===F?void 0:F.branchId,text:"",sort:!0,status:"",isPagination:!1}))))},[s,U,J]);const G=()=>{const e={text:"",status:!0,sort:!0,isTL:"",isHR:"",isPagination:!1,departmentId:T?"":"employee"===(null===F||void 0===F?void 0:F.userType)?null===F||void 0===F?void 0:F.departmentId:"",designationId:"",companyId:"admin"===(null===F||void 0===F?void 0:F.userType)?U:"company"===(null===F||void 0===F?void 0:F.userType)?null===F||void 0===F?void 0:F._id:null===F||void 0===F?void 0:F.companyId,branchId:"company"===(null===F||void 0===F?void 0:F.userType)||"admin"===(null===F||void 0===F?void 0:F.userType)||"companyDirector"===(null===F||void 0===F?void 0:F.userType)?J:"companyBranch"===(null===F||void 0===F?void 0:F.userType)?null===F||void 0===F?void 0:F._id:null===F||void 0===F?void 0:F.branchId};q((0,j.qV)(e))},X=()=>{P(),z([]),A()};return(0,b.jsx)(n.A,{title:"Create Project Task",open:s,onCancel:X,footer:null,width:800,centered:!0,className:"antmodalclassName",children:(0,b.jsxs)("form",{autoComplete:"off",onSubmit:C(e=>{const s={companyId:U,directorId:"",branchId:J,title:null===e||void 0===e?void 0:e.name,projectId:"project"===(null===e||void 0===e?void 0:e.relatedTo)?null===e||void 0===e?void 0:e.projectId:null,description:null===e||void 0===e?void 0:e.descriptions,followerIds:[],assignedTo:"manager"===w?null===e||void 0===e?void 0:e.employee:"employee"===w?null===F||void 0===F?void 0:F._id:"",startDateTime:null===e||void 0===e?void 0:e.checkInTime,endDateTime:null===e||void 0===e?void 0:e.checkOutTime,relatedTo:null===e||void 0===e?void 0:e.relatedTo,priority:null===e||void 0===e?void 0:e.taskPriority,attachment:H,estimatedHours:null,tags:[]};q((0,h.x6)(s)).then(e=>{e.error||(P(),z([]),A(),f())})}),children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 my-4",children:[("admin"===L||"company"===L||"companyDirector"===L)&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"".concat(m.Q0),children:["Branch ",(0,b.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,b.jsx)(a.xI,{name:"PDBranchId",control:D,rules:{required:"Branch is required"},render:e=>{let{field:s}=e;return(0,b.jsxs)(d.A,(0,i.A)((0,i.A)({},s),{},{className:"".concat(m.Hy," ").concat(O.PDBranchId?"border-red-500":"border-gray-300"),filterOption:(e,s)=>String(null===s||void 0===s?void 0:s.children).toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,placeholder:"Select Branch",children:[(0,b.jsx)(d.A.Option,{value:"",children:"Select Branch"}),E?(0,b.jsx)(d.A.Option,{disabled:!0,children:(0,b.jsx)(u.A,{})}):null===R||void 0===R?void 0:R.map(e=>(0,b.jsx)(d.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),O.PDBranchId&&(0,b.jsx)("p",{className:"text-red-500 text-sm",children:O.PDBranchId.message})]}),(0,b.jsxs)("div",{className:"",children:[(0,b.jsxs)("label",{className:"".concat(m.Q0),children:["Task Title ",(0,b.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,b.jsx)("input",(0,i.A)((0,i.A)({type:"text"},S("name",{required:"Task Title is required"})),{},{className:"".concat(m.Ol," ").concat(O.name?"border-red-500":"border-gray-300"),placeholder:"Enter Task Title"})),O.name&&(0,b.jsx)("p",{className:"text-red-500 text-sm",children:O.name.message})]}),"manager"===w&&(0,b.jsxs)("div",{className:"",children:[(0,b.jsxs)("label",{className:"".concat(m.Q0),children:["Assign To ",(0,b.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,b.jsx)(a.xI,{control:D,name:"employee",rules:{required:"employee is required"},render:e=>{var s;let{field:t}=e;return(0,b.jsxs)(d.A,(0,i.A)((0,i.A)({},t),{},{showSearch:!0,filterOption:(e,s)=>String(null===s||void 0===s?void 0:s.children).toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,className:"".concat(m.Hy," ").concat(O.employee?"border-red-500":"border-gray-300"),placeholder:"Select Assign To",children:[(0,b.jsx)(d.A.Option,{value:"",children:"Select Assign To"}),V?(0,b.jsx)(d.A.Option,{disabled:!0,children:(0,b.jsx)(u.A,{})}):null===(s=(0,m._o)(Q,"fullName"))||void 0===s?void 0:s.map((e,s)=>(0,b.jsx)(d.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},s))]}))}}),O.employee&&(0,b.jsx)("p",{className:"text-red-500 text-sm",children:O.employee.message})]}),(0,b.jsxs)("div",{className:"w-full",children:[(0,b.jsxs)("label",{className:"".concat(m.Q0),children:["Task Priority ",(0,b.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,b.jsx)(a.xI,{control:D,name:"taskPriority",rules:{required:"Task Priority is required"},render:e=>{var s;let{field:t}=e;return(0,b.jsxs)(d.A,(0,i.A)((0,i.A)({},t),{},{placeholder:"Select Task Priority",className:"".concat(m.Hy," ").concat(O.taskPriority?"border-red-500":"border-gray-300"),showSearch:!0,getPopupContainer:e=>e.parentNode,filterOption:(e,s)=>String(null===s||void 0===s?void 0:s.children).toLowerCase().includes(e.toLowerCase()),children:[(0,b.jsx)(d.A.Option,{value:"",children:"Select Task Priority"}),null===(s=["low","medium","high","urgent"])||void 0===s?void 0:s.map(e=>(0,b.jsx)(d.A.Option,{value:e,children:e},e))]}))}}),O.taskPriority&&(0,b.jsx)("p",{className:"text-red-500 text-sm",children:O.taskPriority.message})]}),(0,b.jsxs)("div",{className:"w-full",children:[(0,b.jsxs)("label",{className:"".concat(m.Q0),children:["Related To ",(0,b.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,b.jsx)(a.xI,{control:D,name:"relatedTo",rules:{required:"Related To is required"},render:e=>{var s;let{field:t}=e;return(0,b.jsxs)(d.A,(0,i.A)((0,i.A)({},t),{},{placeholder:"Select Related To",className:"".concat(m.Hy," ").concat(O.relatedTo?"border-red-500":"border-gray-300"),showSearch:!0,getPopupContainer:e=>e.parentNode,filterOption:(e,s)=>String(null===s||void 0===s?void 0:s.children).toLowerCase().includes(e.toLowerCase()),children:[(0,b.jsx)(d.A.Option,{value:"",children:"Select Related To"}),null===(s=["project","other"])||void 0===s?void 0:s.map(e=>(0,b.jsx)(d.A.Option,{value:e,children:e},e))]}))}}),O.relatedTo&&(0,b.jsx)("p",{className:"text-red-500 text-sm",children:O.relatedTo.message})]}),"project"===W&&(0,b.jsxs)("div",{className:"w-full",children:[(0,b.jsxs)("label",{className:"".concat(m.Q0),children:["Project ",(0,b.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,b.jsx)(a.xI,{control:D,name:"projectId",rules:{required:"Project is required"},render:e=>{let{field:s}=e;return(0,b.jsxs)(d.A,(0,i.A)((0,i.A)({},s),{},{placeholder:"Select Project",getPopupContainer:e=>e.parentNode,className:"".concat(m.Hy," ").concat(O.projectId?"border-red-500":"border-gray-300"),showSearch:!0,filterOption:(e,s)=>String(null===s||void 0===s?void 0:s.children).toLowerCase().includes(e.toLowerCase()),children:[(0,b.jsx)(d.A.Option,{value:"",children:"Select Project"}),null===K||void 0===K?void 0:K.map((e,s)=>(0,b.jsx)(d.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.title},s))]}))}}),O.projectId&&(0,b.jsx)("p",{className:"text-red-500 text-sm",children:O.projectId.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"".concat(m.Q0),children:["Start Time ",(0,b.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,b.jsx)(a.xI,{name:"checkInTime",control:D,rules:{required:!0},render:e=>{let{field:s}=e;return(0,b.jsx)(N.A,{field:s,showTime:!0,format:"DD/MM/YYYY HH:mm",errors:O,disabledDate:e=>e&&e.isBefore(y()().endOf("day"),"day")})}}),O.checkInTime&&(0,b.jsx)("p",{className:"text-red-500 text-sm",children:"Start Time is required"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"".concat(m.Q0),children:["End Time ",(0,b.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,b.jsx)(a.xI,{name:"checkOutTime",control:D,rules:{required:!0},render:e=>{let{field:s}=e;return(0,b.jsx)(N.A,{field:s,showTime:!0,format:"DD/MM/YYYY HH:mm",errors:O,disabledDate:e=>e&&e.isBefore(y()().endOf("day"),"day")})}}),O.checkOutTime&&(0,b.jsx)("p",{className:"text-red-500 text-sm",children:"End Time is required"})]}),(0,b.jsxs)("div",{className:"md:col-span-2 ",children:[(0,b.jsxs)("label",{className:"".concat(m.Q0),children:["Description ",(0,b.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,b.jsx)("textarea",(0,i.A)((0,i.A)({},S("descriptions",{required:"Description is required"})),{},{className:"".concat(m.Ol," ").concat(O.descriptions?"border-red-500":"border-gray-300"," h-24"),placeholder:"Enter description"})),O.descriptions&&(0,b.jsx)("p",{className:"text-red-500 text-sm",children:O.descriptions.message})]}),(0,b.jsxs)("div",{className:"md:col-span-2 space-y-4",children:[(0,b.jsx)("input",{type:"file",onChange:e=>{const s=e.target.files[0];if(!s)return;const t={filePath:s,isVideo:!1,isMultiple:!1};q((0,g.Sg)(t)).then(e=>{var s;null!==e&&void 0!==e&&null!==(s=e.payload)&&void 0!==s&&s.data&&z(s=>{var t;return[...s,null===e||void 0===e||null===(t=e.payload)||void 0===t?void 0:t.data]})})},className:"hidden",id:"file-upload"}),(0,b.jsxs)("label",{htmlFor:"file-upload",className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white cursor-pointer hover:bg-gray-50",children:[(0,b.jsx)(v.chT,{className:"mr-2"})," Add Attachments"]}),(0,b.jsx)("div",{className:"space-y-2",children:null===H||void 0===H?void 0:H.map((e,s)=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-md",children:[(0,b.jsxs)("a",{href:"".concat("https://vigapi.vigorousit.com","/public/").concat(e),className:"flex items-center space-x-2",target:"_blank",rel:"noopener noreferrer",children:[(0,b.jsx)(v.chT,{className:"text-gray-500"}),(0,b.jsx)("span",{className:"text-sm text-gray-600",children:e})]}),(0,b.jsx)("button",{type:"button",onClick:()=>(e=>{z(s=>null===s||void 0===s?void 0:s.filter((s,t)=>t!==e))})(s),className:"text-red-500 hover:text-red-700",children:(0,b.jsx)(v.QCr,{})})]},s))})]})]}),(0,b.jsxs)("div",{className:"flex justify-end space-x-4 mt-6",children:[(0,b.jsx)(r.Ay,{onClick:X,disabled:k,children:"Cancel"}),(0,b.jsx)(r.Ay,{type:"primary",htmlType:"submit",disabled:k,loading:k,children:k?"Submitting...":"Submit"})]})]})})}},26929:(e,s,t)=>{t.d(s,{A:()=>X});var i=t(65043),l=t(45964),a=t(37490),r=t(13382),n=t(89073),d=t(20691),o=t(8354),c=t(85578),m=t(22019),x=t(53913),u=(t(91686),t(8918)),h=t(76399),p=t(96651),v=t(29813),j=t(81210),g=t(12499),f=t(46237),y=t(30119),N=t(53727),b=t(92252),A=t(28369),w=t(89330),T=t(84965),k=t(73889),S=t(22162),C=t(46833),I=t(88719),D=t(77677),_=t(4394),P=t(45591),O=t(53722),M=t(86178),Y=t.n(M),B=t(83003),L=t(60089),q=t(88967),H=t(30064),z=t.n(H),R=t(15187),E=t(49804),F=t(70579);const{Text:Q,Title:V,Paragraph:K}=v.A,{TextArea:U}=c.A,{TabPane:W}=u.A,J=(e,s)=>{if(!e)return"0h 0m";const t=s||new Date,i=Y().duration(Y()(t).diff(Y()(e))),l=Math.floor(i.asHours()),a=Math.floor(i.asMinutes())%60;return"".concat(l,"h ").concat(a,"m")},G={assigned:{color:"blue",text:"Assigned",icon:(0,F.jsx)(O.A,{})},"in-progress":{color:"orange",text:"In Progress",icon:(0,F.jsx)(D.A,{})},completed:{color:"green",text:"Completed",icon:(0,F.jsx)(f.A,{})},reviewed:{color:"purple",text:"Reviewed",icon:(0,F.jsx)(f.A,{})},done:{color:"green",text:"Done",icon:(0,F.jsx)(f.A,{})},rejected:{color:"red",text:"Rejected",icon:(0,F.jsx)(N.A,{})},reassign:{color:"volcano",text:"Reassigned",icon:(0,F.jsx)(O.A,{})}},X=e=>{var s,t,c,v,M;let{isOpen:H,data:Q,closeModalFunc:V,fetchListAfterSuccess:K}=e;const X=(0,B.wA)(),[Z,$]=(0,i.useState)(""),[ee,se]=(0,i.useState)("comments"),[te,ie]=(0,i.useState)([]),[le,ae]=(0,i.useState)("00:00:00"),{projectTaskDetails:re}=(0,B.d4)(e=>e.projectTask),ne=null===re||void 0===re?void 0:re.isCheckIn,de=null===re||void 0===re||null===(s=re.timeSpentData)||void 0===s||null===(t=s.latestCheckIn)||void 0===t?void 0:t.checkInTime,[oe,ce]=(0,i.useState)([]),me=JSON.parse(localStorage.getItem("user_info_".concat(R.AU))),xe=null===me||void 0===me?void 0:me._id,[ue,he]=(0,i.useState)(window.innerWidth<768);(0,i.useEffect)(()=>{const e=()=>{he(window.innerWidth<768)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,i.useEffect)(()=>{if(re){var e,s,t;const i=[...((null===re||void 0===re||null===(e=re.timeSpentData)||void 0===e?void 0:e.comments)||[]).map(e=>e._id),...((null===re||void 0===re||null===(s=re.timeSpentData)||void 0===s||null===(t=s.timeLogs)||void 0===t?void 0:t.list)||[]).map(e=>e._id||e.checkInTime)];ie(i)}},[re]),(0,i.useEffect)(()=>{H&&null!==Q&&void 0!==Q&&Q._id&&pe(Q._id)},[H,null===Q||void 0===Q?void 0:Q._id]);const pe=(0,i.useCallback)(e=>{X((0,L.pA)({_id:e}))},[X]);(0,i.useEffect)(()=>{if(("assigned"===(null===re||void 0===re?void 0:re.status)||"reassign"===(null===re||void 0===re?void 0:re.status)||"in-progress"===(null===re||void 0===re?void 0:re.status))&&ne&&de){const e=setInterval(()=>{const e=Y().duration(Y()().diff(de)),s=String(e.hours()).padStart(2,"0"),t=String(e.minutes()).padStart(2,"0"),i=String(e.seconds()).padStart(2,"0");ae("".concat(s,":").concat(t,":").concat(i))},1e3);return()=>clearInterval(e)}},[re]);const ve=e=>{const s=e.target.files[0];if(!s)return;const t={filePath:s,isVideo:!1,isMultiple:!1};X((0,q.Sg)(t)).then(e=>{var s;null!==e&&void 0!==e&&null!==(s=e.payload)&&void 0!==s&&s.data&&ce(s=>{var t;return[...s,null===e||void 0===e||null===(t=e.payload)||void 0===t?void 0:t.data]})})},je=e=>{ce(s=>null===s||void 0===s?void 0:s.filter((s,t)=>t!==e))},ge=()=>{Z.trim()||0!==oe.length?X((0,L.d1)({_id:Q._id,type:"comment",comment:Z.trim(),filePath:oe})).then(e=>{e.error||($(""),ce([]),pe(Q._id))}):m.Ay.warning("Please add a comment or attachment")},fe=()=>{var e,s,t,i;return null!==re&&void 0!==re&&null!==(e=re.timeSpentData)&&void 0!==e&&null!==(s=e.timeLogs)&&void 0!==s&&s.totalMinutes?"".concat(null===re||void 0===re||null===(t=re.timeSpentData)||void 0===t||null===(i=t.timeLogs)||void 0===i?void 0:i.totalMinutes," Minutes"):"0.00"},ye=e=>{var s,t,i;return(0,F.jsx)("div",{className:"mb-4 rounded-lg border border-gray-200 bg-white p-4 shadow-sm transition-all duration-200 hover:shadow-md",children:(0,F.jsxs)("div",{className:"flex items-start",children:[(0,F.jsx)("div",{className:"mr-3",children:(0,F.jsx)(l.A,{size:40,src:null!==(s=e.createdBy)&&void 0!==s&&s.profileImage?"".concat("https://vigapi.vigorousit.com","/public/").concat(e.createdBy.profileImage):null,icon:(0,F.jsx)(O.A,{})})}),(0,F.jsxs)("div",{className:"flex-1 overflow-hidden",children:[(0,F.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2",children:[(0,F.jsxs)("div",{className:"flex items-center",children:[(0,F.jsx)("span",{className:"font-medium text-gray-900 text-sm sm:text-base",children:(null===(t=e.createdBy)||void 0===t?void 0:t.fullName)||"Unknown"}),(0,F.jsx)("span",{className:"ml-2 text-xs sm:text-sm text-gray-500",children:Y()(e.createdAt).fromNow()})]}),(0,F.jsx)(h.A,{color:"green",icon:(0,F.jsx)(b.A,{}),className:"text-xs sm:text-sm",children:"Comment"})]}),(0,F.jsx)("p",{className:"mt-2 text-gray-700 text-sm sm:text-base",children:e.comment}),(null===(i=e.file)||void 0===i?void 0:i.length)>0&&(0,F.jsxs)("div",{className:"mt-3",children:[(0,F.jsx)("h4",{className:"mb-2 text-xs sm:text-sm font-medium text-gray-500",children:"Attachments"}),(0,F.jsx)("div",{className:"space-y-2",children:e.file.map((e,s)=>(0,F.jsxs)("a",{href:"".concat("https://vigapi.vigorousit.com","/public/").concat(e),target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between rounded-md bg-gray-50 px-3 py-2 hover:bg-gray-100 transition-colors text-xs sm:text-sm",children:[(0,F.jsx)("span",{className:"truncate font-medium text-gray-700",children:e}),(0,F.jsx)(w.A,{className:"ml-2 text-gray-400 hover:text-gray-600"})]},s))})]})]})]})})},Ne=e=>{var s,t;const i=te.includes(e._id||e.checkInTime);return(0,F.jsx)("div",{className:"mb-4 rounded-lg border border-gray-200 bg-white p-4 shadow-sm transition-all duration-200 ".concat(i?"ring-2 ring-blue-500":"hover:shadow-md"),children:(0,F.jsxs)("div",{className:"flex items-start",children:[(0,F.jsx)("div",{className:"mr-3",children:(0,F.jsx)(l.A,{size:40,src:"".concat("https://vigapi.vigorousit.com","/public/").concat(null===re||void 0===re||null===(s=re.assignedToData)||void 0===s?void 0:s.profileImage),icon:(0,F.jsx)(O.A,{})})}),(0,F.jsxs)("div",{className:"flex-1 overflow-hidden",children:[(0,F.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2",children:[(0,F.jsxs)("div",{className:"flex items-center",children:[(0,F.jsx)("span",{className:"font-medium text-gray-900 text-sm sm:text-base",children:(null===re||void 0===re||null===(t=re.assignedToData)||void 0===t?void 0:t.fullName)||"Unknown"}),(0,F.jsx)("span",{className:"ml-2 text-xs sm:text-sm text-gray-500",children:Y()(e.checkInTime).fromNow()})]}),(0,F.jsxs)("div",{className:"flex items-center",children:[(0,F.jsx)(h.A,{color:"blue",icon:(0,F.jsx)(y.A,{}),className:"text-xs sm:text-sm",children:e.checkOutTime?"Time Entry":"Timer Running"}),(0,F.jsx)(r.Ay,{type:"text",icon:i?(0,F.jsx)(P.A,{}):(0,F.jsx)(A.A,{}),onClick:()=>{return s=e._id||e.checkInTime,void ie(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s]);var s},className:"ml-2",size:"small"})]})]}),i&&(0,F.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,F.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,F.jsxs)("div",{className:"flex items-center",children:[(0,F.jsx)("div",{className:"mr-3 flex h-8 w-8 items-center justify-center rounded-full bg-green-100 text-green-600",children:(0,F.jsx)(f.A,{})}),(0,F.jsxs)("div",{children:[(0,F.jsx)("p",{className:"text-xs sm:text-sm font-medium text-gray-500",children:"Checked in"}),(0,F.jsx)("p",{className:"text-xs sm:text-sm text-gray-900",children:Y()(e.checkInTime).format("MMM D, YYYY h:mm A")})]})]}),e.checkOutTime&&(0,F.jsxs)("div",{className:"flex items-center",children:[(0,F.jsx)("div",{className:"mr-3 flex h-8 w-8 items-center justify-center rounded-full bg-green-100 text-green-600",children:(0,F.jsx)(f.A,{})}),(0,F.jsxs)("div",{children:[(0,F.jsx)("p",{className:"text-xs sm:text-sm font-medium text-gray-500",children:"Checked out"}),(0,F.jsx)("p",{className:"text-xs sm:text-sm text-gray-900",children:Y()(e.checkOutTime).format("MMM D, YYYY h:mm A")})]})]})]}),(0,F.jsxs)("div",{className:"flex items-center",children:[(0,F.jsx)("div",{className:"mr-3 flex h-8 w-8 items-center justify-center rounded-full bg-blue-100 text-blue-600",children:(0,F.jsx)(S.A,{})}),(0,F.jsxs)("div",{children:[(0,F.jsx)("p",{className:"text-xs sm:text-sm font-medium text-gray-500",children:"Duration"}),(0,F.jsx)("p",{className:"text-xs sm:text-sm text-gray-900",children:J(e.checkInTime,e.checkOutTime)})]})]}),e.comment&&(0,F.jsxs)("div",{className:"flex items-start",children:[(0,F.jsx)("div",{className:"mr-3 flex h-8 w-8 items-center justify-center rounded-full bg-purple-100 text-purple-600 mt-1",children:(0,F.jsx)(b.A,{})}),(0,F.jsxs)("div",{children:[(0,F.jsx)("p",{className:"text-xs sm:text-sm font-medium text-gray-500",children:"Comment"}),(0,F.jsx)("p",{className:"text-xs sm:text-sm text-gray-900",children:e.comment})]})]})]})]})]})})},be=()=>{var e,s,t;return(0,F.jsx)(n.A,{title:"Task Details",className:"mb-6",headStyle:{borderBottom:"1px solid #f0f0f0",padding:"16px"},bodyStyle:{padding:"16px"},children:(0,F.jsxs)(d.A,{column:1,bordered:!1,className:"task-details-descriptions",children:[(0,F.jsx)(d.A.Item,{label:"Priority",className:"py-2",children:(0,F.jsxs)("div",{className:"flex items-center",children:[(0,F.jsx)("div",{className:"mr-2 flex h-6 w-6 items-center justify-center rounded-full bg-red-100 text-red-600",children:(0,F.jsx)(T.A,{className:"text-xs"})}),(0,F.jsx)("span",{className:"font-medium text-sm",children:(null===re||void 0===re?void 0:re.priority)||"Not set"})]})}),(0,F.jsx)(d.A.Item,{label:"Status",className:"py-2",children:(0,F.jsxs)("div",{className:"flex items-center",children:[(0,F.jsx)("div",{className:"mr-2 flex h-6 w-6 items-center justify-center rounded-full bg-blue-100 text-blue-600",children:(null===(e=G[null===re||void 0===re?void 0:re.status])||void 0===e?void 0:e.icon)||(0,F.jsx)(a.A,{status:"processing"})}),(0,F.jsx)(h.A,{color:(null===(s=G[null===re||void 0===re?void 0:re.status])||void 0===s?void 0:s.color)||"default",className:"font-medium text-xs sm:text-sm",children:(null===(t=G[null===re||void 0===re?void 0:re.status])||void 0===t?void 0:t.text)||(null===re||void 0===re?void 0:re.status)||"Not set"})]})}),(0,F.jsx)(d.A.Item,{label:"Start Date",className:"py-2",children:(0,F.jsxs)("div",{className:"flex items-center",children:[(0,F.jsx)(j.A,{className:"mr-2 text-gray-400"}),(0,F.jsx)("span",{className:"font-medium text-sm",children:null!==re&&void 0!==re&&re.startDateTime?Y()(re.startDateTime).format("MMM D, YYYY"):"Not set"})]})}),(0,F.jsx)(d.A.Item,{label:"Due Date",className:"py-2",children:(0,F.jsxs)("div",{className:"flex items-center",children:[(0,F.jsx)(j.A,{className:"mr-2 text-gray-400"}),(0,F.jsx)("span",{className:"font-medium text-sm",children:null!==re&&void 0!==re&&re.endDateTime?Y()(re.endDateTime).format("MMM D, YYYY"):"Not set"})]})}),(0,F.jsx)(d.A.Item,{label:"Total Time",className:"py-2",children:(0,F.jsxs)("div",{className:"flex items-center",children:[(0,F.jsx)(y.A,{className:"mr-2 text-gray-400"}),(0,F.jsx)("span",{className:"font-medium text-sm",children:fe()})]})})]})})},Ae=()=>{var e,s,t;return(0,F.jsxs)(n.A,{title:"Assignee",headStyle:{borderBottom:"1px solid #f0f0f0",padding:"16px"},bodyStyle:{padding:"16px",textAlign:"center"},children:[(0,F.jsx)(l.A,{size:ue?60:80,src:"".concat("https://vigapi.vigorousit.com","/public/").concat(null===re||void 0===re||null===(e=re.assignedToData)||void 0===e?void 0:e.profileImage),icon:(0,F.jsx)(O.A,{}),className:"mb-4"}),(0,F.jsxs)("div",{className:"text-center",children:[(0,F.jsx)("p",{className:"font-semibold text-gray-900 text-base sm:text-lg mb-1",children:(null===re||void 0===re||null===(s=re.assignedToData)||void 0===s?void 0:s.fullName)||"Unassigned"}),(0,F.jsx)("p",{className:"text-gray-500 mb-3 text-sm",children:(null===re||void 0===re||null===(t=re.assignedToData)||void 0===t?void 0:t.role)||"Team Member"})]})]})};const we=[...(null===re||void 0===re||null===(c=re.timeSpentData)||void 0===c?void 0:c.comments)||[]],Te=[...(null===re||void 0===re||null===(v=re.timeSpentData)||void 0===v||null===(M=v.timeLogs)||void 0===M?void 0:M.list)||[]],ke=we.sort((e,s)=>new Date(s.createdAt)-new Date(e.createdAt)),Se=Te.sort((e,s)=>new Date(s.checkInTime)-new Date(e.checkInTime));return(0,F.jsxs)(x.A,{open:H,onCancel:V,footer:null,width:ue?"100%":1100,centered:!0,destroyOnClose:!0,className:"task-logs-modal antmodalclassName",style:ue?{top:0,margin:0,padding:0,maxWidth:"100%",height:"100vh"}:{top:20},bodyStyle:ue?{padding:"16px",maxHeight:"calc(100vh - 55px)",overflowY:"auto"}:{},title:(0,F.jsxs)("div",{className:ue?"max-w-full":"max-w-3/4",children:[(0,F.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-1 line-clamp-2",children:null===re||void 0===re?void 0:re.title}),(0,F.jsxs)("p",{className:"text-gray-500 flex items-center flex-wrap text-xs sm:text-sm",children:[(0,F.jsxs)("span",{className:"mr-2",children:["#",null===re||void 0===re?void 0:re.taskCode]}),(0,F.jsx)("span",{className:"text-gray-300 hidden sm:inline",children:"\u2022"}),(0,F.jsxs)("span",{className:"ml-0 sm:ml-2 mt-1 sm:mt-0",children:["Created ",null!==re&&void 0!==re&&re.createdAt?Y()(re.createdAt).fromNow():""]})]})]}),children:[(0,F.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-3 mb-6",children:[(0,F.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2",children:[xe===(null===re||void 0===re?void 0:re.assignedTo)&&("assigned"===(null===re||void 0===re?void 0:re.status)||"reassign"===(null===re||void 0===re?void 0:re.status)||"in-progress"===(null===re||void 0===re?void 0:re.status))&&(0,F.jsx)(p.A,{title:ne?"Stop timer":"Start timer",children:(0,F.jsx)(r.Ay,{type:ne?"primary":"default",danger:ne,icon:ne?(0,F.jsx)(I.A,{}):(0,F.jsx)(D.A,{}),onClick:async()=>{if(ne){const{value:e}=await z().fire({title:"Check-out Comment",input:"textarea",inputLabel:"Please enter your comment for checking out",inputPlaceholder:"Enter your comment here...",inputAttributes:{"aria-label":"Check-out comment"},showCancelButton:!0,confirmButtonText:"Submit",cancelButtonText:"Cancel"});void 0!==e&&X((0,L.d1)({_id:Q._id,type:"check-out",comment:(null===e||void 0===e?void 0:e.trim())||""})).then(e=>{e.error||pe(Q._id)})}else X((0,L.d1)({_id:Q._id,type:"check-in"})).then(e=>{e.error||pe(Q._id)})},size:ue?"small":"middle",className:"flex items-center w-full sm:w-auto justify-center mb-2 sm:mb-0",children:ne?"Stop Timer":"Start Timer"})}),"in-progress"===(null===re||void 0===re?void 0:re.status)&&!(null!==re&&void 0!==re&&re.isCheckIn)&&xe===(null===re||void 0===re?void 0:re.assignedTo)&&(0,F.jsx)(r.Ay,{type:"primary",icon:(0,F.jsx)(g.A,{}),onClick:()=>{X((0,L.fw)({_id:null===re||void 0===re?void 0:re._id,status:"completed"})).then(e=>{e.error||pe(Q._id)})},size:ue?"small":"middle",className:"w-full sm:w-auto justify-center",children:"Mark Complete"})]}),("assigned"===(null===re||void 0===re?void 0:re.status)||"reassign"===(null===re||void 0===re?void 0:re.status)||"in-progress"===(null===re||void 0===re?void 0:re.status))&&ne&&le&&(0,F.jsxs)("div",{className:"text-[20px] font-medium text-teal-600 flex items-center  gap-2",children:[(0,F.jsx)(E.Roy,{}),(0,F.jsx)("span",{className:"font-semibold",children:le})]})]}),(0,F.jsx)(o.A,{className:"my-4"}),ue?(0,F.jsxs)(n.A,{bodyStyle:{padding:"16px"},className:"mobile-task-card",children:[(0,F.jsxs)("div",{className:"mb-6",children:[(0,F.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Task Details"}),(0,F.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:be()})]}),(0,F.jsxs)("div",{className:"mb-6",children:[(0,F.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Assignee"}),(0,F.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:Ae()})]}),(0,F.jsxs)("div",{className:"mb-6",children:[(0,F.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Description"}),(0,F.jsx)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:(0,F.jsx)("p",{className:"text-gray-700 text-sm",children:(null===re||void 0===re?void 0:re.description)||"No description provided for this task."})})]}),(0,F.jsxs)("div",{className:"mb-6",children:[(0,F.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Add Comment"}),(0,F.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,F.jsx)(U,{rows:3,value:Z,onChange:e=>$(e.target.value),placeholder:"Add a comment...",className:"w-full mb-4",autoSize:{minRows:3,maxRows:6}}),(0,F.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,F.jsxs)("div",{className:"space-y-4",children:[(0,F.jsx)("input",{type:"file",onChange:ve,className:"hidden",id:"file-upload-mobile"}),(0,F.jsxs)("label",{htmlFor:"file-upload-mobile",className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white cursor-pointer hover:bg-gray-50 transition-colors w-full justify-center",children:[(0,F.jsx)(C.A,{className:"mr-2"})," Add Attachments"]}),(0,F.jsx)("div",{className:"space-y-2",children:null===oe||void 0===oe?void 0:oe.map((e,s)=>(0,F.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-md text-xs",children:[(0,F.jsxs)("a",{href:"".concat("https://vigapi.vigorousit.com","/public/").concat(e),className:"flex items-center space-x-2 truncate",target:"_blank",rel:"noopener noreferrer",children:[(0,F.jsx)(C.A,{className:"text-gray-500"}),(0,F.jsx)("span",{className:"text-gray-600 truncate max-w-[120px]",children:e})]}),(0,F.jsx)("button",{type:"button",onClick:()=>je(s),className:"text-red-500 hover:text-red-700 transition-colors",children:(0,F.jsx)(N.A,{})})]},s))})]}),(0,F.jsx)(r.Ay,{type:"primary",onClick:ge,disabled:!Z.trim()&&0===oe.length,className:"flex items-center justify-center w-full",icon:(0,F.jsx)(_.A,{}),size:"middle",children:"Post Comment"})]})]})]}),(0,F.jsxs)("div",{children:[(0,F.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Activity"}),(0,F.jsxs)(u.A,{defaultActiveKey:"comments",activeKey:ee,onChange:se,className:"activity-tabs",type:"card",children:[(0,F.jsx)(W,{tab:(0,F.jsxs)("span",{className:"flex justify-center items-center gap-1 text-xs sm:text-sm",children:[(0,F.jsx)(b.A,{}),"Comments"]}),children:(0,F.jsx)("div",{className:"pt-4",children:(0,F.jsxs)("div",{className:"space-y-4",children:[ke.map((e,s)=>(0,F.jsx)(i.Fragment,{children:ye(e)},e._id||s)),0===ke.length&&(0,F.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,F.jsx)(b.A,{className:"text-3xl mb-2"}),(0,F.jsx)("p",{children:"No comments yet"})]})]})})},"comments"),(0,F.jsx)(W,{tab:(0,F.jsxs)("span",{className:"flex justify-center items-center gap-1 text-xs sm:text-sm",children:[(0,F.jsx)(k.A,{}),"Time Activity"]}),children:(0,F.jsx)("div",{className:"pt-4",children:(0,F.jsxs)("div",{className:"space-y-4",children:[Se.map((e,s)=>(0,F.jsx)(i.Fragment,{children:Ne(e)},e._id||e.checkInTime||s)),0===Se.length&&(0,F.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,F.jsx)(y.A,{className:"text-3xl mb-2"}),(0,F.jsx)("p",{children:"No time activity recorded"})]})]})})},"activity")]})]})]}):(0,F.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,F.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,F.jsx)(n.A,{title:"Description",headStyle:{borderBottom:"1px solid #f0f0f0",padding:"16px 24px"},bodyStyle:{padding:"24px"},children:(0,F.jsx)("p",{className:"text-gray-700",children:(null===re||void 0===re?void 0:re.description)||"No description provided for this task."})}),(0,F.jsxs)(n.A,{title:"Add Comment",headStyle:{borderBottom:"1px solid #f0f0f0",padding:"16px 24px"},bodyStyle:{padding:"24px"},className:"mb-6",children:[(0,F.jsx)(U,{rows:4,value:Z,onChange:e=>$(e.target.value),placeholder:"Add a comment...",className:"w-full mb-4",autoSize:{minRows:3,maxRows:6}}),(0,F.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,F.jsxs)("div",{className:"space-y-4",children:[(0,F.jsx)("input",{type:"file",onChange:ve,className:"hidden",id:"file-upload"}),(0,F.jsxs)("label",{htmlFor:"file-upload",className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white cursor-pointer hover:bg-gray-50 transition-colors",children:[(0,F.jsx)(C.A,{className:"mr-2"})," Add Attachments"]}),(0,F.jsx)("div",{className:"space-y-2",children:null===oe||void 0===oe?void 0:oe.map((e,s)=>(0,F.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-md",children:[(0,F.jsxs)("a",{href:"".concat("https://vigapi.vigorousit.com","/public/").concat(e),className:"flex items-center space-x-2",target:"_blank",rel:"noopener noreferrer",children:[(0,F.jsx)(C.A,{className:"text-gray-500"}),(0,F.jsx)("span",{className:"text-sm text-gray-600",children:e})]}),(0,F.jsx)("button",{type:"button",onClick:()=>je(s),className:"text-red-500 hover:text-red-700 transition-colors",children:(0,F.jsx)(N.A,{})})]},s))})]}),(0,F.jsx)(r.Ay,{type:"primary",onClick:ge,disabled:!Z.trim()&&0===oe.length,className:"flex items-center self-end",icon:(0,F.jsx)(_.A,{}),size:"middle",children:"Post Comment"})]})]}),(0,F.jsx)(n.A,{bodyStyle:{padding:0},className:"activity-card",children:(0,F.jsxs)(u.A,{defaultActiveKey:"comments",activeKey:ee,onChange:se,className:"activity-tabs !px-5",children:[(0,F.jsx)(W,{tab:(0,F.jsxs)("span",{className:"flex justify-center items-center gap-1",children:[(0,F.jsx)(b.A,{}),"Comments"]}),children:(0,F.jsxs)("div",{className:"p-6",children:[(0,F.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Comments"}),(0,F.jsxs)("div",{className:"space-y-4",children:[ke.map((e,s)=>(0,F.jsx)(i.Fragment,{children:ye(e)},e._id||s)),0===ke.length&&(0,F.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,F.jsx)(b.A,{className:"text-3xl mb-2"}),(0,F.jsx)("p",{children:"No comments yet"})]})]})]})},"comments"),(0,F.jsx)(W,{tab:(0,F.jsxs)("span",{className:"flex justify-center items-center gap-1",children:[(0,F.jsx)(k.A,{}),"Time Activity"]}),children:(0,F.jsxs)("div",{className:"p-6",children:[(0,F.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Time Activity"}),(0,F.jsxs)("div",{className:"space-y-4",children:[Se.map((e,s)=>(0,F.jsx)(i.Fragment,{children:Ne(e)},e._id||e.checkInTime||s)),0===Se.length&&(0,F.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,F.jsx)(y.A,{className:"text-3xl mb-2"}),(0,F.jsx)("p",{children:"No time activity recorded"})]})]})]})},"activity")]})})]}),(0,F.jsxs)("div",{className:"space-y-6",children:[be(),Ae()]})]})]})}},58302:(e,s,t)=>{t.d(s,{A:()=>m});var i=t(30326),l=t(84084),a=t(76399),r=t(96651),n=t(28369),d=t(70579);const o={reviewed:"blue",done:"purple",rejected:"error",reassign:"warning"},c={assigned:"#f5f5f5","in-progress":"#e6f7ff",completed:"#f6ffed",reviewed:"#e6f4ff",done:"#f9f0ff",rejected:"#fff1f0",reassign:"#fffbe6"},m=e=>{let{element:s,handleStatusChange:t,employeePortal:m=!1}=e;const x="completed"===(null===s||void 0===s?void 0:s.status)||"reviewed"===(null===s||void 0===s?void 0:s.status);if(m)return(0,d.jsx)("td",{className:"whitespace-nowrap border-none p-2",children:(0,d.jsx)("div",{className:"flex capitalize items-center gap-2 px-2 py-1 border rounded-md",style:{backgroundColor:c[null===s||void 0===s?void 0:s.status]||"#fafafa"},children:null===s||void 0===s?void 0:s.status})});const u=(0,d.jsx)(l.A,{onClick:e=>{let{key:i}=e;x&&t(i,null===s||void 0===s?void 0:s._id)},selectedKeys:[null===s||void 0===s?void 0:s.status],children:Object.keys(o).map(e=>{const s=!x||["assigned","in-progress","completed"].includes(e);let t="";return x?["assigned","in-progress","completed"].includes(e)&&(t="Status will change according to Working"):t="You can only change status when it is Completed or Reviewed",(0,d.jsx)(l.A.Item,{disabled:s,style:{cursor:s?"not-allowed":"pointer",opacity:s?.6:1},children:t?(0,d.jsx)(r.A,{title:t,placement:"right",children:(0,d.jsx)("div",{children:(0,d.jsx)(a.A,{color:o[e],children:e})})}):(0,d.jsx)(a.A,{color:o[e],children:e})},e)})});return(0,d.jsx)("td",{className:"whitespace-nowrap border-none p-2",children:(0,d.jsx)(r.A,{placement:"topLeft",title:x?"Change Status":"Already ".concat(null===s||void 0===s?void 0:s.status),children:(0,d.jsx)(i.A,{overlay:u,trigger:["click"],children:(0,d.jsxs)("div",{className:"flex capitalize items-center gap-2 px-2 py-1 border rounded-md transition ".concat(x?"cursor-pointer hover:shadow":"cursor-not-allowed"),style:{backgroundColor:c[null===s||void 0===s?void 0:s.status]||"#fafafa"},children:[null===s||void 0===s?void 0:s.status,x&&(0,d.jsx)(n.A,{style:{fontSize:10,color:"#666"}})]})})})})}}}]);
//# sourceMappingURL=4082.dc88082b.chunk.js.map