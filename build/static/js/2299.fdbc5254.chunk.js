"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[2299],{32299:(e,a,s)=>{s.r(a),s.d(a,{default:()=>N});var l=s(89379),t=s(24858),d=s(39160),i=s(83003),n=s(73216),r=s(65043),c=(s(42837),s(15187)),o=s(31744),m=s(78729),u=s(92823),p=s.n(u),h=s(60184),v=s(88967),x=s(96712),y=s(65512),j=s(70579);const N=()=>{const{register:e,handleSubmit:a,control:s,formState:{errors:u},setValue:N}=(0,t.mN)(),g=(0,i.wA)(),b=(0,n.Zp)(),{companyList:f}=(0,i.d4)(e=>e.company),{branchList:A}=(0,i.d4)(e=>e.branch),[C,I]=(0,r.useState)(""),[T,S]=(0,r.useState)(""),[P,D]=(0,r.useState)([]),[k,_]=(0,r.useState)(!1),[B,q]=(0,r.useState)({attachments:[]}),w=JSON.parse(localStorage.getItem("user_info_".concat(c.AU))),O=(0,t.FH)({control:s,name:"PDCompanyId",defaultValue:""});(0,r.useEffect)(()=>{(O||"company"===(null===w||void 0===w?void 0:w.userType)||"companyDirector"===(null===w||void 0===w?void 0:w.userType))&&g((0,o.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===w||void 0===w?void 0:w.userType)?O:"company"===(null===w||void 0===w?void 0:w.userType)?null===w||void 0===w?void 0:w._id:null===w||void 0===w?void 0:w.companyId}))},[O]),(0,r.useEffect)(()=>{"admin"===(null===w||void 0===w?void 0:w.userType)&&g((0,m.Ar)({text:"",sort:!0,status:!0,isPagination:!1}))},[]);return(0,j.jsx)(d.A,{children:(0,j.jsx)("div",{className:"gap-4",children:(0,j.jsxs)("form",{autoComplete:"off",className:"mt-2 md:px-1",onSubmit:a(e=>{const a={companyId:"admin"===(null===w||void 0===w?void 0:w.userType)?null===e||void 0===e?void 0:e.PDCompanyId:"company"===(null===w||void 0===w?void 0:w.userType)?null===w||void 0===w?void 0:w._id:null===w||void 0===w?void 0:w.companyId,title:null===e||void 0===e?void 0:e.title,content:C,attachments:null===B||void 0===B?void 0:B.attachments};g((0,x.v3)(a)).then(e=>{e.error||b("/admin/policy")})}),children:[(0,j.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 md:gap-8 gap-3 md:my-2",children:["admin"===(null===w||void 0===w?void 0:w.userType)&&(0,j.jsxs)("div",{className:"",children:[(0,j.jsxs)("label",{className:"".concat(c.Q0),children:["Company ",(0,j.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,j.jsxs)("select",(0,l.A)((0,l.A)({},e("PDCompanyId",{required:"company is required"})),{},{className:" ".concat(c.Ol," ").concat(u.PDCompanyId?"border-[1px] ":"border-gray-300"),children:[(0,j.jsx)("option",{className:"",value:"",children:"Select Comapany"}),null===f||void 0===f?void 0:f.map(e=>(0,j.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName}))]})),u.PDCompanyId&&(0,j.jsx)("p",{className:"text-red-500 text-sm",children:u.PDCompanyId.message})]}),("admin"===(null===w||void 0===w?void 0:w.userType)||"company"===(null===w||void 0===w?void 0:w.userType)||"companyDirector"===(null===w||void 0===w?void 0:w.userType))&&(0,j.jsxs)("div",{className:"",children:[(0,j.jsxs)("label",{className:"".concat(c.Q0),children:["Branch ",(0,j.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,j.jsx)(t.xI,{name:"PDBranchId",control:s,rules:{required:"Branch is required"},render:e=>{let{field:a}=e;return(0,j.jsxs)(y.A,(0,l.A)((0,l.A)({},a),{},{className:"".concat(c.Hy," ").concat(u.PDBranchId?"border-[1px] ":"border-gray-300"),placeholder:"Select Branch",children:[(0,j.jsx)(y.A.Option,{value:"",children:"Select Branch"}),null===A||void 0===A?void 0:A.map(e=>(0,j.jsx)(y.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),u.PDBranchId&&(0,j.jsx)("p",{className:"text-red-500 text-sm",children:u.PDBranchId.message})]}),(0,j.jsxs)("div",{className:"",children:[(0,j.jsxs)("label",{className:"".concat(c.Q0),children:["Title ",(0,j.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,j.jsx)("input",(0,l.A)((0,l.A)({type:"text"},e("title",{required:"Title is required"})),{},{className:"".concat(c.Ol," ").concat(u.title?"border-[1px] ":"border-gray-300"),placeholder:"Enter Title"})),u.title&&(0,j.jsx)("p",{className:"text-red-500 text-sm",children:u.title.message})]})]}),(0,j.jsxs)("div",{className:"",children:[(0,j.jsxs)("label",{className:"".concat(c.Q0),children:["Content ",(0,j.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,j.jsx)("div",{className:"col-span-2",children:(0,j.jsx)(p(),{value:C,onChange:e=>{I(e)},placeholder:"Write the email body here",modules:{toolbar:[[{header:"1"},{header:"2"},{font:[]}],[{list:"ordered"},{list:"bullet"}],["bold","italic","underline","strike"],[{align:[]}],["link","image","video"],["blockquote","code-block"],["clean"]]},formats:["header","font","list","bold","italic","underline","link","align","clean"]})})]}),(0,j.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 md:gap-8 gap-3 md:my-2",children:(0,j.jsxs)("div",{className:"pt-0 mt-6",children:[(0,j.jsx)("div",{className:"font-medium mb-2",children:"Attachments:"}),k?(0,j.jsx)("div",{className:"space-y-2"}):(0,j.jsxs)("div",{className:"space-y-4",children:[(0,j.jsx)("input",{type:"file",onChange:e=>{const a={filePath:e.target.files[0],isVideo:!1,isMultiple:!1};g((0,v.Sg)(a)).then(e=>{var a;null!==e&&void 0!==e&&null!==(a=e.payload)&&void 0!==a&&a.data&&q(a=>{var s;return(0,l.A)((0,l.A)({},a),{},{attachments:[...a.attachments,null===(s=e.payload)||void 0===s?void 0:s.data]})})})},className:"hidden",id:"file-upload"}),(0,j.jsxs)("label",{htmlFor:"file-upload",className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white cursor-pointer",children:[(0,j.jsx)(h.chT,{className:"mr-2"})," Add Attachments"]}),(0,j.jsx)("div",{className:"space-y-2",children:B.attachments.map((e,a)=>(0,j.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-md",children:[(0,j.jsxs)("a",{href:"".concat("https://vigapi.vigorousit.com","/public/").concat(e),className:"flex items-center space-x-2",target:"_blank",rel:"noopener noreferrer",children:[(0,j.jsx)(h.chT,{className:"text-gray-500"}),(0,j.jsx)("span",{className:"text-sm text-gray-600",children:e})]}),(0,j.jsx)("button",{type:"button",onClick:()=>(e=>{q(a=>{const s=a.attachments.filter((a,s)=>s!==e);return(0,l.A)((0,l.A)({},a),{},{attachments:s})})})(a),className:"text-red-500 hover:text-red-700",children:(0,j.jsx)(h.QCr,{})})]},a))})]})]})}),(0,j.jsx)("div",{className:"flex justify-end",children:(0,j.jsx)("button",{type:"submit",className:"bg-header text-white p-2 px-4 rounded mt-4",children:"Submit"})})]})})})}}}]);
//# sourceMappingURL=2299.fdbc5254.chunk.js.map