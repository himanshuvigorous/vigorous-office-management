"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[247],{30247:(e,n,d)=>{d.r(n),d.d(n,{default:()=>C});var a=d(89379),l=d(24858),o=d(39160),i=d(83003),t=d(73216),s=d(65043),r=d(15187),c=d(65512),u=d(66015),m=d(60184),v=d(86178),p=d.n(v),x=d(31744),h=d(71923),y=d(88967),j=d(20126),N=d(31536),f=d(89427),A=d(94084),b=d(17995),g=d(34203),I=d(30064),T=d.n(I),_=d(70579);const C=()=>{var e;const{loading:n}=(0,i.d4)(e=>e.projectpurchaseExpence),{register:d,handleSubmit:v,control:I,formState:{errors:C},setValue:D}=(0,l.mN)({defaultValues:{typeSelection:"Vendor"}}),P=(0,i.wA)(),S=(0,t.Zp)(),{branchList:w,branchListloading:O}=(0,i.d4)(e=>e.branch),k=JSON.parse(localStorage.getItem("user_info_".concat(r.AU))),{expenseTypeList:B}=(0,i.d4)(e=>e.expenceHead),H=(0,l.FH)({control:I,name:"PDCompanyId",defaultValue:""}),q=(0,l.FH)({control:I,name:"PDBranchId",defaultValue:""}),V=(0,l.FH)({control:I,name:"vendorId",defaultValue:""}),{vendorDataList:Q,loading:L}=(0,i.d4)(e=>e.vendor),{accountantList:M,loading:E}=(0,i.d4)(e=>e.accountManagement),[F,R]=(0,s.useState)(!1),[U,G]=(0,s.useState)({attachment:[]}),J=(0,l.FH)({control:I,name:"paymentMethod",defaultValue:""}),Y=(0,l.FH)({control:I,name:"accountant",defaultValue:""});(0,s.useEffect)(()=>{(H||"company"===(null===k||void 0===k?void 0:k.userType)||"companyDirector"===(null===k||void 0===k?void 0:k.userType))&&P((0,x.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===k||void 0===k?void 0:k.userType)?H:"company"===(null===k||void 0===k?void 0:k.userType)?null===k||void 0===k?void 0:k._id:null===k||void 0===k?void 0:k.companyId}))},[H]);const Z=()=>{P((0,j.Pe)({companyId:"admin"===(null===k||void 0===k?void 0:k.userType)?H:"company"===(null===k||void 0===k?void 0:k.userType)?null===k||void 0===k?void 0:k._id:null===k||void 0===k?void 0:k.companyId,branchId:"company"===(null===k||void 0===k?void 0:k.userType)||"admin"===(null===k||void 0===k?void 0:k.userType)||"companyDirector"===(null===k||void 0===k?void 0:k.userType)?q:"companyBranch"===(null===k||void 0===k?void 0:k.userType)?null===k||void 0===k?void 0:k._id:null===k||void 0===k?void 0:k.branchId,isPagination:!1,text:"",sort:!0,status:!0,groupId:""}))};(0,s.useEffect)(()=>{if(V){const e=null===Q||void 0===Q?void 0:Q.find(e=>(null===e||void 0===e?void 0:e._id)===V);D("Name",e?null===e||void 0===e?void 0:e.fullName:"")}else D("Name","")},[V]),(0,s.useEffect)(()=>{D("paymentMethod","Cash"),P((0,g.v1)({directorId:"",companyId:"admin"===(null===k||void 0===k?void 0:k.userType)?H:"company"===(null===k||void 0===k?void 0:k.userType)?null===k||void 0===k?void 0:k._id:null===k||void 0===k?void 0:k.companyId,branchId:"company"===(null===k||void 0===k?void 0:k.userType)||"admin"===(null===k||void 0===k?void 0:k.userType)||"companyDirector"===(null===k||void 0===k?void 0:k.userType)?q:"companyBranch"===(null===k||void 0===k?void 0:k.userType)?null===k||void 0===k?void 0:k._id:null===k||void 0===k?void 0:k.branchId,text:"",sort:!0,status:!0,isPagination:!1}))},[]);const z=c.A.Option;return(0,_.jsx)(o.A,{children:(0,_.jsx)("div",{className:"gap-4",children:(0,_.jsxs)("form",{autoComplete:"off",className:"mt-2 md:px-1",onSubmit:v(e=>{var n,d,a;const l={companyId:"admin"===(null===k||void 0===k?void 0:k.userType)?null===e||void 0===e?void 0:e.PDCompanyId:"company"===(null===k||void 0===k?void 0:k.userType)?null===k||void 0===k?void 0:k._id:null===k||void 0===k?void 0:k.companyId,directorId:"companyDirector"===(null===k||void 0===k?void 0:k.userType)?null===k||void 0===k?void 0:k._id:null===k||void 0===k?void 0:k.directorId,branchId:"admin"===(null===k||void 0===k?void 0:k.userType)||"companyDirector"===(null===k||void 0===k?void 0:k.userType)||"company"===(null===k||void 0===k?void 0:k.userType)?null===e||void 0===e?void 0:e.PDBranchId:"companyBranch"===(null===k||void 0===k?void 0:k.userType)?null===k||void 0===k?void 0:k._id:null===k||void 0===k?void 0:k.branchId,vendorId:null===e||void 0===e?void 0:e.vendorId,expenseHeadId:null===e||void 0===e||null===(n=e.expencehead)||void 0===n?void 0:n.value,accountentId:null===e||void 0===e?void 0:e.accountant,userId:null===M||void 0===M||null===(d=M.find(e=>e._id===Y))||void 0===d||null===(a=d.accountentData)||void 0===a?void 0:a._id,bankAccountId:null===e||void 0===e?void 0:e.bankAccountId,paymentMethod:null===e||void 0===e?void 0:e.paymentMethod,paymentReference:null===e||void 0===e?void 0:e.paymentReference,vendorName:null===e||void 0===e?void 0:e.Name,totalAmount:+(null===e||void 0===e?void 0:e.totalAmount),totalGSTAmount:0,grandTotal:+(null===e||void 0===e?void 0:e.totalAmount),date:(0,r.Tk)(null===e||void 0===e?void 0:e.paymentDate),remark:null===e||void 0===e?void 0:e.remark,attachment:null===U||void 0===U?void 0:U.attachments};T().fire({title:"Are you sure?",text:"Once submitted, this entry cannot be edited. Do you want to proceed?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, submit it!"}).then(e=>{e.isConfirmed&&P((0,h.iU)(l)).then(e=>{e.error||S(-1)})})}),children:[(0,_.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 md:gap-8 md:my-1 px-3 md:mt-4",children:[("admin"===(null===k||void 0===k?void 0:k.userType)||"company"===(null===k||void 0===k?void 0:k.userType)||"companyDirector"===(null===k||void 0===k?void 0:k.userType))&&(0,_.jsxs)("div",{className:"",children:[(0,_.jsxs)("label",{className:"".concat(r.Q0),children:["Branch ",(0,_.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,_.jsx)(l.xI,{control:I,name:"PDBranchId",rules:{required:"Branch is required"},render:e=>{let{field:n}=e;return(0,_.jsxs)(c.A,(0,a.A)((0,a.A)({},n),{},{defaultValue:"",className:"".concat(r.Hy," "),showSearch:!0,filterOption:(e,n)=>String(null===n||void 0===n?void 0:n.children).toLowerCase().includes(e.toLowerCase()),children:[(0,_.jsx)(c.A.Option,{value:"",children:"Select Branch"}),O?(0,_.jsx)(c.A.Option,{disabled:!0,children:(0,_.jsx)(f.A,{})}):null===w||void 0===w?void 0:w.map(e=>(0,_.jsx)(c.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),C.PDBranchId&&(0,_.jsx)("p",{className:"text-red-500 text-sm",children:C.PDBranchId.message})]}),(0,_.jsxs)("div",{className:"",children:[(0,_.jsx)("label",{className:"".concat(r.Q0),children:"Vendor"}),(0,_.jsx)(l.xI,{control:I,name:"vendorId",render:e=>{let{field:n}=e;return(0,_.jsxs)(c.A,(0,a.A)((0,a.A)({},n),{},{defaultValue:"",className:"".concat(r.Hy," "),onFocus:Z,showSearch:!0,filterOption:(e,n)=>String(null===n||void 0===n?void 0:n.children).toLowerCase().includes(e.toLowerCase()),children:[(0,_.jsx)(c.A.Option,{value:"",children:"Select Vendor"}),L?(0,_.jsx)(c.A.Option,{disabled:!0,children:(0,_.jsx)(f.A,{})}):null===Q||void 0===Q?void 0:Q.map((e,n)=>(0,_.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName}))]}))}}),C.vendorId&&(0,_.jsx)("p",{className:"text-red-500 text-sm",children:C.vendorId.message})]}),(0,_.jsxs)("div",{className:"",children:[(0,_.jsxs)("label",{className:"".concat(r.Q0),children:["Name",(0,_.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,_.jsx)("input",(0,a.A)((0,a.A)({},d("Name",{required:"Name is required"})),{},{className:" ".concat(r.Ol," ").concat(C.Name?"border-[1px] ":"border-gray-300"),placeholder:"Enter Name"})),C.Name&&(0,_.jsx)("p",{className:"text-red-500 text-sm",children:C.Name.message})]}),(0,_.jsxs)("div",{className:"w-full",children:[(0,_.jsx)("label",{className:"".concat(r.Q0),children:"Expense Head"}),(0,_.jsx)(l.xI,{name:"expencehead",control:I,rules:{required:"Expence Head is required"},render:e=>{let{field:n}=e;return(0,_.jsx)(u.Ay,(0,a.A)((0,a.A)({onFocus:()=>{const e={directorId:"",companyId:"admin"===(null===k||void 0===k?void 0:k.userType)?H:"company"===(null===k||void 0===k?void 0:k.userType)?null===k||void 0===k?void 0:k._id:null===k||void 0===k?void 0:k.companyId,branchId:"company"===(null===k||void 0===k?void 0:k.userType)||"admin"===(null===k||void 0===k?void 0:k.userType)||"companyDirector"===(null===k||void 0===k?void 0:k.userType)?q:"companyBranch"===(null===k||void 0===k?void 0:k.userType)?null===k||void 0===k?void 0:k._id:null===k||void 0===k?void 0:k.branchId,text:"",sort:!0,status:"",isPagination:!1};P((0,N.dV)(e))}},n),{},{options:null===B||void 0===B?void 0:B.map(e=>({value:null===e||void 0===e?void 0:e._id,label:null===e||void 0===e?void 0:e.name})),classNamePrefix:"react-select",className:"".concat(r.Ph," ").concat(C.expencehead?"border-[1px] ":"border-gray-300"),placeholder:"Select Expence Head"}))}}),C.expencehead&&(0,_.jsx)("p",{className:"text-red-500 text-sm",children:C.expencehead.message})]}),(0,_.jsxs)("div",{className:"",children:[(0,_.jsx)("label",{className:"".concat(r.Q0),children:"Total Amount"}),(0,_.jsx)("input",(0,a.A)((0,a.A)({type:"number",step:"0.01"},d("totalAmount")),{},{className:" ".concat(r.Ol," ").concat(C.totalAmount?"border-[1px] ":"border-gray-300"),placeholder:"Enter Total Amount"})),C.totalAmount&&(0,_.jsx)("p",{className:"text-red-500 text-sm",children:C.totalAmount.message})]}),(0,_.jsxs)("div",{className:"w-full",children:[(0,_.jsxs)("label",{className:"".concat(r.Q0),children:["Accountant ",(0,_.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,_.jsx)(l.xI,{name:"accountant",control:I,rules:{required:"Accountant is required"},render:e=>{let{field:n}=e;return(0,_.jsx)(c.A,(0,a.A)((0,a.A)({placeholder:"Select accountant",loading:E},n),{},{showSearch:!0,getPopupContainer:e=>e.parentNode,optionFilterProp:"children",className:"".concat(r.Hy," "),filterOption:(e,n)=>n.children.toLowerCase().indexOf(e.toLowerCase())>=0,children:null===M||void 0===M?void 0:M.map(e=>{var n;return(0,_.jsx)(z,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e||null===(n=e.accountentData)||void 0===n?void 0:n.fullName},null===e||void 0===e?void 0:e._id)})}))}}),C.accountant&&(0,_.jsx)("p",{className:"text-red-500 text-sm",children:C.accountant.message})]}),(0,_.jsxs)("div",{children:[(0,_.jsxs)("label",{className:"".concat(r.Q0),children:["Payment Method ",(0,_.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,_.jsx)(l.xI,{control:I,name:"paymentMethod",rules:{required:"Payment method is required"},render:e=>{var n;let{field:d}=e;return(0,_.jsx)(c.A,(0,a.A)((0,a.A)({},d),{},{className:"".concat(r.Hy," "),getPopupContainer:e=>e.parentNode,children:null===(n=["Cash","Cheque","Card","Bank","Online","Other"])||void 0===n?void 0:n.map(e=>(0,_.jsx)(c.A.Option,{value:e,children:e},e))}))}}),C.paymentMethod&&(0,_.jsx)("p",{className:"text-red-500 text-sm",children:C.paymentMethod.message})]}),"Cash"!==J&&(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{className:"".concat(r.Q0),children:"Bank Account"}),(0,_.jsx)(l.xI,{control:I,name:"bankAccountId",render:e=>{var n,d;let{field:l}=e;return(0,_.jsxs)(c.A,(0,a.A)((0,a.A)({},l),{},{className:"".concat(r.Hy," "),getPopupContainer:e=>e.parentNode,children:[(0,_.jsx)(c.A.Option,{value:"",children:"Select Bank Account"}),null===M||void 0===M||null===(n=M.find(e=>e._id===Y))||void 0===n||null===(d=n.bankAccountData)||void 0===d?void 0:d.map(e=>(0,_.jsx)(c.A.Option,{value:e._id,children:(0,r.ig)(e)},e._id))]}))}}),C.bankAccountId&&(0,_.jsx)("p",{className:"text-red-500 text-sm",children:C.bankAccountId.message})]}),(0,_.jsxs)("div",{children:[(0,_.jsxs)("label",{className:"".concat(r.Q0),children:["Payment Date ",(0,_.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,_.jsx)(l.xI,{name:"paymentDate",control:I,rules:{required:"Payment date is required"},render:e=>{let{field:n}=e;return(0,_.jsx)(A.A,{field:n,errors:C,disabledDate:e=>e&&e.isAfter(p()(),"day")})}}),C.paymentDate&&(0,_.jsx)("p",{className:"text-red-500 text-sm",children:"Payment date is required"})]}),(0,_.jsxs)("div",{className:"col-span-2",children:[(0,_.jsx)("label",{className:"".concat(r.Q0),children:"Payment Reference"}),(0,_.jsx)("input",(0,a.A)((0,a.A)({type:"text"},d("paymentReference")),{},{className:r.Ol,placeholder:"e.g. TRANS123456789"})),C.paymentReference&&(0,_.jsx)("p",{className:"text-red-500 text-sm",children:C.paymentReference.message})]}),(0,_.jsxs)("div",{className:"col-span-2",children:[(0,_.jsx)("label",{className:"".concat(r.Q0),children:"Remarks"}),(0,_.jsx)("textarea",(0,a.A)((0,a.A)({},d("remark")),{},{rows:3,className:r.Ol,placeholder:"Additional notes (optional)"}))]}),(0,_.jsxs)("div",{className:"",children:[(0,_.jsx)("label",{className:"".concat(r.Q0),children:"Documents"}),F?(0,_.jsx)("div",{className:"space-y-2"}):(0,_.jsxs)("div",{className:"space-y-4",children:[(0,_.jsx)("input",{type:"file",onChange:e=>{const n={filePath:e.target.files[0],isVideo:!1,isMultiple:!1};P((0,y.Sg)(n)).then(e=>{var n;null!==e&&void 0!==e&&null!==(n=e.payload)&&void 0!==n&&n.data&&G(n=>{var d;return(0,a.A)((0,a.A)({},n),{},{attachments:[...(null===n||void 0===n?void 0:n.attachments)||[],null===e||void 0===e||null===(d=e.payload)||void 0===d?void 0:d.data]})})})},className:"hidden",id:"file-upload"}),(0,_.jsxs)("label",{htmlFor:"file-upload",className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-600 bg-white cursor-pointer",children:[(0,_.jsx)(m.chT,{className:"mr-2"})," Add Documents"]}),(0,_.jsx)("div",{className:"space-y-2",children:null===U||void 0===U||null===(e=U.attachments)||void 0===e?void 0:e.map((e,n)=>(0,_.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-md",children:[(0,_.jsxs)("a",{href:"".concat("https://vigapi.vigorousit.com","/public/").concat(e),className:"flex items-center space-x-2",target:"_blank",rel:"noopener noreferrer",children:[(0,_.jsx)(m.chT,{className:"text-gray-500"}),(0,_.jsx)("span",{className:"text-sm text-gray-600",children:e})]}),(0,_.jsx)("button",{type:"button",onClick:()=>(e=>{G(n=>{const d=null===n||void 0===n?void 0:n.attachments.filter((n,d)=>d!==e);return(0,a.A)((0,a.A)({},n),{},{attachments:d})})})(n),className:"text-red-500 hover:text-red-700",children:(0,_.jsx)(m.QCr,{})})]},n))})]})]})]}),(0,_.jsx)("div",{className:"flex justify-end",children:(0,_.jsx)("button",{type:"submit",disabled:n,className:"".concat(n?"bg-gray-400":"bg-header"," text-white p-2 px-4 rounded"),children:n?(0,_.jsx)(b.A,{}):"Submit"})})]})})})}}}]);
//# sourceMappingURL=247.9d5ed892.chunk.js.map