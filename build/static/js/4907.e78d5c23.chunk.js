"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[4907],{74907:(e,t,a)=>{a.r(t),a.d(t,{default:()=>z});var n=a(89379),i=a(65043),d=a(73216),s=a(35475),r=a(83003),l=a(13382),c=a(85578),o=a(65512),x=a(10898),u=a(85157),g=a(76399),h=a(96651),m=a(29813),y=a(61966),p=a(67407),j=a(75337),A=a(60446),f=a.n(A),v=a(735),C=a(4938),w=a(10405),b=a(39160),N=a(55971),k=a(78227),I=a(31174),S=a(30064),_=a.n(S),L=a(31744),D=a(24858),R=a(15187),B=a(89427),E=a(70579);const{Search:P}=c.A,{Text:O}=m.A;const z=function(){const e=(0,d.Zp)(),t=(0,r.wA)(),{setValue:a,control:c}=(0,D.mN)(),{userCompanyId:m,userType:A,userBranchId:S}=(0,v.A)(),{LeadCategoryListData:P,totalLeadCategoryCount:z,loading:T}=(0,r.d4)(e=>e.leadCategory),[Y,K]=(0,i.useState)([]),{canCreate:M,canRead:U,canUpdate:V,canDelete:q}=(0,C.A)(),{branchList:H,branchListloading:W}=(0,r.d4)(e=>e.branch),[Z,F]=(0,s.ok)(),G=parseInt(Z.get("page"))||1,J=parseInt(Z.get("limit"))||10,Q=Z.get("branchId")||"",[X,$]=(0,i.useState)(G),[ee,te]=(0,i.useState)(J),[ae,ne]=(0,i.useState)(""),[ie,de]=(0,i.useState)(Q);(0,i.useEffect)(()=>{const e=new URLSearchParams;X>1&&e.set("page",X),ee&&e.set("limit",ee),ie&&e.set("branchId",ie),F(e)},[ie,ae,X,ee]),(0,i.useEffect)(()=>{se()},[ie,ae,X,ee]);const se=()=>{const e={limit:ee,page:X,reqPayload:{text:ae,sort:!0,branchId:ie,companyId:m,isPagination:!0,status:""}};t((0,w.jN)(e))},re=e=>{let a={_id:e};_().fire({title:"Warning",text:"Are you sure you want to delete!",icon:"warning",showCancelButton:!0,cancelButtonText:"No"}).then(e=>{e.isConfirmed&&t((0,w.y3)(a)).then(e=>{X>1&&1==(null===P||void 0===P?void 0:P.length)?$(Number(X-1)):!e.error&&se()})})};(0,i.useEffect)(()=>{m&&t((0,L.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:m}))},[m]);const le=[{title:"S.No.",dataIndex:"index",key:"index",width:80,render:(e,t,a)=>a+1+(X-1)*ee},{title:"Lead Category Name",dataIndex:"name",key:"name",render:(e,t)=>(0,E.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,E.jsx)(O,{children:e})})},{title:"Created At",dataIndex:"createdAt",key:"createdAt",render:e=>{var t;return null!==(t=f()(e).format("DD-MM-YYYY hh:mm a"))&&void 0!==t?t:"-"}},{title:"Created By",dataIndex:"createdBy",key:"createdBy"},{title:"Status",dataIndex:"status",key:"status",render:e=>(0,E.jsx)(g.A,{color:e?"green":"red",children:e?"Active":"Inactive"})},{title:"Action",key:"action",width:150,render:(t,a)=>(0,E.jsxs)(x.A,{size:"small",children:[!a.leadCategoryId&&M&&(0,E.jsx)(h.A,{title:"Add Subcategory",children:(0,E.jsx)(l.Ay,{type:"text",icon:(0,E.jsx)(j.A,{}),onClick:()=>e("/admin/lead-category/create?parentPageId=".concat(a._id))})}),V&&(0,E.jsx)(h.A,{title:"Edit",children:(0,E.jsx)(l.Ay,{type:"text",icon:(0,E.jsx)(p.A,{}),onClick:()=>e("/admin/lead-category/edit/".concat((0,I.w)(a._id)))})}),q&&(0,E.jsx)(h.A,{title:"Delete",children:(0,E.jsx)(l.Ay,{type:"text",icon:(0,E.jsx)(y.A,{}),onClick:()=>re(a._id),danger:!0})})]})}];return(0,E.jsxs)(b.A,{children:[(0,E.jsx)("div",{className:"flex justify-end items-center",children:(0,E.jsxs)("div",{className:"grid grid-cols-1 gap-2 xl:grid-cols-5 2xl:grid-cols-7 lg:grid-cols-4 sm:grid-cols-2 md:grid-cols-4 w-full items-center",children:[(0,E.jsxs)("div",{className:"flex items-center p-2 gap-2",children:[(0,E.jsx)("span",{className:"text-sm font-light text-gray-500",children:"Rows per page:"}),(0,E.jsx)(o.A,{value:ee,onChange:e=>{te(Number(e)),$(Number(1))},className:"text-sm font-light text-gray-700 bg-white border border-gray-200 rounded-md px-3 py-1.5 shadow-sm focus:outline-none focus:ring-1 focus:ring-gray-300 transition",children:R.jR.map(e=>(0,E.jsx)(o.A.Option,{value:e,children:e},e))})]}),("admin"===A||"company"===A||"companyDirector"===A)&&(0,E.jsx)("div",{className:"relative md:flex justify-center items-center space-x-2  text-[14px] rounded-md",children:(0,E.jsxs)(o.A,{defaultValue:"",disabled:T,onChange:e=>{de(e),$(1)},value:ie,className:"".concat(R.Lp," "),showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,E.jsx)(o.A.Option,{value:"",children:"Select Branch"}),W?(0,E.jsx)(o.A.Option,{disabled:!0,children:(0,E.jsx)(B.A,{})}):null===H||void 0===H?void 0:H.map(e=>(0,E.jsx)(o.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]})}),(0,E.jsx)("div",{className:"flex justify-end  items-center",children:(0,E.jsx)("button",{onClick:()=>{$(1),de(""),te(10),ne("")},className:"bg-header w-full  py-[6px]  rounded-md  flex px-5 justify-center items-center  text-white",children:(0,E.jsx)("span",{className:"text-[12px]",children:"Reset"})})}),M&&(0,E.jsx)(l.Ay,{type:"primary",icon:(0,E.jsx)(j.A,{}),onClick:()=>e("/admin/lead-category/create"),children:"Add Category"})]})}),T?(0,E.jsx)(N.A,{}):(0,E.jsxs)("div",{className:"sm:w-full overflow-x-auto bg-white",children:[(0,E.jsx)(u.A,{columns:le,dataSource:P,rowKey:"_id",expandable:{expandedRowRender:t=>{const a=[...le.slice(0,-1),(0,n.A)((0,n.A)({},le[le.length-1]),{},{render:(t,a)=>(0,E.jsxs)(x.A,{size:"small",children:[V&&(0,E.jsx)(h.A,{title:"Edit",children:(0,E.jsx)(l.Ay,{type:"text",icon:(0,E.jsx)(p.A,{}),onClick:()=>e("/admin/lead-category/edit/".concat((0,I.w)(a._id)))})}),q&&(0,E.jsx)(h.A,{title:"Delete",children:(0,E.jsx)(l.Ay,{type:"text",icon:(0,E.jsx)(y.A,{}),onClick:()=>re(a._id),danger:!0})})]})})];return(0,E.jsx)(u.A,{columns:a,dataSource:t.leadSubCategoryData,rowKey:"_id",pagination:!1,showHeader:!1,size:"small",style:{backgroundColor:"#fafafa"}})},expandedRowKeys:Y,onExpand:(e,t)=>{K(e?[...Y,t._id]:Y.filter(e=>e!==t._id))},rowExpandable:e=>{var t;return(null===(t=e.leadSubCategoryData)||void 0===t?void 0:t.length)>0}},pagination:!1,bordered:!0}),(0,E.jsx)("div",{style:{marginTop:16,textAlign:"right"},children:(0,E.jsx)(k.A,{totalCount:z,pageSize:ee,currentPage:X,onChange:e=>$(e)})})]})]})}}}]);
//# sourceMappingURL=4907.e78d5c23.chunk.js.map