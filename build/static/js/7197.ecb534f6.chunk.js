"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[7197],{77197:(e,l,a)=>{a.r(l),a.d(l,{default:()=>y});var s=a(89379),t=a(65043),n=a(24858),r=a(83003),c=a(73216),i=a(92823),d=a.n(i),o=a(15187),u=a(735),m=a(78729),p=a(79304),x=a(39160),h=a(31744),v=a(66015),j=(a(36105),a(30575),a(84480),a(42837),a(88967)),g=a(70337),b=a(12208),N=a(33007),f=a(70579);const y=function(){const{register:e,handleSubmit:l,setValue:a,getValues:i,unregister:y,watch:I,control:A,formState:{errors:C}}=(0,n.mN)(),{userCompanyId:w,userDirectorId:S,userBranchId:k,userEmployeId:q,userDepartmentId:_,userDesignationId:U,userType:F}=(0,u.A)(),{companyList:D}=(0,r.d4)(e=>e.company),{departmentListData:L}=(0,r.d4)(e=>e.department),{clientList:P}=(0,r.d4)(e=>e.client),{clientGroupList:Q}=(0,r.d4)(e=>e.clientGroup),T=(0,c.Zp)(),O=(0,r.wA)(),[V,E]=(0,t.useState)([]),[G,B]=(0,t.useState)(""),[M,H]=(0,t.useState)(!1),[W,R]=(0,t.useState)(!1),[z,J]=(0,t.useState)(""),K=e=>{if(M)e.onChange([]);else{const l=Q.map(e=>({value:e._id,label:e.fullName}));e.onChange(l)}H(!M)},Z=e=>{if(W)e.onChange([]);else{const l=null===P||void 0===P?void 0:P.map(e=>({value:e._id,label:e.fullName}));e.onChange(l)}R(!W)},{branchList:X}=(0,r.d4)(e=>e.branch),Y=(0,n.FH)({control:A,name:"companyId",defaultValue:w}),$=(0,n.FH)({control:A,name:"branchId",defaultValue:k}),ee=(0,n.FH)({control:A,name:"notificationType",defaultValue:""});return(0,f.jsx)(x.A,{children:(0,f.jsx)("div",{className:"gap-4",children:(0,f.jsxs)("form",{autoComplete:"off",className:"mt-5",onSubmit:l(e=>{var l,a;const s={companyId:Y,directorId:"",branchId:$,departmentId:null===e||void 0===e?void 0:e.departmentId,subject:null===e||void 0===e?void 0:e.subject,notificationType:null===e||void 0===e?void 0:e.notificationType,attachment:null===e||void 0===e?void 0:e.fileUploadLink,message:z,clientIds:"client"===ee?null===e||void 0===e||null===(l=e.client)||void 0===l?void 0:l.map(e=>e.value):[],clientGroupIds:"group"===ee?null===e||void 0===e||null===(a=e.group)||void 0===a?void 0:a.map(e=>e.value):[],clients:"group"===ee?V:[]};O((0,p.UI)(s)).then(e=>{e.error||T("/admin/notification")})}),children:[(0,f.jsxs)("div",{className:"grid grid-cols-1 gap-2 md:my-2",children:["admin"===F&&(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsxs)("label",{className:"".concat(o.Q0),children:["Company",(0,f.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,f.jsxs)("select",(0,s.A)((0,s.A)({onFocus:()=>{O((0,m.Ar)({text:"",sort:!0,status:"",isPagination:!1}))}},e("companyId",{required:"Company is required"})),{},{className:" ".concat(o.Ol," ").concat(C.companyId?"border-[1px] ":"border-gray-300"),children:[(0,f.jsx)("option",{className:"",value:"",children:"Select Company"}),null===D||void 0===D?void 0:D.map(e=>(0,f.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName}))]})),C.companyId&&(0,f.jsx)("p",{className:"text-red-500 text-sm",children:C.companyId.message})]}),("admin"===F||"company"===F||"companyDirector"===F)&&(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsxs)("label",{className:"".concat(o.Q0),children:["Branch",(0,f.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,f.jsxs)("select",(0,s.A)((0,s.A)({onFocus:()=>{const e={companyId:Y,directorId:"",text:"",sort:!0,status:"",isPagination:!1};O((0,h.d0)(e))}},e("branchId",{required:"Branch is required"})),{},{className:" ".concat(o.Ol," ").concat(C.branchId?"border-[1px] ":"border-gray-300"),children:[(0,f.jsx)("option",{className:"",value:"",children:"Select Branch"}),null===X||void 0===X?void 0:X.map(e=>(0,f.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName}))]})),C.branchId&&(0,f.jsx)("p",{className:"text-red-500 text-sm",children:C.branchId.message})]}),(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsxs)("label",{className:"".concat(o.Q0),children:["Type",(0,f.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,f.jsxs)("select",(0,s.A)((0,s.A)({},e("notificationType",{required:"Category is required"})),{},{className:" ".concat(o.Ol," ").concat(C.notificationType?"border-[1px] ":"border-gray-300"),children:[(0,f.jsx)("option",{className:"",value:"",children:"Select Type"}),(0,f.jsx)("option",{value:"group",children:"Client Group"}),(0,f.jsx)("option",{value:"client",children:"Client Wise"}),(0,f.jsx)("option",{value:"department",children:"Department Wise"}),(0,f.jsx)("option",{value:"other",children:"other"})]})),C.notificationType&&(0,f.jsx)("p",{className:"text-red-500 text-sm",children:C.notificationType.message})]}),(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsxs)("label",{className:"".concat(o.Q0),children:["Subject ",(0,f.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,f.jsx)("input",(0,s.A)((0,s.A)({type:"text"},e("subject",{required:"Subject is required"})),{},{className:"placeholder: ".concat(o.Ol," ").concat(C.subject?"border-[1px] ":"border-gray-300"),placeholder:"Enter subject"})),C.subject&&(0,f.jsx)("p",{className:"text-red-500 text-sm",children:C.subject.message})]}),"client"===ee&&(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsxs)("label",{className:"".concat(o.Q0),children:["client ",(0,f.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,f.jsx)(n.xI,{name:"client",control:A,rules:{required:"At least one client is required"},render:e=>{let{field:l}=e;return(0,f.jsx)(v.Ay,(0,s.A)((0,s.A)({},l),{},{isMulti:!0,onFocus:()=>{O((0,g.Aq)({companyId:Y,branchId:$,groupId:I("groupName"),directorId:"",organizationId:"",industryId:"",text:"",sort:!0,status:!0,isPagination:!1}))},options:[{value:"select_all",label:"Select All"},...Array.isArray(P)?P.map(e=>({value:e._id,label:e.fullName})):[]],classNamePrefix:"react-select",className:"".concat(o.Ph," ").concat(C.client?"border-[1px] ":"border-gray-300"),placeholder:"Select client...",onChange:e=>{e.find(e=>"select_all"===e.value)?Z(l):(R(e.length===P.length),l.onChange(e))},value:l.value||[],formatOptionLabel:(e,a)=>{let{context:s}=a;return"select_all"===e.value?(0,f.jsxs)("div",{className:"flex items-center",children:[(0,f.jsx)("input",{type:"checkbox",checked:W,onChange:()=>Z(l),style:{marginRight:"10px"}}),(0,f.jsx)("span",{children:"Select All"})]}):e.label}}))}}),C.client&&(0,f.jsx)("p",{className:"text-red-500 text-sm mt-1",children:C.client.message})]}),"group"===ee&&(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsxs)("label",{className:"".concat(o.Q0),children:["Group ",(0,f.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,f.jsx)(n.xI,{name:"group",control:A,rules:{required:"At least one group is required"},render:e=>{let{field:l}=e;return(0,f.jsx)(v.Ay,(0,s.A)((0,s.A)({},l),{},{isMulti:!0,onFocus:()=>{O((0,b.J_)({companyId:Y,branchId:$,text:"",sort:!0,status:!0,isPagination:!1}))},options:[{value:"select_all",label:"Select All"},...Array.isArray(Q)?Q.map(e=>({value:e._id,label:e.fullName})):[]],classNamePrefix:"react-select",className:"".concat(o.Ph," ").concat(C.group?"border-[1px] ":"border-gray-300"),placeholder:"Select Employees...",onChange:e=>{e.find(e=>"select_all"===e.value)?K(l):(H(e.length===Q.length),l.onChange(e))},value:l.value||[],formatOptionLabel:(e,a)=>{let{context:s}=a;return"select_all"===e.value?(0,f.jsxs)("div",{className:"flex items-center",children:[(0,f.jsx)("input",{type:"checkbox",checked:M,onChange:()=>K(l),style:{marginRight:"10px"}}),(0,f.jsx)("span",{children:"Select All"})]}):e.label}}))}}),C.group&&(0,f.jsx)("p",{className:"text-red-500 text-sm mt-1",children:C.group.message})]}),"department"===ee&&(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsxs)("label",{className:"".concat(o.Q0),children:["Department",(0,f.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,f.jsxs)("select",(0,s.A)((0,s.A)({onFocus:()=>{const e={companyId:Y,branchId:$,directorId:"",text:"",sort:!0,status:!0,isPagination:!1};O((0,N.UU)(e))}},e("departmentId",{required:"Department is required"})),{},{className:" ".concat(o.Ol," ").concat(C.departmentId?"border-[1px] ":"border-gray-300"),children:[(0,f.jsx)("option",{className:"",value:"",children:"Select Department"}),null===L||void 0===L?void 0:L.map(e=>(0,f.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.name}))]})),C.departmentId&&(0,f.jsx)("p",{className:"text-red-500 text-sm",children:C.departmentId.message})]}),"other"===ee&&(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsxs)("label",{className:"".concat(o.Q0),children:["Clients ",(0,f.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,f.jsx)("input",(0,s.A)((0,s.A)({type:"text"},e("clients")),{},{className:"".concat(o.Ol," ").concat(C.clients?"border-[1px] ":"border-gray-300"),placeholder:"Write Clients & Press Enter",value:G,onChange:e=>{B(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&""!==G.trim()&&(e.preventDefault(),E(e=>[...e,G.trim()]),B(""))}})),C.clients&&(0,f.jsx)("p",{className:"text-red-500 text-sm",children:C.clients.message})]}),(0,f.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:V.map((e,l)=>(0,f.jsxs)("span",{className:"bg-gray-200 text-gray-700 px-3 py-1 text-xs rounded-full flex items-center gap-2",children:[e,(0,f.jsx)("button",{type:"button",onClick:()=>{return l=e,void E(e=>e.filter(e=>e!==l));var l},className:"text-red-500 hover:text-red-700",children:"\xd7"})]},l))})]}),(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsxs)("label",{className:"".concat(o.Q0),children:["Message ",(0,f.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,f.jsx)(d(),{value:z,onChange:e=>{J(e)},modules:{toolbar:[[{header:"1"},{header:"2"},{font:[]}],[{list:"ordered"},{list:"bullet"}],["bold","italic","underline","strike"],[{align:[]}],["link","image","video"],["blockquote","code-block"],["clean"]]},formats:["header","font","list","bold","italic","underline","link","align","clean"]})]}),(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsx)("label",{className:"".concat(o.Q0),children:"File  Upload"}),(0,f.jsx)(n.xI,{name:"fileUpload",control:A,render:e=>{let{field:l}=e;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("input",{type:"file",id:"file-upload",className:"hidden",onChange:e=>{var s;l.onChange(e),s=e.target.files[0],O((0,j.Sg)({filePath:s,isVideo:!1,isMultiple:!1})).then(e=>{var l;e.error||a("fileUploadLink",null===e||void 0===e||null===(l=e.payload)||void 0===l?void 0:l.data)})}}),(0,f.jsx)("br",{}),(0,f.jsx)("label",{htmlFor:"file-upload",className:"bg-header text-white mt-2 py-1.5 px-3 text-nowrap text-sm rounded cursor-pointer",children:"File Upload"}),C.fileUpload&&(0,f.jsx)("p",{className:"text-red-600 text-sm mt-1",children:C.fileUpload.message})]})}}),I("fileUploadLink")&&(0,f.jsx)("img",{src:"".concat("https://vigapi.vigorousit.com","/public/").concat(I("fileUploadLink")),alt:"Uploaded",className:"w-20 h-20 shadow rounded-sm"})]})]}),(0,f.jsx)("div",{className:"flex justify-end ",children:(0,f.jsx)("button",{type:"submit",className:"bg-header text-white p-2 px-4 rounded mt-4",children:"Submit"})})]})})})}}}]);
//# sourceMappingURL=7197.ecb534f6.chunk.js.map