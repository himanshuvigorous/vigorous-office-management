"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[3506],{43506:(e,t,n)=>{n.r(t),n.d(t,{default:()=>C});var o=n(89379),a=n(24858),l=n(83003),r=n(15187),d=n(65043),i=n(31744),s=n(39160),c=n(97326),u=n(53913),p=n(65512),m=(n(86178),n(60446)),h=n.n(m),v=n(78227),x=n(12106),w=(n(42837),n(94084)),y=n(69223),f=n(55971),N=n(50822),b=n(6720),g=n(37762),j=n(64857),A=(n(11906),n(33007),n(89427)),D=(n(70337),n(40088),n(12208)),I=(n(27744),n(17995),n(76932),n(70579));const C=function(){var e;const{control:t,formState:{errors:n},setValue:m,watch:C}=(0,a.mN)(),[S,R]=(0,d.useState)(10),T=(0,l.wA)(),{clientGrowthRevenueReportList:F,clientGrowthRevenueReportFunc_loading:k,clientGrowthRevenueReportCount:z}=(0,l.d4)(e=>e.reports),P=(0,a.FH)({control:t,name:"amountFrom",defaultValue:""}),_=(0,a.FH)({control:t,name:"amountTo",defaultValue:""}),{departmentListData:L,loading:B}=(0,l.d4)(e=>e.department),[V,G]=(0,d.useState)({}),{taskTypeList:Y}=(0,l.d4)(e=>e.taskType),{clientGroupList:E,groupSearchLoading:H}=(0,l.d4)(e=>e.clientGroup),{clientList:O}=(0,l.d4)(e=>e.client),{employeList:M}=(0,l.d4)(e=>e.employe),K=(0,a.FH)({control:t,name:"startDate",defaultValue:h()().subtract(1,"month")}),U=(0,a.FH)({control:t,name:"endDate",defaultValue:h()()}),[J,W]=(0,d.useState)(""),q=JSON.parse(localStorage.getItem("user_info_".concat(r.AU))),{industryListData:Q,indusSearchloading:X}=(0,l.d4)(e=>e.industry),{orgTypeList:Z,orgSearchloading:$}=(0,l.d4)(e=>e.orgType),[ee,te]=(0,d.useState)(1),[ne,oe]=(0,d.useState)(""),{branchList:ae}=(0,l.d4)(e=>e.branch),le=(0,a.FH)({control:t,name:"PDCompanyId",defaultValue:""}),re=(0,a.FH)({control:t,name:"PDBranchId",defaultValue:""}),de=(0,a.FH)({control:t,name:"status",defaultValue:""}),ie=(0,a.FH)({control:t,name:"PDOrganizationType",defaultValue:""}),se=(0,a.FH)({control:t,name:"PDindustrytype",defaultValue:""}),ce=((0,a.FH)({control:t,name:"department",defaultValue:""}),(0,a.FH)({control:t,name:"groupName",defaultValue:""}));(0,d.useEffect)(()=>{const e=setTimeout(()=>{oe(J)},500);return()=>{clearTimeout(e)}},[J]),(()=>{const e=[];for(let t=2005;t<=2034;t++)e.push("".concat(t,"-").concat(t+1))})();const ue=function(){return{currentPage:ee,pageSize:S,reqPayload:{text:ne,sort:!0,isPagination:!(arguments.length>0&&void 0!==arguments[0])||arguments[0],companyId:"admin"===(null===q||void 0===q?void 0:q.userType)?le:"company"===(null===q||void 0===q?void 0:q.userType)?null===q||void 0===q?void 0:q._id:null===q||void 0===q?void 0:q.companyId,directorId:"",branchId:"company"===(null===q||void 0===q?void 0:q.userType)||"admin"===(null===q||void 0===q?void 0:q.userType)||"companyDirector"===(null===q||void 0===q?void 0:q.userType)?re:"companyBranch"===(null===q||void 0===q?void 0:q.userType)?null===q||void 0===q?void 0:q._id:null===q||void 0===q?void 0:q.branchId,status:"true"==de||"false"!=de&&"",organizationId:ie,organizationIds:[],departmentId:"",departmentIds:[],amountFrom:P?Number(P):"",amountTo:_?Number(_):"",clientId:"",clientIds:[],industryId:se,industryIds:[],groupId:ce,groupIds:[],dueAmount:"",startDate:K?h()(K).format("YYYY-MM-DD"):"",endDate:U?h()(U).format("YYYY-MM-DD"):""}}};(0,d.useEffect)(()=>{pe(ne)},[ee,ne,S]);const pe=()=>{T((0,x.tJ)(ue(!0)))},[me,he]=(0,d.useState)(!1);(0,d.useEffect)(()=>{"company"!==(null===q||void 0===q?void 0:q.userType)&&"companyDirector"!==(null===q||void 0===q?void 0:q.userType)||T((0,i.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===q||void 0===q?void 0:q.userType)?le:"company"===(null===q||void 0===q?void 0:q.userType)?null===q||void 0===q?void 0:q._id:null===q||void 0===q?void 0:q.companyId})),m("startDate",h()().subtract(1,"month")),m("endDate",h()())},[]);const ve=async()=>{pe()},xe=[{key:"1",label:(0,I.jsx)("span",{className:"text-white",children:"Advance Filters"}),children:(0,I.jsxs)("div",{className:"bg-[#ececec] space-y-1 2xl:flex justify-between items-center",children:[(0,I.jsxs)("div",{className:"sm:flex  grid grid-cols-1  gap-2 sm:flex-wrap text-[14px]",children:[("admin"===(null===q||void 0===q?void 0:q.userType)||"company"===(null===q||void 0===q?void 0:q.userType)||"companyDirector"===(null===q||void 0===q?void 0:q.userType))&&(0,I.jsxs)("div",{className:"",children:[(0,I.jsx)(a.xI,{name:"PDBranchId",control:t,render:e=>{let{field:t}=e;return(0,I.jsxs)(p.A,(0,o.A)((0,o.A)({},t),{},{className:"inputAntdSelectClassNameFilterReport",placeholder:"Select Branch",showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,I.jsx)(p.A.Option,{value:"",children:"Select Branch"}),null===ae||void 0===ae?void 0:ae.map(e=>(0,I.jsxs)(p.A.Option,{value:null===e||void 0===e?void 0:e._id,children:[" ",null===e||void 0===e?void 0:e.fullName," "]}))]}))}}),n.PDBranchId&&(0,I.jsx)("p",{className:"text-red-500 text-sm",children:n.PDBranchId.message})]}),(0,I.jsx)("div",{className:"",children:(0,I.jsx)(a.xI,{name:"groupName",control:t,render:e=>{var t;let{field:n}=e;return(0,I.jsxs)(p.A,(0,o.A)((0,o.A)({},n),{},{className:"inputAntdSelectClassNameFilterReport",showSearch:!0,placeholder:"Select Group",onFocus:()=>{T((0,D.J_)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===q||void 0===q?void 0:q.userType)?le:"company"===(null===q||void 0===q?void 0:q.userType)?null===q||void 0===q?void 0:q._id:null===q||void 0===q?void 0:q.companyId,branchId:["admin","company","companyDirector"].includes(null===q||void 0===q?void 0:q.userType)?re:"companyBranch"===(null===q||void 0===q?void 0:q.userType)?null===q||void 0===q?void 0:q._id:null===q||void 0===q?void 0:q.branchId,groupId:""}))},onChange:e=>n.onChange(e),filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,I.jsx)(p.A.Option,{value:"",children:"Select Group"}),H?(0,I.jsx)(p.A.Option,{disabled:!0,children:(0,I.jsx)(A.A,{})}):null===(t=(0,r._o)(E))||void 0===t?void 0:t.map(e=>(0,I.jsxs)(p.A.Option,{value:null===e||void 0===e?void 0:e._id,children:[null===e||void 0===e?void 0:e.fullName," (",null===e||void 0===e?void 0:e.groupName,")"]},null===e||void 0===e?void 0:e._id))]}))}})}),(0,I.jsx)("div",{children:(0,I.jsx)(a.xI,{name:"amountFrom",control:t,render:e=>{let{field:t}=e;return(0,I.jsx)("input",{type:"number",value:null===t||void 0===t?void 0:t.value,onChange:e=>t.onChange(e),className:"inputAntdMultiSelectClassNameFilterReport",placeholder:"Enter Amount From "})}})}),(0,I.jsx)("div",{children:(0,I.jsx)(a.xI,{name:"amountTo",control:t,render:e=>{let{field:t}=e;return(0,I.jsx)("input",{type:"number",value:null===t||void 0===t?void 0:t.value,onChange:e=>t.onChange(e),className:"inputAntdMultiSelectClassNameFilterReport",placeholder:"Enter Amount To "})}})}),(0,I.jsx)("div",{children:(0,I.jsx)(a.xI,{name:"startDate",control:t,render:e=>{let{field:t}=e;return(0,I.jsx)(w.A,{report:!0,defaultValue:h()().subtract(1,"month"),size:"middle",field:t,errors:n})}})}),(0,I.jsx)("div",{children:(0,I.jsx)(a.xI,{name:"endDate",control:t,render:e=>{let{field:t}=e;return(0,I.jsx)(w.A,{report:!0,defaultValue:h()(),size:"middle",field:t,errors:n})}})})]}),(0,I.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,I.jsx)("button",{onClick:()=>{m("PDCompanyId",""),m("PDBranchId",""),m("groupName",""),m("amountFrom",""),m("amountTo",""),m("startDate",h()().subtract(1,"month")),m("endDate",h()()),ve()},className:"bg-header py-2 my-0.5 rounded-md flex px-10 justify-center items-center text-white",children:(0,I.jsx)("span",{className:"text-[12px]",children:"Reset"})}),(0,I.jsx)("button",{onClick:()=>{ve()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,I.jsx)("span",{className:"text-[12px]",children:"Submit"})})]})]})}];return(0,I.jsx)(s.A,{onChange:e=>{W(e)},children:(0,I.jsxs)("div",{className:"bg-grey-100 w-full p-1",children:[(0,I.jsxs)("div",{className:"",children:[(0,I.jsx)(c.A,{className:"custom-collapse",items:xe,defaultActiveKey:[1],expandIcon:e=>{let{isActive:t}=e;return(0,I.jsx)(b.WnU,{size:20,style:{color:"white",transform:t?"rotate(-90deg)":"rotate(0deg)",transition:"transform 0.3s ease"}})}}),(0,I.jsxs)("div",{className:"space-y-1.5 sm:flex grid grid-cols-1  justify-between items-center",children:[(0,I.jsxs)("div",{className:"flex items-center py-1 gap-2",children:[(0,I.jsx)("span",{htmlFor:"pageSize",className:"text-sm font-light text-gray-500",children:"Rows per page:"}),(0,I.jsx)(p.A,{id:"pageSize",value:S,onChange:e=>{R(Number(e)),te(Number(1))},className:"text-sm font-light text-gray-700 bg-white border border-gray-200 rounded-md px-3 py-1.5 shadow-sm focus:outline-none focus:ring-1 focus:ring-gray-300 transition",children:r.qc.map(e=>(0,I.jsx)(p.A.Option,{value:e,children:e},e))})]}),(0,I.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,I.jsx)("button",{onClick:()=>{(async()=>{var e,t;const n=new g.uE({orientation:"landscape",unit:"pt"});n.setFontSize(16);const o=await(null===N.K||void 0===N.K?void 0:N.K.clientGrowthRevenueReportFunc(ue(!1)));if(!F&&!o)return;const a=null===o||void 0===o||null===(e=o.data)||void 0===e||null===(t=e.docs)||void 0===t?void 0:t.map((e,t)=>[t+1,(null===e||void 0===e?void 0:e.groupName)||"-",(null===e||void 0===e?void 0:e.fullName)||"-",(null===e||void 0===e?void 0:e.totalTaskAmount)||0,(null===e||void 0===e?void 0:e.totalInvoiceAmount)||0,(null===e||void 0===e?void 0:e.totalReceiptAmount)||0,(null===e||void 0===e?void 0:e.dueAmount)||0]);(0,j.Ay)(n,{startY:40,head:[["S.No.","Group Name","Client Name","Total Amount","Invoice Raised","Amount Received","Due Amount"]],body:a,margin:{horizontal:10},styles:{cellPadding:8,fontSize:10,valign:"middle",halign:"left"},headStyles:{fillColor:[211,211,211],textColor:[0,0,0],fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]}}),n.save("Client_Revenue_Report.pdf")})()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,I.jsx)("span",{className:"text-[12px]",children:"Export PDF"})}),(0,I.jsx)("button",{onClick:()=>{(async()=>{var e;const t=new y.Workbook,n=t.addWorksheet("Client Revenue Report");n.columns=[{header:"S.No.",key:"sno",width:10},{header:"Group Name",key:"groupName",width:25},{header:"Client Name",key:"clientName",width:30},{header:"Total Amount",key:"totalTaskAmount",width:20},{header:"Invoice Raised",key:"totalInvoiceAmount",width:20},{header:"Amount Received",key:"totalReceiptAmount",width:20},{header:"Due Amount",key:"dueAmount",width:20}],n.getRow(1).eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFB6D7A8"}},e.font={bold:!0},e.alignment={vertical:"middle",horizontal:"center"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});const o=await(null===N.K||void 0===N.K?void 0:N.K.clientGrowthRevenueReportFunc(ue(!1)));if(null===o||void 0===o||null===(e=o.data)||void 0===e||!e.docs)return;o.data.docs.map((e,t)=>({sno:t+1,groupName:(null===e||void 0===e?void 0:e.groupName)||"-",clientName:(null===e||void 0===e?void 0:e.fullName)||"-",totalTaskAmount:(null===e||void 0===e?void 0:e.totalTaskAmount)||0,totalInvoiceAmount:(null===e||void 0===e?void 0:e.totalInvoiceAmount)||0,totalReceiptAmount:(null===e||void 0===e?void 0:e.totalReceiptAmount)||0,dueAmount:(null===e||void 0===e?void 0:e.dueAmount)||0})).forEach(e=>{n.addRow(e).eachCell(e=>{e.alignment={vertical:"middle",horizontal:"left"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),n.autoFilter={from:"A1",to:"G1"},t.xlsx.writeBuffer().then(e=>{const t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),n=document.createElement("a");n.href=URL.createObjectURL(t),n.download="ClientRevenueReport.xlsx",n.click()})})()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,I.jsx)("span",{className:"text-[12px]",children:"Export Excel"})})]})]})]}),(0,I.jsxs)("div",{className:"bg-[#ffffff]  w-full overflow-x-auto mt-1 rounded-xl",children:[(0,I.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto",children:[(0,I.jsx)("thead",{children:(0,I.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] capitalize text-[12px] bg-header text-white font-[500] h-[40px]",children:[(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap  w-[5%]",children:"S.No."}),(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Group Name"}),(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Client Name"}),(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Total Amount "}),(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Invoice raised "}),(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Amount Recieved "}),(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Due Amount"})]})}),k?(0,I.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,I.jsx)("td",{colSpan:15,className:"px-6 py-2 whitespace-nowrap  font-[600] text-sm text-gray-500",children:(0,I.jsx)(f.A,{})})}):(0,I.jsx)("tbody",{children:F&&(null===F||void 0===F?void 0:F.length)>0?null===F||void 0===F?void 0:F.map((e,t)=>(0,I.jsxs)("tr",{className:"border-b-[1px] ".concat(t%2===0?"bg-[#e9ecef]/80":"bg-white"," border-[#DDDDDD] text-[#374151] text-[14px]"),children:[(0,I.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:t+1+(ee-1)*S}),(0,I.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:null===e||void 0===e?void 0:e.groupName}),(0,I.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:null===e||void 0===e?void 0:e.fullName}),(0,I.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:(null===e||void 0===e?void 0:e.totalTaskAmount)||0}),(0,I.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:(null===e||void 0===e?void 0:e.totalInvoiceAmount)||0}),(0,I.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:Number(null===e||void 0===e?void 0:e.totalReceiptAmount).toFixed(2)||0}),(0,I.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:(null===e||void 0===e?void 0:e.dueAmount)||0})]})):(0,I.jsx)("tr",{className:"bg-white bg-opacity-5",children:(0,I.jsx)("td",{colSpan:15,className:"px-6 py-2 whitespace-nowrap  font-[600] text-sm text-gray-500",children:"Record Not Found"})})})]}),(0,I.jsx)(u.A,{className:"antmodalclassName !w-[60%] !h-[50%]",title:"Departments",open:me,onCancel:()=>he(!1),footer:null,children:(0,I.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto",children:[(0,I.jsx)("thead",{children:(0,I.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] capitalize text-[12px] bg-header text-white font-[500] h-[40px]",children:[(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap  w-[5%]",children:"S.No."}),(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Department Name"}),(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Email"}),(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Mobile"}),(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Created At"}),(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Created By"})]})}),k?(0,I.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,I.jsx)("td",{colSpan:15,className:"px-6 py-2 whitespace-nowrap  font-[600] text-sm text-gray-500",children:(0,I.jsx)(f.A,{})})}):(0,I.jsx)("tbody",{children:null!==V&&void 0!==V&&V.departmentData&&(null===V||void 0===V?void 0:V.departmentData.length)>0?null===V||void 0===V||null===(e=V.departmentData)||void 0===e?void 0:e.map((e,t)=>{var n,o;return(0,I.jsxs)("tr",{className:"border-b-[1px] ".concat(t%2===0?"bg-[#e9ecef]/80":"bg-white"," border-[#DDDDDD] text-[#374151] text-[14px]"),children:[(0,I.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:t+1+(ee-1)*S}),(0,I.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:null===e||void 0===e?void 0:e.name}),(0,I.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:(null===e||void 0===e?void 0:e.email)||"-"}),(0,I.jsxs)("td",{className:"whitespace-nowrap  border-none p-2",children:[(null===e||void 0===e||null===(n=e.mobile)||void 0===n?void 0:n.code)||"-"," ",(null===e||void 0===e||null===(o=e.mobile)||void 0===o?void 0:o.number)||"-"]}),(0,I.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:h()(null===e||void 0===e?void 0:e.createdAt).format("DD-MM-YYYY hh:mm a")}),(0,I.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:null===e||void 0===e?void 0:e.createdBy})]})}):(0,I.jsx)("tr",{className:"bg-white bg-opacity-5",children:(0,I.jsx)("td",{colSpan:15,className:"px-6 py-2 whitespace-nowrap  font-[600] text-sm text-gray-500",children:"Record Not Found"})})})]})})]}),(0,I.jsx)(v.A,{totalCount:z,pageSize:S,currentPage:ee,onChange:e=>{te(e)}})]})})}}}]);
//# sourceMappingURL=3506.dd5f4081.chunk.js.map