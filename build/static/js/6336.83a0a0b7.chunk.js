"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[6336],{26336:(e,t,a)=>{a.r(t),a.d(t,{default:()=>P});var l=a(89379),d=a(73216),s=a(39160),n=a(83003),i=a(65043),r=a(30064),o=a.n(r),c=a(31174),u=a(23156),x=a(47196),m=a(24858),v=a(15187),p=a(78227),h=a(31744),j=a(78729),f=(a(65337),a(12362)),b=a(86178),y=a.n(b),N=a(30326),g=a(65512),D=a(96651),A=a(4938),w=a(55971),C=a(83002),I=a(89427),T=a(70579);const P=function(){const{register:e,setValue:t,control:a,formState:{errors:r}}=(0,m.mN)(),b=(0,d.Zp)(),P=(0,n.wA)(),S=JSON.parse(localStorage.getItem("user_info_".concat(v.AU))),{companyList:B}=(0,n.d4)(e=>e.company),{branchList:_,branchListloading:k}=(0,n.d4)(e=>e.branch),{eventDataList:E,totalEventCount:H,loading:L}=(0,n.d4)(e=>e.event),O=(0,m.FH)({control:a,name:"PDCompanyId",defaultValue:""}),q=(0,m.FH)({control:a,name:"PDBranchId",defaultValue:""}),Y=(0,m.FH)({control:a,name:"status",defaultValue:""}),[V,z]=(0,i.useState)(""),[F,M]=(0,i.useState)(1),R=[q,O,Y,V].join("-"),[J,U]=(0,i.useState)(!1);(0,i.useEffect)(()=>{J?1===F?W():M(1):U(e=>!0)},[R]),(0,i.useEffect)(()=>{W()},[F]);const W=()=>{const e={page:F,limit:10,reqPayload:{companyId:"admin"===(null===S||void 0===S?void 0:S.userType)?O:"company"===(null===S||void 0===S?void 0:S.userType)?null===S||void 0===S?void 0:S._id:null===S||void 0===S?void 0:S.companyId,branchId:"company"===(null===S||void 0===S?void 0:S.userType)||"admin"===(null===S||void 0===S?void 0:S.userType)||"companyDirector"===(null===S||void 0===S?void 0:S.userType)?q:"companyBranch"===(null===S||void 0===S?void 0:S.userType)?null===S||void 0===S?void 0:S._id:null===S||void 0===S?void 0:S.branchId,directorId:"",text:V,sort:!0,status:"true"===Y||"false"!==Y&&"",isPagination:!0}};P((0,f.Lv)(e))};(0,i.useEffect)(()=>{(O||"company"===(null===S||void 0===S?void 0:S.userType)||"companyDirector"===(null===S||void 0===S?void 0:S.userType))&&P((0,h.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===S||void 0===S?void 0:S.userType)?O:"company"===(null===S||void 0===S?void 0:S.userType)?null===S||void 0===S?void 0:S._id:null===S||void 0===S?void 0:S.companyId}))},[O]),(0,i.useEffect)(()=>{"admin"===(null===S||void 0===S?void 0:S.userType)&&P((0,j.Ar)({text:"",sort:!0,status:!0,isPagination:!1}))},[]);const{canCreate:G,canRead:Z,canUpdate:K,canDelete:Q}=(0,A.A)();return(0,T.jsx)(s.A,{onChange:e=>{z(e)},children:(0,T.jsxs)("section",{children:[(0,T.jsxs)("div",{className:"lg:flex justify-between items-center xl:space-y-0 space-y-2 py-1",children:[(0,T.jsxs)("div",{className:"grid md:flex sm:grid-cols-3 grid-cols-1 flex-wrap md:gap-3 gap-1.5",children:["admin"===(null===S||void 0===S?void 0:S.userType)&&(0,T.jsxs)("div",{className:"",children:[(0,T.jsx)(m.xI,{control:a,name:"PDCompanyId",rules:{required:"Company is required"},render:e=>{let{field:t}=e;return(0,T.jsxs)(g.A,(0,l.A)((0,l.A)({},t),{},{defaultValue:"",disabled:L,className:"".concat(v.Lp," "),children:[(0,T.jsx)(g.A.Option,{value:"",children:"Select Company"}),null===B||void 0===B?void 0:B.map(e=>(0,T.jsx)(g.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),r.PDCompanyId&&(0,T.jsx)("p",{className:"text-red-500 text-sm",children:r.PDCompanyId.message})]}),("admin"===(null===S||void 0===S?void 0:S.userType)||"company"===(null===S||void 0===S?void 0:S.userType)||"companyDirector"===(null===S||void 0===S?void 0:S.userType))&&(0,T.jsxs)("div",{className:"",children:[(0,T.jsx)(m.xI,{control:a,name:"PDBranchId",rules:{required:"Branch is required"},render:e=>{let{field:t}=e;return(0,T.jsxs)(g.A,(0,l.A)((0,l.A)({},t),{},{defaultValue:"",disabled:L,className:"".concat(v.Lp," "),children:[(0,T.jsx)(g.A.Option,{value:"",children:"Select Branch"}),k?(0,T.jsx)(g.A.Option,{disabled:!0,children:(0,T.jsx)(I.A,{})}):null===_||void 0===_?void 0:_.map(e=>(0,T.jsx)(g.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),r.PDBranchId&&(0,T.jsx)("p",{className:"text-red-500 text-sm",children:r.PDBranchId.message})]}),(0,T.jsx)("div",{children:(0,T.jsx)(m.xI,{control:a,name:"status",rules:{required:"Status is required"},render:e=>{let{field:t}=e;return(0,T.jsxs)(g.A,(0,l.A)((0,l.A)({},t),{},{defaultValue:"",disabled:L,className:"".concat(v.Lp," "),children:[(0,T.jsx)(g.A.Option,{value:"",children:"Select status"}),(0,T.jsx)(g.A.Option,{value:"true",children:"Active"}),(0,T.jsx)(g.A.Option,{value:"false",children:"Inactive"})]}))}})})]}),(0,T.jsxs)("div",{className:"flex justify-end items-end gap-2",children:[(0,T.jsx)("button",{onClick:()=>{t("PDBranchId",""),t("PDCompanyId",""),t("status","")},className:"bg-header   py-[6px]  rounded-md  flex px-5 justify-center items-center  text-white",children:(0,T.jsx)("span",{className:"text-[12px]",children:"Reset"})}),G&&(0,T.jsx)(D.A,{placement:"topLeft",title:"Add Event",children:(0,T.jsxs)("button",{onClick:()=>{b("/admin/event/create")},className:"bg-header px-2 py-1.5 rounded-md flex justify-center items-center space-x-2 text-white",children:[(0,T.jsx)(u.OiG,{}),(0,T.jsx)("span",{className:"text-[12px]",children:"Add Event"})]})})]})]}),(0,T.jsx)("div",{className:"bg-[#ffffff] w-full overflow-x-auto mt-1 rounded-xl",children:Z&&(0,T.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto ",children:[(0,T.jsx)("thead",{className:"",children:(0,T.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] capitalize bg-header text-white font-[500] h-[40px]",children:[(0,T.jsx)("th",{className:"tableHead w-[10%]",children:"S.No."}),(0,T.jsx)("th",{className:"tableHead",children:"Title"}),(0,T.jsx)("th",{className:"tableHead",children:"Date"}),(0,T.jsx)("th",{className:"tableHead",children:"Created At"}),(0,T.jsx)("th",{className:"tableHead",children:"Created By"}),(0,T.jsx)("th",{className:"tableHead",children:"Status"}),(Q||K)&&(0,T.jsx)("th",{className:"tableHead w-[15%]",children:"Action"})]})}),L?(0,T.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,T.jsx)("td",{colSpan:10,className:"px-6 py-2 whitespace-nowrap font-[600] text-sm text-gray-500",children:(0,T.jsx)(w.A,{})})}):(0,T.jsx)("tbody",{children:E&&(null===E||void 0===E?void 0:E.length)>0?null===E||void 0===E?void 0:E.map((e,t)=>{var a,l,d,s,n;return(0,T.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] ".concat(t%2===0?"bg-[#e9ecef]/80":"bg-white"," text-[#374151]"),children:[(0,T.jsx)("td",{className:"tableData ",children:t+1+10*(F-1)}),(0,T.jsx)("td",{className:"tableData ",children:null!==(a=null===e||void 0===e?void 0:e.title)&&void 0!==a?a:"-"}),(0,T.jsx)("td",{className:"tableData ",children:null!==(l=y()(null===e||void 0===e?void 0:e.date).format("DD-MM-YYYY"))&&void 0!==l?l:"-"}),(0,T.jsx)("td",{className:"tableData ",children:null!==(d=y()(null===e||void 0===e?void 0:e.createdAt).format("DD-MM-YYYY hh:mm a"))&&void 0!==d?d:"-"}),(0,T.jsx)("td",{className:"tableData ",children:null!==(s=null===e||void 0===e?void 0:e.createdBy)&&void 0!==s?s:"-"}),(0,T.jsx)("td",{className:"tableData ",children:(0,T.jsx)("span",{className:"".concat(null!==e&&void 0!==e&&e.status?"bg-[#E0FFBE] border-green-500":"bg-red-200 border-red-500"," border-[1px] px-2 py-1.5 rounded-lg text-black text-[12px]"),children:null!==e&&void 0!==e&&e.status?"Active":null!==(n="Inactive")?n:"-"})}),(Q||K)&&(0,T.jsx)("td",{className:"tableData",children:(0,T.jsx)(N.A,{menu:{items:[K&&{key:"edit",label:(0,T.jsxs)("span",{onClick:()=>b("/admin/event/edit/".concat((0,c.w)(null===e||void 0===e?void 0:e._id))),className:"flex items-center text-[#3c8dbc] hover:text-[#337ab7]",children:[(0,T.jsx)(u.Jcp,{className:"mr-2",size:16}),"Edit"]})},Q&&{key:"delete",label:(0,T.jsxs)("span",{onClick:()=>(e=>{let t={_id:e};o().fire({title:"Warning",text:"Are you sure you want to delete!",icon:"warning",showCancelButton:!0,cancelButtonText:"No"}).then(e=>{e.isConfirmed&&P((0,f.oR)(t)).then(e=>{F>1&&1==(null===E||void 0===E?void 0:E.length)?M(Number(F-1)):W()})})})(null===e||void 0===e?void 0:e._id),className:"flex items-center text-red-600 hover:text-red-500",children:[(0,T.jsx)(x.tqC,{className:"mr-2",size:16}),"Delete"]})}].filter(Boolean)},trigger:["click"],children:(0,T.jsx)(D.A,{placement:"topLeft",title:"More Actions",children:(0,T.jsx)("button",{className:"px-2 py-1.5 text-xs rounded-md bg-transparent border border-muted",type:"button",children:(0,T.jsx)(C.xWf,{className:"hover:text-[#337ab7] text-[#3c8dbc]",size:16})})})})})]})}):(0,T.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,T.jsx)("td",{colSpan:5,className:"px-6 py-2 whitespace-nowrap font-[600] text-sm text-gray-500",children:"Record Not Found"})})})]})}),(null===E||void 0===E?void 0:E.length)>0&&(0,T.jsx)(p.A,{totalCount:H,pageSize:10,currentPage:F,onChange:e=>{M(e)}})]})})}},65337:(e,t,a)=>{a.d(t,{A:()=>s});var l=a(91686),d=a(70579);const s=function(){return(0,d.jsx)("div",{className:"flex justify-center items-center h-[80vh]",children:(0,d.jsx)(l.A,{size:"large"})})}}}]);
//# sourceMappingURL=6336.83a0a0b7.chunk.js.map