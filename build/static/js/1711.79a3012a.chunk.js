(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[1711],{8259:function(e){e.exports=function(){"use strict";var e="minute",a=/[+-]\d\d(?::?\d\d)?/g,t=/([+-]|\d\d)/g;return function(l,r,i){var n=r.prototype;i.utc=function(e){return new r({date:e,utc:!0,args:arguments})},n.utc=function(a){var t=i(this.toDate(),{locale:this.$L,utc:!0});return a?t.add(this.utcOffset(),e):t},n.local=function(){return i(this.toDate(),{locale:this.$L,utc:!1})};var s=n.parse;n.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),s.call(this,e)};var d=n.init;n.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else d.call(this)};var o=n.utcOffset;n.utcOffset=function(l,r){var i=this.$utils().u;if(i(l))return this.$u?0:i(this.$offset)?o.call(this):this.$offset;if("string"==typeof l&&(l=function(e){void 0===e&&(e="");var l=e.match(a);if(!l)return null;var r=(""+l[0]).match(t)||["-",0,0],i=r[0],n=60*+r[1]+ +r[2];return 0===n?0:"+"===i?n:-n}(l),null===l))return this;var n=Math.abs(l)<=16?60*l:l,s=this;if(r)return s.$offset=n,s.$u=0===l,s;if(0!==l){var d=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(s=this.local().add(n+d,e)).$offset=n,s.$x.$localOffset=d}else s=this.utc();return s};var c=n.format;n.format=function(e){var a=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return c.call(this,a)},n.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},n.isUTC=function(){return!!this.$u},n.toISOString=function(){return this.toDate().toISOString()},n.toString=function(){return this.toDate().toUTCString()};var u=n.toDate;n.toDate=function(e){return"s"===e&&this.$offset?i(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():u.call(this)};var p=n.diff;n.diff=function(e,a,t){if(e&&this.$u===e.$u)return p.call(this,e,a,t);var l=this.local(),r=i(e).local();return p.call(l,r,a,t)}}}()},14836:(e,a,t)=>{"use strict";t.d(a,{A:()=>p});var l=t(65043),r=t(53913),i=t(85157),n=t(96651),s=(t(86178),t(83003)),d=t(15811),o=t(60446),c=t.n(o),u=t(70579);const p=e=>{var a,t,o,p,m;let{isOpen:y,onClose:x,element:h}=e;const v=(0,s.wA)(),{loading:f,payrolsalaryReportData:j}=(0,s.d4)(e=>e.payrollReducer),g=(()=>{var e;const a=(null===j||void 0===j||null===(e=j.jsonData)||void 0===e?void 0:e.employeDayWiseReport)||[],t={presentDays:0,holidayDays:0,workingDays:0,sandwichDays:0,perDayTargetMin:0,totalEmployeWorkingMin:0,perDayEmployminMinutes:0,perDayEmployPendingMin:0,perDayEmployOvertimeMin:0,employePerDaySalary:0,perDaySalary:0,employePerExtraDaySalary:0,totalDiffrence:0,totalSalary:0};return a.forEach(e=>{var a;t.perDayTargetMin+=e.perDayTargetMin||0,t.totalEmployeWorkingMin+=e.totalEmployeWorkingMin||0,t.perDayEmployminMinutes+=e.perDayEmployminMinutes||0,t.perDayEmployPendingMin+=e.perDayEmployPendingMin||0,t.perDayEmployOvertimeMin+=e.perDayEmployOvertimeMin||0,e.isPresent&&t.presentDays++,e.isHoliday&&t.holidayDays++,e.isWorkingDay&&t.workingDays++,null!==(a=e.assignedShiftDetail)&&void 0!==a&&a.isApplySandwich&&t.sandwichDays++,e.salary&&(t.employePerDaySalary+=e.salary.employePerDaySalary||0,t.perDaySalary+=e.salary.perDaySalary||0,t.employePerExtraDaySalary+=e.salary.employePerExtraDaySalary||0,t.totalSalary+=(e.salary.employePerDaySalary||0)+(e.salary.employePerExtraDaySalary||0),t.totalDiffrence=t.totalSalary-t.perDaySalary)}),t})();(0,l.useEffect)(()=>{v((0,d.jy)({_id:h}))},[h]);const D=[{title:(0,u.jsx)(n.A,{placement:"topLeft",title:"Date",children:(0,u.jsx)("span",{style:{fontSize:"12px"},children:"Date"})}),dataIndex:"date",key:"date"},{title:(0,u.jsx)(n.A,{placement:"topLeft",title:"Day of Week",children:(0,u.jsx)("span",{style:{fontSize:"12px"},children:"Day"})}),dataIndex:"dayOfWeek",key:"dayOfWeek"},{title:(0,u.jsx)(n.A,{placement:"topLeft",title:"Day of Week",children:(0,u.jsx)("span",{style:{fontSize:"12px"},children:"Is WFH"})}),dataIndex:"iswfh",key:"iswfh",render:(e,a)=>{var t;return(0,u.jsx)("div",{children:a.attendanceData?null!==(t=a.attendanceData)&&void 0!==t&&t.wfhReqData?"Yes":"No":"-"})}},{title:(0,u.jsx)(n.A,{placement:"topLeft",title:"Per Day Target (Hours)",children:(0,u.jsx)("span",{style:{fontSize:"12px"},children:"Office Timing"})}),dataIndex:"perDayTargetMinwe",key:"perDayTargetMinwe",render:(e,a)=>{var t,l;return(0,u.jsx)("div",{children:a.assignedShiftDetail?(0,u.jsxs)(u.Fragment,{children:[null===(t=a.assignedShiftDetail)||void 0===t?void 0:t.openingTime," -",null===(l=a.assignedShiftDetail)||void 0===l?void 0:l.closingTime]}):"-"})}},{title:(0,u.jsx)(n.A,{placement:"topLeft",title:"Per Day Target (Hours)",children:(0,u.jsx)("span",{style:{fontSize:"12px"},children:"Target (Hours)"})}),dataIndex:"perDayTargetMin",key:"perDayTargetMin",render:e=>e?Math.floor(e/60).toString().padStart(2,"0")+":"+(e%60).toString().padStart(2,"0"):"-"},{title:(0,u.jsx)(n.A,{placement:"topLeft",title:"Total Employee Working (Hours)",children:(0,u.jsx)("span",{style:{fontSize:"12px"},children:"Worked Hours"})}),dataIndex:"totalEmployeWorkingMin",key:"totalEmployeWorkingMin",render:e=>e?Math.floor(e/60).toString().padStart(2,"0")+":"+(e%60).toString().padStart(2,"0"):"-"},{title:(0,u.jsx)(n.A,{placement:"topLeft",title:"Per Day Employee Pending (Hours)",children:(0,u.jsx)("span",{style:{fontSize:"12px"},children:"Pending (Hours)"})}),dataIndex:"perDayEmployPendingMin",key:"perDayEmployPendingMin",render:e=>e?Math.floor(e/60).toString().padStart(2,"0")+":"+(e%60).toString().padStart(2,"0"):"-"},{title:(0,u.jsx)(n.A,{placement:"topLeft",title:"Per Day Employee Overtime (Hours)",children:(0,u.jsx)("span",{style:{fontSize:"12px"},children:"Overtime (Hours)"})}),dataIndex:"perDayEmployOvertimeMin",key:"perDayEmployOvertimeMin",render:e=>e?Math.floor(e/60).toString().padStart(2,"0")+":"+(e%60).toString().padStart(2,"0"):"-"},{title:(0,u.jsx)(n.A,{placement:"topLeft",title:"Employee Per Day Salary",children:(0,u.jsx)("span",{style:{fontSize:"12px"},children:"Per Day Salary"})}),dataIndex:"salary.perDaySalary",render:(e,a)=>{var t;return(0,u.jsx)("div",{children:null!==a.salary.perDaySalary&&void 0!==a.salary.perDaySalary?null===(t=a.salary.perDaySalary)||void 0===t?void 0:t.toFixed(2):"-"})},key:"salary.perDaySalary"},{title:(0,u.jsx)(n.A,{placement:"topLeft",title:"Difference between Total and Calculated Salary",children:(0,u.jsx)("span",{style:{fontSize:"12px"},children:"Salary diffrence"})}),key:"salaryDifference",render:(e,a)=>{const t=a.salary.perDaySalary,l=a.salary.employePerExtraDaySalary+a.salary.employePerDaySalary;if(null!==t&&void 0!==t&&null!==l&&void 0!==l&&0!==l){const e=l-t,a=e>0?"+":e<0?"-":"";return(0,u.jsx)("div",{children:a+Math.abs(e).toFixed(2)})}return(0,u.jsx)("div",{children:"-"})}},{title:(0,u.jsx)(n.A,{placement:"topLeft",title:"Total Per Day Salary",children:(0,u.jsx)("span",{style:{fontSize:"12px"},children:"Total Salary"})}),dataIndex:"salary.totalperDaySalary",key:"salary.totalperDaySalary",render:(e,a)=>{var t;return(0,u.jsx)("div",{children:null===(t=a.salary.employePerExtraDaySalary+a.salary.employePerDaySalary)||void 0===t?void 0:t.toFixed(2)})}}];return y?(0,u.jsx)(r.A,{title:"Payroll Data - ".concat(null===j||void 0===j||null===(a=j.employeId)||void 0===a?void 0:a.fullName," / ").concat(c()(null===j||void 0===j||null===(t=j.jsonData)||void 0===t||null===(o=t.employeDayWiseReport)||void 0===o?void 0:o.date).format("MMMM")," / ").concat(null===j||void 0===j||null===(p=j.employeId)||void 0===p?void 0:p.email," "),visible:y,onCancel:x,footer:null,className:"antmodalclassName",width:1400,children:(0,u.jsx)(i.A,{columns:D,dataSource:(null===j||void 0===j||null===(m=j.jsonData)||void 0===m?void 0:m.employeDayWiseReport)||[],rowKey:"_id",pagination:!1,size:"small",bordered:!0,scroll:{x:"max-content"},locale:{emptyText:"Record Not Found"},rowClassName:(e,a)=>a%2===0?"bg-[#e9ecef]/80":"bg-white",summary:()=>{var e,a;return(0,u.jsx)(i.A.Summary,{fixed:!0,children:(0,u.jsxs)(i.A.Summary.Row,{style:{fontWeight:"bold",background:"#f0f0f0"},children:[(0,u.jsx)(i.A.Summary.Cell,{index:0,colSpan:3,children:"Total"}),(0,u.jsxs)(i.A.Summary.Cell,{index:4,children:[g.perDayTargetMin?Math.floor(g.perDayTargetMin/60).toString().padStart(2,"0")+":"+(g.perDayTargetMin%60).toString().padStart(2,"0"):"-"," hrs"]}),(0,u.jsxs)(i.A.Summary.Cell,{index:5,children:[g.totalEmployeWorkingMin?Math.floor(g.totalEmployeWorkingMin/60).toString().padStart(2,"0")+":"+(g.totalEmployeWorkingMin%60).toString().padStart(2,"0"):"-"," hrs"]}),(0,u.jsxs)(i.A.Summary.Cell,{index:6,children:[g.perDayEmployPendingMin?Math.floor(g.perDayEmployPendingMin/60).toString().padStart(2,"0")+":"+(g.perDayEmployPendingMin%60).toString().padStart(2,"0"):"-"," hrs"]}),(0,u.jsxs)(i.A.Summary.Cell,{index:9,children:[g.perDayEmployOvertimeMin?Math.floor(g.perDayEmployOvertimeMin/60).toString().padStart(2,"0")+":"+(g.perDayEmployOvertimeMin%60).toString().padStart(2,"0"):"-"," hrs"]}),(0,u.jsx)(i.A.Summary.Cell,{index:10,children:null===g||void 0===g||null===(e=g.perDaySalary)||void 0===e?void 0:e.toFixed(2)}),(0,u.jsx)(i.A.Summary.Cell,{index:10,children:"-"}),(0,u.jsx)(i.A.Summary.Cell,{index:12,children:null===(a=g.totalSalary)||void 0===a?void 0:a.toFixed(2)})]})})}})}):null}},21711:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>B});var l=t(89379),r=t(65043),i=t(73216),n=t(83003),s=t(47196),d=t(30064),o=t.n(d),c=t(23156),u=t(39160),p=(t(65337),t(31174)),m=t(15811),y=t(15187),x=t(78227),h=t(60184),v=t(86178),f=t.n(v),j=t(24858),g=t(31744),D=t(78729),S=t(42837),b=(t(33007),t(42044),t(88967),t(16998),t(41914),t(94084)),N=t(53913),A=t(65512),w=t(89427),T=t(487),M=t(60446),P=t.n(M),I=t(8259),C=t.n(I),O=t(17995),k=t(70579);P().extend(C());const E=e=>{let{isOpen:a,onClose:t,fetchattendanceListData:i}=e;const{register:s,handleSubmit:d,control:o,watch:c,setValue:u,formState:{errors:p}}=(0,j.mN)({defaultValues:{employeeName:"",date:f()().format("YYYY-MM-DD"),checkInTime:"",checkOutTime:"",reason:"",errors:{},month:null,startDate:null,endDate:null}}),{loading:x,payrollEmployeeList:h}=(0,n.d4)(e=>e.payrollReducer),v=JSON.parse(localStorage.getItem("user_info_".concat(y.AU))),b=(0,n.wA)(),{loading:M}=(0,n.d4)(e=>e.payrollReducer),{branchList:I,branchListloading:C}=(0,n.d4)(e=>e.branch),{companyList:E,companyListLoading:Y}=(0,n.d4)(e=>e.company),{employeList:_,employeeListLoading:$}=(0,n.d4)(e=>e.employe),H=(0,j.FH)({control:o,name:"PDBranchId",defaultValue:""}),L=(0,j.FH)({control:o,name:"PDCompanyId",defaultValue:""}),F=(0,j.FH)({control:o,name:"month",defaultValue:""});(0,r.useEffect)(()=>{"admin"===(null===v||void 0===v?void 0:v.userType)&&b((0,D.Ar)({text:"",sort:!0,status:!0,isPagination:!1}))},[]),(0,r.useEffect)(()=>{("admin"===(null===v||void 0===v?void 0:v.userType)&&L||"company"===(null===v||void 0===v?void 0:v.userType)&&null!==v&&void 0!==v&&v._id||"companyDirector"===(null===v||void 0===v?void 0:v.userType))&&(u("PDDepartmentId",""),u("PDDesignationId",""),u("PDBranchId",""),b((0,g.d0)({companyId:"admin"===(null===v||void 0===v?void 0:v.userType)?L:"company"===(null===v||void 0===v?void 0:v.userType)?null===v||void 0===v?void 0:v._id:null===v||void 0===v?void 0:v.companyId,text:"",sort:!0,status:!0,isPagination:!1})))},[L]),(0,r.useEffect)(()=>{!L&&"admin"===(null===v||void 0===v?void 0:v.userType)||!H&&"companBranch"===(null===v||void 0===v?void 0:v.userType)&&"employee"!==(null===v||void 0===v?void 0:v.userType)||!F||(B(),V())},[L,H,F]);const B=()=>{const e={text:"",status:!0,sort:!0,isTL:"",isHR:"",isPagination:!1,departmentId:"",designationId:"",companyId:"admin"===(null===v||void 0===v?void 0:v.userType)?L:"company"===(null===v||void 0===v?void 0:v.userType)?null===v||void 0===v?void 0:v._id:null===v||void 0===v?void 0:v.companyId,branchId:"company"===(null===v||void 0===v?void 0:v.userType)||"admin"===(null===v||void 0===v?void 0:v.userType)||"companyDirector"===(null===v||void 0===v?void 0:v.userType)?H:"companyBranch"===(null===v||void 0===v?void 0:v.userType)?null===v||void 0===v?void 0:v._id:null===v||void 0===v?void 0:v.branchId};b((0,S.qV)(e))},V=()=>{const e=F||P()(),a=e.year(),t=e.month()+1,l={companyId:"admin"===(null===v||void 0===v?void 0:v.userType)?L:"company"===(null===v||void 0===v?void 0:v.userType)?null===v||void 0===v?void 0:v._id:null===v||void 0===v?void 0:v.companyId,branchId:"company"===(null===v||void 0===v?void 0:v.userType)||"admin"===(null===v||void 0===v?void 0:v.userType)||"companyDirector"===(null===v||void 0===v?void 0:v.userType)?H:"companyBranch"===(null===v||void 0===v?void 0:v.userType)?null===v||void 0===v?void 0:v._id:null===v||void 0===v?void 0:v.branchId,text:"",sort:!0,year:a,month:t.toString().padStart(2,"0"),status:"",isPagination:!1,directorId:"",employeId:""};b((0,m.yq)(l))};if(!a)return null;const z=(null===_||void 0===_?void 0:_.filter(e=>!(null===h||void 0===h?void 0:h.some(a=>{var t;return(null===a||void 0===a||null===(t=a.employeData)||void 0===t?void 0:t._id)===(null===e||void 0===e?void 0:e._id)}))))||[];return(0,k.jsx)(N.A,{open:!0,onCancel:t,footer:null,centered:!0,className:"antmodalclassName",width:800,zIndex:1050,children:(0,k.jsx)("div",{children:(0,k.jsxs)("form",{autoComplete:"off",onSubmit:d(e=>{const a={employeId:null===e||void 0===e?void 0:e.employee,companyId:"admin"===(null===v||void 0===v?void 0:v.userType)?L:"company"===(null===v||void 0===v?void 0:v.userType)?null===v||void 0===v?void 0:v._id:null===v||void 0===v?void 0:v.companyId,branchId:"company"===(null===v||void 0===v?void 0:v.userType)||"admin"===(null===v||void 0===v?void 0:v.userType)||"companyDirector"===(null===v||void 0===v?void 0:v.userType)?H:"companyBranch"===(null===v||void 0===v?void 0:v.userType)?null===v||void 0===v?void 0:v._id:null===v||void 0===v?void 0:v.branchId,directorId:"",startDate:null===e||void 0===e?void 0:e.startDate,endDate:null===e||void 0===e?void 0:e.endDate,allowanceId:[],deductionId:[],penalties:[]};b((0,m.iv)(a)).then(e=>{e.error||(i(),t())})}),className:"",children:[(0,k.jsxs)("div",{className:"grid grid-col-1 md:grid-cols-2 gap-4",children:["admin"===(null===v||void 0===v?void 0:v.userType)&&(0,k.jsxs)("div",{children:[(0,k.jsxs)("label",{className:"".concat(y.Q0),children:["Company ",(0,k.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,k.jsx)(j.xI,{name:"PDCompanyId",control:o,rules:{required:"Company is required"},render:e=>{let{field:a}=e;return(0,k.jsxs)(A.A,(0,l.A)((0,l.A)({},a),{},{className:" ".concat(y.Hy," ").concat(p.PDPlan?"border-[1px] ":"border-gray-300"),getPopupContainer:e=>e.parentNode,placeholder:"Select Company",showSearch:!0,children:[(0,k.jsx)(A.A.Option,{value:"",children:"Select Company"}),Y?(0,k.jsx)(A.A.Option,{disabled:!0,children:(0,k.jsx)(w.A,{})}):null===E||void 0===E?void 0:E.map(e=>(0,k.jsxs)(A.A.Option,{value:null===e||void 0===e?void 0:e._id,children:[" ",null===e||void 0===e?void 0:e.fullName," "]}))]}))}}),p.PDCompanyId&&(0,k.jsx)("p",{className:"text-red-500 text-sm",children:p.PDCompanyId.message})]}),("admin"===(null===v||void 0===v?void 0:v.userType)||"company"===(null===v||void 0===v?void 0:v.userType)||"companyDirector"===(null===v||void 0===v?void 0:v.userType))&&(0,k.jsxs)("div",{children:[(0,k.jsxs)("label",{className:"".concat(y.Q0),children:["Branch ",(0,k.jsx)("span",{className:"text-red-600",children:" *"})]}),(0,k.jsx)(j.xI,{name:"PDBranchId",control:o,rules:{required:"Branch is required"},render:e=>{let{field:a}=e;return(0,k.jsxs)(A.A,(0,l.A)((0,l.A)({},a),{},{onChange:e=>{u("employee",""),a.onChange(e)},className:" ".concat(y.Hy," ").concat(p.PDPlan?"border-[1px] ":"border-gray-300"),getPopupContainer:()=>document.body,dropdownStyle:{zIndex:2e3},placeholder:"Select Branch",filterOption:(e,a)=>String(null===a||void 0===a?void 0:a.children).toLowerCase().includes(e.toLowerCase()),children:[(0,k.jsx)(A.A.Option,{value:"",children:"Select Branch"}),C?(0,k.jsx)(A.A.Option,{disabled:!0,children:(0,k.jsx)(w.A,{})}):null===I||void 0===I?void 0:I.map(e=>(0,k.jsxs)(A.A.Option,{value:null===e||void 0===e?void 0:e._id,children:[" ",null===e||void 0===e?void 0:e.fullName," "]}))]}))}}),p.PDBranchId&&(0,k.jsx)("p",{className:"text-red-500 text-sm",children:p.PDBranchId.message})]}),(0,k.jsxs)("div",{className:"",children:[(0,k.jsxs)("label",{className:y.Q0,children:["Select Month ",(0,k.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,k.jsx)(j.xI,{name:"month",control:o,rules:{required:"Month is required"},render:e=>{let{field:a}=e;return(0,k.jsx)(T.A,(0,l.A)((0,l.A)({},a),{},{size:"large",picker:"month",format:"MMMM YYYY",placeholder:"Select Month",className:"".concat(y.ot),getPopupContainer:e=>document.body,popupStyle:{zIndex:1600},disabledDate:e=>{if(!e)return!1;return e.clone().startOf("month").valueOf()>=P()().startOf("month").valueOf()},onChange:e=>((e,a,t)=>{if(e&&P()(e).isValid()){const l=P()(e).startOf("month").format("YYYY-MM-DD"),r=P()(e).endOf("month").format("YYYY-MM-DD");t("startDate",l,{shouldValidate:!0}),t("endDate",r,{shouldValidate:!0}),a.onChange(e)}else t("startDate",null),t("endDate",null),a.onChange(null)})(e,a,u),value:a.value?P()(a.value):null}))}}),p.month&&(0,k.jsx)("p",{className:"text-red-500 text-sm",children:p.month.message})]}),(0,k.jsxs)("div",{className:"w-full",children:[(0,k.jsxs)("label",{className:"".concat(y.Q0),children:["Employee ",(0,k.jsx)("span",{className:"text-red-600",children:" *"})]}),(0,k.jsx)(j.xI,{name:"employee",control:o,rules:{required:"Employee is required"},render:e=>{let{field:a}=e;return(0,k.jsxs)(A.A,(0,l.A)((0,l.A)({},a),{},{className:"".concat(y.Hy," ").concat(p.employee?"border-[1px]":"border-gray-300"),getPopupContainer:()=>document.body,dropdownStyle:{zIndex:2e3},placeholder:"Select Employee",showSearch:!0,filterOption:(e,a)=>String(null===a||void 0===a?void 0:a.children).toLowerCase().includes(e.toLowerCase()),children:[(0,k.jsx)(A.A.Option,{value:"",children:"Select Employee"}),$?(0,k.jsx)(A.A.Option,{disabled:!0,children:(0,k.jsx)(w.A,{})}):null===z||void 0===z?void 0:z.map(e=>(0,k.jsx)(A.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),p.employee&&(0,k.jsx)("p",{className:"text-red-500 text-sm",children:p.employee.message})]})]}),(0,k.jsx)("div",{className:"my-2",children:(0,k.jsx)("div",{className:"grid grid-col-1 md:grid-cols-2 gap-4"})}),(0,k.jsx)("div",{className:"flex justify-end space-x-2 mt-4",children:(0,k.jsx)("button",{type:"submit",disabled:M,className:" ".concat(M?"bg-gray-400":"bg-header"," px-4 py-2 text-sm font-medium text-white bg-header rounded-md hover:bg-[#063156]"),children:M?(0,k.jsx)(O.A,{}):"Submit"})})]})})})};var Y=t(96651),_=t(30326),$=t(55971),H=t(14836),L=t(78973),F=t(83002);const B=function(){const{register:e,handleSubmit:a,control:t,formState:{errors:d},setValue:v}=(0,j.mN)({defaultValues:{date:P()()}}),S=(0,i.Zp)(),N=(0,n.wA)(),{loading:w,payrollRequestData:T,totalPayrollquestCount:M,payrollSummary:I}=(0,n.d4)(e=>e.payrollReducer),{companyList:C}=(0,n.d4)(e=>e.company),{branchList:O}=(0,n.d4)(e=>e.branch),B=(0,j.FH)({control:t,name:"PDCompanyId",defaultValue:""}),V=(0,j.FH)({control:t,name:"PDBranchId",defaultValue:""}),z=(0,j.FH)({control:t,name:"status",defaultValue:""}),W=(0,j.FH)({control:t,name:"date",defaultValue:P()()}),[R,q]=(0,r.useState)(1),[U,Z]=(0,r.useState)(!1),[G,Q]=(0,r.useState)(P()().format("YYYY-MM")),[J,K]=(0,r.useState)({_id:null,visible:!1}),X=JSON.parse(localStorage.getItem("user_info_".concat(y.AU))),[ee,ae]=(0,r.useState)(""),te=[B,V,ee,z,W].join("-"),[le,re]=(0,r.useState)(!1);(0,r.useEffect)(()=>{le?1===R?ie():q(1):re(e=>!0)},[te]),(0,r.useEffect)(()=>{ie()},[R]);const ie=()=>{const e=W||P()(),a=e.year(),t=e.month()+1,l={currentPage:R,pageSize:15,reqData:{companyId:"admin"===(null===X||void 0===X?void 0:X.userType)?B:"company"===(null===X||void 0===X?void 0:X.userType)?null===X||void 0===X?void 0:X._id:null===X||void 0===X?void 0:X.companyId,branchId:"company"===(null===X||void 0===X?void 0:X.userType)||"admin"===(null===X||void 0===X?void 0:X.userType)||"companyDirector"===(null===X||void 0===X?void 0:X.userType)?V:"companyBranch"===(null===X||void 0===X?void 0:X.userType)?null===X||void 0===X?void 0:X._id:null===X||void 0===X?void 0:X.branchId,text:ee,sort:!0,year:a,month:t.toString().padStart(2,"0"),status:z,isPagination:!0,directorId:"",employeId:""}};N((0,m.mc)(l))};return(0,r.useEffect)(()=>{(B||"company"===(null===X||void 0===X?void 0:X.userType)||"companyDirector"===(null===X||void 0===X?void 0:X.userType))&&N((0,g.d0)({text:"",sort:!0,status:!0,companyId:"admin"===(null===X||void 0===X?void 0:X.userType)?B:"company"===(null===X||void 0===X?void 0:X.userType)?null===X||void 0===X?void 0:X._id:null===X||void 0===X?void 0:X.companyId}))},[B]),(0,r.useEffect)(()=>{"admin"===(null===X||void 0===X?void 0:X.userType)&&N((0,D.Ar)({text:"",sort:!0,status:!0,isPagination:!1}))},[]),(0,k.jsxs)(u.A,{onChange:e=>{ae(e)},children:[(0,k.jsxs)("div",{className:"flex justify-start items-center  my-1",children:[(0,k.jsx)("button",{onClick:()=>S("/admin/standardPayroll"),className:" px-3 border border-black py-2 rounded-l-md flex justify-center items-center space-x-2 text-black",children:(0,k.jsx)("span",{className:"text-[12px]",children:"Standard payroll"})}),(0,k.jsx)("button",{className:"bg-header px-3 py-2 border border-header rounded-r-md flex justify-center items-center space-x-2 text-white",children:(0,k.jsx)("span",{className:"text-[12px]",children:"Actual Payslip"})})]}),(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{className:"bg-grey-100 w-full",children:(0,k.jsxs)("div",{className:"sm:flex justify-between items-center md:space-y-0 space-y-2 py-1",children:[(0,k.jsxs)("div",{className:"sm:flex gap-2 md:space-y-0 space-y-1",children:["admin"===(null===X||void 0===X?void 0:X.userType)&&(0,k.jsxs)("div",{className:"",children:[(0,k.jsx)(j.xI,{control:t,name:"PDCompanyId",rules:{required:"Company is required"},render:e=>{let{field:a}=e;return(0,k.jsxs)(A.A,(0,l.A)((0,l.A)({},a),{},{defaultValue:"",disabled:w,className:"".concat(y.Lp," "),children:[(0,k.jsx)(A.A.Option,{value:"",children:"Select Company"}),null===C||void 0===C?void 0:C.map(e=>(0,k.jsx)(A.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),d.PDCompanyId&&(0,k.jsx)("p",{className:"text-red-500 text-sm",children:d.PDCompanyId.message})]}),("admin"===(null===X||void 0===X?void 0:X.userType)||"company"===(null===X||void 0===X?void 0:X.userType)||"companyDirector"===(null===X||void 0===X?void 0:X.userType))&&(0,k.jsxs)("div",{className:"",children:[(0,k.jsx)(j.xI,{control:t,name:"PDBranchId",rules:{required:"Branch is required"},render:e=>{let{field:a}=e;return(0,k.jsxs)(A.A,(0,l.A)((0,l.A)({},a),{},{defaultValue:"",disabled:w,className:"".concat(y.Lp," "),children:[(0,k.jsx)(A.A.Option,{value:"",children:"Select Branch"}),null===O||void 0===O?void 0:O.map(e=>(0,k.jsx)(A.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),d.PDBranchId&&(0,k.jsx)("p",{className:"text-red-500 text-sm",children:d.PDBranchId.message})]}),(0,k.jsx)("div",{className:"",children:(0,k.jsx)(j.xI,{name:"status",control:t,rules:{},render:e=>{let{field:a}=e;return(0,k.jsxs)(A.A,(0,l.A)((0,l.A)({},a),{},{className:" w-32 ".concat(y.Lp," ").concat(d.PDPlan?"border-[1px] ":"border-gray-300"),placeholder:"Select Status",disabled:w,showSearch:!0,children:[(0,k.jsx)(A.A.Option,{value:"",children:"Select Status"}),(0,k.jsx)(A.A.Option,{value:"Draft",children:" Draft  "}),(0,k.jsx)(A.A.Option,{value:"Approved",children:" Approved  "}),(0,k.jsx)(A.A.Option,{value:"Paid",children:" Paid  "})]}))}})}),(0,k.jsx)("div",{className:"",children:(0,k.jsx)(j.xI,{name:"date",control:t,render:e=>{let{field:a}=e;return(0,k.jsx)(b.A,{field:a,errors:d,picker:"month",report:!0,format:"MM/YYYY",disabledDate:e=>e&&e.isAfter(f()().endOf("day"),"day")})}})}),(0,k.jsx)("button",{onClick:()=>{v("PDBranchId",""),v("PDCompanyId",""),v("status",""),v("date",P()())},className:"bg-header py-[6px] w-full rounded-md flex px-5 justify-center items-center  text-white",children:(0,k.jsx)("span",{className:"text-[12px]",children:"Reset"})})]}),(0,k.jsx)("div",{className:"flex justify-end items-center gap-2",children:(0,k.jsx)(Y.A,{placement:"topLeft",title:"Create Payroll",children:(0,k.jsxs)("button",{onClick:()=>{Z(!0)},className:"bg-header px-2 py-1.5 rounded-md flex justify-center whitespace-nowrap items-center space-x-2 text-white",children:[(0,k.jsx)(c.OiG,{}),(0,k.jsx)("span",{className:"text-[12px]",children:"Generate Payslip"})]})})})]})}),I&&(0,k.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-md mb-4",children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold mb-3",children:["Payroll Summary for ",P()(W).format("MMMM YYYY")]}),(0,k.jsx)("div",{className:"overflow-x-auto",children:(0,k.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,k.jsx)("thead",{className:"bg-gray-50",children:(0,k.jsxs)("tr",{children:[(0,k.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Metric"}),(0,k.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),(0,k.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Metric"}),(0,k.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"})]})}),(0,k.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:[(0,k.jsxs)("tr",{children:[(0,k.jsx)("td",{className:"px-4 py-2 text-sm font-medium text-gray-900",children:" Standard Salary"}),(0,k.jsxs)("td",{className:"px-4 py-2 text-sm text-gray-900",children:["\u20b9",(0,y.ZV)(I.totalTargetSalary).toFixed(2)]}),(0,k.jsx)("td",{className:"px-4 py-2 text-sm font-medium text-gray-900",children:" Base Salary"}),(0,k.jsxs)("td",{className:"px-4 py-2 text-sm text-gray-900",children:["\u20b9",(0,y.ZV)(I.totalBasicSalary).toFixed(2)]})]}),(0,k.jsxs)("tr",{children:[(0,k.jsx)("td",{className:"px-4 py-2 text-sm font-medium text-gray-900",children:"Total Allowances"}),(0,k.jsxs)("td",{className:"px-4 py-2 text-sm text-gray-900",children:["\u20b9",(0,y.ZV)(I.totalAllowancesFromSummary).toFixed(2)]}),(0,k.jsx)("td",{className:"px-4 py-2 text-sm font-medium text-gray-900",children:"Gross Salary"}),(0,k.jsxs)("td",{className:"px-4 py-2 text-sm text-gray-900",children:["\u20b9",(0,y.ZV)(I.totalGrossSalary).toFixed(2)]})]}),(0,k.jsxs)("tr",{children:[(0,k.jsx)("td",{className:"px-4 py-2 text-sm font-medium text-gray-900",children:"Total Deductions"}),(0,k.jsxs)("td",{className:"px-4 py-2 text-sm text-gray-900",children:["\u20b9",(0,y.ZV)(I.totalNetSalary-I.totalGrossSalary).toFixed(2)]}),(0,k.jsx)("td",{className:"px-4 py-2 text-sm font-medium text-gray-900",children:"Net Salary"}),(0,k.jsxs)("td",{className:"px-4 py-2 text-sm text-gray-900",children:["\u20b9",(0,y.ZV)(I.totalNetSalary).toFixed(2)]})]})]})]})})]}),(0,k.jsx)("div",{className:"bg-[#ffffff] w-full overflow-x-auto mt-1 rounded-xl",children:(0,k.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto ",children:[(0,k.jsx)("thead",{className:"",children:(0,k.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] bg-header capitalize text-[#ffff] font-[500] h-[40px]",children:[(0,k.jsx)("th",{className:"tableHead w-[10%]",children:"S.No."}),(0,k.jsx)("th",{className:"tableHead w-[10%]",children:"Employee Name"}),(0,k.jsx)("th",{className:"tableHead w-[10%]",children:"Designation"}),(0,k.jsx)("th",{className:"tableHead",children:"Standard Salary"}),(0,k.jsx)("th",{className:"tableHead",children:"Gross Salary"}),(0,k.jsx)("th",{className:"tableHead",children:"Deductions"}),(0,k.jsx)("th",{className:"tableHead",children:"Net Salary"}),(0,k.jsx)("th",{className:"tableHead",children:"createdAt"}),(0,k.jsx)("th",{className:"tableHead",children:"Status"}),(0,k.jsx)("th",{className:"tableHead w-[10%]",children:"Action"})]})}),w?(0,k.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,k.jsx)("td",{colSpan:10,className:"px-6 py-2 whitespace-nowrap font-[600] text-sm text-gray-500",children:(0,k.jsx)($.A,{})})}):(0,k.jsx)("tbody",{children:T&&T.length>0?T.map((e,a)=>(0,k.jsxs)("tr",{className:"text-black ".concat(a%2===0?"bg-[#e9ecef]/80":"bg-white"," border-b-[1px] border-[#DDDDDD]"),children:[(0,k.jsx)("td",{className:"tableData",children:a+1+15*(R-1)}),(0,k.jsx)("td",{className:"tableData",children:null===e||void 0===e?void 0:e.employeName}),(0,k.jsx)("td",{className:"tableData",children:(null===e||void 0===e?void 0:e.designationName)||"-"}),(0,k.jsxs)("td",{className:"tableData whitespace-nowrap",children:[(0,y.ZV)(null===e||void 0===e?void 0:e.currentSalaryPerMonth).toFixed(2)," \u20b9"]}),(0,k.jsxs)("td",{className:"tableData  whitespace-nowrap",children:[(0,y.ZV)(null===e||void 0===e?void 0:e.grossSalary).toFixed(2)," \u20b9"]}),(0,k.jsxs)("td",{className:"tableData  whitespace-nowrap",children:[(0,y.ZV)((null===e||void 0===e?void 0:e.grossSalary)-(null===e||void 0===e?void 0:e.netSalary)).toFixed(2)," \u20b9"]}),(0,k.jsxs)("td",{className:"tableData whitespace-nowrap",children:[(0,y.ZV)(null===e||void 0===e?void 0:e.netSalary).toFixed(2)," \u20b9"]}),(0,k.jsx)("td",{className:"tableData",children:P()(null===e||void 0===e?void 0:e.createdAt).format("DD-MM-YYYY hh:mm A")}),(0,k.jsx)("td",{className:"tableData",children:(0,k.jsx)("span",{className:"tableData px-2 py-1 text-xs rounded-md border-[1px] font-medium\n                          ".concat("Draft"===(null===e||void 0===e?void 0:e.status)?"text-gray-600 bg-gray-100 border-gray-300":"Approved"===(null===e||void 0===e?void 0:e.status)?"text-green-600 bg-green-100 border-green-300":"Rejected"===(null===e||void 0===e?void 0:e.status)?"text-red-600 bg-red-100 border-red-300":"Paid"===(null===e||void 0===e?void 0:e.status)?"text-yellow-600 bg-yellow-100 border-yellow-300":""),children:null===e||void 0===e?void 0:e.status})}),(0,k.jsx)("td",{className:"tableData",children:(0,k.jsx)(_.A,{trigger:["click"],menu:{items:[{key:"daily-report",label:(0,k.jsxs)("span",{className:"flex items-center text-cyan-600",children:[(0,k.jsx)(L.wOe,{className:"mr-2"})," Daily Report"]}),onClick:()=>(e=>{K({_id:null===e||void 0===e?void 0:e._id,visible:!0})})(e)},{key:"approve",label:(0,k.jsxs)("span",{className:"flex items-center ".concat(["Approved","Rejected","Paid"].includes(null===e||void 0===e?void 0:e.status)?"text-gray-400 cursor-not-allowed":"text-green-600"),children:[(0,k.jsx)(h.A7C,{className:"mr-2"}),"Approve"]}),onClick:()=>{return!["Approved","Rejected","Paid"].includes(null===e||void 0===e?void 0:e.status)&&(a="Approved",t=null===e||void 0===e?void 0:e._id,void o().fire({title:"Are you sure?",text:"Do you want to update the payroll status as ".concat(a," ?"),icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, update it!",cancelButtonText:"Cancel"}).then(e=>{e.isConfirmed&&N((0,m.oK)({_id:t,status:a})).then(e=>{null!==e&&void 0!==e&&e.error?o().fire("Error!","Something went wrong while updating the payroll status.","error"):(o().fire("Updated!","The payroll status has been updated successfully.","success"),ie())})}));var a,t},disabled:["Approved","Rejected","Paid"].includes(null===e||void 0===e?void 0:e.status)},{key:"view",label:(0,k.jsxs)("span",{className:"flex items-center text-sky-600",children:[(0,k.jsx)(h.Ny1,{className:"mr-2"}),"View"]}),onClick:()=>S("/admin/paySlipData/".concat((0,p.w)(null===e||void 0===e?void 0:e._id)))},{key:"delete",label:(0,k.jsxs)("span",{className:"flex items-center ".concat("Draft"===(null===e||void 0===e?void 0:e.status)?"text-red-600":"text-gray-500 cursor-not-allowed"),children:[(0,k.jsx)(s.tqC,{className:"mr-2"}),"Delete"]}),onClick:()=>{return"Draft"===(null===e||void 0===e?void 0:e.status)&&(a=null===e||void 0===e?void 0:e._id,void N((0,m.BB)({_id:a})).then(e=>{R>1&&1==(null===T||void 0===T?void 0:T.length)?q(Number(R-1)):ie()}));var a},disabled:"Draft"!==(null===e||void 0===e?void 0:e.status)}]},children:(0,k.jsx)(Y.A,{placement:"topLeft",title:"More",children:(0,k.jsx)("button",{className:"px-2 py-1.5 rounded-md bg-transparent border border-muted",type:"button",children:(0,k.jsx)(F.xWf,{size:16,className:"text-[#3c8dbc] hover:text-[#337ab7]"})})})})})]},null===e||void 0===e?void 0:e._id)):(0,k.jsx)("tr",{className:"bg-white bg-opacity-5",children:(0,k.jsx)("td",{colSpan:12,className:"px-6 py-2 whitespace-nowrap font-[600] text-center text-sm text-gray-500",children:"Record Not Found"})})})]})}),(0,k.jsx)(x.A,{totalCount:M,pageSize:15,currentPage:R,onChange:e=>{q(e)}}),U&&(0,k.jsx)(E,{isOpen:!0,onClose:()=>Z(!1),fetchattendanceListData:ie}),(null===J||void 0===J?void 0:J.visible)&&(0,k.jsx)(H.A,{isOpen:!0,onClose:()=>K({_id:null,visible:!1}),element:null===J||void 0===J?void 0:J._id})]})]})}},65337:(e,a,t)=>{"use strict";t.d(a,{A:()=>i});var l=t(91686),r=t(70579);const i=function(){return(0,r.jsx)("div",{className:"flex justify-center items-center h-[80vh]",children:(0,r.jsx)(l.A,{size:"large"})})}}}]);
//# sourceMappingURL=1711.79a3012a.chunk.js.map