"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[1824],{31824:(e,d,l)=>{l.r(d),l.d(d,{default:()=>C});var n=l(89379),a=l(24858),s=l(39160),o=l(83003),i=l(73216),t=l(65043),r=l(15187),c=l(96603),u=l(65512),m=l(31744),v=l(78729),p=(l(36105),l(30575),l(84480),l(66015)),x=(l(42837),l(31536)),h=l(88967),y=l(66497),j=l(20126),N=l(60184),A=l(94084),b=l(86178),g=l.n(b),f=l(17995),I=l(89427),T=l(30295),S=(l(60446),l(70579));const C=()=>{const{loading:e}=(0,o.d4)(e=>e.purchaseExpence),{register:d,handleSubmit:l,control:b,watch:C,formState:{errors:q},setValue:D}=(0,a.mN)({defaultValues:{typeSelection:"Vendor"}}),V=(0,o.wA)(),O=(0,i.Zp)(),_=(0,a.FH)({control:b,name:"typeSelection"}),{companyList:w,companyListLoading:P}=(0,o.d4)(e=>e.company),{branchList:L,branchListloading:Q}=(0,o.d4)(e=>e.branch),B=JSON.parse(localStorage.getItem("user_info_".concat(r.AU))),{expenseTypeList:E}=(0,o.d4)(e=>e.expenceHead),H=(0,a.FH)({control:b,name:"PDCompanyId",defaultValue:""}),F=(0,a.FH)({control:b,name:"PDBranchId",defaultValue:""}),k=(0,a.FH)({control:b,name:"vendorId",defaultValue:""}),{vendorDataList:G,totalVendorCount:J,loading:K}=(0,o.d4)(e=>e.vendor),[M,U]=(0,t.useState)(!1),[X,Z]=(0,t.useState)({attachment:[]}),{AssetTypeListData:z}=(0,o.d4)(e=>e.AssetType);(0,t.useEffect)(()=>{(H||"company"===(null===B||void 0===B?void 0:B.userType)||"companyDirector"===(null===B||void 0===B?void 0:B.userType))&&V((0,m.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===B||void 0===B?void 0:B.userType)?H:"company"===(null===B||void 0===B?void 0:B.userType)?null===B||void 0===B?void 0:B._id:null===B||void 0===B?void 0:B.companyId}))},[H]),(0,t.useEffect)(()=>{"admin"===(null===B||void 0===B?void 0:B.userType)&&V((0,v.Ar)({text:"",sort:!0,status:!0,isPagination:!1}))},[]);(0,t.useEffect)(()=>{D("typeSelection","Vendor")},[]),(0,t.useEffect)(()=>{D("totalAmount",Number(C("amount"))+Number(C("gstAmount")))},[C("amount"),C("gstAmount")]);const R=()=>{V((0,j.Pe)({companyId:"admin"===(null===B||void 0===B?void 0:B.userType)?H:"company"===(null===B||void 0===B?void 0:B.userType)?null===B||void 0===B?void 0:B._id:null===B||void 0===B?void 0:B.companyId,branchId:"company"===(null===B||void 0===B?void 0:B.userType)||"admin"===(null===B||void 0===B?void 0:B.userType)||"companyDirector"===(null===B||void 0===B?void 0:B.userType)?F:"companyBranch"===(null===B||void 0===B?void 0:B.userType)?null===B||void 0===B?void 0:B._id:null===B||void 0===B?void 0:B.branchId,isPagination:!1,text:"",sort:!0,status:!0,groupId:""}))},W=()=>{V((0,T.BX)({companyId:"admin"===(null===B||void 0===B?void 0:B.userType)?H:"company"===(null===B||void 0===B?void 0:B.userType)?null===B||void 0===B?void 0:B._id:null===B||void 0===B?void 0:B.companyId,branchId:"company"===(null===B||void 0===B?void 0:B.userType)||"admin"===(null===B||void 0===B?void 0:B.userType)||"companyDirector"===(null===B||void 0===B?void 0:B.userType)?F:"companyBranch"===(null===B||void 0===B?void 0:B.userType)?null===B||void 0===B?void 0:B._id:null===B||void 0===B?void 0:B.branchId,isPagination:!1,text:"",sort:!0,status:!0,groupId:""}))};return(0,t.useEffect)(()=>{if(k){const e=null===G||void 0===G?void 0:G.find(e=>(null===e||void 0===e?void 0:e._id)===k);D("Name",e?null===e||void 0===e?void 0:e.fullName:"")}else D("Name","")},[k]),(0,S.jsx)(s.A,{children:(0,S.jsx)("div",{className:"gap-4",children:(0,S.jsxs)("form",{autoComplete:"off",className:"mt-2 md:px-1",onSubmit:l(e=>{var d,l;const n={companyId:"admin"===(null===B||void 0===B?void 0:B.userType)?null===e||void 0===e?void 0:e.PDCompanyId:"company"===(null===B||void 0===B?void 0:B.userType)?null===B||void 0===B?void 0:B._id:null===B||void 0===B?void 0:B.companyId,directorId:"companyDirector"===(null===B||void 0===B?void 0:B.userType)?null===B||void 0===B?void 0:B._id:null===B||void 0===B?void 0:B.directorId,branchId:"admin"===(null===B||void 0===B?void 0:B.userType)||"companyDirector"===(null===B||void 0===B?void 0:B.userType)||"company"===(null===B||void 0===B?void 0:B.userType)?null===e||void 0===e?void 0:e.PDBranchId:"companyBranch"===(null===B||void 0===B?void 0:B.userType)?null===B||void 0===B?void 0:B._id:null===B||void 0===B?void 0:B.branchId,vendorId:null===e||void 0===e?void 0:e.vendorId,quantity:"Vendor"===_?+(null===e||void 0===e?void 0:e.quantity):"",assetNameId:"Vendor"===_?null===e||void 0===e?void 0:e.assetNameId:"",assetName:"Vendor"===_?null===z||void 0===z||null===(d=z.find(d=>(null===d||void 0===d?void 0:d._id)===(null===e||void 0===e?void 0:e.assetNameId)))||void 0===d?void 0:d.name:"",expenseHeadId:null===e||void 0===e||null===(l=e.expencehead)||void 0===l?void 0:l.value,totalAmount:+(null===e||void 0===e?void 0:e.amount),totalGSTAmount:+(null===e||void 0===e?void 0:e.gstAmount),grandTotal:+(null===e||void 0===e?void 0:e.totalAmount),purchaseDate:(0,r.Tk)(null===e||void 0===e?void 0:e.date),status:"Pending",purchaseType:null===e||void 0===e?void 0:e.typeSelection,attachment:null===X||void 0===X?void 0:X.attachment,remarks:"",vendorOtherName:null===e||void 0===e?void 0:e.Name};V((0,y.Kt)(n)).then(e=>{e.error||O(-1)})}),children:[(0,S.jsxs)("div",{className:"col-span-2",children:[(0,S.jsx)(a.xI,{name:"typeSelection",control:b,rules:{required:"Client Selection Type is required"},render:e=>{let{field:d}=e;return(0,S.jsxs)(c.Ay.Group,(0,n.A)((0,n.A)({},d),{},{onChange:e=>{d.onChange(e)},optionType:"button",buttonStyle:"solid",block:!0,defaultValue:"Vendor",className:"  ".concat(q.clientSelection?"border-[1px] ":"border-gray-300"),children:[(0,S.jsx)(c.Ay,{value:"Vendor",children:"Asset"}),(0,S.jsx)(c.Ay,{value:"Other",children:"Other Expenses"})]}))}}),q.clientSelection&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:q.clientSelection.message})]}),(0,S.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-1 md:gap-8 md:my-1 px-3 md:mt-4",children:["admin"===(null===B||void 0===B?void 0:B.userType)&&(0,S.jsxs)("div",{className:"",children:[(0,S.jsxs)("label",{className:"".concat(r.Q0),children:["Company ",(0,S.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,S.jsx)(a.xI,{control:b,name:"PDCompanyId",rules:{required:"Company is required"},render:e=>{let{field:d}=e;return(0,S.jsxs)(u.A,(0,n.A)((0,n.A)({},d),{},{defaultValue:"",className:"".concat(r.Hy," "),showSearch:!0,filterOption:(e,d)=>String(null===d||void 0===d?void 0:d.children).toLowerCase().includes(e.toLowerCase()),children:[(0,S.jsx)(u.A.Option,{value:"",children:"Select Company"}),P?(0,S.jsx)(u.A.Option,{disabled:!0,children:(0,S.jsx)(I.A,{})}):null===w||void 0===w?void 0:w.map(e=>(0,S.jsx)(u.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),q.PDCompanyId&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:q.PDCompanyId.message})]}),("admin"===(null===B||void 0===B?void 0:B.userType)||"company"===(null===B||void 0===B?void 0:B.userType)||"companyDirector"===(null===B||void 0===B?void 0:B.userType))&&(0,S.jsxs)("div",{className:"",children:[(0,S.jsxs)("label",{className:"".concat(r.Q0),children:["Branch ",(0,S.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,S.jsx)(a.xI,{control:b,name:"PDBranchId",rules:{required:"Branch is required"},render:e=>{let{field:d}=e;return(0,S.jsxs)(u.A,(0,n.A)((0,n.A)({},d),{},{defaultValue:"",className:"".concat(r.Hy," "),showSearch:!0,filterOption:(e,d)=>String(null===d||void 0===d?void 0:d.children).toLowerCase().includes(e.toLowerCase()),children:[(0,S.jsx)(u.A.Option,{value:"",children:"Select Branch"}),Q?(0,S.jsx)(u.A.Option,{disabled:!0,children:(0,S.jsx)(I.A,{})}):null===L||void 0===L?void 0:L.map(e=>(0,S.jsx)(u.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),q.PDBranchId&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:q.PDBranchId.message})]}),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("div",{className:"",children:[(0,S.jsxs)("label",{className:"".concat(r.Q0),children:["Vendor ","Vendor"===_&&(0,S.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,S.jsx)(a.xI,{control:b,name:"vendorId",rules:{required:"Vendor"===_&&" vendor is required"},render:e=>{let{field:d}=e;return(0,S.jsxs)(u.A,(0,n.A)((0,n.A)({},d),{},{defaultValue:"",className:"".concat(r.Hy," "),onFocus:R,showSearch:!0,filterOption:(e,d)=>String(null===d||void 0===d?void 0:d.children).toLowerCase().includes(e.toLowerCase()),children:[(0,S.jsx)(u.A.Option,{value:"",children:"Select Vendor"}),K?(0,S.jsx)(u.A.Option,{disabled:!0,children:(0,S.jsx)(I.A,{})}):null===G||void 0===G?void 0:G.map((e,d)=>(0,S.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName}))]}))}}),q.vendorId&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:q.vendorId.message})]}),"Other"===_&&(0,S.jsxs)("div",{className:"",children:[(0,S.jsxs)("label",{className:"".concat(r.Q0),children:["Name",(0,S.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,S.jsx)("textarea",(0,n.A)((0,n.A)({},d("Name",{required:"Name is required"})),{},{className:" ".concat(r.Ol," ").concat(q.Name?"border-[1px] ":"border-gray-300"),placeholder:"Enter Name"})),q.Name&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:q.Name.message})]}),"Vendor"===_&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("div",{className:"",children:[(0,S.jsxs)("label",{className:"".concat(r.Q0),children:["Asset Name  ",(0,S.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,S.jsx)(a.xI,{control:b,name:"assetNameId",rules:{required:"Assets Name is required"},render:e=>{let{field:d}=e;return(0,S.jsxs)(u.A,(0,n.A)((0,n.A)({},d),{},{defaultValue:"",className:"".concat(r.Hy," "),onFocus:W,showSearch:!0,filterOption:(e,d)=>String(null===d||void 0===d?void 0:d.children).toLowerCase().includes(e.toLowerCase()),children:[(0,S.jsx)(u.A.Option,{value:"",children:"Select Asset Name"}),null===z||void 0===z?void 0:z.map((e,d)=>(0,S.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.name}))]}))}}),q.assetNameId&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:q.assetNameId.message})]}),(0,S.jsxs)("div",{className:"",children:[(0,S.jsxs)("label",{className:"".concat(r.Q0),children:["Quantity",(0,S.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,S.jsx)("input",(0,n.A)((0,n.A)({type:"number"},d("quantity",{required:"Quantity is required"})),{},{className:" ".concat(r.Ol," ").concat(q.quantity?"border-[1px] ":"border-gray-300"),placeholder:"Enter Quantity"})),q.quantity&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:q.quantity.message})]})]})]}),"Other"===(0,a.FH)({control:b,name:"typeSelection"})&&(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)("div",{className:"w-full",children:[(0,S.jsx)("label",{className:"".concat(r.Q0),children:"Expense Head"}),(0,S.jsx)(a.xI,{name:"expencehead",control:b,rules:{required:"Expence Head is required"},render:e=>{let{field:d}=e;return(0,S.jsx)(p.Ay,(0,n.A)((0,n.A)({onFocus:()=>{const e={directorId:"",companyId:"admin"===(null===B||void 0===B?void 0:B.userType)?H:"company"===(null===B||void 0===B?void 0:B.userType)?null===B||void 0===B?void 0:B._id:null===B||void 0===B?void 0:B.companyId,branchId:"company"===(null===B||void 0===B?void 0:B.userType)||"admin"===(null===B||void 0===B?void 0:B.userType)||"companyDirector"===(null===B||void 0===B?void 0:B.userType)?F:"companyBranch"===(null===B||void 0===B?void 0:B.userType)?null===B||void 0===B?void 0:B._id:null===B||void 0===B?void 0:B.branchId,text:"",sort:!0,status:"",isPagination:!1};V((0,x.dV)(e))}},d),{},{options:null===E||void 0===E?void 0:E.map(e=>({value:null===e||void 0===e?void 0:e._id,label:null===e||void 0===e?void 0:e.name})),classNamePrefix:"react-select",className:"".concat(r.Ph," ").concat(q.expencehead?"border-[1px] ":"border-gray-300"),placeholder:"Select Expence Head"}))}}),q.expencehead&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:q.expencehead.message})]})}),(0,S.jsxs)("div",{className:"",children:[(0,S.jsxs)("label",{className:"".concat(r.Q0),children:["Amount",(0,S.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,S.jsx)("input",(0,n.A)((0,n.A)({type:"number",step:"0.01"},d("amount",{required:"Amount is required"})),{},{className:" ".concat(r.Ol," ").concat(q.amount?"border-[1px] ":"border-gray-300"),placeholder:"Enter Amount"})),q.amount&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:q.amount.message})]}),(0,S.jsxs)("div",{className:"",children:[(0,S.jsx)("label",{className:"".concat(r.Q0),children:"Gst Amount"}),(0,S.jsx)("input",(0,n.A)((0,n.A)({type:"number",step:"0.01"},d("gstAmount")),{},{className:" ".concat(r.Ol," ").concat(q.gstAmount?"border-[1px] ":"border-gray-300"),placeholder:"Enter Gst Amount"})),q.gstAmount&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:q.gstAmount.message})]}),(0,S.jsxs)("div",{className:"",children:[(0,S.jsx)("label",{className:"".concat(r.Q0),children:"Total Amount"}),(0,S.jsx)("input",(0,n.A)((0,n.A)({type:"number",step:"0.01",disabled:!0},d("totalAmount")),{},{className:" ".concat(r.id," ").concat(q.totalAmount?"border-[1px] ":"border-gray-300"),placeholder:"Enter Total Amount"})),q.totalAmount&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:q.totalAmount.message})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"".concat(r.Q0),children:"Bill Date"}),(0,S.jsx)(a.xI,{name:"date",control:b,render:e=>{let{field:d}=e;return(0,S.jsx)(A.A,{field:d,errors:q,disabledDate:e=>e&&e.isAfter(g()().endOf("day"),"day")})}}),q.date&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:"Bill Date is required"})]}),(0,S.jsxs)("div",{className:"",children:[(0,S.jsx)("label",{className:"".concat(r.Q0),children:"Documents"}),M?(0,S.jsx)("div",{className:"space-y-2"}):(0,S.jsxs)("div",{className:"space-y-4",children:[(0,S.jsx)("input",{type:"file",onChange:e=>{const d={filePath:e.target.files[0],isVideo:!1,isMultiple:!1};V((0,h.Sg)(d)).then(e=>{var d;null!==e&&void 0!==e&&null!==(d=e.payload)&&void 0!==d&&d.data&&Z(d=>{var l;return(0,n.A)((0,n.A)({},d),{},{attachment:[...d.attachment,null===(l=e.payload)||void 0===l?void 0:l.data]})})})},className:"hidden",id:"file-upload"}),(0,S.jsxs)("label",{htmlFor:"file-upload",className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-600 bg-white cursor-pointer",children:[(0,S.jsx)(N.chT,{className:"mr-2"})," Add Documents"]}),(0,S.jsx)("div",{className:"space-y-2",children:X.attachment.map((e,d)=>(0,S.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-md",children:[(0,S.jsxs)("a",{href:"".concat("https://vigapi.vigorousit.com","/public/").concat(e),className:"flex items-center space-x-2",target:"_blank",rel:"noopener noreferrer",children:[(0,S.jsx)(N.chT,{className:"text-gray-500"}),(0,S.jsx)("span",{className:"text-sm text-gray-600",children:e})]}),(0,S.jsx)("button",{type:"button",onClick:()=>(e=>{Z(d=>{const l=d.attachment.filter((d,l)=>l!==e);return(0,n.A)((0,n.A)({},d),{},{attachment:l})})})(d),className:"text-red-500 hover:text-red-700",children:(0,S.jsx)(N.QCr,{})})]},d))})]})]})]}),(0,S.jsx)("div",{className:"flex justify-end",children:(0,S.jsx)("button",{type:"submit",disabled:e,className:"".concat(e?"bg-gray-400":"bg-header"," text-white p-2 px-4 rounded"),children:e?(0,S.jsx)(f.A,{}):"Submit"})})]})})})}}}]);
//# sourceMappingURL=1824.057f3919.chunk.js.map