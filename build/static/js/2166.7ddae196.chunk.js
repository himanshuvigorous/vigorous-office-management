"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[2166],{72166:(e,i,o)=>{o.r(i),o.d(i,{default:()=>D});var d=o(89379),n=o(65043),l=o(24858),s=o(86178),a=o.n(s),r=o(42837),t=o(83003),c=o(15187),u=o(78729),m=o(33007),v=o(31744),p=o(32256),h=o(73216),y=o(30064),x=o.n(y),f=o(94084),j=o(60446),I=o.n(j),T=o(53913),b=o(65512),g=o(17995),N=o(89427),A=o(57916),S=o(70579);const D=e=>{let{isOpen:i,onClose:o,fetchattendanceListData:s}=e;const{register:y,handleSubmit:j,watch:D,control:C,setValue:O,reset:P,formState:{errors:w}}=(0,l.mN)({defaultValues:{employeeName:"",date:"",checkInTime:"",checkOutTime:"",reason:"",errors:{}}}),_=b.A.Option,{timeSlotsListData:k}=(0,t.d4)(e=>e.timeSlots),L=((0,h.Zp)(),(0,l.FH)({control:C,name:"PDBranchId",defaultValue:""})),q=(0,l.FH)({control:C,name:"PDCompanyId",defaultValue:""}),B=(0,l.FH)({control:C,name:"PDDepartmentId",defaultValue:""}),H=(0,l.FH)({control:C,name:"PDDesignationId",defaultValue:""}),Y=JSON.parse(localStorage.getItem("user_info_".concat(c.AU))),E=(0,t.wA)(),{branchList:V,branchListloading:Q}=(0,t.d4)(e=>e.branch),{companyList:M,companyListLoading:F}=(0,t.d4)(e=>e.company),{loading:U}=(0,t.d4)(e=>e.attendance),{employeList:z}=(0,t.d4)(e=>e.employe);(0,n.useEffect)(()=>{"admin"===(null===Y||void 0===Y?void 0:Y.userType)&&E((0,u.Ar)({text:"",sort:!0,status:!0,isPagination:!1}))},[]),(0,n.useEffect)(()=>{("admin"!==(null===Y||void 0===Y?void 0:Y.userType)||q)&&(O("PDDepartmentId",""),O("PDDesignationId",""),O("PDBranchId",""),E((0,m.UU)({companyId:"admin"===(null===Y||void 0===Y?void 0:Y.userType)?q:"company"===(null===Y||void 0===Y?void 0:Y.userType)?null===Y||void 0===Y?void 0:Y._id:null===Y||void 0===Y?void 0:Y.companyId,text:"",sort:!0,status:!0,isPagination:!1})),E((0,v.d0)({companyId:"admin"===(null===Y||void 0===Y?void 0:Y.userType)?q:"company"===(null===Y||void 0===Y?void 0:Y.userType)?null===Y||void 0===Y?void 0:Y._id:null===Y||void 0===Y?void 0:Y.companyId,text:"",sort:!0,status:!0,isPagination:!1})))},[q]),(0,n.useEffect)(()=>{!q&&"admin"===(null===Y||void 0===Y?void 0:Y.userType)||!L&&"companBranch"===(null===Y||void 0===Y?void 0:Y.userType)&&"employee"!==(null===Y||void 0===Y?void 0:Y.userType)||R()},[q,L,B,H]),(0,n.useEffect)(()=>{J()},[L]);const R=()=>{const e={text:"",status:!0,sort:!0,isTL:"",isHR:"",isPagination:!1,departmentId:"",designationId:"",companyId:"admin"===(null===Y||void 0===Y?void 0:Y.userType)?q:"company"===(null===Y||void 0===Y?void 0:Y.userType)?null===Y||void 0===Y?void 0:Y._id:null===Y||void 0===Y?void 0:Y.companyId,branchId:"company"===(null===Y||void 0===Y?void 0:Y.userType)||"admin"===(null===Y||void 0===Y?void 0:Y.userType)||"companyDirector"===(null===Y||void 0===Y?void 0:Y.userType)?L:"companyBranch"===(null===Y||void 0===Y?void 0:Y.userType)?null===Y||void 0===Y?void 0:Y._id:null===Y||void 0===Y?void 0:Y.branchId};E((0,r.qV)(e))},J=()=>{E((0,A.iU)({directorId:"",companyId:"admin"===(null===Y||void 0===Y?void 0:Y.userType)?q:"company"===(null===Y||void 0===Y?void 0:Y.userType)?null===Y||void 0===Y?void 0:Y._id:null===Y||void 0===Y?void 0:Y.companyId,branchId:"company"===(null===Y||void 0===Y?void 0:Y.userType)||"admin"===(null===Y||void 0===Y?void 0:Y.userType)||"companyDirector"===(null===Y||void 0===Y?void 0:Y.userType)?L:"companyBranch"===(null===Y||void 0===Y?void 0:Y.userType)?null===Y||void 0===Y?void 0:Y._id:null===Y||void 0===Y?void 0:Y.branchId,text:"",sort:!0,status:"",isPagination:!1}))};return i?(0,S.jsx)(T.A,{visible:i,onCancel:()=>{o(),P()},className:"antmodalclassName",footer:null,title:"Apply Attendence",width:600,height:400,children:(0,S.jsx)("div",{children:(0,S.jsxs)("form",{autoComplete:"off",onSubmit:j(e=>{console.log(e);const i={employeId:null===e||void 0===e?void 0:e.employee,companyId:"admin"===(null===Y||void 0===Y?void 0:Y.userType)?q:"company"===(null===Y||void 0===Y?void 0:Y.userType)?null===Y||void 0===Y?void 0:Y._id:null===Y||void 0===Y?void 0:Y.companyId,branchId:"company"===(null===Y||void 0===Y?void 0:Y.userType)||"admin"===(null===Y||void 0===Y?void 0:Y.userType)||"companyDirector"===(null===Y||void 0===Y?void 0:Y.userType)?L:"companyBranch"===(null===Y||void 0===Y?void 0:Y.userType)?null===Y||void 0===Y?void 0:Y._id:null===Y||void 0===Y?void 0:Y.branchId,directorId:"companyDirector"===(null===Y||void 0===Y?void 0:Y.userType)?null===Y||void 0===Y?void 0:Y._id:null===Y||void 0===Y?void 0:Y.directorId,attendanceDate:I()(e.checkInTime).format("YYYY-MM-DD"),checkInTime:null!==e&&void 0!==e&&e.checkInTime?null===e||void 0===e?void 0:e.checkInTime:null,checkOutTime:e.checkOutTime?null===e||void 0===e?void 0:e.checkOutTime:null,method:"hr_portal",reason:e.reason,employeeName:e.employeeName,isVerified:!0,shift:e.shift};E((0,p.xn)(i)).then(e=>{e.error||(x().fire({icon:"success",title:"Success!",text:"Attendance record has been created successfully.",confirmButtonText:"OK",customClass:{confirmButton:"bg-header text-white hover:bg-[#063156]"}}),s(),o())})}),className:"",children:[(0,S.jsxs)("div",{className:"grid grid-col-1 md:grid-cols-2 gap-4",children:["admin"===(null===Y||void 0===Y?void 0:Y.userType)&&(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"".concat(c.Q0),children:"Company"}),(0,S.jsx)(l.xI,{name:"PDCompanyId",control:C,rules:{required:"Company is required"},render:e=>{let{field:i}=e;return(0,S.jsxs)(b.A,(0,d.A)((0,d.A)({},i),{},{className:" ".concat(c.Hy," ").concat(w.PDPlan?"border-[1px] ":"border-gray-300"),placeholder:"Select Company",showSearch:!0,filterOption:(e,i)=>String(null===i||void 0===i?void 0:i.children).toLowerCase().includes(e.toLowerCase()),getPopupContainer:e=>e.parentNode,children:[(0,S.jsx)(b.A.Option,{value:"",children:"Select Company"}),F?(0,S.jsx)(b.A.Option,{disabled:!0,children:(0,S.jsx)(N.A,{})}):null===M||void 0===M?void 0:M.map(e=>(0,S.jsxs)(b.A.Option,{value:null===e||void 0===e?void 0:e._id,children:[" ",null===e||void 0===e?void 0:e.fullName," "]}))]}))}}),w.PDCompanyId&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:w.PDCompanyId.message})]}),("admin"===(null===Y||void 0===Y?void 0:Y.userType)||"company"===(null===Y||void 0===Y?void 0:Y.userType)||"companyDirector"===(null===Y||void 0===Y?void 0:Y.userType))&&(0,S.jsxs)("div",{children:[(0,S.jsxs)("label",{className:"".concat(c.Q0),children:["Branch ",(0,S.jsx)("span",{className:"text-red-600",children:"* "})]}),(0,S.jsx)(l.xI,{name:"PDBranchId",control:C,rules:{required:"Branch is required"},render:e=>{var i;let{field:o}=e;return(0,S.jsxs)(b.A,(0,d.A)((0,d.A)({},o),{},{onChange:e=>{O("employee",""),O("shift",""),o.onChange(e)},className:" ".concat(c.Hy," ").concat(w.PDPlan?"border-[1px] ":"border-gray-300"," "),dropdownStyle:{zIndex:2e3},placeholder:"Select Branch",showSearch:!0,filterOption:(e,i)=>String(null===i||void 0===i?void 0:i.children).toLowerCase().includes(e.toLowerCase()),getPopupContainer:()=>document.body,children:[(0,S.jsx)(b.A.Option,{value:"",children:"Select Branch"}),Q?(0,S.jsx)(b.A.Option,{disabled:!0,children:(0,S.jsx)(N.A,{})}):null===(i=(0,c._o)(V,"fullName"))||void 0===i?void 0:i.map(e=>(0,S.jsxs)(b.A.Option,{value:null===e||void 0===e?void 0:e._id,children:[" ",null===e||void 0===e?void 0:e.fullName," "]}))]}))}}),w.PDBranchId&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:w.PDBranchId.message})]}),(0,S.jsxs)("div",{className:"w-full",children:[(0,S.jsxs)("label",{className:"".concat(c.Q0),children:["Employee ",(0,S.jsx)("span",{className:"text-red-600",children:"* "})]}),(0,S.jsx)(l.xI,{name:"employee",control:C,rules:{required:"Employee is required"},render:e=>{var i;let{field:o}=e;return(0,S.jsxs)(b.A,(0,d.A)((0,d.A)({},o),{},{onChange:e=>{var i;const o=z.find(i=>i._id===e);O("employee",e),O("shift",(null===o||void 0===o||null===(i=o.shiftTimeSlot)||void 0===i?void 0:i._id)||"")},dropdownStyle:{zIndex:2e3},getPopupContainer:()=>document.body,classNamePrefix:"react-select",className:"".concat(c.Hy," ").concat(w.employee?"border-[1px] ":"border-gray-300"),showSearch:!0,filterOption:(e,i)=>String(null===i||void 0===i?void 0:i.children).toLowerCase().includes(e.toLowerCase()),placeholder:"Select Employee",children:[(0,S.jsx)(b.A.Option,{value:"",children:"Select Employee"}),Q?(0,S.jsx)(b.A.Option,{disabled:!0,children:(0,S.jsx)(N.A,{})}):null===(i=(0,c._o)(z,"fullName"))||void 0===i?void 0:i.map(e=>(0,S.jsxs)(b.A.Option,{value:null===e||void 0===e?void 0:e._id,children:[" ",null===e||void 0===e?void 0:e.fullName," "]}))]}))}}),w.employee&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:w.employee.message})]}),(0,S.jsxs)("div",{children:[(0,S.jsxs)("label",{className:"".concat(c.Q0),children:["Check-in Time ",(0,S.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,S.jsx)(l.xI,{name:"checkInTime",control:C,rules:{required:!0},render:e=>{let{field:i}=e;return(0,S.jsx)(f.A,{field:i,showTime:!0,format:"DD/MM/YYYY HH:mm",errors:w,disabledDate:e=>{const i=a()(),o=i.date()<=3,d=i.clone().subtract(1,"month").startOf("month"),n=(i.clone().subtract(1,"month").endOf("month"),e.isSame(d,"month")),l=e.isSame(i,"month"),s=e.isAfter(i,"day");return o?s||!n&&!l:s||!l}})}}),w.checkInTime&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:"Check-in time is required"})]}),(0,S.jsxs)("div",{children:[(0,S.jsxs)("label",{className:"".concat(c.Q0),children:["Check-out Time ",(0,S.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,S.jsx)(l.xI,{name:"checkOutTime",control:C,rules:{required:!0},render:e=>{let{field:i}=e;return(0,S.jsx)(f.A,{field:i,showTime:!0,format:"DD/MM/YYYY HH:mm",errors:w,disabledDate:e=>{const i=D("checkInTime");if(!i)return!0;const o=I()(i).startOf("day"),d=o.add(1,"day");return!e.isSame(o,"day")&&!e.isSame(d,"day")}})}}),w.checkOutTime&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:"Check-out time is required"})]}),(0,S.jsxs)("div",{className:"",children:[(0,S.jsxs)("label",{className:"".concat(c.Q0),children:["Select Shift ",(0,S.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,S.jsx)(l.xI,{name:"shift",control:C,rules:{required:"Shift is required"},render:e=>{let{field:i}=e;return(0,S.jsxs)(b.A,(0,d.A)((0,d.A)({},i),{},{className:"".concat(c.Hy," ").concat(w.shift?"":"border-gray-300"),placeholder:"Select Shift",showSearch:!0,filterOption:(e,i)=>String(null===i||void 0===i?void 0:i.children).toLowerCase().includes(e.toLowerCase()),getPopupContainer:()=>document.body,dropdownStyle:{zIndex:2e3},children:[(0,S.jsx)(_,{value:"",children:"Select Shift"}),null===k||void 0===k?void 0:k.map(e=>(0,S.jsx)(_,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.shiftName},null===e||void 0===e?void 0:e._id))]}))}}),w.shift&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:w.shift.message})]}),(0,S.jsxs)("div",{children:[(0,S.jsxs)("label",{className:"".concat(c.Q0),children:["Reason ",(0,S.jsx)("span",{className:"text-red-600",children:"* "})]}),(0,S.jsx)("input",(0,d.A)((0,d.A)({type:"text"},y("reason",{required:!0})),{},{className:"".concat(c.Ol," ").concat(w.reason?"border-[1px] ":"border-gray-300"),rows:"3"})),w.reason&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:"Reason is required "})]})]}),(0,S.jsx)("div",{className:"flex justify-end space-x-2 mt-4",children:(0,S.jsx)("button",{type:"submit",disabled:U,className:"px-4 py-2 text-sm font-medium text-white ".concat(U?"bg-gray-400":"bg-header hover:bg-[#063156]"," rounded-md "),children:U?(0,S.jsx)(g.A,{}):"Submit"})})]})})}):null}}}]);
//# sourceMappingURL=2166.7ddae196.chunk.js.map