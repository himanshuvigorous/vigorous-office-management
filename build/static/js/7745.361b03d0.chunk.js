"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[7745],{27745:(e,t,l)=>{l.r(t),l.d(t,{default:()=>C});var a=l(65043),o=l(83003),n=l(73216),d=l(27810),i=l(31174),r=l(39160),s=l(29813),c=l(8918),u=l(70579);const{Title:m,Text:h}=s.A,{TabPane:v}=c.A;var p=l(55971),x=l(24858),b=l(15187),w=l(60446),f=l.n(w),y=l(94084),D=l(37762),j=l(64857),N=l(69223),g=l.n(N);const Y=function(e){var t,l,o,n,d,i,r;let{cashbookDetailsListdata:s,control:c,errors:m}=e;const{setValue:h}=(0,x.mN)(),[v,w]=(0,a.useState)(10),[N,Y]=(0,a.useState)([]),[C,k]=(0,a.useState)(""),[E,R]=(0,a.useState)(1),[F,A]=(0,a.useState)("");(0,a.useEffect)(()=>{const e=setTimeout(()=>{A(C)},500);return()=>{clearTimeout(e)}},[C]);const B=(0,a.useMemo)(()=>{var e,t,l,a,o,n,d;return{name:null===s||void 0===s?void 0:s.fullName,email:null===s||void 0===s||null===(e=s.branchData)||void 0===e?void 0:e.email,number:"".concat((null===s||void 0===s||null===(t=s.branchData)||void 0===t||null===(l=t.mobile)||void 0===l?void 0:l.code)||""," ").concat((null===s||void 0===s||null===(a=s.branchData)||void 0===a||null===(o=a.mobile)||void 0===o?void 0:o.number)||"").trim(),userName:null===s||void 0===s||null===(n=s.branchData)||void 0===n?void 0:n.userName,outstandingAmount:null===s||void 0===s||null===(d=s.summary)||void 0===d?void 0:d.closingBalance}},[s]),M=(0,a.useMemo)(()=>F?N.filter(e=>Object.values(e).some(e=>null===e||void 0===e?void 0:e.toString().toLowerCase().includes(F.toLowerCase()))):N,[N,F]),S=(0,a.useCallback)(async()=>{var e,t,l;const a=new(g().Workbook),o=a.addWorksheet("EmployeeCashbookDetails");o.columns=[{header:"S.No.",key:"sno",width:8},{header:"Entry Date",key:"entryDate",width:20},{header:"Value Date",key:"valueDate",width:15},{header:"Description",key:"description",width:30},{header:"Reference",key:"reference",width:20},{header:"Debit",key:"debit",width:15},{header:"Credit",key:"credit",width:15},{header:"Balance",key:"balance",width:15},{header:"Updated By",key:"updatedBy",width:20}],o.mergeCells("A1:I1"),o.getCell("A1").value="Employee Cashbook Report",o.getCell("A1").font={bold:!0,size:16},o.getCell("A1").alignment={horizontal:"center"},o.addRow([]),o.addRow(["Employee Details:","","","","","","","",""]),o.addRow(["Name:",B.name]),o.addRow(["Email:",B.email]),o.addRow(["Phone:",B.number]),o.addRow(["Username:",B.userName]),o.addRow(["Outstanding Amount:",B.outstandingAmount]),o.addRow([]);const n=f()().format("DD/MM/YYYY");o.addRow(["Report Date:",n]),o.addRow(["Date Range:","".concat(f()().startOf("month").format("DD/MM/YYYY")," - ").concat(f()().endOf("month").format("DD/MM/YYYY"))]),o.addRow([]);const d=o.addRow(["S.No.","Entry Date","Value Date","Description","Reference","Debit","Credit","Balance","Updated By"]);d.eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF2E86AB"}},e.font={bold:!0,color:{argb:"FFFFFFFF"}},e.alignment={vertical:"middle",horizontal:"center"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),M.forEach((e,t)=>{var l,a,n,d,i;o.addRow({sno:t+1,entryDate:null!==(l=null===e||void 0===e?void 0:e.date)&&void 0!==l?l:"-",valueDate:null!==(a=null===e||void 0===e?void 0:e.dateofValue)&&void 0!==a?a:"-",description:null!==(n=null===e||void 0===e?void 0:e.Description)&&void 0!==n?n:"-",reference:null!==(d=null===e||void 0===e?void 0:e.reference)&&void 0!==d?d:"-",debit:(0,b.w2)(e.amountDebit),credit:(0,b.w2)(e.amountCredit),balance:(0,b.w2)(e.acc),updatedBy:null!==(i=null===e||void 0===e?void 0:e.updatedBy)&&void 0!==i?i:"-"}).eachCell(t=>{t.alignment={vertical:"middle",horizontal:"left"},t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},"total"===e.key&&(t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF0F0F0"}},t.font={bold:!0})})});o.addRow([]);o.addRow(["Summary:","","","","","","","",""]);const i=(null===s||void 0===s||null===(e=s.summary)||void 0===e?void 0:e.totalDebit)||0,r=(null===s||void 0===s||null===(t=s.summary)||void 0===t?void 0:t.totalCredit)||0,c=(null===s||void 0===s||null===(l=s.summary)||void 0===l?void 0:l.closingBalance)||0;o.addRow(["Total Debit:","","","","",(0,b.w2)(i)]),o.addRow(["Total Credit:","","","","","",(0,b.w2)(r)]),o.addRow(["Closing Balance:","","","","","","",(0,b.w2)(c)]);const u="A".concat(d.number,":I").concat(d.number+M.length);o.autoFilter=u,o.views=[{state:"frozen",xSplit:0,ySplit:d.number}];const m=await a.xlsx.writeBuffer(),h=new Blob([m],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),v=document.createElement("a");v.href=URL.createObjectURL(h),v.download="Employee_Cashbook_".concat(f()().format("DD-MM-YYYY"),".xlsx"),document.body.appendChild(v),v.click(),document.body.removeChild(v)},[M,B,s]),T=(0,a.useCallback)(async()=>{const e=new D.uE({orientation:"landscape",unit:"pt"});e.setFontSize(16),e.text("Employee Cashbook Report",40,30),e.setFontSize(10);let t=60;e.text("Employee: ".concat(B.name),40,t),e.text("Date: ".concat(f()().format("DD/MM/YYYY")),300,t),t+=20,e.text("Period: ".concat(f()().startOf("month").format("DD/MM/YYYY")," - ").concat(f()().endOf("month").format("DD/MM/YYYY")),40,t);const l=M.map((e,t)=>{var l,a,o,n,d;return[t+1,null!==(l=null===e||void 0===e?void 0:e.date)&&void 0!==l?l:"-",null!==(a=null===e||void 0===e?void 0:e.dateofValue)&&void 0!==a?a:"-",null!==(o=null===e||void 0===e?void 0:e.Description)&&void 0!==o?o:"-",null!==(n=null===e||void 0===e?void 0:e.reference)&&void 0!==n?n:"-",(0,b.w2)(null===e||void 0===e?void 0:e.amountDebit),(0,b.w2)(null===e||void 0===e?void 0:e.amountCredit),(0,b.w2)(null===e||void 0===e?void 0:e.acc),null!==(d=null===e||void 0===e?void 0:e.updatedBy)&&void 0!==d?d:"-"]});(0,j.Ay)(e,{startY:t+20,head:[["S.No.","Entry Date","Value Date","Description","Reference","Debit","Credit","Balance","Updated By"]],body:l,margin:{horizontal:10},styles:{cellPadding:6,fontSize:8,valign:"middle",halign:"left"},headStyles:{fillColor:[46,134,171],textColor:[255,255,255],fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},didDrawCell:t=>{"Total"===t.cell.raw&&(e.setFillColor(240,240,240),e.rect(t.cell.x,t.cell.y,t.cell.width,t.cell.height,"F"),e.setTextColor(0,0,0),e.setFont(void 0,"bold"))}}),e.save("Employee_Cashbook_".concat(f()().format("DD-MM-YYYY"),".pdf"))},[M,B]);(0,a.useEffect)(()=>{Y(z(s))},[s]);const z=e=>{var t,l,a,o;if(!Array.isArray(null===e||void 0===e?void 0:e.allTransactions)||0===(null===e||void 0===e||null===(t=e.allTransactions)||void 0===t?void 0:t.length))return[];let n=[];return null===e||void 0===e||e.allTransactions.forEach(e=>{const t={key:"statement",date:null!==e&&void 0!==e&&e.createdAt?f()(null===e||void 0===e?void 0:e.createdAt).format("DD-MM-YYYY hh:mm a"):"-",dateofValue:null!==e&&void 0!==e&&e.date?f()(null===e||void 0===e?void 0:e.date).format("DD-MM-YYYY"):"-",amountDebit:"debit"==(null===e||void 0===e?void 0:e.debit_credit)?null===e||void 0===e?void 0:e.amount:0,amountCredit:"credit"==(null===e||void 0===e?void 0:e.debit_credit)?null===e||void 0===e?void 0:e.amount:0,acc:null===e||void 0===e?void 0:e.currentBalance,Description:(null===e||void 0===e?void 0:e.naration)||"-",reference:(null===e||void 0===e?void 0:e.referanceBy)||"-"};n.push(t)}),n.push({key:"total",date:null,dateofValue:null,amountDebit:null===e||void 0===e||null===(l=e.summary)||void 0===l?void 0:l.totalDebit,amountCredit:null===e||void 0===e||null===(a=e.summary)||void 0===a?void 0:a.totalCredit,acc:null===e||void 0===e||null===(o=e.summary)||void 0===o?void 0:o.closingBalance,Description:"Total",reference:""}),n};return(0,u.jsxs)("div",{className:"bg-grey-100 w-full p-1",children:[(0,u.jsx)("div",{className:"",children:(0,u.jsx)("div",{className:"space-y-1.5 flex justify-end items-center"})}),(0,u.jsxs)("div",{className:"max-w-[300px] rounded overflow-hidden shadow-md p-2 mb-2 bg-white",children:[(0,u.jsx)("h2",{className:"text-md font-semibold mb-1",children:"Employee Details"}),(0,u.jsxs)("div",{className:"mb-1",children:[(0,u.jsx)("span",{className:"font-bold text-[14px] text-header",children:"Employee Name: "}),(0,u.jsx)("span",{className:"text-gray-800 text-[13px]",children:null===s||void 0===s?void 0:s.fullName})]}),(0,u.jsxs)("div",{className:"mb-1",children:[(0,u.jsx)("span",{className:"font-bold text-[14px] text-header",children:"Email: "}),(0,u.jsx)("span",{className:"text-gray-800 text-[13px]",children:null===s||void 0===s||null===(t=s.branchData)||void 0===t?void 0:t.email})]}),(0,u.jsxs)("div",{className:"mb-1",children:[(0,u.jsx)("span",{className:"font-bold text-[14px] text-header",children:"Number: "}),(0,u.jsxs)("span",{className:"text-gray-800 text-[13px]",children:[null===s||void 0===s||null===(l=s.branchData)||void 0===l||null===(o=l.mobile)||void 0===o?void 0:o.code," ",null===s||void 0===s||null===(n=s.branchData)||void 0===n||null===(d=n.mobile)||void 0===d?void 0:d.number]})]}),(0,u.jsxs)("div",{className:"mb-1",children:[(0,u.jsx)("span",{className:"font-bold text-[14px] text-header",children:"UserName: "}),(0,u.jsx)("span",{className:"text-gray-800 text-[13px]",children:null===s||void 0===s||null===(i=s.branchData)||void 0===i?void 0:i.userName})]}),(0,u.jsxs)("div",{className:"mb-1",children:[(0,u.jsx)("span",{className:"font-bold text-[14px] text-header",children:"Outstanding Amount : "}),(0,u.jsx)("span",{className:"text-gray-800 text-[13px]",children:null===s||void 0===s||null===(r=s.summary)||void 0===r?void 0:r.closingBalance})]})]}),(0,u.jsxs)("div",{className:"flex flex-row w-full flex-wrap gap-2  ",children:[(0,u.jsx)("div",{className:"sm:w-auto w-full",children:(0,u.jsx)(x.xI,{name:"startDate",control:c,render:e=>{let{field:t}=e;return(0,u.jsx)(y.A,{report:!0,size:"middle",field:t,errors:m})}})}),(0,u.jsx)("div",{className:"sm:w-auto w-full",children:(0,u.jsx)(x.xI,{name:"endDate",report:!0,control:c,render:e=>{let{field:t}=e;return(0,u.jsx)(y.A,{size:"middle",report:!0,field:t,errors:m})}})})]}),(0,u.jsx)("div",{children:(0,u.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,u.jsx)("button",{onClick:()=>{T()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,u.jsx)("span",{className:"text-[12px]",children:"Export PDF"})}),(0,u.jsx)("button",{onClick:()=>{S()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,u.jsx)("span",{className:"text-[12px]",children:"Export Excel"})})]})}),(0,u.jsx)("div",{className:"bg-[#ffffff]  w-full overflow-x-auto mt-1 rounded-xl",children:(0,u.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto",children:[(0,u.jsx)("thead",{children:(0,u.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] capitalize text-[12px] bg-header text-white font-[500] h-[40px]",children:[(0,u.jsx)("th",{className:"border-none p-2 whitespace-nowrap  w-[5%]",children:"S.No."}),(0,u.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Entry Date"}),(0,u.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Value Date"}),(0,u.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Description "}),(0,u.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"References"}),(0,u.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Debit"}),(0,u.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Credit"}),(0,u.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Balance"}),(0,u.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Updated By"})]})}),s?(0,u.jsx)("tbody",{children:N&&(null===N||void 0===N?void 0:N.length)>0?null===N||void 0===N?void 0:N.map((e,t)=>{var l,a,o,n,d;return(0,u.jsxs)("tr",{className:"border-b-[1px] ".concat(t%2===0?"bg-[#e9ecef]/80":"bg-white"," border-[#DDDDDD] text-[#374151] text-[14px]"),children:[(0,u.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:t+1+(E-1)*v}),(0,u.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:null!==(l=null===e||void 0===e?void 0:e.date)&&void 0!==l?l:"-"}),(0,u.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:null!==(a=null===e||void 0===e?void 0:e.dateofValue)&&void 0!==a?a:"-"}),(0,u.jsx)("td",{className:" max-w-[350px] min-w-[200px] border-none p-2",children:(null===e||void 0===e?void 0:e.Description)||"-"}),(0,u.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:null!==(o=null===e||void 0===e?void 0:e.reference)&&void 0!==o?o:"-"}),(0,u.jsx)("td",{className:"whitespace-nowrap text-center  border-none p-2",children:null!==(n=(0,b.w2)(null===e||void 0===e?void 0:e.amountDebit))&&void 0!==n?n:"-"}),(0,u.jsx)("td",{className:"whitespace-nowrap  text-center border-none p-2",children:null!==(d=(0,b.w2)(null===e||void 0===e?void 0:e.amountCredit))&&void 0!==d?d:"-"}),(0,u.jsx)("td",{className:"whitespace-nowrap  text-center border-none p-2",children:null!==e&&void 0!==e&&e.acc?null===e||void 0===e?void 0:e.acc.toFixed(2):"-"}),(0,u.jsx)("td",{className:" max-w-[350px] min-w-[200px] border-none p-2",children:(null===e||void 0===e?void 0:e.updatedBy)||"-"})]})}):(0,u.jsx)("tr",{className:"bg-white bg-opacity-5",children:(0,u.jsx)("td",{colSpan:15,className:"px-6 py-2 whitespace-nowrap  font-[600] text-sm text-gray-500",children:"Record Not Found"})})}):(0,u.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,u.jsx)("td",{colSpan:15,className:"px-6 py-2 whitespace-nowrap  font-[600] text-sm text-gray-500",children:(0,u.jsx)(p.A,{})})})]})})]})},C=()=>{const{companyIdEnc:e,branchIdEnc:t,employeeIdEnc:l}=(0,n.g)(),{control:s,formState:{errors:c},setValue:m,watch:h}=(0,x.mN)(),v=(0,x.FH)({control:s,name:"startDate"}),w=(0,x.FH)({control:s,name:"endDate"});(0,a.useEffect)(()=>{m("startDate",f()().startOf("month")),m("endDate",f()().endOf("month"))},[]);const y=(0,i.Yc)(e),D=(0,i.Yc)(t),j=(0,i.Yc)(l),{cashbookDetailsLoading:N,cashbookDetailsListdata:g}=(0,o.d4)(e=>e.cashbook),C=(0,o.wA)();return(0,a.useEffect)(()=>{C((0,d.LX)({companyId:y,directorId:"",branchId:D,employeId:j,startDate:v?(0,b.Tk)(v):null,endDate:w?(0,b.Tk)(w):null}))},[e,t,l,v,w]),(0,u.jsx)(r.A,{children:N?(0,u.jsx)(p.A,{}):(0,u.jsx)(Y,{cashbookDetailsListdata:g,control:s,errors:c,setValue:m,watch:h})})}}}]);
//# sourceMappingURL=7745.361b03d0.chunk.js.map