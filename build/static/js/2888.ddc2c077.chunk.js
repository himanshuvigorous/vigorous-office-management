"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[2888],{62888:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Y});var s=a(65043),l=a(39160),n=a(73216),d=a(35475),i=a(83003),c=a(23156),o=a(31174),r=a(78227),x=a(15187),m=a(31744),h=a(78729),u=a(66497),p=a(86178),v=a.n(p),j=a(30326),N=a(53913),g=a(65512),b=a(96651),f=a(4938),y=a(55971),A=a(60184),w=a(45394),D=a(3825),k=a(60446),C=a.n(k),S=a(83002),T=a(29542),P=a(89427),L=a(32620),z=a(60397),E=a(6720),O=a(30064),_=a.n(O),H=a(70579);const Y=function(){var e,t,a,p,k,O,Y,I;const{canCreate:R,canRead:B,canUpdate:G,canDelete:M}=(0,f.A)(),[F,W]=(0,s.useState)(!1),U=(0,n.Zp)(),V=(0,i.wA)(),{purchaseExpenceListData:J,purchaseExpenceDetails:q,totalpurchaseExpenceListCount:Q,loading:X}=(0,i.d4)(e=>e.purchaseExpence),Z=JSON.parse(localStorage.getItem("user_info_".concat(x.AU))),[$,K]=(0,s.useState)({isOpen:!1,data:{},purchaseExpence:{}}),{branchList:ee,branchListloading:te}=(0,i.d4)(e=>e.branch),[ae,se]=(0,d.ok)(),le=parseInt(ae.get("page"))||1,ne=ae.get("branchId")||"",de=ae.get("status")||"",[ie,ce]=(0,s.useState)(le),[oe,re]=(0,s.useState)(10),[xe,me]=(0,s.useState)(de),[he,ue]=(0,s.useState)(""),[pe,ve]=(0,s.useState)(ne);(0,s.useEffect)(()=>{const e=new URLSearchParams;ie>1&&e.set("page",ie),pe&&e.set("branchId",pe),xe&&e.set("status",xe),se(e)},[ie,oe,pe,xe,he]),(0,s.useEffect)(()=>{je()},[ie,oe,pe,xe,he]);const je=()=>{const e={currentPage:ie,pageSize:oe,reqData:{directorId:"",companyId:"company"===(null===Z||void 0===Z?void 0:Z.userType)?null===Z||void 0===Z?void 0:Z._id:null===Z||void 0===Z?void 0:Z.companyId,branchId:"company"===(null===Z||void 0===Z?void 0:Z.userType)||"admin"===(null===Z||void 0===Z?void 0:Z.userType)||"companyDirector"===(null===Z||void 0===Z?void 0:Z.userType)?pe:"companyBranch"===(null===Z||void 0===Z?void 0:Z.userType)?null===Z||void 0===Z?void 0:Z._id:null===Z||void 0===Z?void 0:Z.branchId,text:he,sort:!0,status:xe,isPagination:!0}};V((0,u.s$)(e))};(0,s.useEffect)(()=>{"company"!==(null===Z||void 0===Z?void 0:Z.userType)&&"companyDirector"!==(null===Z||void 0===Z?void 0:Z.userType)||V((0,m.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"company"===(null===Z||void 0===Z?void 0:Z.userType)?null===Z||void 0===Z?void 0:Z._id:null===Z||void 0===Z?void 0:Z.companyId}))},[]),(0,s.useEffect)(()=>{"admin"===(null===Z||void 0===Z?void 0:Z.userType)&&V((0,h.Ar)({text:"",sort:!0,status:!0,isPagination:!1}))},[]);const Ne=e=>e.toLowerCase().endsWith(".pdf"),ge=e=>[".jpg",".jpeg",".png",".gif",".webp",".bmp",".tiff"].some(t=>e.toLowerCase().endsWith(t));return(0,H.jsx)(l.A,{onChange:e=>{ue(e)},children:(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)("div",{className:"",children:(0,H.jsxs)("div",{class:"sm:flex justify-between items-center py-1 lg:space-y-0 space-y-2 overflow-y-auto",children:[(0,H.jsxs)("div",{className:"grid grid-cols-1 md:gap-2 gap-1 md:grid-cols-3 items-center",children:[("admin"===(null===Z||void 0===Z?void 0:Z.userType)||"company"===(null===Z||void 0===Z?void 0:Z.userType)||"companyDirector"===(null===Z||void 0===Z?void 0:Z.userType))&&(0,H.jsx)("div",{className:"",children:(0,H.jsxs)(g.A,{value:pe,onChange:e=>{ve(e),ce(1)},defaultValue:"",disabled:X,className:"".concat(x.Lp," "),showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,H.jsx)(g.A.Option,{value:"",children:"Select Branch"}),te?(0,H.jsx)(g.A.Option,{disabled:!0,children:(0,H.jsx)(P.A,{})}):null===ee||void 0===ee?void 0:ee.map(e=>(0,H.jsx)(g.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]})}),(0,H.jsx)("div",{className:"",children:(0,H.jsxs)(g.A,{value:xe,onChange:e=>{me(e),ce(1)},disabled:X,className:"".concat(x.Lp," "),showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,H.jsx)(g.A.Option,{value:"",children:"Select Status"}),(0,H.jsx)(g.A.Option,{value:"Draft",children:"Draft"}),(0,H.jsx)(g.A.Option,{value:"Pending",children:"Pending"}),(0,H.jsx)(g.A.Option,{value:"Paid",children:"Paid"})]})})]}),(0,H.jsxs)("div",{className:"flex justify-end items-center gap-2 ",children:[(0,H.jsx)("button",{onClick:()=>{ce(1),ve(""),me(""),ue("")},className:"bg-header  py-1.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,H.jsx)("span",{className:"text-[12px]",children:"Reset"})}),R&&(0,H.jsx)(b.A,{placement:"topLeft",title:"Add Purchase Expense",children:(0,H.jsxs)("button",{onClick:()=>{U("/admin/purchase-expence/create")},className:"bg-header px-2 py-1.5 rounded-md flex justify-center items-center space-x-2 text-white",children:[(0,H.jsx)(c.OiG,{}),(0,H.jsx)("span",{className:"text-[12px]",children:"Add Purchase Expense"})]})})]})]})}),(0,H.jsx)("div",{className:"bg-[#ffffff] w-full overflow-x-auto mt-1 rounded-xl",children:B&&(0,H.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto ",children:[(0,H.jsx)("thead",{className:"",children:(0,H.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] bg-header capitalize text-[#ffff] font-[500] h-[40px]",children:[(0,H.jsx)("th",{className:"tableHead w-[10%]",children:"S.No."}),(0,H.jsx)("th",{className:"tableHead w-[10%]",children:"Date Of Entry"}),(0,H.jsx)("th",{className:"tableHead",children:"Bill Date"}),(0,H.jsx)("th",{className:"tableHead",children:"Vendor Name"}),(0,H.jsx)("th",{className:"tableHead w-[10%]",children:"Type of Asset/Expense"}),(0,H.jsx)("th",{className:"tableHead text-right",children:"Amount"}),(0,H.jsx)("th",{className:"tableHead text-right",children:"GST Amount"}),(0,H.jsx)("th",{className:"tableHead text-right",children:"Gross Amount"}),(0,H.jsx)("th",{className:"tableHead",children:"Status"}),(M||G)&&(0,H.jsx)("th",{className:"tableHead w-[10%]",children:"Action"})]})}),X?(0,H.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,H.jsx)("td",{colSpan:10,className:"px-6 py-2 whitespace-nowrap font-[600] text-sm text-gray-500",children:(0,H.jsx)(y.A,{})})}):(0,H.jsx)("tbody",{children:J&&(null===J||void 0===J?void 0:J.length)>0?null===J||void 0===J?void 0:J.map((e,t)=>{var a;return(0,H.jsxs)("tr",{className:"text-black ".concat(t%2===0?"bg-[#e9ecef]/80":"bg-white"," border-b-[1px] border-[#DDDDDD]"),children:[(0,H.jsx)("td",{className:"tableData",children:t+1+(ie-1)*oe}),(0,H.jsx)("td",{className:"tableData",children:null!==e&&void 0!==e&&e.createdAt?(0,x.Tk)(null===e||void 0===e?void 0:e.createdAt):"-"}),(0,H.jsx)("td",{className:"tableData",children:null===(a=v()(null===e||void 0===e?void 0:e.purchaseDate))||void 0===a?void 0:a.format("DD-MM-YYYY")}),(0,H.jsx)("td",{className:"tableData",children:(0,H.jsx)(b.A,{placement:"topLeft",title:"Vendor Name - ".concat(null===e||void 0===e?void 0:e.vendorName),children:null!==e&&void 0!==e&&e.vendorName?"".concat(null===e||void 0===e?void 0:e.vendorName):"".concat((null===e||void 0===e?void 0:e.vendorOtherName)||"-"," ")})}),(0,H.jsx)("td",{className:"tableData",children:"Other"!==(null===e||void 0===e?void 0:e.purchaseType)?null===e||void 0===e?void 0:e.assetName:null===e||void 0===e?void 0:e.expenseHeadName}),(0,H.jsx)("td",{className:"tableData text-right",children:(0,x.w2)(null!==e&&void 0!==e&&e.totalAmount?null===e||void 0===e?void 0:e.totalAmount:"-")}),(0,H.jsx)("td",{className:"tableData text-right",children:(0,x.w2)(null!==e&&void 0!==e&&e.totalGSTAmount?null===e||void 0===e?void 0:e.totalGSTAmount:"-")}),(0,H.jsx)("td",{className:"tableData text-right",children:(0,x.w2)(null!==e&&void 0!==e&&e.grandTotal?null===e||void 0===e?void 0:e.grandTotal:"-")}),(0,H.jsx)("td",{className:"tableData",children:(0,H.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat("Approved"===(null===e||void 0===e?void 0:e.status)?"bg-cyan-100 border border-cyan-600 text-cyan-800":"Reject"===(null===e||void 0===e?void 0:e.status)||"Rejected"===(null===e||void 0===e?void 0:e.status)?"bg-rose-100 border border-rose-600 text-rose-800":"Paid"===(null===e||void 0===e?void 0:e.status)?"bg-green-100 border border-green-600 text-green-800":"bg-yellow-100 border border-yellow-600 text-yellow-800"),children:null===e||void 0===e?void 0:e.status})}),(M||G)&&(0,H.jsx)("td",{className:"tableData",children:(0,H.jsxs)("span",{className:"py-1.5 flex justify-start items-center space-x-2.5",children:[(0,H.jsx)(b.A,{placement:"topLeft",title:"View Details",children:(0,H.jsx)("button",{onClick:()=>{(e=>{V((0,u.Wv)({_id:null===e||void 0===e?void 0:e._id})),W(!0)})(e)},className:"px-2 py-2 text-xs rounded-md bg-transparent text-header border border-muted",type:"button",children:(0,H.jsx)(A.Ny1,{className:" hover:text-[#337ab7] text-[#3c8dbc]"})})}),(0,H.jsx)(j.A,{menu:{items:[{key:"created-at",label:(0,H.jsxs)("span",{onClick:()=>(0,x.v2)(C()(null===e||void 0===e?void 0:e.createdAt).format("DD-MM-YYYY hh:mm a")||"Data not available"),className:"flex items-center text-teal-800 hover:text-teal-700",children:[(0,H.jsx)(L.Wv9,{className:"mr-2",size:16}),"Created At"]})},{key:"created-by",label:(0,H.jsxs)("span",{onClick:()=>(0,x.v2)((null===e||void 0===e?void 0:e.createdBy)||"Data not available"),className:"flex items-center text-sky-800 hover:text-sky-700",children:[(0,H.jsx)(z.cCX,{className:"mr-2",size:16}),"Created By"]})},G&&{key:"edit",label:(0,H.jsxs)("span",{onClick:()=>{"Pending"===(null===e||void 0===e?void 0:e.status)&&U("/admin/purchase-expence/edit/".concat((0,o.w)(null===e||void 0===e?void 0:e._id)))},className:"flex items-center ".concat("Pending"===(null===e||void 0===e?void 0:e.status)?"text-[#3c8dbc] hover:text-[#337ab7]":"text-gray-400 cursor-not-allowed"),children:[(0,H.jsx)(c.Jcp,{className:"mr-2",size:16}),"Pending"===(null===e||void 0===e?void 0:e.status)?"Edit":"No Actions (".concat(null===e||void 0===e?void 0:e.status,")")]}),disabled:"Pending"!==(null===e||void 0===e?void 0:e.status)},M&&{key:"delete",label:(0,H.jsxs)("span",{className:"flex items-center ".concat("Pending"===(null===e||void 0===e?void 0:e.status)?"text-rose-500 hover:text-rose-600":"text-gray-400 cursor-not-allowed"),children:[(0,H.jsx)(E.kgr,{className:"mr-2",size:16}),"Pending"===(null===e||void 0===e?void 0:e.status)?"delete":"No Actions (".concat(null===e||void 0===e?void 0:e.status,")")]}),disabled:"Pending"!==(null===e||void 0===e?void 0:e.status),onClick:()=>{"Pending"===(null===e||void 0===e?void 0:e.status)&&(e=>{let t={_id:e};_().fire({title:"Warning",text:"Are you sure you want to delete!",icon:"warning",showCancelButton:!0,cancelButtonText:"No"}).then(e=>{e.isConfirmed&&V((0,u.Rb)(t)).then(e=>{je()})})})(null===e||void 0===e?void 0:e._id)}}].filter(Boolean)},trigger:["click"],children:(0,H.jsx)(b.A,{placement:"topLeft",title:"More Actions",children:(0,H.jsx)("button",{className:"px-2 py-1.5 text-xs rounded-md bg-transparent border border-muted ",type:"button",children:(0,H.jsx)(S.xWf,{className:"text-[#3c8dbc] hover:text-[#337ab7]",size:16})})})})]})})]})}):(0,H.jsx)("tr",{className:"bg-white bg-opacity-5",children:(0,H.jsx)("td",{colSpan:5,className:"px-6 py-2 whitespace-nowrap font-[600] text-sm text-gray-500",children:"Record Not Found"})})})]})}),(null===J||void 0===J?void 0:J.length)>0&&(0,H.jsx)(r.A,{totalCount:Q,pageSize:oe,currentPage:ie,onChange:e=>ce(e)}),(0,H.jsx)(N.A,{className:"antmodalclassName",title:"Attached Docs\tFor ".concat(null===$||void 0===$||null===(e=$.data)||void 0===e||null===(t=e.vendorData)||void 0===t?void 0:t.fullName),width:1e3,footer:!1,open:$.isOpen,onOk:()=>K({open:!1,data:{}}),onCancel:()=>K({open:!1,data:{}}),children:(0,H.jsxs)("table",{className:"w-full max-w-full rounded-xl",children:[(0,H.jsx)("thead",{}),(0,H.jsx)("tbody",{children:(0,H.jsx)("tr",{children:(0,H.jsx)("td",{className:"tableData",children:(0,H.jsx)("div",{className:"flex flex-col space-y-4",children:null!==$&&void 0!==$&&null!==(a=$.data)&&void 0!==a&&a.attachment&&Array.isArray(null===$||void 0===$||null===(p=$.data)||void 0===p?void 0:p.attachment)?$.data.attachment.map((e,t)=>{const a="".concat("https://vigapi.vigorousit.com","/public/").concat(e);return ge(e)?(0,H.jsxs)("div",{className:"flex items-center gap-2",children:[(0,H.jsxs)("p",{className:"font-[500] text-[12px] text-black",children:["(",t+1,")"]}),(0,H.jsx)(T.A,{src:a,alt:"Uploaded ".concat(t+1)})]},t):Ne(e)?(0,H.jsx)(b.A,{placement:"topLeft",title:"PDF Attachment ".concat(t+1),children:(0,H.jsxs)("div",{className:"flex items-center gap-2",children:[(0,H.jsxs)("p",{className:"font-[500] text-[12px] text-black",children:["(",t+1,")"]}),(0,H.jsx)("button",{onClick:()=>window.open(a,"_blank"),className:"px-2 py-1.5 text-xs rounded-md bg-transparent border border-muted hover:border-gray-800",type:"button",children:(0,H.jsx)(A.kl1,{className:"text-red-600 hover:text-red-700",size:26})})]})},t):null}):null!==$&&void 0!==$&&null!==(k=$.data)&&void 0!==k&&k.attachment?(()=>{const e=$.data.attachment,t="".concat("https://vigapi.vigorousit.com","/public/").concat(e);return ge(e)?(0,H.jsx)(T.A,{src:t,alt:"Uploaded Image"}):Ne(e)?(0,H.jsx)(b.A,{placement:"topLeft",title:"PDF Attachment",children:(0,H.jsx)("button",{onClick:()=>window.open(t,"_blank"),className:"px-2 py-1.5 text-xs rounded-md bg-transparent border border-muted hover:border-gray-800",type:"button",children:(0,H.jsx)(A.kl1,{className:"text-red-600 hover:text-red-700",size:26})})}):null})():(0,H.jsx)("span",{className:"text-gray-600 text-sm text-center",children:"No File Attached"})})})})})]})}),(0,H.jsx)(N.A,{className:"antmodalclassName",visible:F,onCancel:()=>W(!1),footer:null,title:!1,width:1200,height:600,children:(0,H.jsx)("div",{className:"w-full overflow-auto",children:(0,H.jsxs)("table",{className:"w-full  rounded-lg shadow-md overflow-hidden bg-white",children:[(0,H.jsx)("thead",{children:(0,H.jsx)("tr",{children:(0,H.jsx)("th",{className:"text-header ",children:(0,H.jsx)("div",{className:"mt-2 ml-2",children:"Purchase Expanse Details"})})})}),(0,H.jsxs)("tbody",{className:"text-sm text-gray-700",children:[(0,H.jsxs)("tr",{className:" hover:bg-indigo-50",children:[(0,H.jsxs)("td",{className:"p-3 text-gray-600",children:[(0,H.jsxs)("div",{className:"flex items-center gap-2",children:[(0,H.jsx)(w.sLb,{className:"size-4 text-header text-lg"}),(0,H.jsx)("span",{className:"text-[16px] font-medium",children:"PurchaseType"})]}),(0,H.jsx)("span",{className:"block text-[15px] ml-4 font-light mt-1",children:(null===q||void 0===q?void 0:q.purchaseType)||"N/A"})]}),(0,H.jsxs)("td",{className:"p-3 text-gray-600",children:[(0,H.jsxs)("div",{className:"flex items-center gap-2",children:[(0,H.jsx)(w.sLb,{className:"size-4 text-header text-lg"}),(0,H.jsx)("span",{className:"text-[16px] font-medium",children:"Expence Head"})]}),(0,H.jsx)("span",{className:"block text-[15px] ml-4 font-light mt-1",children:(null===q||void 0===q||null===(O=q.expenseHeadData)||void 0===O?void 0:O.name)||"N/A"})]})]}),(0,H.jsxs)("tr",{className:" hover:bg-indigo-50",children:[(0,H.jsxs)("td",{className:"p-3  text-gray-600",children:[(0,H.jsxs)("div",{className:"flex items-center gap-2",children:[(0,H.jsx)(D.cC2,{className:"size-4 text-header text-lg"}),(0,H.jsx)("span",{className:"text-[16px] font-medium",children:"purchaseDate"})]}),(0,H.jsx)("span",{className:"block text-[15px] ml-4 font-light mt-1",children:C()(null===q||void 0===q?void 0:q.date).format("DD-MM-YYYY")||"N/A"})]}),(0,H.jsxs)("td",{className:"p-3 text-gray-600",children:[(0,H.jsxs)("div",{className:"flex items-center gap-2",children:[(0,H.jsx)(w.sLb,{className:"size-4 text-header text-lg"}),(0,H.jsx)("span",{className:"text-[16px] font-medium",children:"vendor Name"})]}),(0,H.jsx)("span",{className:"block text-[15px] ml-4 font-light mt-1",children:(null===q||void 0===q||null===(Y=q.vendorData)||void 0===Y?void 0:Y.fullName)||"N/A"})]})]}),(0,H.jsxs)("tr",{className:" hover:bg-indigo-50",children:[(0,H.jsxs)("td",{className:"p-3  text-gray-600",children:[(0,H.jsxs)("div",{className:"flex items-center gap-2",children:[(0,H.jsx)(c._tP,{className:"size-4 text-header text-lg"}),(0,H.jsx)("span",{className:"text-[16px] font-medium",children:"Total Amount"})]}),(0,H.jsxs)("span",{className:"block text-[15px] ml-4 font-light mt-1",children:[(null===q||void 0===q?void 0:q.totalAmount)||"N/A"," Rs"]})]}),(0,H.jsxs)("td",{className:"p-3  text-gray-600",children:[(0,H.jsxs)("div",{className:"flex items-center gap-2",children:[(0,H.jsx)(A.CLz,{className:"size-4 text-header text-lg"}),(0,H.jsx)("span",{className:"text-[16px] font-medium",children:"Gst Amount"})]}),(0,H.jsxs)("span",{className:"block text-[15px] ml-4 font-light mt-1",children:[(null===q||void 0===q?void 0:q.totalGSTAmount)||"N/A"," Rs"]})]})]}),(0,H.jsxs)("tr",{className:" hover:bg-indigo-50",children:[(0,H.jsxs)("td",{className:"p-3  text-gray-600",children:[(0,H.jsxs)("div",{className:"flex items-center gap-2",children:[(0,H.jsx)(A.Y9o,{className:"size-4 text-header text-lg"}),(0,H.jsx)("span",{className:"text-[16px] font-medium",children:"Grand Total Amount"})]}),(0,H.jsxs)("span",{className:"block text-[15px] ml-4 font-light mt-1",children:[(null===q||void 0===q?void 0:q.grandTotal)||"N/A"," Rs"]})]}),(0,H.jsxs)("td",{className:"p-3  text-gray-600",children:[(0,H.jsxs)("div",{className:"flex items-center gap-2",children:[(0,H.jsx)(D.MH0,{className:"size-4 text-header text-lg"}),(0,H.jsx)("span",{className:"text-[16px] font-medium",children:"Status"})]}),(0,H.jsx)("span",{className:"block text-[15px] ml-4 font-light mt-1",children:(null===q||void 0===q?void 0:q.status)||"N/A"})]})]}),(0,H.jsx)("tr",{className:" hover:bg-indigo-50",children:(0,H.jsx)("td",{className:"p-3  text-gray-600",children:(0,H.jsx)("div",{className:"flex flex-col justify-start items-start gap-2",children:(0,H.jsxs)("span",{onClick:()=>{var e;return(null===q||void 0===q||null===(e=q.attachment)||void 0===e?void 0:e.length)>0&&K({isOpen:!0,data:q,purchaseExpence:{}})},className:"flex items-center ".concat((null===q||void 0===q||null===(I=q.attachment)||void 0===I?void 0:I.length)>0?"text-rose-700 hover:text-rose-700":"text-gray-400 cursor-not-allowed"),children:[(0,H.jsx)(A.kQE,{className:"mr-2",size:16}),"View Document"]})})})})]})]})})})]})})}}}]);
//# sourceMappingURL=2888.ddc2c077.chunk.js.map