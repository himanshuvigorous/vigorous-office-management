"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[6770],{26770:(e,a,n)=>{n.r(a),n.d(a,{default:()=>C});var s=n(89379),t=n(73216),l=n(83002),r=n(83003),o=n(65043),d=(n(30064),n(24858)),i=n(66015),c=n(78729),m=n(15187),u=n(39160),p=n(23156),h=(n(31174),n(78227)),x=n(735),v=n(13382),j=n(53913),b=n(96651),N=(n(4938),n(55971)),y=n(86178),f=n.n(y),g=(n(33007),n(31744)),w=(n(42837),n(58215)),D=n(94084),T=n(60446),I=n.n(T),A=n(27810),Y=(n(88967),n(31536)),k=(n(17995),n(89427)),H=n(70579);const C=function(){const{control:e,handleSubmit:a,setValue:n,formState:{errors:y},reset:T,register:C,watch:S}=(0,d.mN)({shouldUnregister:!0}),{userCompanyId:V,userDirectorId:M,userBranchId:E,userEmployeId:F,userDepartmentId:q,userDesignationId:P,userType:O}=(0,x.A)(),{visitorList:B,totalVisitorCount:_,visitorGeneralList:L,loading:Q}=(0,r.d4)(e=>e.visitor),{departmentListData:z}=(0,r.d4)(e=>e.department),{branchList:R}=(0,r.d4)(e=>e.branch),G=JSON.parse(localStorage.getItem("user_info_".concat(m.AU))),{employeList:J}=(0,r.d4)(e=>e.employe),K=((0,t.Zp)(),(0,r.wA)()),[U,Z]=(0,o.useState)(""),W=(0,d.FH)({control:e,name:"PDCompanyId",defaultValue:V}),X=(0,d.FH)({control:e,name:"PDBranchId",defaultValue:E}),$=(0,d.FH)({control:e,name:"PdDepartmentId",defaultValue:""}),ee=(0,d.FH)({control:e,name:"employee",defaultValue:""}),ae=(0,d.FH)({control:e,name:"startTime",defaultValue:null}),ne=(0,d.FH)({control:e,name:"endTime",defaultValue:null}),se=(0,d.FH)({control:e,name:"km",defaultValue:0}),te=(0,d.FH)({control:e,name:"category",defaultValue:""}),le=(0,d.FH)({control:e,name:"expencehead",defaultValue:""}),re=(0,d.FH)({control:e,name:"amount",defaultValue:""}),oe=(0,d.FH)({control:e,name:"naration",defaultValue:""}),de=(0,d.FH)({control:e,name:"date",defaultValue:""}),[ie,ce]=(0,o.useState)(!1);(0,o.useEffect)(()=>{"admin"===O&&K((0,c.Ar)({text:"",sort:!0,status:!0,isPagination:!1}))},[]);const[me,ue]=(0,o.useState)(1);(0,o.useEffect)(()=>{pe()},[me,X,ee,$,te,U]);const pe=()=>{const e={page:me,limit:10,reqPayload:{companyId:W,branchId:X,directorId:"",employeId:F,category:te,departmentId:"",text:U,sort:!0,status:"",isPagination:!0}};K((0,w.Jc)(e))},{expenseTypeList:he}=(0,r.d4)(e=>e.expenceHead),xe=(0,d.FH)({control:e,name:"PDCompanyId",defaultValue:""}),ve=(0,d.FH)({control:e,name:"PDBranchId",defaultValue:""}),{loading:je}=(0,r.d4)(e=>e.cashbook),[be,Ne]=(0,o.useState)(!1),[ye,fe]=(0,o.useState)({attachment:[]});(0,o.useEffect)(()=>{(xe||"company"===(null===G||void 0===G?void 0:G.userType)||"companyDirector"===(null===G||void 0===G?void 0:G.userType))&&K((0,g.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===G||void 0===G?void 0:G.userType)?xe:"company"===(null===G||void 0===G?void 0:G.userType)?null===G||void 0===G?void 0:G._id:null===G||void 0===G?void 0:G.companyId}))},[xe]),(0,o.useEffect)(()=>{"admin"===(null===G||void 0===G?void 0:G.userType)&&K((0,c.Ar)({text:"",sort:!0,status:!0,isPagination:!1}))},[]),(0,o.useEffect)(()=>{n("totalAmount",Number(S("amount"))+Number(S("gstAmount")))},[S("amount"),S("gstAmount")]);const[ge,we]=(0,o.useState)({}),[De,Te]=(0,o.useState)(!1);return"employee"!==(null===G||void 0===G?void 0:G.userType)?(0,H.jsx)(u.A,{children:(0,H.jsx)("div",{className:"bg-red-100 text-red-800 p-4 rounded-md mt-2",children:(0,H.jsx)("p",{className:"text-center font-semibold",children:"You are not an employee. This page is viewable for employees only."})})}):(0,H.jsxs)(u.A,{onChange:e=>{Z(e)},children:[(0,H.jsx)("div",{className:"",children:(0,H.jsxs)("div",{class:"xl:flex justify-between items-center py-1 xl:space-y-0 space-y-2 overflow-y-auto",children:[(0,H.jsx)("div",{className:"grid sm:grid-cols-2 grid-cols-1 xl:grid-cols-4 lg:grid-cols-4 md:grid-cols-3 sm:gap-3 gap-1"}),(0,H.jsx)("div",{className:"flex justify-end items-center gap-2 "})]})}),(0,H.jsxs)("div",{className:"bg-[#ffffff]  w-full overflow-x-auto mt-1 rounded-xl",children:[(0,H.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto ",children:[(0,H.jsx)("thead",{className:"",children:(0,H.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] capitalize text-[12px] bg-header text-white font-[500] h-[40px]",children:[(0,H.jsx)("th",{className:"border-none p-2 whitespace-nowrap w-[8%]",children:"S.no."}),(0,H.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Visitor Name"}),(0,H.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Category type"}),(0,H.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Mobile Number"}),(0,H.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Employees"}),(0,H.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Reason"}),(0,H.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Start Time"}),(0,H.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"End Time"}),(0,H.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Check In Time"}),(0,H.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Check Out Time"}),(0,H.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Created By"}),(0,H.jsx)("th",{className:"border-none p-2 whitespace-nowrap w-[8%]",children:"Action"})]})}),Q?(0,H.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,H.jsx)("td",{colSpan:10,className:"px-6 py-2 whitespace-nowrap font-[600] text-sm text-gray-500",children:(0,H.jsx)(N.A,{})})}):(0,H.jsx)("tbody",{children:L&&(null===L||void 0===L?void 0:L.length)>0?null===L||void 0===L?void 0:L.map((e,a)=>{var n,s,t,r,o,d;return(0,H.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] ".concat(a%2===0?"bg-[#e9ecef]/80":"bg-white"," text-[#374151] text-[14px]"),children:[(0,H.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:a+1+10*(me-1)}),(0,H.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==(n=null===e||void 0===e?void 0:e.name)&&void 0!==n?n:"-"}),(0,H.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==(s=null===e||void 0===e?void 0:e.category)&&void 0!==s?s:"-"}),(0,H.jsx)("td",{className:"whitespace-nowrap border-none p-2",children:(null===e||void 0===e||null===(t=e.mobile)||void 0===t?void 0:t.code)+" "+(null===e||void 0===e||null===(r=e.mobile)||void 0===r?void 0:r.number)||"-"}),(0,H.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:(0,H.jsx)("div",{className:"  flex items-center justify-center",children:null===e||void 0===e||null===(o=e.employeData)||void 0===o?void 0:o.map((e,a)=>(0,H.jsx)(b.A,{placement:"topLeft",title:null===e||void 0===e?void 0:e.fullName,children:(0,H.jsx)("img",{alt:"",src:"".concat("https://vigapi.vigorousit.com","/public/").concat(e.profileImage),className:"w-10 h-10 ".concat(a>0?" -ml-2":"0"," rounded-full bg-gray-500 flex items-center justify-center")},a)}),[])})}),(0,H.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==(d=null===e||void 0===e?void 0:e.reason)&&void 0!==d?d:"-"}),(0,H.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==e&&void 0!==e&&e.timeDurationStart?f()(null===e||void 0===e?void 0:e.timeDurationStart).format("DD-MM-YYYY hh:mm a"):"-"}),(0,H.jsxs)("td",{className:"whitespace-nowrap border-none p-2 ",children:[null!==e&&void 0!==e&&e.timeDurationEnd?f()(null===e||void 0===e?void 0:e.timeDurationEnd).format("DD-MM-YYYY hh:mm a"):"-"," "]}),(0,H.jsxs)("td",{className:"whitespace-nowrap border-none p-2 ",children:[null!==e&&void 0!==e&&e.checkInTime?f()(null===e||void 0===e?void 0:e.checkInTime).format("DD-MM-YYYY hh:mm a"):"-"," "]}),(0,H.jsxs)("td",{className:"whitespace-nowrap border-none p-2 ",children:[null!==e&&void 0!==e&&e.checkOutTime?f()(null===e||void 0===e?void 0:e.checkOutTime).format("DD-MM-YYYY hh:mm a"):"-"," "]}),(0,H.jsx)("td",{className:"whitespace-nowrap border-none px-2 py-3",children:(null===e||void 0===e?void 0:e.createdBy)||"-"}),(0,H.jsxs)("td",{className:"whitespace-nowrap gap-2 flex  border-none p-2",children:[(0,H.jsx)("button",{onClick:()=>(we(e),void Te(!0)),className:"px-2 py-1.5 rounded-md bg-transparent border border-muted",type:"button",children:(0,H.jsx)(p.CMH,{className:"text-green-600 hover:text-green-500",size:16})}),(0,H.jsx)("button",{onClick:()=>{ce(!0)},className:"px-2 py-1.5 rounded-md bg-transparent border border-muted",type:"button",children:(0,H.jsx)(l.rLx,{className:"text-green-600 hover:text-green-500",size:16})})]})]})}):(0,H.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,H.jsx)("td",{colSpan:4,className:"px-6 py-2 whitespace-nowrap font-[600] text-sm text-gray-500",children:"Record Not Found"})})})]}),(0,H.jsx)(j.A,{className:"antmodalclassName",title:"Visitor Request",width:600,height:400,open:De,onCancel:()=>{n("startTime",null),n("endTime",null),n("km",0),Te(!1),T()},footer:[],children:(0,H.jsxs)("div",{children:[(0,H.jsxs)("div",{className:"grid grid-col-1  gap-4",children:[(0,H.jsxs)("div",{className:"",children:[(0,H.jsxs)("label",{className:"".concat(m.Q0),children:["Check IN Time ",(0,H.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,H.jsx)(d.xI,{name:"startTime",control:e,showTime:!0,rules:{required:"Check IN Time  is required"},format:"DD/MM/YYYY HH:mm",render:e=>{let{field:a}=e;return(0,H.jsx)(D.A,{field:a,showTime:!0,format:"DD/MM/YYYY HH:mm",errors:y,disabledDate:e=>e&&e.isBefore(I()().endOf("day"),"day")})}}),y.startTime&&(0,H.jsx)("p",{className:"text-red-500 text-sm",children:y.startTime.message})]}),(0,H.jsxs)("div",{className:"",children:[(0,H.jsxs)("label",{className:"".concat(m.Q0),children:["Check out Time ",(0,H.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,H.jsx)(d.xI,{name:"endTime",control:e,showTime:!0,rules:{required:"Check out Time  is required"},format:"DD/MM/YYYY HH:mm",render:e=>{let{field:a}=e;return(0,H.jsx)(D.A,{field:a,showTime:!0,format:"DD/MM/YYYY HH:mm",errors:y,disabledDate:e=>e&&e.isBefore(I()().endOf("day"),"day")})}}),y.endTime&&(0,H.jsx)("p",{className:"text-red-500 text-sm",children:y.endTime.message})]}),(0,H.jsxs)("div",{className:"",children:[(0,H.jsxs)("label",{className:"".concat(m.Q0),children:["Km ",(0,H.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,H.jsx)("input",(0,s.A)((0,s.A)({type:"number"},C("km",{required:"km is required"})),{},{className:"placeholder: ".concat(m.Ol," ").concat(y.km?"border-[1px] ":"border-gray-300"),placeholder:"Enter Km"})),y.km&&(0,H.jsx)("p",{className:"text-red-500 text-sm",children:y.km.message})]}),(0,H.jsx)("div",{className:"flex justify-end items-center m-2",children:(0,H.jsx)(v.Ay,{type:"primary",onClick:()=>{(()=>{const e=(0,s.A)((0,s.A)({},ge),{},{checkInTime:ae,checkOutTime:ne,kilometer:Number(se)});K((0,w.o2)(e)).then(e=>{e.error||pe(),n("startTime",null),n("endTime",null),n("date",null),Te(!1)})})()},children:"Check In"},"checkin")})]}),(0,H.jsx)("div",{className:"flex justify-end space-x-2 mt-4"})]})}),(0,H.jsxs)(j.A,{className:"antmodalclassName",title:"Visitor Request",width:600,height:400,open:ie,onCancel:()=>{ce(!1),n("amount",0),n("naration",""),n("expencehead",{value:"",label:""}),n("date",null),T()},footer:null,children:[(0,H.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 md:gap-4 gap-2 md:my-1 px-3 md:mt-4",children:[(0,H.jsxs)("div",{className:"w-full",children:[(0,H.jsx)("label",{className:"".concat(m.Q0),children:"Expence Head"}),(0,H.jsx)(d.xI,{name:"expencehead",control:e,rules:{required:"Expence Head is required"},render:e=>{let{field:a}=e;return(0,H.jsx)(i.Ay,(0,s.A)((0,s.A)({onFocus:()=>{const e={directorId:"",companyId:"admin"===(null===G||void 0===G?void 0:G.userType)?xe:"company"===(null===G||void 0===G?void 0:G.userType)?null===G||void 0===G?void 0:G._id:null===G||void 0===G?void 0:G.companyId,branchId:"company"===(null===G||void 0===G?void 0:G.userType)||"admin"===(null===G||void 0===G?void 0:G.userType)||"companyDirector"===(null===G||void 0===G?void 0:G.userType)?ve:"companyBranch"===(null===G||void 0===G?void 0:G.userType)?null===G||void 0===G?void 0:G._id:null===G||void 0===G?void 0:G.branchId,text:"",sort:!0,status:"",isPagination:!0};K((0,Y.dV)(e))}},a),{},{options:null===he||void 0===he?void 0:he.map(e=>({value:null===e||void 0===e?void 0:e._id,label:null===e||void 0===e?void 0:e.name})),classNamePrefix:"react-select",className:"".concat(m.Ph," ").concat(y.expencehead?"border-[1px] ":"border-gray-300"),placeholder:"Select Expence Head"}))}}),y.expencehead&&(0,H.jsx)("p",{className:"text-red-500 text-sm",children:y.expencehead.message})]}),(0,H.jsxs)("div",{className:"",children:[(0,H.jsxs)("label",{className:"".concat(m.Q0),children:["Amount ",(0,H.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,H.jsx)("input",(0,s.A)((0,s.A)({type:"number"},C("amount",{required:"Amount is required"})),{},{className:" ".concat(m.Ol," ").concat(y.amount?"border-[1px] ":"border-gray-300"),placeholder:"Enter Amount"})),y.amount&&(0,H.jsx)("p",{className:"text-red-500 text-sm",children:y.amount.message})]}),(0,H.jsxs)("div",{className:"",children:[(0,H.jsxs)("label",{className:"".concat(m.Q0),children:["Naration ",(0,H.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,H.jsx)("textarea",(0,s.A)((0,s.A)({},C("naration",{required:"Naration is required"})),{},{className:" ".concat(m.Ol," ").concat(y.naration?"border-[1px] ":"border-gray-300"),placeholder:"Enter Naration"})),y.naration&&(0,H.jsx)("p",{className:"text-red-500 text-sm",children:y.naration.message})]}),(0,H.jsxs)("div",{children:[(0,H.jsx)("label",{className:"".concat(m.Q0),children:"Bill Date"}),(0,H.jsx)(d.xI,{name:"date",control:e,render:e=>{let{field:a}=e;return(0,H.jsx)(D.A,{field:a,errors:y})}}),y.date&&(0,H.jsx)("p",{className:"text-red-500 text-sm",children:"Date is required"})]})]}),(0,H.jsx)("div",{className:"flex justify-end",children:(0,H.jsx)("button",{type:"button",disabled:je,className:"".concat(je?"bg-gray-400":"bg-header"," text-white p-2 px-4 rounded"),onClick:()=>{(()=>{const e={companyId:null===G||void 0===G?void 0:G.companyId,directorId:null===G||void 0===G?void 0:G.directorId,branchId:null===G||void 0===G?void 0:G.branchId,employeId:"employee"===(null===G||void 0===G?void 0:G.userType)?null===G||void 0===G?void 0:G._id:null,expenseTypeId:null===le||void 0===le?void 0:le.value,expenseFor:"Employe",amount:+re,naration:oe,GSTamount:0,date:de,status:"Pending"};K((0,A.pn)(e)).then(e=>{pe(),ce(!1),n("amount",0),n("naration",null),n("expencehead",{value:"",label:""}),n("date",null)})})()},children:je?(0,H.jsx)(k.A,{}):"Submit"})})]})]}),(null===B||void 0===B?void 0:B.length)>0&&(0,H.jsx)(h.A,{totalCount:_,pageSize:10,currentPage:me,onChange:e=>{ue(e)}})]})}}}]);
//# sourceMappingURL=6770.627d6daa.chunk.js.map