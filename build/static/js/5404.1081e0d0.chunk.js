"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[5404],{5404:(e,a,t)=>{t.r(a),t.d(a,{default:()=>g});var d=t(89379),n=t(24858),o=t(39160),s=t(83003),l=t(73216),i=t(65043),r=t(15187),c=(t(31744),t(78729),t(66015)),m=t(42837),u=t(31536),v=t(88967),x=t(27810),p=t(31174),h=t(94084),f=(t(86178),t(60446)),b=t.n(f),y=t(17995),j=t(60184),N=t(70579);const g=()=>{var e;const{loading:a}=(0,s.d4)(e=>e.cashbook),{register:t,handleSubmit:f,control:g,watch:A,reset:I,formState:{errors:S},setValue:_}=(0,n.mN)(),k=(0,s.wA)(),O=(0,l.Zp)(),{companyList:E}=(0,s.d4)(e=>e.company),{branchList:q}=(0,s.d4)(e=>e.branch),{employeList:w}=(JSON.parse(localStorage.getItem("user_info_".concat(r.AU))),(0,s.d4)(e=>e.employe)),{expenseTypeList:D}=(0,s.d4)(e=>e.expenceHead),{cashbookDetails:T}=((0,n.FH)({control:g,name:"PDCompanyId",defaultValue:""}),(0,n.FH)({control:g,name:"PDBranchId",defaultValue:""}),(0,s.d4)(e=>e.cashbook)),[C,F]=(0,i.useState)(!1),[H,P]=(0,i.useState)({attachments:[]}),{cashbookIdEnc:Q}=(0,l.g)(),V=(0,p.Yc)(Q);return(0,i.useEffect)(()=>{k((0,x.ho)({_id:V}))},[]),(0,i.useEffect)(()=>{if(T){_("expenseFor",null===T||void 0===T?void 0:T.expenseFor),_("amount",null===T||void 0===T?void 0:T.amount),_("naration",null===T||void 0===T?void 0:T.naration),_("gstAmount",null===T||void 0===T?void 0:T.GSTamount),_("totalAmount",null===T||void 0===T?void 0:T.totalAmount),_("date",b()(null===T||void 0===T?void 0:T.date)),P({attachments:null===T||void 0===T?void 0:T.attachment});const e={text:"",status:!0,sort:!0,isTL:"",isHR:"",isPagination:!1,departmentId:"",designationId:"",companyId:null===T||void 0===T?void 0:T.companyId,branchId:null===T||void 0===T?void 0:T.branchId};k((0,m.qV)(e)).then(e=>{if(!e.error){var a,t,d;const n=null===e||void 0===e||null===(a=e.payload)||void 0===a||null===(t=a.data)||void 0===t||null===(d=t.docs)||void 0===d?void 0:d.find(e=>(null===T||void 0===T?void 0:T.employeId)===e._id);_("employee",{value:n._id,label:n.fullName})}}),k((0,u.dV)({directorId:"",companyId:null===T||void 0===T?void 0:T.companyId,branchId:null===T||void 0===T?void 0:T.branchId,text:"",sort:!0,status:"",isPagination:!1})).then(e=>{if(!e.error){var a,t,d;const n=null===e||void 0===e||null===(a=e.payload)||void 0===a||null===(t=a.data)||void 0===t||null===(d=t.docs)||void 0===d?void 0:d.find(e=>(null===T||void 0===T?void 0:T.expenseTypeId)===e._id),o={value:null===n||void 0===n?void 0:n._id,label:null===n||void 0===n?void 0:n.name};_("expencehead",o)}})}},[T]),(0,i.useEffect)(()=>{_("totalAmount",Number(A("amount"))+Number(A("gstAmount")))},[A("amount"),A("gstAmount")]),(0,N.jsx)(o.A,{children:(0,N.jsx)("div",{className:"gap-4",children:(0,N.jsxs)("form",{autoComplete:"off",className:"mt-2 md:px-1",onSubmit:f(e=>{var a;const t={_id:V,companyId:null===T||void 0===T?void 0:T.companyId,directorId:null===T||void 0===T?void 0:T.directorId,branchId:null===T||void 0===T?void 0:T.branchId,employeId:null===T||void 0===T?void 0:T.employeId,expenseTypeId:null===e||void 0===e||null===(a=e.expencehead)||void 0===a?void 0:a.value,expenseFor:null===e||void 0===e?void 0:e.expenseFor,amount:+(null===e||void 0===e?void 0:e.amount),naration:null===e||void 0===e?void 0:e.naration,GSTamount:0,totalAmount:+(null===e||void 0===e?void 0:e.amount),date:null===e||void 0===e?void 0:e.date,attachment:null===H||void 0===H?void 0:H.attachments};k((0,x.Yk)(t)).then(e=>{e.error||O(-1)})}),children:[(0,N.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-1 md:gap-8 md:my-1 px-3 md:mt-4",children:[(0,N.jsxs)("div",{className:"w-full",children:[(0,N.jsx)("label",{className:"".concat(r.Q0),children:"Expence Head"}),(0,N.jsx)(n.xI,{name:"expencehead",control:g,rules:{required:"Expence Head is required"},render:e=>{let{field:a}=e;return(0,N.jsx)(c.Ay,(0,d.A)((0,d.A)({},a),{},{options:null===D||void 0===D?void 0:D.map(e=>({value:null===e||void 0===e?void 0:e._id,label:null===e||void 0===e?void 0:e.name})),classNamePrefix:"react-select",className:"".concat(r.Ph," ").concat(S.expencehead?"border-[1px] ":"border-gray-300"),placeholder:"Select Expence Head"}))}}),S.expencehead&&(0,N.jsx)("p",{className:"text-red-500 text-sm",children:S.expencehead.message})]}),(0,N.jsxs)("div",{className:"",children:[(0,N.jsxs)("label",{className:"".concat(r.Q0),children:["Amount",(0,N.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,N.jsx)("input",(0,d.A)((0,d.A)({type:"number",step:"0.01"},t("amount",{required:"Amount is required"})),{},{className:" ".concat(r.Ol," ").concat(S.amount?"border-[1px] ":"border-gray-300"),placeholder:"Enter Amount"})),S.amount&&(0,N.jsx)("p",{className:"text-red-500 text-sm",children:S.amount.message})]}),(0,N.jsxs)("div",{className:"",children:[(0,N.jsxs)("label",{className:"".concat(r.Q0),children:["Naration",(0,N.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,N.jsx)("textarea",(0,d.A)((0,d.A)({},t("naration",{required:"Naration is required"})),{},{className:" ".concat(r.Ol," ").concat(S.naration?"border-[1px] ":"border-gray-300"),placeholder:"Enter Naration"})),S.naration&&(0,N.jsx)("p",{className:"text-red-500 text-sm",children:S.naration.message})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"".concat(r.Q0),children:"Date"}),(0,N.jsx)(n.xI,{name:"date",control:g,render:e=>{let{field:a}=e;return(0,N.jsx)(h.A,{field:a,errors:S,disabledDate:e=>{if(!e)return!0;const a=b()().startOf("day"),t=e.startOf("day");if(a.date()<=5){const e=a.subtract(1,"month"),d=e.endOf("month").startOf("day"),n=e.date(d.date()-4).startOf("day"),o=(t.isAfter(n)||t.isSame(n))&&(t.isBefore(d)||t.isSame(d)),s=a.startOf("month"),l=(t.isAfter(s)||t.isSame(s))&&(t.isBefore(a)||t.isSame(a));return!(o||l)}{const e=a.startOf("month");return!((t.isAfter(e)||t.isSame(e))&&(t.isBefore(a)||t.isSame(a)))}}})}}),S.date&&(0,N.jsx)("p",{className:"text-red-500 text-sm",children:"Date is required"})]}),(0,N.jsxs)("div",{className:"",children:[(0,N.jsx)("label",{className:"".concat(r.Q0),children:"Documents"}),C?(0,N.jsx)("div",{className:"space-y-2"}):(0,N.jsxs)("div",{className:"space-y-4",children:[(0,N.jsx)("input",{type:"file",onChange:e=>{const a={filePath:e.target.files[0],isVideo:!1,isMultiple:!1};k((0,v.Sg)(a)).then(e=>{var a;null!==e&&void 0!==e&&null!==(a=e.payload)&&void 0!==a&&a.data&&P(a=>{var t;return(0,d.A)((0,d.A)({},a),{},{attachments:[...(null===a||void 0===a?void 0:a.attachments)||[],null===e||void 0===e||null===(t=e.payload)||void 0===t?void 0:t.data]})})})},className:"hidden",id:"file-upload"}),(0,N.jsxs)("label",{htmlFor:"file-upload",className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-600 bg-white cursor-pointer",children:[(0,N.jsx)(j.chT,{className:"mr-2"})," Add Documents"]}),(0,N.jsx)("div",{className:"space-y-2",children:null===H||void 0===H||null===(e=H.attachments)||void 0===e?void 0:e.map((e,a)=>(0,N.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-md",children:[(0,N.jsxs)("a",{href:"".concat("https://vigapi.vigorousit.com","/public/").concat(e),className:"flex items-center space-x-2",target:"_blank",rel:"noopener noreferrer",children:[(0,N.jsx)(j.chT,{className:"text-gray-500"}),(0,N.jsx)("span",{className:"text-sm text-gray-600",children:e})]}),(0,N.jsx)("button",{type:"button",onClick:()=>(e=>{P(a=>{const t=null===a||void 0===a?void 0:a.attachments.filter((a,t)=>t!==e);return(0,d.A)((0,d.A)({},a),{},{attachments:t})})})(a),className:"text-red-500 hover:text-red-700",children:(0,N.jsx)(j.QCr,{})})]},a))})]})]})]}),(0,N.jsx)("div",{className:"flex justify-end",children:(0,N.jsx)("button",{type:"submit",disabled:a,className:"".concat(a?"bg-gray-400":"bg-header"," text-white p-2 px-4 rounded"),children:a?(0,N.jsx)(y.A,{}):"Submit"})})]})})})}}}]);
//# sourceMappingURL=5404.1081e0d0.chunk.js.map