"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[8339],{65337:(e,t,a)=>{a.d(t,{A:()=>l});var s=a(91686),n=a(70579);const l=function(){return(0,n.jsx)("div",{className:"flex justify-center items-center h-[80vh]",children:(0,n.jsx)(s.A,{size:"large"})})}},98339:(e,t,a)=>{a.r(t),a.d(t,{default:()=>P});var s=a(89379),n=a(65043),l=a(39160),r=a(73216),i=a(83003),c=a(23156),d=a(47196),o=a(30064),p=a.n(o),m=a(31174),x=(a(65337),a(46817)),h=a(78227),u=a(15187),j=a(24858),v=a(31744),f=a(78729),b=a(78973),w=a(65512),g=a(96651),y=a(735),N=a(4938),A=a(55971),C=a(60446),D=a.n(C),S=a(89427),I=a(70579);const P=function(){const{register:e,control:t,setValue:a,formState:{errors:o}}=(0,j.mN)(),{userCompanyId:C,userBranchId:P,userType:k}=(0,y.A)(),B=(0,r.Zp)(),L=(0,i.wA)(),{commonEmailData:_,totalcommonEmailCount:O,loading:E}=(0,i.d4)(e=>e.emailTemplate),[T,F]=(0,n.useState)(""),z=JSON.parse(localStorage.getItem("user_info_".concat(u.AU))),[q,J]=(0,n.useState)(1),{companyList:V}=(0,i.d4)(e=>e.company),{branchList:H,loading:Y}=(0,i.d4)(e=>e.branch),M=(0,j.FH)({control:t,name:"PDCompanyId",defaultValue:C}),R=(0,j.FH)({control:t,name:"PDBranchId",defaultValue:P}),U=(0,j.FH)({control:t,name:"status",defaultValue:""}),G=[R,M,U,T].join("-"),[W,Z]=(0,n.useState)(!1);(0,n.useEffect)(()=>{W?1===q?K():J(1):Z(e=>!0)},[G]),(0,n.useEffect)(()=>{K()},[q]);const K=()=>{const e={currentPage:q,pageSize:10,reqData:{directorId:"",companyId:M||"",branchId:R||"",text:T,sort:!0,status:"true"===U||"false"!==U&&"",isPagination:!0}};L((0,x.Sj)(e))};(0,n.useEffect)(()=>{(M||"company"===k||"companyDirector"===k)&&L((0,v.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:M}))},[M]),(0,n.useEffect)(()=>{"admin"===k&&L((0,f.Ar)({text:"",sort:!0,status:!0,isPagination:!1}))},[]);const[Q,X]=(0,n.useState)(!1),[$,ee]=(0,n.useState)(null),{canCreate:te,canRead:ae,canUpdate:se,canDelete:ne}=(0,N.A)(),le=()=>{X(!1),ee(null)};return(0,I.jsx)(l.A,{onChange:e=>{F(e)},children:(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("div",{className:"",children:(0,I.jsxs)("div",{className:"sm:flex justify-between items-center md:space-y-0 space-y-2 py-1",children:[(0,I.jsxs)("div",{className:"grid sm:grid-cols-2 grid-cols-1 lg:grid-cols-3 sm:gap-3 gap-1.5",children:["admin"===(null===z||void 0===z?void 0:z.userType)&&(0,I.jsxs)("div",{className:"",children:[(0,I.jsxs)("select",(0,s.A)((0,s.A)({},e("PDCompanyId",{required:"company is required"})),{},{className:" ".concat(u.OJ," ").concat(o.PDCompanyId?"border-[1px] ":"border-gray-300"),showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,I.jsx)("option",{className:"",value:"",children:"Select Comapany"}),null===V||void 0===V?void 0:V.map(e=>(0,I.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName}))]})),o.PDCompanyId&&(0,I.jsx)("p",{className:"text-red-500 text-sm",children:o.PDCompanyId.message})]}),("admin"===k||"company"===k||"companyDirector"===k)&&(0,I.jsxs)("div",{className:"",children:[(0,I.jsx)(j.xI,{name:"PDBranchId",control:t,rules:{required:"Branch is required"},render:e=>{var t;let{field:a}=e;return(0,I.jsxs)(w.A,(0,s.A)((0,s.A)({},a),{},{className:"w-full ".concat(u.Lp," ").concat(o.PDBranchId?"border-[1px] ":"border-gray-300"),showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),placeholder:"Select Branch",children:[(0,I.jsx)(w.A.Option,{value:"",children:"Select Branch"}),Y?(0,I.jsx)(w.A.Option,{disabled:!0,children:(0,I.jsx)(S.A,{})}):null===(t=(0,u._o)(H))||void 0===t?void 0:t.map(e=>(0,I.jsx)(w.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),o.PDBranchId&&(0,I.jsx)("p",{className:"text-red-500 text-sm",children:o.PDBranchId.message})]}),(0,I.jsx)("div",{className:"",children:(0,I.jsx)(j.xI,{name:"status",control:t,rules:{},render:e=>{let{field:t}=e;return(0,I.jsxs)(w.A,(0,s.A)((0,s.A)({},t),{},{className:" w-32 ".concat(u.Lp," ").concat(o.status?"border-[1px] ":"border-gray-300"),placeholder:"Select Status",showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,I.jsx)(w.A.Option,{value:"",children:"Select Status"}),(0,I.jsx)(w.A.Option,{value:"true",children:" Active "}),(0,I.jsx)(w.A.Option,{value:"false",children:" InActive "})]}))}})})]}),(0,I.jsxs)("div",{className:"flex justify-end items-center gap-2 ",children:[(0,I.jsx)("button",{onClick:()=>{a("status",""),a("PDBranchId",""),a("PdDepartmentId",""),a("PdCompanyId","")},className:"bg-header py-[6px] rounded-md flex px-5 justify-center items-center text-white",children:(0,I.jsx)("span",{className:"text-[12px]",children:"Reset"})}),te&&(0,I.jsx)(g.A,{placement:"topLeft",title:"Email Template",children:(0,I.jsxs)("button",{onClick:()=>{B("/admin/email-template/create")},className:"bg-header px-2 py-1.5 rounded-md flex justify-center items-center space-x-2 text-white",children:[(0,I.jsx)(c.OiG,{}),(0,I.jsx)("span",{className:"text-[12px]",children:"Add Email Template"})]})})]})]})}),(0,I.jsxs)("div",{className:"w-full",children:[(0,I.jsx)("div",{className:"bg-[#ffffff] w-full overflow-x-auto mt-1 rounded-xl",children:ae&&(0,I.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto",children:[(0,I.jsx)("thead",{children:(0,I.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] bg-header capitalize text-[12px] text-[#ffff] font-[500] h-[40px]",children:[(0,I.jsx)("th",{className:"p-2 whitespace-nowrap w-[10%]",children:"S.No."}),(0,I.jsx)("th",{className:"p-2 whitespace-nowrap",children:"Template Title"}),(0,I.jsx)("th",{className:"p-2 whitespace-nowrap",children:"create At"}),(0,I.jsx)("th",{className:"p-2 whitespace-nowrap",children:"created By"}),(0,I.jsx)("th",{className:"p-2 whitespace-nowrap",children:"Status"}),(ae||ne||se)&&(0,I.jsx)("th",{className:"p-2 whitespace-nowrap w-[10%]",children:"Action"})]})}),E?(0,I.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,I.jsx)("td",{colSpan:10,className:"px-6 py-2 whitespace-nowrap font-[600] text-sm text-gray-500",children:(0,I.jsx)(A.A,{})})}):(0,I.jsx)("tbody",{children:_&&(null===_||void 0===_?void 0:_.length)>0?null===_||void 0===_?void 0:_.map((e,t)=>(0,I.jsx)(n.Fragment,{children:(0,I.jsxs)("tr",{className:"text-black ".concat(t%2===0?"bg-[#e9ecef]/80":"bg-white"," text-[14px] border-b-[1px] border-[#DDDDDD]"),children:[(0,I.jsx)("td",{className:"whitespace-nowrap p-2",children:t+1+10*(q-1)}),(0,I.jsx)("td",{className:"whitespace-nowrap p-2",children:null===e||void 0===e?void 0:e.title}),(0,I.jsx)("td",{className:"whitespace-nowrap p-2",children:D()(null===e||void 0===e?void 0:e.createdAt).format("DD-MM-YYYY hh:mm a")}),(0,I.jsx)("td",{className:"whitespace-nowrap p-2",children:null===e||void 0===e?void 0:e.createdBy}),(0,I.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:(0,I.jsx)("span",{className:"".concat(null!==e&&void 0!==e&&e.status?"bg-[#E0FFBE] border-green-500":"bg-red-200 border-red-500"," border-[1px] px-2 py-1.5 rounded-lg text-black text-[12px]"),children:null!==e&&void 0!==e&&e.status?"Active":"Inactive"})}),(se||ae||ne)&&(0,I.jsx)("td",{className:"whitespace-nowrap p-2",children:(0,I.jsxs)("span",{className:"py-1.5 flex justify-start items-center space-x-2.5",children:[se&&(0,I.jsx)(g.A,{placement:"topLeft",title:"Edit",children:(0,I.jsx)("button",{onClick:()=>{B("/admin/email-template/edit/".concat((0,m.w)(null===e||void 0===e?void 0:e._id)))},className:"px-2 py-1.5 text-xs rounded-md bg-transparent border border-muted",type:"button",children:(0,I.jsx)(c.Jcp,{className:"hover:text-[#337ab7] text-[#3c8dbc]",size:16})})}),ae&&(0,I.jsx)(g.A,{placement:"topLeft",title:"View Details",children:(0,I.jsx)("button",{onClick:()=>(ee(e),void X(!0)),className:"px-2 py-1.5 rounded-md bg-transparent border border-muted",type:"button",children:(0,I.jsx)(b.JvI,{className:"text-cyan-600 hover:text-cyan-500",size:16})})}),ne&&(0,I.jsx)(g.A,{placement:"topLeft",title:"Delete",children:(0,I.jsx)("button",{onClick:()=>(e=>{let t={_id:e};p().fire({title:"Warning",text:"Are you sure you want to delete!",icon:"warning",showCancelButton:!0,cancelButtonText:"No"}).then(e=>{e.isConfirmed&&L((0,x.Jy)(t)).then(e=>{q>1&&1==(null===_||void 0===_?void 0:_.length)?J(Number(q-1)):K()})})})(null===e||void 0===e?void 0:e._id),className:"px-2 py-1.5 rounded-md bg-transparent border border-muted",type:"button",children:(0,I.jsx)(d.tqC,{className:"text-red-600 hover:text-red-500",size:16})})})]})})]})},e._id)):(0,I.jsx)("tr",{className:"bg-white bg-opacity-5",children:(0,I.jsx)("td",{colSpan:6,className:"px-6 py-2 whitespace-nowrap text-center font-[600] text-sm text-gray-500",children:"Record Not Found"})})})]})}),(null===_||void 0===_?void 0:_.length)>0&&(0,I.jsx)(h.A,{totalCount:O,pageSize:10,currentPage:q,onChange:e=>{J(e)}})]}),Q&&$&&(0,I.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[1501]",onClick:le,children:(0,I.jsxs)("div",{className:"animate-slideInFromTop bg-white rounded-lg px-6 pt-6 pb-3 w-[800px] max-h-[70vh] overflow-y-hidden",onClick:e=>e.stopPropagation(),children:[(0,I.jsx)("div",{className:"mt-4",children:(0,I.jsx)("div",{dangerouslySetInnerHTML:{__html:null===$||void 0===$?void 0:$.content}})}),(0,I.jsx)("div",{className:"mt-4 flex justify-end",children:(0,I.jsx)("button",{onClick:le,className:"px-4 py-2 text-white bg-header rounded-md",children:"Close"})})]})})]})})}}}]);
//# sourceMappingURL=8339.b6f3ae52.chunk.js.map