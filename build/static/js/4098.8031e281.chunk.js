"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[4098],{44098:(e,l,a)=>{a.r(l),a.d(l,{default:()=>w});var d=a(89379),s=a(24858),n=a(83003),t=a(73216),o=a(65043),i=a(31174),r=a(15187),c=a(65337),u=a(39160),m=(a(53219),a(42837)),v=a(51957),h=a(65512),x=(a(30575),a(36105),a(84480),a(70337)),p=(a(86178),a(56659)),g=a(60446),N=a.n(g),I=a(84448),j=a(735),b=a(89427),y=a(33007),f=a(58215),D=a(94084),A=a(78729),P=a(31744),C=a(70579);const w=function(){const{loading:e}=(0,n.d4)(e=>e.visitor),[l,a]=(0,o.useState)(""),{companyList:g,companyListLoading:w}=(0,n.d4)(e=>e.company),{branchList:S,branchListloading:q}=(0,n.d4)(e=>e.branch),{userCompanyId:L,userDirectorId:M,userBranchId:T,userEmployeId:_,userDepartmentId:O,userDesignationId:H,userType:V}=(0,j.A)(),{register:E,handleSubmit:Y,setValue:F,control:Q,formState:{errors:k}}=(0,s.mN)(),[B,U]=(0,o.useState)(!0),z=(0,n.wA)(),R=(0,t.Zp)(),{visitorIdEnc:J}=(0,t.g)(),K=(0,i.Yc)(J),{generalVisitorDetails:Z}=(0,n.d4)(e=>e.visitor),{departmentListData:$,loading:G}=(0,n.d4)(e=>e.department),{employeList:W,loading:X}=(0,n.d4)(e=>e.employe),{countryListData:ee}=(0,n.d4)(e=>e.country),{stateListData:le}=(0,n.d4)(e=>e.states),{cityListData:ae}=(0,n.d4)(e=>e.city),{clientList:de}=(0,n.d4)(e=>e.client),{VisitReasonList:se,loading:ne}=(0,n.d4)(e=>e.visitReason),te=((0,s.FH)({control:Q,name:"PDAddress",defaultValue:""}),(0,s.FH)({control:Q,name:"PDDepartmentId",defaultValue:[]})),oe=((0,s.FH)({control:Q,name:"PDCity",defaultValue:""}),(0,s.FH)({control:Q,name:"PDDepartmentId",defaultValue:""}),(0,s.FH)({control:Q,name:"PDState",defaultValue:""}),(0,s.FH)({control:Q,name:"PDCountry",defaultValue:""}),(0,s.FH)({control:Q,name:"PDPinCode",defaultValue:""})),ie=(0,s.FH)({control:Q,name:"category",defaultValue:""});(0,o.useEffect)(()=>{oe&&oe.length>=4&&oe.length<=6&&/^\d{6}$/.test(oe)&&(0,r.jh)(oe).then(e=>{e&&(F("PDCity",e.city),F("PDState",e.state),F("PDCountry",e.country))}).catch(e=>{console.error("Error fetching data:",e)})},[oe]),(0,o.useEffect)(()=>{(async()=>{const e={text:"",sort:!0,status:"",isPagination:!1,companyId:re};z((0,P.d0)(e));try{const e={_id:K};await z((0,f.p_)(e)).then(e=>{U(!1)})}catch(l){console.error("Error fetching data:",l)}})()},[]),(0,o.useEffect)(()=>{Z&&(z((0,y.UU)({text:"",sort:!0,status:!0,isPagination:!1,companyId:null===Z||void 0===Z?void 0:Z.companyId,branchId:null===Z||void 0===Z?void 0:Z.branchId})).then(e=>{null!==e&&void 0!==e&&e.error||(F("PDDepartmentId",null===Z||void 0===Z?void 0:Z.departmentId),z((0,m.qV)({directorId:"",companyId:null===Z||void 0===Z?void 0:Z.companyId,branchId:null===Z||void 0===Z?void 0:Z.branchId,departmentId:null===Z||void 0===Z?void 0:Z.departmentId,text:"",sort:!0,status:"",isPagination:!1})).then(e=>{var l,a,d,s;e.error||(F("designationName",null===Z||void 0===Z?void 0:Z.name),F("companyId",null===Z||void 0===Z?void 0:Z.companyId),F("branchId",null===Z||void 0===Z?void 0:Z.branchId),F("contactPersonId",null===Z||void 0===Z?void 0:Z.contactPersonId),F("employeId",null===Z||void 0===Z?void 0:Z.employeId),z((0,I.Ih)({companyId:null===Z||void 0===Z?void 0:Z.companyId,directorId:"",branchId:null===Z||void 0===Z?void 0:Z.branchId,text:"",sort:!0,status:!0,isPagination:!1})).then(e=>{null!==e&&void 0!==e&&e.error||F("reason",null===Z||void 0===Z?void 0:Z.reason)}),F("visitorName",null===Z||void 0===Z?void 0:Z.name),F("numberOfPerson",null===Z||void 0===Z?void 0:Z.numberOfPerson),F("status",null===Z||void 0===Z?void 0:Z.status),F("PDPinCode",null===Z||void 0===Z||null===(l=Z.address)||void 0===l?void 0:l.pinCode),F("PDMobileCode",null===Z||void 0===Z||null===(a=Z.mobile)||void 0===a?void 0:a.code),F("PDMobileNo",null===Z||void 0===Z||null===(d=Z.mobile)||void 0===d?void 0:d.number),F("PDAddress",null===Z||void 0===Z||null===(s=Z.address)||void 0===s?void 0:s.street),F("category",null===Z||void 0===Z?void 0:Z.category),F("kilometer",null===Z||void 0===Z?void 0:Z.kilometer),F("PDDepartmentId",(null===Z||void 0===Z?void 0:Z.departmentIds)||[]),F("contactPersonId",null===Z||void 0===Z?void 0:Z.employeIds),F("date",N()(null===Z||void 0===Z?void 0:Z.date)),F("startTime",N()(null===Z||void 0===Z?void 0:Z.timeDurationStart)),F("endTime",N()(null===Z||void 0===Z?void 0:Z.timeDurationEnd)))}))}),z((0,x.Aq)({text:"",sort:!0,status:!0,isPagination:!1,companyId:null===Z||void 0===Z?void 0:Z.companyId,branchId:null===Z||void 0===Z?void 0:Z.branchId})).then(e=>{F("clientId",null===Z||void 0===Z?void 0:Z.clientId)}))},[Z]);const re=(0,s.FH)({control:Q,name:"companyId",defaultValue:L}),ce=(0,s.FH)({control:Q,name:"branchId",defaultValue:""}),[ue,me]=(JSON.parse(localStorage.getItem("user_info_".concat(r.AU))),(0,o.useState)([])),[ve,he]=(0,o.useState)([]),[xe,pe]=(0,o.useState)([]),[ge,Ne]=(0,o.useState)(!1),[Ie,je]=(0,o.useState)(!1),be=null===ue||void 0===ue?void 0:ue.map(e=>e.value),ye=null===ve||void 0===ve?void 0:ve.map(e=>e.value),fe="__all__",De="__all__",Ae=[{label:"Select All",value:fe},...ue],Pe=[{label:"Select All",value:De},...Array.isArray(ve)?ve:[]];(0,o.useEffect)(()=>{z((0,y.UU)({text:"",sort:!0,status:!0,isPagination:!1,companyId:re,branchId:ce})).then(e=>{var l,a,d;const s=null===e||void 0===e||null===(l=e.payload)||void 0===l||null===(a=l.data)||void 0===a||null===(d=a.docs)||void 0===d?void 0:d.map(e=>{var l;return{label:null===e||void 0===e?void 0:e.name,value:null===e||void 0===e?void 0:e._id,searchText:null===e||void 0===e||null===(l=e.name)||void 0===l?void 0:l.toLowerCase()}});me(s)});const e={directorId:"",companyId:re,branchId:ce,departmentId:l,text:"",sort:!0,status:"",isPagination:!1,multipleDepartmentId:te};z((0,m.qV)(e)).then(e=>{var l,a,d;const s=null===e||void 0===e||null===(l=e.payload)||void 0===l||null===(a=l.data)||void 0===a||null===(d=a.docs)||void 0===d?void 0:d.map(e=>{var l;return{label:null===e||void 0===e?void 0:e.fullName,value:null===e||void 0===e?void 0:e._id,searchText:null===e||void 0===e||null===(l=e.fullName)||void 0===l?void 0:l.toLowerCase()}});he(s)})},[]);const Ce=()=>{z((0,y.UU)({text:"",sort:!0,status:!0,isPagination:!1,companyId:re,branchId:ce})).then(e=>{var l,a,d;const s=null===e||void 0===e||null===(l=e.payload)||void 0===l||null===(a=l.data)||void 0===a||null===(d=a.docs)||void 0===d?void 0:d.map(e=>{var l;return{label:null===e||void 0===e?void 0:e.name,value:null===e||void 0===e?void 0:e._id,searchText:null===e||void 0===e||null===(l=e.name)||void 0===l?void 0:l.toLowerCase()}});me(s)})},we=()=>{const e={directorId:"",companyId:re,branchId:ce,departmentId:l,text:"",sort:!0,status:"",isPagination:!1,multipleDepartmentId:te};z((0,m.qV)(e)).then(e=>{var l,a,d;const s=null===e||void 0===e||null===(l=e.payload)||void 0===l||null===(a=l.data)||void 0===a||null===(d=a.docs)||void 0===d?void 0:d.map(e=>{var l;return{label:null===e||void 0===e?void 0:e.fullName,value:null===e||void 0===e?void 0:e._id,searchText:null===e||void 0===e||null===(l=e.fullName)||void 0===l?void 0:l.toLowerCase()}});he(s)})};return(0,C.jsx)(u.A,{children:(0,C.jsx)("div",{className:"gap-4",children:(0,C.jsxs)("form",{autoComplete:"off",className:"mt-5",onSubmit:Y(e=>{var l,a,d;const s={_id:K,companyId:null===Z||void 0===Z?void 0:Z.companyId,directorId:"",branchId:null===Z||void 0===Z?void 0:Z.branchId,departmentIds:null===e||void 0===e?void 0:e.PDDepartmentId,name:null===e||void 0===e?void 0:e.visitorName,employeIds:null===e||void 0===e?void 0:e.contactPersonId,reason:null===e||void 0===e?void 0:e.reason,numberOfPerson:Number(null===e||void 0===e?void 0:e.numberOfPerson),clientId:null===e||void 0===e?void 0:e.clientId,employeId:null===e||void 0===e?void 0:e.employeId,category:"general",timeDurationStart:null===e||void 0===e?void 0:e.startTime,timeDurationEnd:null===e||void 0===e?void 0:e.endTime,date:null===e||void 0===e?void 0:e.date,address:{street:null!==(l=null===e||void 0===e?void 0:e.PDAddress)&&void 0!==l?l:""},mobile:{number:null!==(a=null===e||void 0===e?void 0:e.PDMobileNo)&&void 0!==a?a:"",code:null!==(d=null===e||void 0===e?void 0:e.PDMobileCode)&&void 0!==d?d:""}};z((0,f.o2)(s)).then(e=>{e.error||R(-1)})}),children:[(0,C.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 md:my-2",children:["admin"===V&&(0,C.jsxs)("div",{className:"w-full",children:[(0,C.jsxs)("label",{className:"".concat(r.Q0),children:["Company ",(0,C.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,C.jsx)(s.xI,{control:Q,name:"companyId",rules:{required:"Company is required"},render:e=>{let{field:l}=e;return(0,C.jsxs)(h.A,(0,d.A)((0,d.A)({},l),{},{defaultValue:"",className:" ".concat(r.Hy," ").concat(k.companyId?"border-[1px] ":"border-gray-300"),showSearch:!0,filterOption:(e,l)=>String(null===l||void 0===l?void 0:l.children).toLowerCase().includes(e.toLowerCase()),onFocus:()=>{z((0,A.Ar)({text:"",sort:!0,status:"",isPagination:!1}))},children:[(0,C.jsx)(h.A.Option,{value:"",children:"Select Company"}),w?(0,C.jsx)(h.A.Option,{disabled:!0,children:(0,C.jsx)(b.A,{})}):null===g||void 0===g?void 0:g.map(e=>(0,C.jsx)(h.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),k.companyId&&(0,C.jsx)("p",{className:"text-red-500 text-sm",children:k.companyId.message})]}),("admin"===V||"company"===V||"companyDirector"===V)&&(0,C.jsxs)("div",{className:"w-full",children:[(0,C.jsxs)("label",{className:"".concat(r.Q0),children:["Branch ",(0,C.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,C.jsx)(s.xI,{control:Q,name:"branchId",rules:{required:"Branch is required"},render:e=>{let{field:l}=e;return(0,C.jsxs)(h.A,(0,d.A)((0,d.A)({},l),{},{defaultValue:"",className:" ".concat(r.Hy," "),showSearch:!0,filterOption:(e,l)=>String(null===l||void 0===l?void 0:l.children).toLowerCase().includes(e.toLowerCase()),onFocus:()=>{},children:[(0,C.jsx)(h.A.Option,{value:"",children:"Select Branch"}),q?(0,C.jsx)(h.A.Option,{disabled:!0,children:(0,C.jsx)(b.A,{})}):null===S||void 0===S?void 0:S.map(e=>(0,C.jsx)(h.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),k.branchId&&(0,C.jsx)("p",{className:"text-red-500 text-sm",children:k.branchId.message})]}),(0,C.jsxs)("div",{className:"w-full",children:[(0,C.jsxs)("label",{className:"".concat(r.Q0),children:["Name ",(0,C.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,C.jsx)("input",(0,d.A)((0,d.A)({type:"text"},E("visitorName",{required:"Name is required"})),{},{className:"placeholder: ".concat(r.Ol," ").concat(k.visitorName?"border-[1px] ":"border-gray-300"),placeholder:"Enter Name"})),k.visitorName&&(0,C.jsx)("p",{className:"text-red-500 text-sm",children:k.visitorName.message})]}),(0,C.jsxs)("div",{className:"w-full",children:[(0,C.jsxs)("label",{className:"".concat(r.Q0),children:["Department ",(0,C.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,C.jsx)(s.xI,{name:"PDDepartmentId",control:Q,rules:{required:"At least one Department is required"},render:e=>{let{field:l}=e;return(0,C.jsx)(h.A,{mode:"multiple",placeholder:"Assign To",value:l.value||[],onChange:e=>{e.includes(fe)?ge?(l.onChange([]),Ne(!1)):(l.onChange(be),Ne(!0)):(l.onChange(e),Ne(e.length===be.length))},onFocus:Ce,size:"large",style:{width:"100%"},options:Ae,showSearch:!0,filterOption:(e,l)=>String(null===l||void 0===l?void 0:l.children).toLowerCase().includes(e.toLowerCase())})}}),k.PDDepartmentId&&(0,C.jsx)("p",{className:"text-red-500 text-sm",children:k.PDDepartmentId.message})]}),(0,C.jsxs)("div",{className:"w-full",children:[(0,C.jsxs)("label",{className:"".concat(r.Q0),children:["Contact Person ",(0,C.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,C.jsx)(s.xI,{name:"contactPersonId",control:Q,rules:{required:"At least one Contact Person is required"},render:e=>{let{field:l}=e;return(0,C.jsx)(h.A,{mode:"multiple",placeholder:"Assign To",value:l.value||[],onChange:e=>{e.includes(De)?De?(l.onChange([]),je(!1)):(l.onChange(ye),je(!0)):(l.onChange(e),je(e.length===ye.length))},onFocus:we,size:"large",style:{width:"100%"},options:Pe||[],showSearch:!0,filterOption:(e,l)=>String(null===l||void 0===l?void 0:l.children).toLowerCase().includes(e.toLowerCase())})}}),k.contactPersonId&&(0,C.jsx)("p",{className:"text-red-500 text-sm",children:k.contactPersonId.message})]}),(0,C.jsxs)("div",{className:"",children:[(0,C.jsxs)("label",{className:"".concat(r.Q0),children:["Start Time ",(0,C.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,C.jsx)(s.xI,{name:"startTime",control:Q,showTime:!0,rules:{required:"Start Time  is required"},format:"DD/MM/YYYY HH:mm",render:e=>{let{field:l}=e;return(0,C.jsx)(D.A,{field:l,showTime:!0,format:"DD/MM/YYYY HH:mm",errors:k,disabledDate:e=>e&&e.isBefore(N()().endOf("day"),"day")})}}),k.startTime&&(0,C.jsx)("p",{className:"text-red-500 text-sm",children:k.startTime.message})]}),(0,C.jsxs)("div",{className:"",children:[(0,C.jsxs)("label",{className:"".concat(r.Q0),children:["End Time ",(0,C.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,C.jsx)(s.xI,{name:"endTime",control:Q,showTime:!0,rules:{required:"ENd Time  is required"},format:"DD/MM/YYYY HH:mm",render:e=>{let{field:l}=e;return(0,C.jsx)(D.A,{field:l,showTime:!0,format:"DD/MM/YYYY HH:mm",errors:k,disabledDate:e=>e&&e.isBefore(N()().endOf("day"),"day")})}}),k.endTime&&(0,C.jsx)("p",{className:"text-red-500 text-sm",children:k.endTime.message})]}),(0,C.jsxs)("div",{className:"",children:[(0,C.jsxs)("label",{className:"".concat(r.Q0),children:["Date ",(0,C.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,C.jsx)(s.xI,{name:"date",control:Q,rules:{required:"date  is required"},render:e=>{let{field:l}=e;return(0,C.jsx)(D.A,{field:l,errors:k,disabledDate:e=>e&&e.isBefore(N()().endOf("day"),"day")})}}),k.date&&(0,C.jsx)("p",{className:"text-red-500 text-sm",children:k.date.message})]}),(0,C.jsxs)("div",{className:"w-full",children:[(0,C.jsxs)("label",{className:"".concat(r.Q0),children:["Reason ",(0,C.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,C.jsx)(s.xI,{control:Q,name:"reason",rules:{required:"reason is required"},render:e=>{var l;let{field:a}=e;return(0,C.jsx)(v.A,(0,d.A)((0,d.A)({className:"w-full"},a),{},{onChange:e=>{a.onChange(e)},options:null===(l=(0,r._o)(se))||void 0===l?void 0:l.map(e=>({value:null===e||void 0===e?void 0:e.title})),notFoundContent:(0,C.jsx)(b.A,{}),children:(0,C.jsx)("input",{placeholder:"Enter Country",className:"".concat(r.Ol)})}))}}),k.reason&&(0,C.jsx)("p",{className:"text-red-500 text-sm",children:k.reason.message})]}),"employe"===ie&&(0,C.jsxs)("div",{className:"w-full",children:[(0,C.jsxs)("label",{className:"".concat(r.Q0),children:["KM ",(0,C.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,C.jsx)("input",(0,d.A)((0,d.A)({type:"number"},E("kilometer",{required:"Number kilometer is required"})),{},{className:"placeholder: ".concat(r.Ol," ").concat(k.kilometer?"border-[1px] ":"border-gray-300"),placeholder:"Enter Number kilometer"})),k.designationName&&(0,C.jsx)("p",{className:"text-red-500 text-sm",children:k.kilometer.message})]})]}),(0,C.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 md:gap-8 md:my-1 md:mt-4",children:(0,C.jsxs)("div",{className:"col-span-2",children:[(0,C.jsxs)("label",{className:"".concat(r.Q0),children:["Address"," ","general"!==ie&&(0,C.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,C.jsx)("input",(0,d.A)((0,d.A)({type:"text"},E("PDAddress",{required:"general"!==ie&&"Address is required"})),{},{className:"".concat(r.Ol," ").concat(k.PDAddress?"border-[1px] ":"border-gray-300"),placeholder:"Enter Address "})),k.PDAddress&&(0,C.jsx)("p",{className:"text-red-500 text-sm",children:k.PDAddress.message})]})}),(0,C.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 md:gap-8 gap-3 md:my-1 ",children:(0,C.jsxs)("div",{className:"flex gap-3",children:[(0,C.jsxs)("div",{className:"w-[150px]",children:[(0,C.jsxs)("label",{className:"".concat(r.Q0),children:["Code ",(0,C.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,C.jsx)(s.xI,{control:Q,name:"PDMobileCode",rules:{required:"code is required"},render:e=>{let{field:l}=e;return(0,C.jsx)(p.A,{field:l,errors:k})}}),k.PDMobileCode&&(0,C.jsx)("p",{className:"".concat(r.ci),children:k.PDMobileCode.message})]}),(0,C.jsxs)("div",{className:"w-full",children:[(0,C.jsxs)("label",{className:"".concat(r.Q0),children:["Mobile No ",(0,C.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,C.jsx)("input",(0,d.A)((0,d.A)({type:"number"},E("PDMobileNo",{required:"Mobile No is required",minLength:{value:10,message:"Must be exactly 10 digits"},maxLength:{value:10,message:"Must be exactly 10 digits"}})),{},{className:" ".concat(r.Ol," ").concat(k.PDMobileNo?"border-[1px] ":"border-gray-300"),placeholder:"Enter Mobile No",maxLength:10,onInput:e=>{e.target.value.length>10&&(e.target.value=e.target.value.slice(0,10))}})),k.PDMobileNo&&(0,C.jsx)("p",{className:"text-red-500 text-sm",children:k.PDMobileNo.message})]})]})}),(0,C.jsx)("div",{className:"flex justify-end ",children:(0,C.jsx)("button",{type:"submit",disabled:e,className:"".concat(e?"bg-gray-400":"bg-header"," text-white p-2 px-4 rounded mt-3"),children:e?(0,C.jsx)(c.A,{}):"Submit"})})]})})})}},65337:(e,l,a)=>{a.d(l,{A:()=>n});var d=a(91686),s=a(70579);const n=function(){return(0,s.jsx)("div",{className:"flex justify-center items-center h-[80vh]",children:(0,s.jsx)(d.A,{size:"large"})})}}}]);
//# sourceMappingURL=4098.8031e281.chunk.js.map