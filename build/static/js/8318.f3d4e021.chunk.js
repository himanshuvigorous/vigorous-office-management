"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[8318],{38318:(e,t,i)=>{i.r(t),i.d(t,{default:()=>j});var l=i(89379),a=i(24858),n=i(83003),o=i(15187),d=i(65043),r=i(31744),s=i(39160),c=i(97326),u=i(487),v=(i(86178),i(60446)),p=i.n(v),h=(i(78227),i(12106)),m=(i(42837),i(94084),i(69223)),x=i(55971),f=i(50822),y=i(6720),b=i(37762),w=i(64857),N=(i(11906),i(33007),i(89427),i(70337),i(40088),i(12208),i(27744),i(17995),i(76932),i(73216)),D=i(31174),g=i(70579);const j=function(){const{RangePicker:e}=u.A,{control:t,formState:{errors:i},setValue:v,watch:j}=(0,a.mN)(),{ledgerId:S}=(0,N.g)(),[k,C]=(0,d.useState)(10),F=(0,n.wA)(),{clientStatementReportList:P,clientStatementReportFunc_loading:Y,clientStatementCount:A}=(0,n.d4)(e=>e.reports),{departmentListData:R,loading:T}=(0,n.d4)(e=>e.department),E=(0,N.Zp)(),[I,L]=(0,d.useState)({}),{taskTypeList:_}=(0,n.d4)(e=>e.taskType),{clientGroupList:V}=(0,n.d4)(e=>e.clientGroup),{clientList:B}=(0,n.d4)(e=>e.client),{employeList:M}=(0,n.d4)(e=>e.employe),[O,z]=(0,d.useState)(""),H=JSON.parse(localStorage.getItem("user_info_".concat(o.AU))),{industryListData:K,indusSearchloading:G}=(0,n.d4)(e=>e.industry),{orgTypeList:U,orgSearchloading:W}=(0,n.d4)(e=>e.orgType),[J,Z]=(0,d.useState)(1),[q,Q]=(0,d.useState)(""),{branchList:X}=(0,n.d4)(e=>e.branch),$=(0,a.FH)({control:t,name:"PDCompanyId",defaultValue:""});(0,a.FH)({control:t,name:"PDBranchId",defaultValue:""}),(0,a.FH)({control:t,name:"status",defaultValue:""}),(0,a.FH)({control:t,name:"PDOrganizationType",defaultValue:""}),(0,a.FH)({control:t,name:"PDindustrytype",defaultValue:""}),(0,a.FH)({control:t,name:"department",defaultValue:""}),(0,a.FH)({control:t,name:"groupName",defaultValue:""}),(0,d.useEffect)(()=>{const e=setTimeout(()=>{Q(O)},500);return()=>{clearTimeout(e)}},[O]);const[ee,te]=(0,d.useState)(0),ie=e=>{var t,i,l,a;let n=[];return null===e||void 0===e||null===(t=e.allTransactions)||void 0===t||t.forEach((e,t)=>{const i={key:"",entryDate:null!==e&&void 0!==e&&e.createdAt?p()(null===e||void 0===e?void 0:e.createdAt).format("DD-MM-YYYY"):"-",valueDate:null!==e&&void 0!==e&&e.createdAt?p()(null===e||void 0===e?void 0:e.createdAt).format("DD-MM-YYYY"):"-",particulars:("invoice"==(null===e||void 0===e?void 0:e.type)?"invoice Generated":null===e||void 0===e?void 0:e.naration)||"-",refNo:("invoice"==(null===e||void 0===e?void 0:e.typeOf)?null===e||void 0===e?void 0:e.refNumber:"receipt"==(null===e||void 0===e?void 0:e.typeOf)?"Receipt ".concat(null===e||void 0===e?void 0:e.refNumber):"")||(null===e||void 0===e?void 0:e.refNumber),debit:"debit"==(null===e||void 0===e?void 0:e.debit_credit)?null===e||void 0===e?void 0:e.amount:0,credit:"credit"==(null===e||void 0===e?void 0:e.debit_credit)?null===e||void 0===e?void 0:e.amount:0,balance:(null===e||void 0===e?void 0:e.currentBalance)||0,typeOf:(null===e||void 0===e?void 0:e.typeOf)||"",_id:(null===e||void 0===e?void 0:e._id)||"",invoicePDFPath:"".concat("https://vigapi.vigorousit.com","/public/").concat(e.PDFPath)};n.push(i)}),null===n||void 0===n||n.push({key:"totalBalance",entryDate:"",valueDate:"",particulars:"Total Balance",refNo:"",debit:null===e||void 0===e||null===(i=e.summary)||void 0===i?void 0:i.totalDebit,credit:null===e||void 0===e||null===(l=e.summary)||void 0===l?void 0:l.totalCredit,balance:null===e||void 0===e||null===(a=e.summary)||void 0===a?void 0:a.closingBalance}),n};(0,d.useEffect)(()=>{te(ie(P))},[P]);const le=function(){return{_id:S,startDate:(null===ne||void 0===ne?void 0:ne.length)>0?p()(ne[0]).format("YYYY-MM-DD"):"",endDate:(null===ne||void 0===ne?void 0:ne.length)>0?p()(ne[1]).format("YYYY-MM-DD"):""}};(0,d.useEffect)(()=>{ae(q)},[J,q,k]);const ae=()=>{F((0,h.ph)(le(!0)))},ne=(0,a.FH)({control:t,name:"time",defaultValue:[]});(0,d.useEffect)(()=>{"company"!==(null===H||void 0===H?void 0:H.userType)&&"companyDirector"!==(null===H||void 0===H?void 0:H.userType)||F((0,r.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===H||void 0===H?void 0:H.userType)?$:"company"===(null===H||void 0===H?void 0:H.userType)?null===H||void 0===H?void 0:H._id:null===H||void 0===H?void 0:H.companyId})),v("startDate",""),v("endDate","")},[]);const oe=async()=>{ae()},de=[{key:"1",label:(0,g.jsx)("span",{className:"text-white",children:"Advance Filters"}),children:(0,g.jsxs)("div",{className:"bg-[#ececec]",children:[(0,g.jsx)("div",{className:"sm:flex  grid grid-cols-1  gap-2 sm:flex-wrap text-[14px]",children:(0,g.jsx)(a.xI,{name:"time",control:t,render:t=>{let{field:i}=t;return(0,g.jsx)(e,(0,l.A)((0,l.A)({},i),{},{value:i.value,onChange:e=>i.onChange(e),format:"YYYY-MM-DD",getPopupContainer:()=>document.body,popupClassName:"vertical-range-calendar",className:"custom-range-picker"}))}})}),(0,g.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,g.jsx)("button",{onClick:()=>{v("time",""),oe()},className:"bg-header py-2 my-0.5 rounded-md flex px-10 justify-center items-center text-white",children:(0,g.jsx)("span",{className:"text-[12px]",children:"Reset"})}),(0,g.jsx)("button",{onClick:()=>{oe()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,g.jsx)("span",{className:"text-[12px]",children:"Submit"})})]})]})}];return(0,g.jsx)(s.A,{onChange:e=>{z(e)},children:(0,g.jsxs)("div",{className:"bg-grey-100 w-full p-1",children:[(0,g.jsxs)("div",{className:"",children:[(0,g.jsx)(c.A,{className:"custom-collapse",items:de,defaultActiveKey:[],expandIcon:e=>{let{isActive:t}=e;return(0,g.jsx)(y.WnU,{size:20,style:{color:"white",transform:t?"rotate(-90deg)":"rotate(0deg)",transition:"transform 0.3s ease"}})}}),(0,g.jsx)("div",{className:"space-y-1.5 flex justify-end items-center",children:(0,g.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,g.jsx)("button",{onClick:()=>{(async()=>{var e;const t=new b.uE({orientation:"landscape",unit:"pt"});t.setFontSize(16),t.text("Client Statement Report",40,30);const i=await(null===f.K||void 0===f.K?void 0:f.K.clientStatementReportFunc(le(!1)));if(null===P||void 0===P||!P.allTransactions)return;const l=null===(e=ie(null===i||void 0===i?void 0:i.data))||void 0===e?void 0:e.map((e,t)=>[t+1,null===e||void 0===e?void 0:e.entryDate,null===e||void 0===e?void 0:e.valueDate,null===e||void 0===e?void 0:e.particulars,null===e||void 0===e?void 0:e.refNo,null!==e&&void 0!==e&&e.debit?Number(null===e||void 0===e?void 0:e.debit).toFixed(2):0,null!==e&&void 0!==e&&e.credit?Number(null===e||void 0===e?void 0:e.credit).toFixed(2):0,null===e||void 0===e?void 0:e.balance]);(0,w.Ay)(t,{startY:50,head:[["S.No.","Entry Date","Value Date","Particulars","Ref No.","Debit","Credit","Balance"]],body:l,margin:{horizontal:10},styles:{cellPadding:6,fontSize:9,valign:"middle",halign:"left"},headStyles:{fillColor:[211,211,211],textColor:[0,0,0],fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]}}),t.save("ClientLedgerStatement.pdf")})()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,g.jsx)("span",{className:"text-[12px]",children:"Export PDF"})}),(0,g.jsx)("button",{onClick:()=>{(async()=>{var e;const t=new m.Workbook,i=t.addWorksheet("Client Statement");i.columns=[{header:"S.No.",key:"sno",width:10},{header:"Entry Date",key:"entryDate",width:25},{header:"Value Date",key:"valueDate",width:25},{header:"Particulars",key:"particulars",width:30},{header:"Ref No.",key:"refNo",width:20},{header:"Debit",key:"debit",width:15},{header:"Credit",key:"credit",width:15},{header:"Balance",key:"balance",width:20}],i.getRow(1).eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFB6D7A8"}},e.font={bold:!0},e.alignment={vertical:"middle",horizontal:"center"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});const l=await(null===f.K||void 0===f.K?void 0:f.K.clientStatementReportFunc(le(!1)));if(null===P||void 0===P||!P.allTransactions)return;const a=null===(e=ie(null===l||void 0===l?void 0:l.data))||void 0===e?void 0:e.map((e,t)=>({sno:t+1,entryDate:null===e||void 0===e?void 0:e.entryDate,valueDate:null===e||void 0===e?void 0:e.valueDate,particulars:null===e||void 0===e?void 0:e.particulars,refNo:null===e||void 0===e?void 0:e.refNo,debit:null!==e&&void 0!==e&&e.debit?Number(null===e||void 0===e?void 0:e.debit).toFixed(2):0,credit:null!==e&&void 0!==e&&e.credit?Number(null===e||void 0===e?void 0:e.credit).toFixed(2):0,balance:null===e||void 0===e?void 0:e.balance}));null===a||void 0===a||a.forEach(e=>{i.addRow(e).eachCell(e=>{e.alignment={vertical:"middle",horizontal:"left"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),i.autoFilter={from:"A1",to:"G1"},t.xlsx.writeBuffer().then(e=>{const t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),i=document.createElement("a");i.href=URL.createObjectURL(t),i.download="ClientLedgerStatement.xlsx",i.click()})})()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,g.jsx)("span",{className:"text-[12px]",children:"Export Excel"})})]})})]}),(0,g.jsx)("div",{className:"bg-[#ffffff]  w-full overflow-x-auto mt-1 rounded-xl",children:(0,g.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto",children:[(0,g.jsx)("thead",{children:(0,g.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] capitalize text-[12px] bg-header text-white font-[500] h-[40px]",children:[(0,g.jsx)("th",{className:"border-none p-2 whitespace-nowrap  w-[5%]",children:"S.No."}),(0,g.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Entry Date"}),(0,g.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Value Date"}),(0,g.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"particulars"}),(0,g.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:" Ref no."}),(0,g.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Debit"}),(0,g.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Credit"}),(0,g.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Balance"})]})}),Y?(0,g.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,g.jsx)("td",{colSpan:15,className:"px-6 py-2 whitespace-nowrap  font-[600] text-sm text-gray-500",children:(0,g.jsx)(x.A,{})})}):(0,g.jsx)("tbody",{children:ee&&(null===ee||void 0===ee?void 0:ee.length)>0?null===ee||void 0===ee?void 0:ee.map((e,t)=>(0,g.jsxs)("tr",{className:"border-b-[1px] ".concat(t%2===0?"bg-[#e9ecef]/80":"bg-white"," border-[#DDDDDD] text-[#374151] text-[14px]"),children:[(0,g.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:t+1+(J-1)*k}),(0,g.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:null===e||void 0===e?void 0:e.entryDate}),(0,g.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:null===e||void 0===e?void 0:e.valueDate}),(0,g.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:"invoice"==(null===e||void 0===e?void 0:e.typeOf)?"Invoice Raised":null===e||void 0===e?void 0:e.particulars}),(0,g.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:(0,g.jsx)("div",{className:"text-blue-500 cursor-pointer underline",onClick:()=>{"invoice"===(null===e||void 0===e?void 0:e.typeOf)?E("/admin/viewInvoice?invoiceId=".concat((0,D.w)(null===e||void 0===e?void 0:e._id),"&type=invoice&downloadPdfPath=").concat(null!==e&&void 0!==e&&e.invoicePDFPath?(0,D.w)(null===e||void 0===e?void 0:e.invoicePDFPath):"")):"receipt"===(null===e||void 0===e?void 0:e.typeOf)&&E("/admin/viewInvoice?invoiceId=".concat((0,D.w)(null===e||void 0===e?void 0:e._id),"&type=receipt&downloadPdfPath=").concat(null!==e&&void 0!==e&&e.invoicePDFPath?(0,D.w)(null===e||void 0===e?void 0:e.invoicePDFPath):""))},children:null===e||void 0===e?void 0:e.refNo})}),(0,g.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:(0,o.w2)(null===e||void 0===e?void 0:e.debit)}),(0,g.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:(0,o.w2)(null===e||void 0===e?void 0:e.credit)}),(0,g.jsx)("td",{className:"tableData ",children:(0,o.w2)(null===e||void 0===e?void 0:e.balance)})]})):(0,g.jsx)("tr",{className:"bg-white bg-opacity-5",children:(0,g.jsx)("td",{colSpan:15,className:"px-6 py-2 whitespace-nowrap  font-[600] text-sm text-gray-500",children:"Record Not Found"})})})]})})]})})}}}]);
//# sourceMappingURL=8318.f3d4e021.chunk.js.map