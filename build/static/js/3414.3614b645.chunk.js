"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[3414],{13414:(e,l,s)=>{s.r(l),s.d(l,{default:()=>A});var a=s(89379),i=s(65043),n=s(39160),d=s(15187),t=s(24858),o=s(65512),c=s(83003),r=s(89427),u=s(78729),v=s(31744),m=s(8928),p=s(70337),h=s(47196),x=s(17995),y=s(47989),N=s(35475),j=s(73216),k=s(71985),b=s(31174),g=s(55971),f=s(70579);const A=()=>{var e,l,s,A,S,I,C,P,D,w,G,O,_,L,F,Q,R,q,B,H,E,Y,V,M,z,J,W,$,U,X,Z,K;const[ee]=(0,N.ok)(),le=ee.get("taskData"),[se,ae]=(0,i.useState)(null),{register:ie,handleSubmit:ne,control:de,watch:te,reset:oe,formState:{errors:ce},setValue:re}=(0,t.mN)({defaultValues:{totalAmount:0,totalDiscount:0,totalDiscountedPrice:0,tasks:[{gstAmount:"",gstRate:"",amount:"",hsnCode:"",taskType:""}]}}),ue=(0,t.FH)({control:de,name:"tasks",defaultValue:""}),[ve,me]=(0,i.useState)({totalAmount:0,totalDiscount:0,totalDiscountedPrice:0,totalGST:0,totalFinalAmount:0}),{gstTypeList:pe,loading:he}=(0,c.d4)(e=>e.gstType),{fields:xe,append:ye,remove:Ne}=(0,t.jz)({control:de,name:"tasks"}),je=(0,t.FH)({control:de,name:"PDCompanyId",defaultValue:""}),ke=(0,t.FH)({control:de,name:"PDBranchId",defaultValue:""}),{loading:be}=(0,c.d4)(e=>e.invoice),[ge,fe]=(0,i.useState)(""),[Ae,Te]=(0,i.useState)(!1),Se=(0,c.wA)(),Ie=(0,j.Zp)(),[Ce,Pe]=(0,i.useState)([]),De=JSON.parse(localStorage.getItem("user_info_".concat(d.AU))),{companyList:we,companyListLoading:Ge}=(0,c.d4)(e=>e.company),{branchList:Oe,branchListloading:_e}=(0,c.d4)(e=>e.branch),{officeAddressListData:Le,loading:Fe}=(0,c.d4)(e=>e.officeAddress),{clientList:Qe,loading:Re}=(0,c.d4)(e=>e.client),qe=null===Le||void 0===Le?void 0:Le.find(e=>e._id===te("invoiceLayout")),Be=null===Qe||void 0===Qe?void 0:Qe.find(e=>e._id===te("client"));(0,i.useEffect)(()=>{"admin"===(null===De||void 0===De?void 0:De.userType)&&Se((0,u.Ar)({text:"",sort:!0,status:!0,isPagination:!1}))},[]),(0,i.useEffect)(()=>{(je||"company"===(null===De||void 0===De?void 0:De.userType)||"companyDirector"===(null===De||void 0===De?void 0:De.userType))&&Se((0,v.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===De||void 0===De?void 0:De.userType)?je:"company"===(null===De||void 0===De?void 0:De.userType)?null===De||void 0===De?void 0:De._id:null===De||void 0===De?void 0:De.companyId}))},[je]),(0,i.useEffect)(()=>{se&&Qe&&(null===Qe||void 0===Qe?void 0:Qe.length)>0&&re("client",null===se||void 0===se?void 0:se.clientId),se&&Oe&&(null===Oe||void 0===Oe?void 0:Oe.length)>0&&re("PDBranchId",null===se||void 0===se?void 0:se.branchId)},[se,Qe,Oe]),(0,i.useEffect)(()=>{!je&&"admin"===(null===De||void 0===De?void 0:De.userType)||!ke&&"companyBranch"!==(null===De||void 0===De?void 0:De.userType)&&"employee"!==(null===De||void 0===De?void 0:De.userType)||He()},[je,ke]),(0,i.useEffect)(()=>{var e,l;(Pe([]),null!==Qe&&void 0!==Qe&&null!==(e=Qe.find(e=>e._id===te("client")))&&void 0!==e&&e.clientCompletedTaskData)&&Pe([...null===Qe||void 0===Qe||null===(l=Qe.find(e=>e._id===te("client")))||void 0===l?void 0:l.clientCompletedTaskData,{_id:"other",financialYear:"-",status:"Completed",taskName:"Other",description:"Other",HSNCode:"",GSTRate:0,GSTName:"-",taskFee:0}])},[Qe,te("client"),qe,Be]);const He=()=>{Se((0,p.Aq)({companyId:"admin"===(null===De||void 0===De?void 0:De.userType)?te("PDCompanyId"):"company"===(null===De||void 0===De?void 0:De.userType)?null===De||void 0===De?void 0:De._id:null===De||void 0===De?void 0:De.companyId,branchId:"company"===(null===De||void 0===De?void 0:De.userType)||"admin"===(null===De||void 0===De?void 0:De.userType)||"companyDirector"===(null===De||void 0===De?void 0:De.userType)?te("PDBranchId"):"companyBranch"===(null===De||void 0===De?void 0:De.userType)?null===De||void 0===De?void 0:De._id:null===De||void 0===De?void 0:De.branchId,groupId:"",directorId:"",organizationId:"",industryId:"",text:"",sort:!0,status:!0,isPagination:!1}))};(0,i.useEffect)(()=>{var e,l;if(Be&&qe)if(null!==Be&&void 0!==Be&&null!==(e=Be.clientProfile)&&void 0!==e&&e.GSTNumber&&null!==qe&&void 0!==qe&&qe.isGSTEnabled){var s;Te(!0);const e=null===Be||void 0===Be||null===(s=Be.clientProfile)||void 0===s?void 0:s.GSTNumber,l=null===qe||void 0===qe?void 0:qe.gstNumber,a=null===e||void 0===e?void 0:e.slice(0,2),i=null===l||void 0===l?void 0:l.slice(0,2);fe(a===i?"interstate":"intrastate")}else null!==Be&&void 0!==Be&&null!==(l=Be.clientProfile)&&void 0!==l&&l.GSTNumber||null===qe||void 0===qe||!qe.isGSTEnabled?(Te(!1),fe("")):(Te(!0),fe("interstate"));else Te(!1),fe("")},[Be,qe]),(0,i.useEffect)(()=>{re("tasks",[])},[qe]),(0,i.useEffect)(()=>{if(le)try{const e=JSON.parse((0,b.Yc)(le));ae(e)}catch(e){ae(null)}},[le]),(0,i.useEffect)(()=>{if(!ue||0===ue.length)return void me({totalAmount:0,totalDiscount:0,totalDiscountedPrice:0,totalGST:0,totalFinalAmount:0});const e=ue.reduce((e,l)=>(e.totalAmount+=Number(l.amount)||0,e.totalDiscount+=Number(l.discount)||0,e.totalDiscountedPrice+=Number(l.discountedPrice)||0,e.totalGST+=Number(l.gstPrice)||0,e.totalFinalAmount+=Number(l.finalAmount)||0,e),{totalAmount:0,totalDiscount:0,totalDiscountedPrice:0,totalGST:0,totalFinalAmount:0});me(e)},[ue]);return(0,f.jsx)(n.A,{children:Re?(0,f.jsx)(g.A,{}):(0,f.jsxs)("form",{autoComplete:"off",className:"mt-2 md:px-1",onSubmit:ne(e=>{var l,s,a,i;const n=null===e||void 0===e||null===(l=e.tasks)||void 0===l||null===(s=l.filter(e=>"other"!==e.taskType))||void 0===s?void 0:s.map(e=>{const l=Ce.find(l=>l._id===e.taskType);return{taskType:"task",taskId:e.taskType,taskName:null===l||void 0===l?void 0:l.taskName,HSNCode:e.hsnCode,GSTRate:+e.gstRate,taskAmount:+e.amount,calculatedAmount:+e.finalAmount,gstAmount:+e.gstPrice,discount:+e.discount,discountAmount:+e.discountedPrice,financialYear:null===e||void 0===e?void 0:e.financialYear}}),d=null===e||void 0===e||null===(a=e.tasks)||void 0===a||null===(i=a.filter(e=>"other"===e.taskType))||void 0===i?void 0:i.map(e=>{Ce.find(e=>e._id===e.taskType);return{taskType:"other",taskId:null,taskName:null===e||void 0===e?void 0:e.description,HSNCode:e.hsnCode,GSTRate:+e.gstRate,taskAmount:+e.amount,calculatedAmount:+e.finalAmount,gstAmount:+e.gstPrice,discount:+e.discount,discountAmount:+e.discountedPrice,financialYear:null}}),t={companyId:"admin"===(null===De||void 0===De?void 0:De.userType)?null===e||void 0===e?void 0:e.PDCompanyId:"company"===(null===De||void 0===De?void 0:De.userType)?null===De||void 0===De?void 0:De._id:null===De||void 0===De?void 0:De.companyId,directorId:"",branchId:"admin"===(null===De||void 0===De?void 0:De.userType)||"companyDirector"===(null===De||void 0===De?void 0:De.userType)||"company"===(null===De||void 0===De?void 0:De.userType)?null===e||void 0===e?void 0:e.PDBranchId:"companyBranch"===(null===De||void 0===De?void 0:De.userType)?null===De||void 0===De?void 0:De._id:null===De||void 0===De?void 0:De.branchId,clientId:null===e||void 0===e?void 0:e.client,invoiceLayoutId:null===e||void 0===e?void 0:e.invoiceLayout,taskList:[...n,...d],totalAmount:+(null===ve||void 0===ve?void 0:ve.totalAmount),discountAmount:+(null===ve||void 0===ve?void 0:ve.totalDiscount),grandTotal:+(null===ve||void 0===ve?void 0:ve.totalFinalAmount),isAllTask:(null===e||void 0===e?void 0:e.isAlltask)||!1,isIGST:"intrastate"===ge,isDiscount:!0,SGST:Ae?+(null===ve||void 0===ve?void 0:ve.totalGST)/2:null,CGST:Ae?+(null===ve||void 0===ve?void 0:ve.totalGST)/2:null,IGST:Ae?+(null===ve||void 0===ve?void 0:ve.totalGST):null};Se((0,y._w)(t)).then(e=>{null!==e&&void 0!==e&&e.error||Ie(-1)})}),children:[(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-1 md:gap-8 md:my-1  md:mt-4",children:["admin"===(null===De||void 0===De?void 0:De.userType)&&(0,f.jsxs)("div",{className:"",children:[(0,f.jsxs)("label",{className:"".concat(d.Q0),children:["Company ",(0,f.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,f.jsx)(t.xI,{control:de,name:"PDCompanyId",rules:{required:"Company is required"},render:e=>{var l;let{field:s}=e;return(0,f.jsxs)(o.A,(0,a.A)((0,a.A)({},s),{},{defaultValue:"",className:"".concat(d.Hy," "),showSearch:!0,filterOption:(e,l)=>String(null===l||void 0===l?void 0:l.children).toLowerCase().includes(e.toLowerCase()),children:[(0,f.jsx)(o.A.Option,{value:"",children:"Select Company"}),Ge?(0,f.jsx)(o.A.Option,{disabled:!0,children:(0,f.jsx)(r.A,{})}):null===(l=(0,d._o)(we,"fullName"))||void 0===l?void 0:l.map(e=>(0,f.jsx)(o.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),ce.PDCompanyId&&(0,f.jsx)("p",{className:"text-red-500 text-sm",children:ce.PDCompanyId.message})]}),("admin"===(null===De||void 0===De?void 0:De.userType)||"company"===(null===De||void 0===De?void 0:De.userType)||"companyDirector"===(null===De||void 0===De?void 0:De.userType))&&(0,f.jsxs)("div",{className:"",children:[(0,f.jsxs)("label",{className:"".concat(d.Q0),children:["Branch ",(0,f.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,f.jsx)(t.xI,{control:de,name:"PDBranchId",rules:{required:"Branch is required"},render:e=>{var l;let{field:s}=e;return(0,f.jsxs)(o.A,(0,a.A)((0,a.A)({},s),{},{defaultValue:"",className:"".concat(d.Hy," "),showSearch:!0,filterOption:(e,l)=>String(null===l||void 0===l?void 0:l.children).toLowerCase().includes(e.toLowerCase()),children:[(0,f.jsx)(o.A.Option,{value:"",children:"Select Branch"}),_e?(0,f.jsx)(o.A.Option,{disabled:!0,children:(0,f.jsx)(r.A,{})}):null===(l=(0,d._o)(Oe,"fullName"))||void 0===l?void 0:l.map(e=>(0,f.jsx)(o.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),ce.PDBranchId&&(0,f.jsx)("p",{className:"text-red-500 text-sm",children:ce.PDBranchId.message})]})]}),(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 ",children:[(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsxs)("label",{className:"".concat(d.Q0),children:["Client ",(0,f.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,f.jsx)(t.xI,{name:"client",control:de,rules:{required:" Client is required"},render:e=>{var l;let{field:s}=e;return(0,f.jsxs)(o.A,(0,a.A)((0,a.A)({},s),{},{defaultValue:"",showSearch:!0,filterOption:(e,l)=>String(null===l||void 0===l?void 0:l.children).toLowerCase().includes(e.toLowerCase()),className:" ".concat(d.Hy," ").concat(ce.invoiceLayout?"border-[1px] ":"border-gray-300"),children:[(0,f.jsx)(o.A.Option,{className:"",value:"",children:"Select client"}),Re?(0,f.jsx)(o.A.Option,{disabled:!0,children:(0,f.jsx)(r.A,{})}):null===(l=(0,d._o)(Qe,"fullName"))||void 0===l?void 0:l.map(e=>(0,f.jsx)(o.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName}))]}))}}),ce.client&&(0,f.jsx)("p",{className:"text-red-500 text-sm mt-1",children:ce.client.message})]}),(0,f.jsxs)("div",{className:"",children:[(0,f.jsxs)("label",{className:"".concat(d.Q0),children:["Firm Layout Name ",(0,f.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,f.jsx)(t.xI,{control:de,name:"invoiceLayout",rules:{required:"Layout is required"},render:e=>{var l;let{field:s}=e;return(0,f.jsxs)(o.A,(0,a.A)((0,a.A)({},s),{},{defaultValue:"",className:" ".concat(d.Hy," ").concat(ce.invoiceLayout?"border-[1px] ":"border-gray-300"),showSearch:!0,filterOption:(e,l)=>String(null===l||void 0===l?void 0:l.children).toLowerCase().includes(e.toLowerCase()),onFocus:()=>{Se((0,m.XY)({companyId:"admin"===(null===De||void 0===De?void 0:De.userType)?te("PDCompanyId"):"company"===(null===De||void 0===De?void 0:De.userType)?null===De||void 0===De?void 0:De._id:null===De||void 0===De?void 0:De.companyId,branchId:"company"===(null===De||void 0===De?void 0:De.userType)||"admin"===(null===De||void 0===De?void 0:De.userType)||"companyDirector"===(null===De||void 0===De?void 0:De.userType)?te("PDBranchId"):"companyBranch"===(null===De||void 0===De?void 0:De.userType)?null===De||void 0===De?void 0:De._id:null===De||void 0===De?void 0:De.branchId,directorId:"",text:"",sort:!0,status:!0,type:"invoice",isPagination:!1,bankAccountId:"",isGSTEnabled:""}))},children:[(0,f.jsx)(o.A.Option,{className:"",value:"",children:"Select Layout"}),Fe?(0,f.jsx)(o.A.Option,{disabled:!0,children:(0,f.jsx)(r.A,{})}):null===(l=(0,d._o)(Le,"firmName"))||void 0===l?void 0:l.map(e=>(0,f.jsx)(o.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.firmName}))]}))}}),ce.invoiceLayout&&(0,f.jsx)("p",{className:"text-red-500 text-sm",children:ce.invoiceLayout.message})]})]}),(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Be&&(0,f.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 p-4 shadow-sm",children:[(0,f.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,f.jsx)("div",{className:"p-2 bg-blue-50 rounded-lg",children:(0,f.jsx)("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,f.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,f.jsx)("h3",{className:"text-base font-semibold text-gray-800",children:"Client Details"})]}),(0,f.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,f.jsxs)("div",{className:"space-y-3",children:[(0,f.jsx)(T,{label:"Client",value:null===Be||void 0===Be?void 0:Be.fullName}),(0,f.jsx)(T,{label:"Mobile",value:"".concat(null===Be||void 0===Be||null===(e=Be.mobile)||void 0===e?void 0:e.code," ").concat(null===Be||void 0===Be||null===(l=Be.mobile)||void 0===l?void 0:l.number)})]}),(0,f.jsxs)("div",{className:"space-y-3",children:[(0,f.jsx)(T,{label:"GST Number",value:(null===Be||void 0===Be||null===(s=Be.clientProfile)||void 0===s?void 0:s.GSTNumber)||"-"}),(0,f.jsx)(T,{label:"Address",value:"".concat(null!==(A=null===Be||void 0===Be||null===(S=Be.addresses)||void 0===S||null===(I=S.primary)||void 0===I?void 0:I.city)&&void 0!==A?A:"-",", ").concat(null!==(C=null===Be||void 0===Be||null===(P=Be.addresses)||void 0===P||null===(D=P.primary)||void 0===D?void 0:D.state)&&void 0!==C?C:"-"),fullValue:"".concat(null!==(w=null===Be||void 0===Be||null===(G=Be.addresses)||void 0===G||null===(O=G.primary)||void 0===O?void 0:O.country)&&void 0!==w?w:"-",", ").concat(null!==(_=null===Be||void 0===Be||null===(L=Be.addresses)||void 0===L||null===(F=L.primary)||void 0===F?void 0:F.pinCode)&&void 0!==_?_:"-")})]})]})]}),qe&&(0,f.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 p-4 shadow-sm",children:[(0,f.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,f.jsx)("div",{className:"p-2 bg-green-50 rounded-lg",children:(0,f.jsx)("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,f.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),(0,f.jsx)("h3",{className:"text-base font-semibold text-gray-800",children:"Firm Details"})]}),(0,f.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,f.jsxs)("div",{className:"space-y-3",children:[(0,f.jsx)(T,{label:"Firm Name",value:null===qe||void 0===qe?void 0:qe.firmName}),(0,f.jsx)(T,{label:"Mobile",value:"".concat(null===qe||void 0===qe||null===(Q=qe.mobile)||void 0===Q?void 0:Q.code," ").concat(null===qe||void 0===qe||null===(R=qe.mobile)||void 0===R?void 0:R.number)})]}),(0,f.jsxs)("div",{className:"space-y-3",children:[(0,f.jsx)(T,{label:"GST Number",value:null!==qe&&void 0!==qe&&qe.isGSTEnabled?null===qe||void 0===qe?void 0:qe.gstNumber:"-"}),(0,f.jsx)(T,{label:"Address",value:"".concat(null!==(q=null===qe||void 0===qe||null===(B=qe.address)||void 0===B?void 0:B.city)&&void 0!==q?q:"-",", ").concat(null!==(H=null===qe||void 0===qe||null===(E=qe.address)||void 0===E?void 0:E.state)&&void 0!==H?H:"-"),fullValue:"".concat(null!==(Y=null===qe||void 0===qe||null===(V=qe.address)||void 0===V?void 0:V.country)&&void 0!==Y?Y:"-",", ").concat(null!==(M=null===qe||void 0===qe||null===(z=qe.address)||void 0===z?void 0:z.pinCode)&&void 0!==M?M:"-")})]})]})]})]}),(0,f.jsxs)("div",{className:"space-y-2",children:[Be&&qe&&(0,f.jsxs)("div",{children:[xe.map((e,l)=>{var s,i,n,c,u,v,m,p,x,y,N,j,b,g,A,T,S,I,C,P,D,w,G,O,_,L,F,Q,R,q,B,H,E,Y,V,M,z,J,W,$,U,X,Z,K,ee,le,se,ae,ne,oe,ue,ve,me,xe,ye,je,ke;return(0,f.jsxs)("div",{className:"border border-gray-300 rounded-md",children:[(0,f.jsx)("div",{className:"flex flex-col items-end",children:(0,f.jsx)("div",{className:"w-full bg-header flex justify-end items-center rounded-tl-md rounded-tr-md p-1",children:(0,f.jsx)("button",{type:"button",onClick:()=>Ne(l),children:(0,f.jsx)(h.tqC,{className:"text-white w-12 hover:text-white",size:20})})})}),(0,f.jsxs)("div",{className:"grid sm:grid-cols-2 gap-2 md:grid-cols-4 p-2",children:[(0,f.jsxs)("div",{className:te("isAlltask")?"hidden w-full":"block w-full",children:[(0,f.jsx)("label",{className:"".concat(d.Q0),children:"Task"}),(0,f.jsx)(t.xI,{control:de,name:"tasks[".concat(l,"].taskType"),rules:{required:"Task Type is required"},render:e=>{let{field:s}=e;return(0,f.jsxs)(o.A,{defaultValue:"",className:"".concat(d.Hy),showSearch:!0,filterOption:(e,l)=>String(null===l||void 0===l?void 0:l.children).toLowerCase().includes(e.toLowerCase()),onChange:e=>{if(e){const s=null===Ce||void 0===Ce?void 0:Ce.find(l=>l._id===e);if(s){const e=Ae?null===s||void 0===s?void 0:s.GSTRate:0;re("tasks[".concat(l,"].tasktypeId"),null===s||void 0===s?void 0:s._id),re("tasks[".concat(l,"].amount"),null===s||void 0===s?void 0:s.taskFee),re("tasks[".concat(l,"].gstRate"),e),re("tasks[".concat(l,"].hsnCode"),null===s||void 0===s?void 0:s.HSNCode),re("tasks[".concat(l,"].discount"),0),re("tasks[".concat(l,"].financialYear"),null===s||void 0===s?void 0:s.financialYear),re("tasks[".concat(l,"].discountedPrice"),null===s||void 0===s?void 0:s.taskFee),re("tasks[".concat(l,"].gstPrice"),(null===s||void 0===s?void 0:s.taskFee)*e/100),re("tasks[".concat(l,"].finalAmount"),(null===s||void 0===s?void 0:s.taskFee)*e/100+(null===s||void 0===s?void 0:s.taskFee))}}else re("tasks[".concat(l,"].tasktypeId"),""),re("tasks[".concat(l,"].amount"),0),re("tasks[".concat(l,"].gstRate"),0),re("tasks[".concat(l,"].hsnCode"),""),re("tasks[".concat(l,"].discount"),0),re("tasks[".concat(l,"].discountedPrice"),0),re("tasks[".concat(l,"].gstPrice"),0),re("tasks[".concat(l,"].finalAmount"),0),re("tasks[".concat(l,"].financialYear"),null);s.onChange(e)},children:[(0,f.jsx)(o.A.Option,{value:"",children:"Select Task"}),null===Ce||void 0===Ce?void 0:Ce.filter(e=>{var s;return!(null===(s=te("tasks"))||void 0===s?void 0:s.map((e,s)=>s!==l&&e.taskType).filter(Boolean)).includes(e._id)}).map(e=>(0,f.jsxs)(o.A.Option,{value:null===e||void 0===e?void 0:e._id,children:[null===e||void 0===e?void 0:e.taskName,"Yearly"!==(null===e||void 0===e?void 0:e.type)&&("Monthly"==(null===e||void 0===e?void 0:e.type)?null===e||void 0===e?void 0:e.monthName:"Quarterly"==(null===e||void 0===e?void 0:e.type)?null===e||void 0===e?void 0:e.quarterName:"")]},null===e||void 0===e?void 0:e._id))]})}}),(null===(s=ce.tasks)||void 0===s||null===(i=s[l])||void 0===i?void 0:i.taskType)&&(0,f.jsx)("p",{className:"text-red-500 text-sm",children:null===(n=ce.tasks)||void 0===n||null===(c=n[l])||void 0===c||null===(u=c.taskType)||void 0===u?void 0:u.message})]}),(0,f.jsxs)("div",{className:te("isAlltask")?"block w-full":"hidden w-full",children:[(0,f.jsx)("label",{className:"".concat(d.Q0),children:"Task"}),(0,f.jsx)("input",(0,a.A)((0,a.A)({type:"text",disabled:!0},ie("tasks[".concat(l,"].taskName"))),{},{className:"".concat(d.Ol),placeholder:"Task Name"})),(null===(v=ce.tasks)||void 0===v||null===(m=v[l])||void 0===m?void 0:m.taskName)&&(0,f.jsx)("p",{className:"text-red-500 text-sm",children:null===(p=ce.tasks)||void 0===p||null===(x=p[l])||void 0===x||null===(y=x.taskName)||void 0===y?void 0:y.message})]}),(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsx)("label",{className:"".concat(d.Q0),children:"HSN code"}),(0,f.jsx)("input",(0,a.A)((0,a.A)({type:"text",disabled:"other"!==te("tasks[".concat(l,"].tasktypeId"))},ie("tasks[".concat(l,"].hsnCode"),{required:"other"===te("tasks[".concat(l,"].tasktypeId"))&&"HSN Code is required",pattern:{value:/^\d{4}(\d{2})?(\d{2})?$/,message:"HSN Code must be 4, 6, or 8 digits"}})),{},{className:"".concat(d.Ol),placeholder:"HSN CODE"})),(null===(N=ce.tasks)||void 0===N||null===(j=N[l])||void 0===j?void 0:j.hsnCode)&&(0,f.jsx)("p",{className:"text-red-500 text-sm",children:null===(b=ce.tasks)||void 0===b||null===(g=b[l])||void 0===g||null===(A=g.hsnCode)||void 0===A?void 0:A.message})]}),te("tasks[".concat(l,"].tasktypeId"))&&"other"!==te("tasks[".concat(l,"].tasktypeId"))&&(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsx)("label",{className:"".concat(d.Q0),children:"Financial Year"}),(0,f.jsx)("input",(0,a.A)((0,a.A)({type:"text",disabled:!0},ie("tasks[".concat(l,"].financialYear"),{})),{},{className:"".concat(d.id),placeholder:"Financial Year"})),(null===(T=ce.tasks)||void 0===T||null===(S=T[l])||void 0===S?void 0:S.financialYear)&&(0,f.jsx)("p",{className:"text-red-500 text-sm",children:null===(I=ce.tasks)||void 0===I||null===(C=I[l])||void 0===C||null===(P=C.financialYear)||void 0===P?void 0:P.message})]}),"other"===te("tasks[".concat(l,"].tasktypeId"))&&(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsx)("label",{className:"".concat(d.Q0),children:"Description"}),(0,f.jsx)("input",(0,a.A)((0,a.A)({type:"text"},ie("tasks[".concat(l,"].description"),{})),{},{className:"".concat(d.Ol),placeholder:"Description"})),(null===(D=ce.tasks)||void 0===D||null===(w=D[l])||void 0===w?void 0:w.description)&&(0,f.jsx)("p",{className:"text-red-500 text-sm",children:null===(G=ce.tasks)||void 0===G||null===(O=G[l])||void 0===O||null===(_=O.description)||void 0===_?void 0:_.message})]}),(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsx)("label",{className:"".concat(d.Q0),children:"Amount"}),(0,f.jsx)("input",(0,a.A)((0,a.A)({type:"number",step:"0.01"},ie("tasks[".concat(l,"].amount"),{required:"other"===te("tasks[".concat(l,"].tasktypeId"))&&"Amount is required",min:{value:0,message:"Amount cannot be negative"}})),{},{className:"".concat(d.Ol),placeholder:"Amount",disabled:"other"!==te("tasks[".concat(l,"].tasktypeId")),onChange:e=>{if("other"===te("tasks[".concat(l,"].tasktypeId"))){var s;const a=Number(e.target.value),i=Number(te("tasks[".concat(l,"].gstRate"))),n=a-(null!==(s=Number(te("tasks[".concat(l,"].discount"))))&&void 0!==s?s:0),d=n*i/100,t=n+d;re("tasks[".concat(l,"].discountedPrice"),n),re("tasks[".concat(l,"].gstPrice"),d),re("tasks[".concat(l,"].finalAmount"),t),re("tasks[".concat(l,"].amount"),a)}}})),(null===(L=ce.tasks)||void 0===L||null===(F=L[l])||void 0===F?void 0:F.amount)&&(0,f.jsx)("p",{className:"text-red-500 text-sm",children:null===(Q=ce.tasks)||void 0===Q||null===(R=Q[l])||void 0===R||null===(q=R.amount)||void 0===q?void 0:q.message})]}),(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsx)("label",{className:"".concat(d.Q0),children:"Discount"}),(0,f.jsx)("input",(0,a.A)((0,a.A)({type:"number",step:"0.01"},ie("tasks[".concat(l,"].discount"),{min:{value:0,message:"Discount cannot be negative"},validate:e=>{const s=Number(te("tasks[".concat(l,"].amount")));return!(Number(e)>s)||"Discount cannot exceed amount"}})),{},{className:"".concat(d.Ol),placeholder:"Discount",onChange:e=>{const s=Math.max(0,Number(e.target.value)),a=Number(te("tasks[".concat(l,"].amount"))),i=Math.min(s,a);re("tasks[".concat(l,"].discount"),i);const n=a-i,d=n*Number(te("tasks[".concat(l,"].gstRate")))/100,t=n+d;re("tasks[".concat(l,"].discountedPrice"),n),re("tasks[".concat(l,"].gstPrice"),d),re("tasks[".concat(l,"].finalAmount"),t)}})),(null===(B=ce.tasks)||void 0===B||null===(H=B[l])||void 0===H?void 0:H.discount)&&(0,f.jsx)("p",{className:"text-red-500 text-sm",children:null===(E=ce.tasks)||void 0===E||null===(Y=E[l])||void 0===Y||null===(V=Y.discount)||void 0===V?void 0:V.message})]}),(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsx)("label",{className:"".concat(d.Q0),children:"Discounted Price"}),(0,f.jsx)("input",(0,a.A)((0,a.A)({type:"number",step:"0.01",disabled:!0},ie("tasks[".concat(l,"].discountedPrice"),{})),{},{className:"".concat(d.Ol),placeholder:"discountedPrice"})),(null===(M=ce.tasks)||void 0===M||null===(z=M[l])||void 0===z?void 0:z.discountedPrice)&&(0,f.jsx)("p",{className:"text-red-500 text-sm",children:null===(J=ce.tasks)||void 0===J||null===(W=J[l])||void 0===W||null===($=W.discountedPrice)||void 0===$?void 0:$.message})]}),Ae&&(0,f.jsxs)(f.Fragment,{children:["other"===te("tasks[".concat(l,"].tasktypeId"))?(0,f.jsxs)("div",{className:"",children:[(0,f.jsxs)("label",{className:"".concat(d.Q0),children:["Gst Rate ",(0,f.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,f.jsx)(t.xI,{name:"tasks[".concat(l,"].gstTypeId"),control:de,rules:{required:"GST Rate is required"},render:e=>{let{field:s}=e;return(0,f.jsxs)(o.A,(0,a.A)((0,a.A)({},s),{},{showSearch:!0,placeholder:"Select GST Rate",className:"".concat(d.Hy," ").concat(ce.gstTypeId?"border-[1px] ":"border-gray-300"),onFocus:()=>{const e={directorId:"",companyId:"admin"===(null===De||void 0===De?void 0:De.userType)?te("companyId"):"company"===(null===De||void 0===De?void 0:De.userType)?null===De||void 0===De?void 0:De._id:null===De||void 0===De?void 0:De.companyId,branchId:["company","admin","companyDirector"].includes(null===De||void 0===De?void 0:De.userType)?te("PDBranchId"):"companyBranch"===(null===De||void 0===De?void 0:De.userType)?null===De||void 0===De?void 0:De._id:null===De||void 0===De?void 0:De.branchId,text:"",sort:!0,status:"",isPagination:!1};Se((0,k.Bw)(e))},onChange:e=>{re("tasks[".concat(l,"].gstRate"),e),re("tasks[".concat(l,"].gstTypeId"),e);const s=Number(e),a=Number(te("tasks[".concat(l,"].discountedPrice"))),i=a*s/100,n=a+i;re("tasks[".concat(l,"].gstPrice"),i),re("tasks[".concat(l,"].finalAmount"),n)},children:[(0,f.jsx)(o.A.Option,{value:"",children:"Select GST Type"}),he?(0,f.jsx)(o.A.Option,{disabled:!0,children:(0,f.jsx)(r.A,{})}):null===pe||void 0===pe?void 0:pe.map(e=>(0,f.jsxs)(o.A.Option,{value:null===e||void 0===e?void 0:e.percentage,children:[null===e||void 0===e?void 0:e.percentage," %"]},null===e||void 0===e?void 0:e._id))]}))}}),(null===ce||void 0===ce||null===(U=ce.tasks)||void 0===U||null===(X=U[l])||void 0===X?void 0:X.gstTypeId)&&(0,f.jsx)("p",{className:"text-red-500 text-sm",children:null===ce||void 0===ce||null===(Z=ce.tasks)||void 0===Z||null===(K=Z[l])||void 0===K||null===(ee=K.gstTypeId)||void 0===ee?void 0:ee.message})]}):(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsx)("label",{className:"".concat(d.Q0),children:"Gst Rate"}),(0,f.jsx)("input",(0,a.A)((0,a.A)({type:"text",disabled:!0},ie("tasks[".concat(l,"].gstRate"),{required:"other"===te("tasks[".concat(l,"].tasktypeId"))&&"GST Rate is required",pattern:{value:/^\d+(\.\d{1,2})?$/,message:"Enter a valid GST Rate (e.g., 5, 12.5)"},min:{value:0,message:"GST Rate cannot be less than 0%"},max:{value:100,message:"GST Rate cannot be more than 100%"}})),{},{className:"".concat(d.Ol),placeholder:"GST Rate"})),(null===ce||void 0===ce||null===(le=ce.tasks)||void 0===le||null===(se=le[l])||void 0===se?void 0:se.gstRate)&&(0,f.jsx)("p",{className:"text-red-500 text-sm",children:ce.tasks[l].gstRate.message})]}),(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsx)("label",{className:"".concat(d.Q0),children:"Gst Price"}),(0,f.jsx)("input",(0,a.A)((0,a.A)({type:"text",disabled:!0},ie("tasks[".concat(l,"].gstPrice"),{})),{},{className:"".concat(d.Ol),placeholder:"gst Price"})),(null===ce||void 0===ce||null===(ae=ce.tasks)||void 0===ae||null===(ne=ae[l])||void 0===ne?void 0:ne.gstPrice)&&(0,f.jsx)("p",{className:"text-red-500 text-sm",children:null===ce||void 0===ce||null===(oe=ce.tasks)||void 0===oe||null===(ue=oe[l])||void 0===ue||null===(ve=ue.gstPrice)||void 0===ve?void 0:ve.message})]})]}),(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsx)("label",{className:"".concat(d.Q0),children:"Final Amount"}),(0,f.jsx)("input",(0,a.A)((0,a.A)({type:"number",step:"0.01",disabled:!0},ie("tasks[".concat(l,"].finalAmount"),{})),{},{className:"".concat(d.Ol),placeholder:"Final Amount"})),(null===(me=ce.tasks)||void 0===me||null===(xe=me[l])||void 0===xe?void 0:xe.finalAmount)&&(0,f.jsx)("p",{className:"text-red-500 text-sm",children:null===(ye=ce.tasks)||void 0===ye||null===(je=ye[l])||void 0===je||null===(ke=je.finalAmount)||void 0===ke?void 0:ke.message})]})]})]})}),Ce.length>(null===xe||void 0===xe?void 0:xe.length)&&(0,f.jsx)("button",{type:"button",onClick:()=>ye({taskType:"",amount:""}),className:te("isAlltask")?"hidden":"bg-header text-white p-2 px-4 rounded mt-4",children:"Add Task Details"}),(0,f.jsx)("div",{className:"w-full flex flex-row items-end justify-end",children:(0,f.jsxs)("div",{className:"",children:[(0,f.jsxs)("div",{className:"",children:[(0,f.jsx)("label",{className:"".concat(d.Q0),children:"Total Amount"}),(0,f.jsx)("input",{type:"number",step:"0.01",value:null!==(J=null===ve||void 0===ve?void 0:ve.totalAmount)&&void 0!==J?J:0,className:"".concat(d.Ol),placeholder:"totalAmount",disabled:!0})]}),(0,f.jsxs)("div",{className:"",children:[(0,f.jsx)("label",{className:"".concat(d.Q0),children:"Discount"}),(0,f.jsx)("input",{type:"number",step:"0.01",disabled:!0,value:null!==(W=null===ve||void 0===ve?void 0:ve.totalDiscount)&&void 0!==W?W:0,className:"".concat(d.Ol),placeholder:"Discount"})]}),(0,f.jsxs)("div",{className:"",children:[(0,f.jsx)("label",{className:"".concat(d.Q0),children:"Discounted Price"}),(0,f.jsx)("input",{type:"number",step:"0.01",disabled:!0,value:null!==($=null===ve||void 0===ve?void 0:ve.totalDiscountedPrice)&&void 0!==$?$:0,className:"".concat(d.Ol),placeholder:"Discounted Price"})]}),"intrastate"===ge&&(0,f.jsxs)("div",{className:"",children:[(0,f.jsx)("label",{className:"".concat(d.Q0),children:"IGST"}),(0,f.jsx)("input",{type:"number",step:"0.01",value:null!==(U=null===ve||void 0===ve?void 0:ve.totalGST)&&void 0!==U?U:0,disabled:!0,className:"".concat(d.Ol),placeholder:"IGST"})]}),"interstate"===ge&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("div",{className:"",children:[(0,f.jsx)("label",{className:"".concat(d.Q0),children:"Total SGST"}),(0,f.jsx)("input",{type:"number",step:"0.01",disabled:!0,value:null!==(X=(null===ve||void 0===ve?void 0:ve.totalGST)/2)&&void 0!==X?X:0,className:"".concat(d.Ol),placeholder:"SGST"})]}),(0,f.jsxs)("div",{className:"",children:[(0,f.jsx)("label",{className:"".concat(d.Q0),children:"Total CGST"}),(0,f.jsx)("input",{type:"number",disabled:!0,value:null!==(Z=(null===ve||void 0===ve?void 0:ve.totalGST)/2)&&void 0!==Z?Z:0,className:"".concat(d.Ol),placeholder:"CGST"})]})]}),(0,f.jsxs)("div",{className:"",children:[(0,f.jsx)("label",{className:"".concat(d.Q0),children:"Grand Total"}),(0,f.jsx)("input",{type:"number",value:null!==(K=null===ve||void 0===ve?void 0:ve.totalFinalAmount)&&void 0!==K?K:0,className:"".concat(d.Ol),placeholder:"grandTotal",disabled:!0})]})]})})]}),(0,f.jsx)("div",{className:"flex justify-end my-4",children:(0,f.jsx)("button",{type:"submit",disabled:be,className:"".concat(be?"bg-gray-400":"bg-header"," text-white p-2 px-4 rounded"),children:be?(0,f.jsx)(x.A,{}):"Submit"})})]})]})})},T=e=>{let{label:l,value:s,fullValue:a}=e;return(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"text-xs font-medium text-gray-500 mb-1",children:l}),(0,f.jsxs)("p",{className:"text-sm font-medium text-gray-800",children:[s,a&&(0,f.jsx)("span",{className:"block text-xs text-gray-500 mt-0.5",children:a})]})]})}}}]);
//# sourceMappingURL=3414.3614b645.chunk.js.map