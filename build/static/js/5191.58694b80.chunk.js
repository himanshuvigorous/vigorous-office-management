"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[5191],{95191:(e,t,a)=>{a.r(t),a.d(t,{default:()=>O});var s=a(89379),l=a(65043),d=a(73216),n=a(83003),r=a(23156),i=a(30064),o=a.n(i),c=a(39160),u=a(26759),m=a(15187),x=a(78227),h=a(86178),p=a.n(h),v=a(24858),f=(a(31744),a(78729),a(65512)),j=a(96651),b=a(30326),y=a(4938),N=(a(55971),a(60446)),g=a.n(N),D=a(83002),w=(a(29542),a(42837),a(94084)),A=(a(33007),a(89427)),I=(a(56679),a(16963)),Y=a(37230),S=(a(88967),a(53913)),C=a(17995),R=a(13561),k=a(70579);const q=e=>{let{isOpen:t,onClose:a,fetchattendanceListData:r}=e;const{register:i,handleSubmit:c,control:x,setValue:h,reset:j,formState:{errors:b}}=(0,v.mN)({defaultValues:{employeeName:"",date:p()().format("YYYY-MM-DD"),checkInTime:"",checkOutTime:"",reason:"",errors:{}}}),y=((0,d.Zp)(),(0,v.FH)({control:x,name:"PDBranchId",defaultValue:""})),N=(0,v.FH)({control:x,name:"PDCompanyId",defaultValue:""}),D=JSON.parse(localStorage.getItem("user_info_".concat(m.AU))),I=(0,n.wA)(),{wfhManagerListData:Y,loading:q}=(0,n.d4)(e=>e.wfhManager);return(0,l.useEffect)(()=>{!N&&"admin"===(null===D||void 0===D?void 0:D.userType)||!y&&"companBranch"===(null===D||void 0===D?void 0:D.userType)&&"employee"!==(null===D||void 0===D?void 0:D.userType)||I((0,R.v0)({text:"",sort:!0,status:!0,isPagination:!1,directorId:"",companyId:"admin"===(null===D||void 0===D?void 0:D.userType)?N:"company"===(null===D||void 0===D?void 0:D.userType)?null===D||void 0===D?void 0:D._id:null===D||void 0===D?void 0:D.companyId,branchId:"company"===(null===D||void 0===D?void 0:D.userType)||"admin"===(null===D||void 0===D?void 0:D.userType)||"companyDirector"===(null===D||void 0===D?void 0:D.userType)?y:"companyBranch"===(null===D||void 0===D?void 0:D.userType)?null===D||void 0===D?void 0:D._id:null===D||void 0===D?void 0:D.branchId}))},[N,y]),t?(0,k.jsx)(S.A,{visible:t,onCancel:()=>{a(),j()},footer:null,title:"Apply wfh",width:600,height:400,className:"antmodalclassName",children:(0,k.jsx)("div",{children:(0,k.jsxs)("form",{autoComplete:"off",onSubmit:c(e=>{const t={companyId:null===D||void 0===D?void 0:D.companyId,branchId:null===D||void 0===D?void 0:D.branchId,employeId:null===D||void 0===D?void 0:D._id,directorId:"",wfhManagerId:null===e||void 0===e?void 0:e.wfhTypeId,reason:null===e||void 0===e?void 0:e.wfhReason,startDate:g()(null===e||void 0===e?void 0:e.fromDate).format("YYYY-MM-DD"),endDate:g()(null===e||void 0===e?void 0:e.fromDate).format("YYYY-MM-DD"),worktodo:(null===e||void 0===e?void 0:e.worktodo)||"-",status:"pending"};I((0,u.dG)(t)).then(e=>{e.error||(o().fire({icon:"success",title:"Success!",text:"wfh Request sent successfully.",confirmButtonText:"OK",customClass:{confirmButton:"bg-header text-white hover:bg-[#063156]"}}),r(),a(),j())})}),className:"",children:[(0,k.jsxs)("div",{className:"grid grid-col-1 md:grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{className:"",children:[(0,k.jsxs)("label",{className:"".concat(m.Q0),children:["wfh Type ",(0,k.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,k.jsx)(v.xI,{control:x,name:"wfhTypeId",rules:{required:"wfh Request is required"},render:e=>{let{field:t}=e;return(0,k.jsxs)(f.A,(0,s.A)((0,s.A)({},t),{},{getPopupContainer:e=>e.parentNode,defaultValue:"",className:"".concat(m.Hy," "),children:[(0,k.jsx)(f.A.Option,{value:"",children:"Select wfh Request"}),q?(0,k.jsx)(f.A.Option,{disabled:!0,children:(0,k.jsx)(A.A,{})}):null===Y||void 0===Y?void 0:Y.map(e=>(0,k.jsx)(f.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.name},null===e||void 0===e?void 0:e._id))]}))}}),b.wfhTypeId&&(0,k.jsx)("p",{className:"text-red-500 text-sm",children:b.wfhTypeId.message})]}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("label",{className:"".concat(m.Q0),children:["Date ",(0,k.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,k.jsx)(v.xI,{name:"fromDate",control:x,rules:{required:"Date is required"},render:e=>{let{field:t}=e;return(0,k.jsx)(w.A,{field:t,errors:b,disabledDate:e=>e&&e.isBefore(p()().endOf("day"),"day")})}}),b.fromDate&&(0,k.jsx)("p",{className:"text-red-500 text-sm",children:"Date is required"})]})]}),(0,k.jsxs)("div",{className:"grid grid-col-1 md:grid-cols-1 gap-4",children:[(0,k.jsxs)("div",{className:"",children:[(0,k.jsxs)("label",{className:"".concat(m.Q0),children:["wfh Reason ",(0,k.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,k.jsx)("input",(0,s.A)((0,s.A)({type:"text"},i("wfhReason",{required:"wfh Reason is required"})),{},{className:" ".concat(m.Ol," ").concat(b.wfhReason?"border-[1px] ":"border-gray-300"," "),placeholder:"Enter wfh Reason"})),b.wfhReason&&(0,k.jsx)("p",{className:"text-red-500 text-sm",children:b.wfhReason.message})]}),(0,k.jsxs)("div",{className:"",children:[(0,k.jsxs)("label",{className:"".concat(m.Q0),children:["Work To Do ",(0,k.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,k.jsx)("input",(0,s.A)((0,s.A)({type:"text"},i("worktodo",{required:"Work To Do is required"})),{},{className:" ".concat(m.Ol," ").concat(b.worktodo?"border-[1px] ":"border-gray-300"," "),placeholder:"Enter Work To Do"})),b.worktodo&&(0,k.jsx)("p",{className:"text-red-500 text-sm",children:b.worktodo.message})]})]}),(0,k.jsx)("div",{className:"flex justify-end mt-4",children:(0,k.jsx)("button",{type:"submit",disabled:q,className:"".concat(q?"bg-gray-400":"bg-header"," text-white p-2 px-4 rounded"),children:q?(0,k.jsx)(C.A,{}):"Submit"})})]})})}):null};const O=function(){const{employeList:e}=(0,n.d4)(e=>e.employe),{departmentListData:t,loading:a}=(0,n.d4)(e=>e.department),{register:i,handleSubmit:o,control:h,formState:{errors:N},setValue:A}=(0,v.mN)({defaultValues:{status:""}}),S=((0,d.Zp)(),(0,n.wA)()),{wfhRequestData:C,totalwfhrequestCount:R,loading:O}=(0,n.d4)(e=>e.wfhRequest),{companyList:T}=(0,n.d4)(e=>e.company),[H,M]=(0,l.useState)({isOpen:!1,data:{},wfhRequest:{}}),F=(0,v.FH)({control:h,name:"startDate",defaultValue:""}),L=(0,v.FH)({control:h,name:"endDate",defaultValue:""}),{branchList:V}=(0,n.d4)(e=>e.branch),_=(0,v.FH)({control:h,name:"PDCompanyId",defaultValue:""}),P=(0,v.FH)({control:h,name:"department",defaultValue:""}),B=(0,v.FH)({control:h,name:"PDBranchId",defaultValue:""}),z=(0,v.FH)({control:h,name:"status",defaultValue:""}),[E,W]=(0,l.useState)(1),[J,G]=(0,l.useState)(!1),[Q,U]=(0,l.useState)(!1),[Z,K]=(0,l.useState)(null),X=JSON.parse(localStorage.getItem("user_info_".concat(m.AU))),$=(0,v.FH)({control:h,defaultValue:"",name:"employeeId"}),[ee,te]=(0,l.useState)(""),ae=[_,B,ee,z,F,L,$,P].join("-"),[se,le]=(0,l.useState)(!1);(0,l.useEffect)(()=>{se?1===E?oe():W(1):le(e=>!0)},[ae]),(0,l.useEffect)(()=>{oe()},[E]);const{canCreate:de,canRead:ne,canUpdate:re,canDelete:ie}=(0,y.A)(),oe=()=>{const e={currentPage:E,pageSize:10,reqData:{employeId:"employee"===(null===X||void 0===X?void 0:X.userType)?null===X||void 0===X?void 0:X._id:null,companyId:null===X||void 0===X?void 0:X.companyId,branchId:null===X||void 0===X?void 0:X.branchId,directorId:"",text:ee,startDate:F?g()(F).format("YYYY-MM-DD"):"",endDate:L?g()(L).format("YYYY-MM-DD"):"",sort:!0,status:z,isPagination:!0}};S((0,u.J9)(e))},[ce,ue]=(0,l.useState)({isOpen:!1,data:null});return"employee"!==(null===X||void 0===X?void 0:X.userType)?(0,k.jsx)(c.A,{children:(0,k.jsx)("div",{className:"bg-red-100 text-red-800 p-4 rounded-md mt-2",children:(0,k.jsx)("p",{className:"text-center font-semibold",children:"You are not an employee. This page is viewable for employees only."})})}):(0,k.jsx)(c.A,{onChange:e=>{te(e)},children:(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("div",{className:"",children:[(0,k.jsxs)("div",{class:"2xl:flex justify-between items-center py-1 lg:space-y-0 space-y-2 overflow-y-auto gap-1",children:[(0,k.jsxs)("div",{className:"grid sm:grid-cols-3 grid-cols-1 lg:grid-cols-3 xl:grid-cols-3 sm:gap-3 gap-1",children:[(0,k.jsx)("div",{className:"",children:(0,k.jsx)(v.xI,{name:"startDate",control:h,render:e=>{let{field:t}=e;return(0,k.jsx)(w.A,{size:"middle",disabled:O,report:!0,field:t,errors:N})}})}),(0,k.jsx)("div",{className:"",children:(0,k.jsx)(v.xI,{name:"endDate",control:h,className:"inputAntdSelectClassNameFilterReport",render:e=>{let{field:t}=e;return(0,k.jsx)(w.A,{size:"middle",disabled:O,report:!0,field:t,errors:N})}})}),(0,k.jsx)("div",{className:"",children:(0,k.jsx)(v.xI,{name:"status",control:h,rules:{},render:e=>{let{field:t}=e;return(0,k.jsxs)(f.A,(0,s.A)((0,s.A)({},t),{},{className:"inputAntdSelectClassNameFilterReport",placeholder:"Select Status",disabled:O,showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,k.jsx)(f.A.Option,{value:"",children:"Select Status"}),(0,k.jsx)(f.A.Option,{value:"pending",children:" pending "}),(0,k.jsx)(f.A.Option,{value:"approved",children:" approved "}),(0,k.jsx)(f.A.Option,{value:"rejected",children:" rejected "})]}))}})})]}),(0,k.jsxs)("div",{className:"2xl:flex hidden justify-end items-center gap-2",children:[(0,k.jsx)("button",{onClick:()=>{A("PDBranchId",""),A("PdCompanyId",""),A("endDate",""),A("startDate",""),A("status",""),A("department",""),A("employeeId","")},className:"bg-header  py-1.5 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,k.jsx)("span",{className:"text-[12px]",children:"Reset"})}),de&&(0,k.jsx)(j.A,{placement:"topLeft",title:"Add wfh Request",children:(0,k.jsxs)("button",{onClick:()=>{G(!0)},className:"bg-header px-2 py-1.5 w-44 rounded-md flex justify-center items-center space-x-2 text-white",children:[(0,k.jsx)(r.OiG,{}),(0,k.jsx)("span",{className:"text-[12px]",children:"Add wfh Request"})]})})]})]}),(0,k.jsxs)("div",{className:"flex 2xl:hidden justify-end items-center gap-2",children:[(0,k.jsx)("button",{onClick:()=>{A("PDBranchId",""),A("PdCompanyId",""),A("endDate",""),A("startDate",""),A("status",""),A("department",""),A("employeeId","")},className:"bg-header  py-1.5 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,k.jsx)("span",{className:"text-[12px]",children:"Reset"})}),de&&(0,k.jsx)(j.A,{placement:"topLeft",title:"Add wfh Request",children:(0,k.jsxs)("button",{onClick:()=>{G(!0)},className:"bg-header px-2 py-1.5 w-44 rounded-md flex justify-center items-center space-x-2 text-white",children:[(0,k.jsx)(r.OiG,{}),(0,k.jsx)("span",{className:"text-[12px]",children:"Add wfh Request"})]})})]})]}),(0,k.jsx)("div",{className:"bg-[#ffffff] w-full overflow-x-auto mt-1 rounded-xl",children:(0,k.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto",children:[(0,k.jsx)("thead",{children:(0,k.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] bg-header capitalize text-[#ffff] font-[500] h-[40px]",children:[(0,k.jsx)("th",{className:"tableHead w-[5%]",children:"S.No."}),(0,k.jsx)("th",{className:"tableHead",children:"Reason"}),(0,k.jsx)("th",{className:"tableHead",children:"WFH Type"}),(0,k.jsx)("th",{className:"tableHead",children:"Requested days"}),(0,k.jsx)("th",{className:"tableHead",children:"from date"}),(0,k.jsx)("th",{className:"tableHead",children:"to date"}),(0,k.jsx)("th",{className:"tableHead",children:"Requested At"}),(0,k.jsx)("th",{className:"tableHead",children:"approved By"}),(0,k.jsx)("th",{className:"tableHead",children:"approved Date"}),(0,k.jsx)("th",{className:"tableHead",children:"Status"}),(0,k.jsx)("th",{className:"tableHead w-[10%]",children:"Action"})]})}),(0,k.jsx)("tbody",{children:C&&C.length>0?C.map((e,t)=>{var a;return(0,k.jsxs)("tr",{className:"text-black ".concat(t%2===0?"bg-[#e9ecef]/80":"bg-white"," border-b-[1px] border-[#DDDDDD]"),children:[(0,k.jsx)("td",{className:"tableData",children:t+1}),(0,k.jsx)("td",{className:"tableData",children:(null===e||void 0===e?void 0:e.reason)||"N/A"}),(0,k.jsx)("td",{className:"tableData",children:(null===e||void 0===e||null===(a=e.wfhManagerData)||void 0===a?void 0:a.name)||"N/A"}),(0,k.jsx)("td",{className:"tableData",children:p()(null===e||void 0===e?void 0:e.endDate).diff(p()(null===e||void 0===e?void 0:e.startDate),"days")+1}),(0,k.jsx)("td",{className:"tableData",children:p()(null===e||void 0===e?void 0:e.startDate).format("DD-MM-YYYY")}),(0,k.jsx)("td",{className:"tableData",children:p()(null===e||void 0===e?void 0:e.endDate).format("DD-MM-YYYY")}),(0,k.jsx)("td",{className:"tableData",children:g()(null===e||void 0===e?void 0:e.createdAt).format("DD-MM-YYYY hh:mm a")}),(0,k.jsx)("td",{className:"tableData",children:"pending"!==(null===e||void 0===e?void 0:e.status)?(null===e||void 0===e?void 0:e.updatedBy)||"SJC and Saar Group":"-"}),(0,k.jsx)("td",{className:"tableData",children:g()(null===e||void 0===e?void 0:e.updatedAt).format("DD-MM-YYYY hh:mm a")}),(0,k.jsx)("td",{className:"tableData",children:(0,k.jsx)(j.A,{placement:"topLeft",title:"WFH Status - ".concat(null===e||void 0===e?void 0:e.status),children:(0,k.jsx)("span",{className:"".concat("approved"===(null===e||void 0===e?void 0:e.status)?"bg-green-200 border-green-500 text-black":"pending"===(null===e||void 0===e?void 0:e.status)?"bg-yellow-200 border-yellow-500 text-black":"rejected"===(null===e||void 0===e?void 0:e.status)?"bg-red-200 border-red-500 text-black":"bg-gray-200 border-gray-500 text-black"," border-[1px] px-2 py-1.5 rounded-lg text-[12px]"),children:(null===e||void 0===e?void 0:e.status)||"-"})})}),(0,k.jsx)("td",{className:"tableData",children:(0,k.jsx)(b.A,{menu:{items:[{key:"view",label:(0,k.jsxs)("span",{className:"flex items-center text-[#3c8dbc] hover:text-[#337ab7]",children:[(0,k.jsx)(r.Ny1,{className:"mr-2",size:16}),"view Request"]}),onClick:()=>{ue({isOpen:!0,data:e})}},{key:"edit",label:(0,k.jsxs)("span",{className:"flex items-center text-[#3c8dbc] hover:text-[#337ab7]",children:[(0,k.jsx)(r.Jcp,{className:"mr-2",size:16}),"Edit Request"]}),disabled:"pending"!==(null===e||void 0===e?void 0:e.status),onClick:()=>{"pending"===(null===e||void 0===e?void 0:e.status)&&(U(!0),K(null===e||void 0===e?void 0:e._id))}}]},trigger:["click"],children:(0,k.jsx)(j.A,{placement:"topLeft",title:"Actions",children:(0,k.jsx)("button",{className:"px-2 py-1.5 text-xs rounded-md bg-transparent border border-muted",type:"button",children:(0,k.jsx)(D.xWf,{className:"hover:text-[#337ab7] text-[#3c8dbc]",size:16})})})})})]},e._id)}):(0,k.jsx)("tr",{className:"bg-white bg-opacity-5",children:(0,k.jsx)("td",{colSpan:12,className:"px-6 py-2 whitespace-nowrap font-[600] text-sm text-center text-gray-500",children:"Record Not Found"})})})]})}),(0,k.jsx)(x.A,{totalCount:R,pageSize:10,currentPage:E,onChange:e=>{W(e)}}),(0,k.jsx)(q,{isOpen:J,onClose:()=>G(!1),fetchattendanceListData:oe}),(0,k.jsx)(I.A,{isOpen:Q,onClose:()=>{U(!1),K(null)},wfhRequestId:Z,fetchattendanceListData:oe}),(0,k.jsx)(Y.A,{modaldata:ce,handleClose:()=>{ue({isOpen:!1,data:null})}})]})})}}}]);
//# sourceMappingURL=5191.58694b80.chunk.js.map