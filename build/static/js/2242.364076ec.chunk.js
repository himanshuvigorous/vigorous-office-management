"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[2242],{2242:(e,a,t)=>{t.r(a),t.d(a,{default:()=>S});var o=t(89379),n=t(53986),l=t(73216),i=t(83003),s=t(65043),d=(t(30064),t(24858)),r=t(78729),c=t(15187),p=t(60184),h=t(39160),u=t(78227),m=t(735),v=t(96651),x=t(4938),b=t(55971),w=t(86178),j=t.n(w),N=t(58215),k=t(21541),y=t(60446),D=t.n(y),f=t(51371),g=t(16973),C=t(3825),I=t(70579);const A=["date","checkInTime","checkOutTime","timeDurationStart","timeDurationEnd"];const S=function(){const{canCreate:e,canRead:a,canUpdate:t,canDelete:w}=(0,x.A)(),{setValue:y,control:S}=(0,d.mN)(),{userCompanyId:T,userBranchId:Y,userType:M}=(0,m.A)(),{visitorList:O,totalVisitorCount:E,visitorGeneralList:L,loading:V}=(0,i.d4)(e=>e.visitor),{departmentListData:P}=(0,i.d4)(e=>e.department),{branchList:R}=(0,i.d4)(e=>e.branch),_=JSON.parse(localStorage.getItem("user_info_".concat(c.AU))),{employeList:F}=(0,i.d4)(e=>e.employe),z=((0,l.Zp)(),(0,i.wA)()),[H,q]=(0,s.useState)(""),[B,G]=(0,s.useState)({data:null,isOpen:!1}),J=((0,d.FH)({control:S,name:"PDCompanyId",defaultValue:T}),(0,d.FH)({control:S,name:"PDBranchId",defaultValue:Y})),U=(0,d.FH)({control:S,name:"PdDepartmentId",defaultValue:""}),K=(0,d.FH)({control:S,name:"employee",defaultValue:""}),Z=(0,d.FH)({control:S,name:"category",defaultValue:""}),[$,Q]=(0,s.useState)({isOpen:!1,data:null}),[W,X]=(0,s.useState)({}),[ee,ae]=(0,s.useState)(!1),[te,oe]=(0,s.useState)("");(0,s.useEffect)(()=>{"admin"===M&&z((0,r.Ar)({text:"",sort:!0,status:!0,isPagination:!1}))},[]);const[ne,le]=(0,s.useState)(1);(0,s.useEffect)(()=>{"employee"===(null===_||void 0===_?void 0:_.userType)&&ie()},[ne,J,K,U,Z,H]);const ie=()=>{const e={page:ne,limit:10,reqPayload:{companyId:null===_||void 0===_?void 0:_.companyId,directorId:"",branchId:null===_||void 0===_?void 0:_.branchId,employeId:"employee"===(null===_||void 0===_?void 0:_.userType)?null===_||void 0===_?void 0:_._id:null,category:Z,departmentId:U,text:H,sort:!0,status:"",isPagination:!0}};z((0,N.Jc)(e))},se=(e,a)=>{oe(a),ae(!0),X(e)};return"employee"!==(null===_||void 0===_?void 0:_.userType)?(0,I.jsx)(h.A,{children:(0,I.jsx)("div",{className:"bg-red-100 text-red-800 p-4 rounded-md mt-2",children:(0,I.jsx)("p",{className:"text-center font-semibold",children:"You are not an employee. This page is viewable for employees only."})})}):(0,I.jsxs)(h.A,{onChange:e=>{q(e)},children:[(0,I.jsx)("div",{className:"bg-[#ffffff]  w-full overflow-x-auto mt-1 rounded-xl",children:a&&(0,I.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto ",children:[(0,I.jsx)("thead",{className:"",children:(0,I.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] capitalize text-[12px] bg-header text-white font-[500] h-[40px]",children:[(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap w-[8%]",children:"S.no."}),(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Visitor Name"}),(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Category type"}),(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Mobile Number"}),(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Employees"}),(0,I.jsx)("th",{className:"border-none !w-12 p-2 whitespace-nowrap",children:"Reason"}),(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Expected Checkin"}),(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Expected CheckOut"}),(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap w-[20%]",children:"Employee Checkin"}),(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Employee Checkout"}),(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Cashbook Status"}),(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"KM"}),t&&(0,I.jsx)("th",{className:"border-none p-2 whitespace-nowrap w-[8%]",children:"Action"})]})}),V?(0,I.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,I.jsx)("td",{colSpan:10,className:"px-6 py-2 whitespace-nowrap font-[600] text-sm text-gray-500",children:(0,I.jsx)(b.A,{})})}):(0,I.jsx)("tbody",{children:L&&(null===L||void 0===L?void 0:L.length)>0?null===L||void 0===L?void 0:L.map((e,a)=>{var l,i,s,d,r,c,h,u,m,x,b,y,f,g,S,T;return(0,I.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] ".concat(a%2===0?"bg-[#e9ecef]/80":"bg-white"," text-[#374151] text-[14px]"),children:[(0,I.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:a+1+10*(ne-1)}),(0,I.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==(l=null===e||void 0===e?void 0:e.name)&&void 0!==l?l:"-"}),(0,I.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:"client"==(null===e||void 0===e?void 0:e.category)?"Client Visit":"General Visit"}),(0,I.jsx)("td",{className:"whitespace-nowrap border-none p-2",children:(null===e||void 0===e||null===(i=e.mobile)||void 0===i?void 0:i.code)+" "+(null===e||void 0===e||null===(s=e.mobile)||void 0===s?void 0:s.number)||"-"}),(0,I.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:(0,I.jsx)("div",{className:"  ",children:null===e||void 0===e||null===(d=e.employeData)||void 0===d?void 0:d.map((e,a)=>null===e||void 0===e?void 0:e.fullName,[])})}),(0,I.jsx)("td",{className:"whitespace-nowrap border-none p-2 !w-12 ",children:null!==(r=null===e||void 0===e?void 0:e.reason)&&void 0!==r?r:"-"}),(0,I.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==e&&void 0!==e&&e.timeDurationStart?j()(null===e||void 0===e?void 0:e.timeDurationStart).format("DD-MM-YYYY hh:mm a"):"-"}),(0,I.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==e&&void 0!==e&&e.timeDurationEnd?j()(null===e||void 0===e?void 0:e.timeDurationEnd).format("DD-MM-YYYY hh:mm a"):"-"}),(0,I.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:(0,I.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[null!==e&&void 0!==e&&e.checkInTime?j()(null===e||void 0===e?void 0:e.checkInTime).format("DD-MM-YYYY hh:mm a"):(0,I.jsx)(v.A,{placement:"topLeft",title:"Checkin",children:(0,I.jsx)("button",{onClick:()=>{(async e=>{var a,t;const l=await(0,k.Lu)(),i=await(0,k.Aw)(null===l||void 0===l?void 0:l.lat,null===l||void 0===l?void 0:l.lng),{date:s,checkInTime:d,checkOutTime:r,timeDurationStart:c,timeDurationEnd:p}=e,h=(0,n.A)(e,A),u=(0,o.A)((0,o.A)({},h),{},{checkInTime:D()(),checkInLocation:{latitude:null!==(a=null===l||void 0===l?void 0:l.lat)&&void 0!==a?a:0,longitude:null!==(t=l.lng)&&void 0!==t?t:0,address:null!==i&&void 0!==i?i:""}});z((0,N.o2)(u)).then(e=>{e.error||ie()})})(e)},className:"px-2 py-1.5 text-xs rounded-md bg-header text-white border border-muted",type:"button",children:"check in"})}),e.checkInTime?(0,I.jsx)(p.Ny1,{onClick:()=>se(e,"checkin"),className:" hover:text-[#337ab7] text-[#3c8dbc]",size:14}):""]})}),(0,I.jsx)("td",{className:"whitespace-nowrap border-none p-2",children:(0,I.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[null!==e&&void 0!==e&&e.checkInTime?null!==e&&void 0!==e&&e.checkOutTime?j()(e.checkOutTime).format("DD-MM-YYYY hh:mm a"):(0,I.jsx)(v.A,{placement:"topLeft",title:"Checkout",children:(0,I.jsx)("button",{onClick:()=>(e=>{G({data:e,isOpen:!0})})(e),className:"px-2 py-1.5 text-xs rounded-md bg-header text-white border border-muted",type:"button",children:"Check Out"})}):"-",e.checkOutTime?(0,I.jsx)(p.Ny1,{onClick:()=>se(e,"checkout"),className:" hover:text-[#337ab7] text-[#3c8dbc]",size:14}):""]})}),(0,I.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==e&&void 0!==e&&null!==(c=e.cashbookData)&&void 0!==c&&c._id?"Pending"===(null===e||void 0===e||null===(h=e.cashbookData)||void 0===h?void 0:h.status)?"Cashbook Requested":"Approved"===(null===e||void 0===e||null===(u=e.cashbookData)||void 0===u?void 0:u.status)?"Claimed":"Reject"===(null===e||void 0===e||null===(m=e.cashbookData)||void 0===m?void 0:m.status)?"Claim Rejected":"-":"Not Claimed"}),(0,I.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==(x=null===e||void 0===e?void 0:e.kilometer)&&void 0!==x?x:"-"}),(w||t)&&(0,I.jsx)("td",{className:"whitespace-nowrap border-none p-2",children:(0,I.jsx)("span",{className:"py-1.5 flex justify-start items-center space-x-2",children:t&&(0,I.jsx)(v.A,{placement:"topLeft",title:null!==e&&void 0!==e&&null!==(b=e.cashbookData)&&void 0!==b&&b._id?"Pending"===(null===e||void 0===e||null===(y=e.cashbookData)||void 0===y?void 0:y.status)?"Cashbook Requested":"Approved"===(null===e||void 0===e||null===(f=e.cashbookData)||void 0===f?void 0:f.status)?"Claimed":"Reject"===(null===e||void 0===e||null===(g=e.cashbookData)||void 0===g?void 0:g.status)?"Claim Rejected":"-":"Claim Cashbook",children:(0,I.jsx)("button",{disabled:null===e||void 0===e||null===(S=e.cashbookData)||void 0===S?void 0:S._id,onClick:()=>Q({isOpen:!0,data:e}),className:"px-2 py-1.5 text-xs rounded-md bg-transparent border border-muted",type:"button",children:(0,I.jsx)(C.p9$,{className:null!==e&&void 0!==e&&null!==(T=e.cashbookData)&&void 0!==T&&T._id?" text-gray-500":" hover:text-[#337ab7] text-[#3c8dbc]",size:16})})})})})]})}):(0,I.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,I.jsx)("td",{colSpan:4,className:"px-6 py-2 whitespace-nowrap font-[600] text-sm text-gray-500",children:"Record Not Found"})})})]})}),(0,I.jsx)(g.A,{visible:$,onCancel:()=>Q({isOpen:!1,data:null}),onSuccess:ie}),(0,I.jsx)(k.Ay,{setVisitorModal:G,visitorModal:B,updateList:ie}),(0,I.jsx)(f.A,{empDetailModalData:W,empCheckInDetailModalOpen:ee,checkIn:te,setEmpCheckinDetailModalOpen:ae}),(null===L||void 0===L?void 0:L.length)>0&&(0,I.jsx)(u.A,{totalCount:E,pageSize:10,currentPage:ne,onChange:e=>{le(e)}})]})}}}]);
//# sourceMappingURL=2242.364076ec.chunk.js.map