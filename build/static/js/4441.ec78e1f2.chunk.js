"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[4441],{4441:(e,t,a)=>{a.r(t),a.d(t,{default:()=>O});var s=a(89379),l=a(65043),n=a(39160),r=a(73216),d=a(83003),i=a(23156),c=a(60184),o=a(78227),m=a(86178),u=a.n(m),h=a(15187),x=a(32256),p=a(60446),f=a.n(p),v=a(65512),j=a(96651),b=a(24858),N=(a(42837),a(78729),a(33007),a(31744),a(53913)),y=a(30064),g=a.n(y),D=a(94084),S=a(17995),I=a(57916),A=a(59e3),k=a(70579);const w=e=>{var t;let{isOpen:a,onClose:n,fetchattendanceListData:r}=e;const i=null===(t=JSON.parse(localStorage.getItem("user_info_".concat(h.AU))))||void 0===t?void 0:t.onboardingId,{loading:c}=(0,d.d4)(e=>e.attendance),o=v.A.Option,{timeSlotsListData:m}=(0,d.d4)(e=>e.timeSlots),{onBoardingDetailsData:p}=(0,d.d4)(e=>e.onBoarding),{register:j,handleSubmit:y,control:w,setValue:H,reset:T,watch:O,formState:{errors:Y}}=(0,b.mN)({defaultValues:{employeeName:"",date:"",checkInTime:"",checkOutTime:"",reason:"",errors:{}}});(0,l.useEffect)(()=>{_()},[]);const C=JSON.parse(localStorage.getItem("user_info_".concat(h.AU))),M=(0,d.wA)(),_=()=>{M((0,I.iU)({directorId:"",companyId:null===C||void 0===C?void 0:C.companyId,branchId:null===C||void 0===C?void 0:C.branchId,text:"",sort:!0,status:"",isPagination:!1})).then(e=>{null!==e&&void 0!==e&&e.error||M((0,A.Og)({_id:i})).then(e=>{var t,a;null!==e&&void 0!==e&&e.error||H("employeeName",null===e||void 0===e||null===(t=e.payload)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.employeeName)})}),H("shift",null===p||void 0===p?void 0:p.shift)};return a?(0,k.jsx)(N.A,{visible:a,onCancel:()=>{n(),T()},footer:null,className:"antmodalclassName",title:"Manual Attendence",width:600,height:400,children:(0,k.jsx)("div",{children:(0,k.jsxs)("form",{autoComplete:"off",onSubmit:y(e=>{const t={employeId:"employee"===(null===C||void 0===C?void 0:C.userType)?null===C||void 0===C?void 0:C._id:null===e||void 0===e?void 0:e.employeeId,companyId:null===C||void 0===C?void 0:C.companyId,branchId:null===C||void 0===C?void 0:C.branchId,directorId:null===C||void 0===C?void 0:C.directorId,attendanceDate:f()(e.checkInTime).format("YYYY-MM-DD"),checkInTime:null!==e&&void 0!==e&&e.checkInTime?null===e||void 0===e?void 0:e.checkInTime:null,checkOutTime:e.checkOutTime?null===e||void 0===e?void 0:e.checkOutTime:null,method:"employeReq",reason:e.reason,employeeName:null===C||void 0===C?void 0:C.fullName,shift:e.shift};M((0,x.xn)(t)).then(e=>{e.error||(g().fire({icon:"success",title:"Success!",text:"Attendance record has been created successfully.",confirmButtonText:"OK",customClass:{confirmButton:"bg-header text-white hover:bg-[#063156]"}}),r(),n())})}),className:"",children:[(0,k.jsxs)("div",{className:"grid grid-col-1 md:grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsxs)("label",{className:"".concat(h.Q0),children:["Check-in Time ",(0,k.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,k.jsx)(b.xI,{name:"checkInTime",control:w,rules:{required:!0},render:e=>{let{field:t}=e;return(0,k.jsx)(D.A,{field:t,showTime:!0,format:"DD/MM/YYYY HH:mm",errors:Y,disabledDate:e=>{const t=u()();return e&&(e.isAfter(t,"day")||!e.isSame(t,"month"))}})}}),Y.checkInTime&&(0,k.jsx)("p",{className:"text-red-500 text-sm",children:"Check-in time is required"})]}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("label",{className:"".concat(h.Q0),children:["Check-out Time ",(0,k.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,k.jsx)(b.xI,{name:"checkOutTime",control:w,rules:{required:!0},render:e=>{let{field:t}=e;return(0,k.jsx)(D.A,{field:t,showTime:!0,format:"DD/MM/YYYY HH:mm",errors:Y,disabledDate:e=>{const t=O("checkInTime");if(!t)return!0;const a=f()(t).startOf("day"),s=a.add(1,"day");return!e.isSame(a,"day")&&!e.isSame(s,"day")}})}}),Y.checkOutTime&&(0,k.jsx)("p",{className:"text-red-500 text-sm",children:"Check-out time is required"})]}),(0,k.jsxs)("div",{className:"",children:[(0,k.jsxs)("label",{className:"".concat(h.Q0),children:["Select Shift ",(0,k.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,k.jsx)(b.xI,{name:"shift",control:w,rules:{required:"Shift is required"},render:e=>{let{field:t}=e;return(0,k.jsxs)(v.A,(0,s.A)((0,s.A)({},t),{},{className:"".concat(h.Hy," ").concat(Y.shift?"":"border-gray-300"),placeholder:"Select Shift",showSearch:!0,getPopupContainer:()=>document.body,dropdownStyle:{zIndex:2e3},filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,k.jsx)(o,{value:"",children:"Select Shift"}),null===m||void 0===m?void 0:m.map(e=>(0,k.jsx)(o,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.shiftName},null===e||void 0===e?void 0:e._id))]}))}}),Y.shift&&(0,k.jsx)("p",{className:"text-red-500 text-sm",children:Y.shift.message})]}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("label",{className:"".concat(h.Q0),children:["Reason ",(0,k.jsx)("span",{className:"text-red-600",children:"* "})]}),(0,k.jsx)("input",(0,s.A)((0,s.A)({type:"text"},j("reason",{required:!0})),{},{className:"".concat(h.Ol," ").concat(Y.reason?"border-[1px] ":"border-gray-300"),rows:"3"})),Y.reason&&(0,k.jsx)("p",{className:"text-red-500 text-sm",children:"Reason is required"})]})]}),(0,k.jsx)("div",{className:"flex justify-end space-x-2 mt-4",children:(0,k.jsx)("button",{type:"submit",disabled:c,className:"".concat(c?"bg-gray-400":"bg-header"," text-white p-2 px-4 rounded"),children:c?(0,k.jsx)(S.A,{}):"Submit"})})]})})}):null};var H=a(4938),T=a(89427);const O=function(){(0,r.Zp)();const e=(0,d.wA)(),{attendanceListForEmployee:t,totalattendancegCountForEmployee:a,loading:m}=(0,d.d4)(e=>e.attendance),p=JSON.parse(localStorage.getItem("user_info_".concat(h.AU))),[N,y]=(0,l.useState)(1),[g,S]=(0,l.useState)(""),[I,A]=(0,l.useState)(g),[O,Y]=(0,l.useState)(!1),{control:C,setValue:M,formState:{errors:_}}=(0,b.mN)(),P=(0,b.FH)({control:C,name:"startDate",defaultValue:""}),F=(0,b.FH)({control:C,name:"endDate",defaultValue:""}),V=(0,b.FH)({control:C,name:"status",defaultValue:["present"]});(0,l.useEffect)(()=>{const e=setTimeout(()=>{A(g)},500);return()=>{clearTimeout(e)}},[g]);const[q,B]=(0,l.useState)("");(0,l.useEffect)(()=>{"employee"===(null===p||void 0===p?void 0:p.userType)&&null!==p&&void 0!==p&&p._id&&R(I)},[N,I,q,V,P,F]);const R=()=>{var t,a;let s={currentPage:N,pageSize:30,reqPayload:{shift:"",workType:"",text:q,status:"",isPresentDay:V||"",sort:!0,startDate:P?null===(t=f()(P))||void 0===t?void 0:t.format("YYYY-MM-DD"):null,endDate:F?null===(a=f()(F))||void 0===a?void 0:a.format("YYYY-MM-DD"):null,isPagination:!0,companyId:"company"===(null===p||void 0===p?void 0:p.userType)?null===p||void 0===p?void 0:p._id:null===p||void 0===p?void 0:p.companyId,branchId:"companyBranch"===(null===p||void 0===p?void 0:p.userType)?null===p||void 0===p?void 0:p._id:null===p||void 0===p?void 0:p.branchId,employeId:"employee"===(null===p||void 0===p?void 0:p.userType)?null===p||void 0===p?void 0:p._id:null}};e((0,x.XI)(s))},{canCreate:E,canRead:L,canUpdate:z,canDelete:U}=(0,H.A)(),[Q,Z]=(0,l.useState)([]);(0,l.useEffect)(()=>{t&&J()},[t]);const J=(e,a)=>{const s=(0,h.Hc)(e,a,t);Z(s)};return"employee"!==(null===p||void 0===p?void 0:p.userType)?(0,k.jsx)(n.A,{children:(0,k.jsx)("div",{className:"bg-red-100 text-red-800 p-4 rounded-md mt-2",children:(0,k.jsx)("p",{className:"text-center font-semibold",children:"You are not an employee. This page is viewable for employees only."})})}):(0,k.jsx)(n.A,{onChange:e=>{B(e)},children:(0,k.jsxs)("div",{className:"bg-grey-100 w-full p-1 mt-3",children:[(0,k.jsxs)("div",{className:"",children:[(0,k.jsx)("div",{className:"xl:flex justify-between items-center md:space-y-0 space-y-1.5 py-1",children:(0,k.jsxs)("div",{className:"sm:flex justify-start items-center sm:space-x-2 space-x-0 sm:space-y-0 space-y-1.5",children:[(0,k.jsx)("div",{children:(0,k.jsx)(b.xI,{name:"startDate",control:C,render:e=>{let{field:t}=e;return(0,k.jsx)(D.A,{report:!0,defaultValue:f()().subtract(1,"month"),size:"middle",field:t,errors:_})}})}),(0,k.jsx)(b.xI,{name:"status",control:C,rules:{},render:e=>{let{field:t}=e;return(0,k.jsxs)(v.A,(0,s.A)((0,s.A)({},t),{},{mode:"multiple",className:" inputAntdMultiSelectClassNameFilterReport ".concat(_.PDPlan?"border-[1px] ":"border-gray-300"),placeholder:"Select Status",defaultValue:"present",showSearch:!0,children:[(0,k.jsx)(v.A.Option,{value:"",children:"Select Status"}),(0,k.jsx)(v.A.Option,{value:"present",children:" Present "}),(0,k.jsxs)(v.A.Option,{value:"firstHalf",children:[" ","First Half"," "]}),(0,k.jsxs)(v.A.Option,{value:"secondHalf",children:[" ","Second Half"," "]}),(0,k.jsxs)(v.A.Option,{value:"leave",children:[" ","Leave"," "]}),(0,k.jsxs)(v.A.Option,{value:"absent",children:[" ","Absent"," "]}),(0,k.jsxs)(v.A.Option,{value:"off",children:[" ","OFF"," "]}),(0,k.jsxs)(v.A.Option,{value:"holiday",children:[" ","holiday"," "]})]}))}}),(0,k.jsx)("div",{children:(0,k.jsx)(b.xI,{name:"endDate",control:C,render:e=>{let{field:t}=e;return(0,k.jsx)(D.A,{report:!0,defaultValue:f()(),size:"middle",field:t,errors:_})}})})]})}),(0,k.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,k.jsx)("button",{onClick:()=>{M("PDBranchId",""),M("PdCompanyId",""),M("status",["present"]),M("isVerified",""),M("startDate",f()()),M("endDate",f()())},className:"bg-header py-[5px] rounded-md flex px-5 justify-center items-center  text-white",children:(0,k.jsx)("span",{className:"text-[12px]",children:"Reset"})}),E&&(0,k.jsx)(j.A,{placement:"topLeft",title:"Add Manual Attendence",children:(0,k.jsxs)("button",{onClick:()=>Y(!0),className:"bg-header px-2 py-1.5 rounded-md flex justify-center items-center space-x-2 text-white",children:[(0,k.jsx)(i.OiG,{}),(0,k.jsx)("span",{className:"text-[12px]",children:"Manual Attendance"})]})})]})]}),(0,k.jsx)("div",{className:"bg-[#ffffff]  w-full overflow-x-auto mt-1 rounded-xl",children:L&&(0,k.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto",children:[(0,k.jsx)("thead",{children:(0,k.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] capitalize bg-header text-white font-[500] h-[40px]",children:[(0,k.jsx)("th",{className:"tableHead w-[5%]",children:"S.No."}),(0,k.jsx)("th",{className:"tableHead ",children:(0,k.jsxs)("div",{className:"flex justify-start items-center gap-1",children:["Attendance Date",(0,k.jsxs)("div",{className:"flex flex-col -space-y-1.5 cursor-pointer",children:[(0,k.jsx)(c.Odn,{onClick:()=>J("attendanceDate","asc")}),(0,k.jsx)(c.BNo,{onClick:()=>J("attendanceDate","desc")})]})]})}),(0,k.jsx)("th",{className:"tableHead",children:(0,k.jsxs)("div",{className:"flex gap-1",children:["Check-In Time",(0,k.jsxs)("div",{className:"flex flex-col -space-y-1.5 cursor-pointer",children:[(0,k.jsx)(c.Odn,{onClick:()=>J("checkInTime","asc")}),(0,k.jsx)(c.BNo,{onClick:()=>J("checkInTime","desc")})]})]})}),(0,k.jsx)("th",{className:"tableHead",children:(0,k.jsxs)("div",{className:"flex gap-1",children:["Check-Out Time",(0,k.jsxs)("div",{className:"flex flex-col -space-y-1.5 cursor-pointer",children:[(0,k.jsx)(c.Odn,{onClick:()=>J("checkOutTime","asc")}),(0,k.jsx)(c.BNo,{onClick:()=>J("checkOutTime","desc")})]})]})}),(0,k.jsx)("th",{className:"tableHead",children:(0,k.jsx)("div",{className:"flex gap-1",children:"Worked Hours (HH:MM)"})}),(0,k.jsx)("th",{className:"tableHead",children:"Pending Hours (HH:MM)"}),(0,k.jsx)("th",{className:"tableHead",children:"Overtime Hours (HH:MM)"}),(0,k.jsx)("th",{className:"tableHead",children:"Is WFH"}),(0,k.jsx)("th",{className:"tableHead",children:"Status"}),(0,k.jsx)("th",{className:"tableHead",children:"Is Verified"})]})}),m?(0,k.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,k.jsx)("td",{colSpan:10,className:"px-6 py-2 whitespace-nowrap text-center font-[600] text-sm text-gray-500",children:(0,k.jsx)(T.A,{})})}):(0,k.jsx)("tbody",{children:Q&&(null===Q||void 0===Q?void 0:Q.length)>0?null===Q||void 0===Q?void 0:Q.map((e,t)=>(0,k.jsxs)("tr",{className:"border-b-[1px] ".concat(t%2===0?"bg-[#e9ecef]/80":"bg-white"," border-[#DDDDDD] text-[#374151]"),children:[(0,k.jsx)("td",{className:"tableData",children:t+1+30*(N-1)}),(0,k.jsx)("td",{className:"tableData",children:u()(e.attendanceDate).format("DD-MM-YYYY")}),(0,k.jsx)("td",{className:"tableData",children:e.checkInTime?f()(e.checkInTime).format("DD-MM-YYYY hh:mm A"):"-"}),(0,k.jsx)("td",{className:"tableData",children:e.checkOutTime?f()(e.checkOutTime).format("DD-MM-YYYY hh:mm A"):"-"}),(0,k.jsx)("td",{className:"tableData",children:(0,h.bZ)(e.workedHRS)}),(0,k.jsx)("td",{className:"tableData",children:(0,h.bZ)(e.pendingHRS)}),(0,k.jsx)("td",{className:"tableData",children:(0,h.bZ)(e.overtimeHRS)}),(0,k.jsx)("td",{className:"tableData",children:e.isWFHapplied?"Yes":"No"}),(0,k.jsx)("td",{className:"tableData",children:(0,k.jsx)("span",{className:(()=>{switch(e.isPresentDay){case"present":return"bg-[#E0FFBE] border-green-500";case"absent":return"bg-red-200 border-red-500";case"leave":return"bg-yellow-300 border-yellow-500";case"off":return"bg-gray-300 border-gray-500";case"holiday":return"bg-blue-200 border-blue-500";case"firstHalf":return"bg-orange-200 border-orange-500";case"secondHalf":return"bg-purple-200 border-purple-500";default:return"bg-white border-gray-400"}})()+" border-[1px] px-2 py-1.5 rounded-lg text-black text-[12px] capitalize",children:e.isPresentDay})}),(0,k.jsx)("td",{className:"tableData",children:e.status?"Yes":"No"})]})):(0,k.jsx)("tr",{className:"bg-white bg-opacity-5",children:(0,k.jsx)("td",{colSpan:15,className:"px-6 py-2 whitespace-nowrap font-[600] text-sm text-gray-500",children:"Record Not Found"})})})]})}),(0,k.jsx)(o.A,{totalCount:a,pageSize:30,currentPage:N,onChange:e=>{y(e)}}),O&&(0,k.jsx)(w,{isOpen:!0,onClose:()=>Y(!1),fetchattendanceListData:R})]})})}}}]);
//# sourceMappingURL=4441.ec78e1f2.chunk.js.map