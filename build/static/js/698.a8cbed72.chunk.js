"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[698],{70698:(e,t,n)=>{n.r(t),n.d(t,{default:()=>O});var l=n(89379),i=n(24858),o=n(83003),a=n(15187),d=n(65043),r=n(31744),s=n(39160),c=n(97326),u=n(53913),p=n(65512),v=(n(86178),n(60446)),m=n.n(v),h=n(78227),x=n(12106),y=(n(42837),n(94084),n(69223)),f=n(55971),j=n(50822),g=n(6720),w=n(37762),N=n(64857),b=(n(11906),n(33007)),A=n(89427),D=(n(70337),n(40088),n(12208)),S=n(60184),C=n(27744),I=n(17995),T=n(76932),F=n(70579);const O=function(){var e,t,n,v;const{control:O,formState:{errors:P},setValue:_,watch:L}=(0,i.mN)(),[z,B]=(0,d.useState)(10),R=(0,o.wA)(),{clientServiceReportList:k,clientServiceReportFunc_loading:Y,clientServiceReportCount:V}=(0,o.d4)(e=>e.reports),{departmentListData:E,loading:H}=(0,o.d4)(e=>e.department),[M,U]=(0,d.useState)({}),{taskTypeList:q}=(0,o.d4)(e=>e.taskType),{clientGroupList:G,groupSearchLoading:K}=(0,o.d4)(e=>e.clientGroup),{clientList:W}=(0,o.d4)(e=>e.client),{employeList:J}=(0,o.d4)(e=>e.employe),[X,Q]=(0,d.useState)(""),Z=JSON.parse(localStorage.getItem("user_info_".concat(a.AU))),{industryListData:$,indusSearchloading:ee}=(0,o.d4)(e=>e.industry),{orgTypeList:te,orgSearchloading:ne}=(0,o.d4)(e=>e.orgType),[le,ie]=(0,d.useState)(1),[oe,ae]=(0,d.useState)(""),{branchList:de}=(0,o.d4)(e=>e.branch),re=(0,i.FH)({control:O,name:"PDCompanyId",defaultValue:""}),se=(0,i.FH)({control:O,name:"PDBranchId",defaultValue:""}),ce=(0,i.FH)({control:O,name:"status",defaultValue:""}),ue=(0,i.FH)({control:O,name:"PDOrganizationType",defaultValue:""}),pe=(0,i.FH)({control:O,name:"PDindustrytype",defaultValue:""}),ve=(0,i.FH)({control:O,name:"department",defaultValue:""}),me=(0,i.FH)({control:O,name:"groupName",defaultValue:""});(0,d.useEffect)(()=>{const e=setTimeout(()=>{ae(X)},500);return()=>{clearTimeout(e)}},[X]),(()=>{const e=[];for(let t=2005;t<=2034;t++)e.push("".concat(t,"-").concat(t+1))})();const he=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return{currentPage:le,pageSize:z,reqPayload:{text:oe,sort:!0,isPagination:e,companyId:"admin"===(null===Z||void 0===Z?void 0:Z.userType)?re:"company"===(null===Z||void 0===Z?void 0:Z.userType)?null===Z||void 0===Z?void 0:Z._id:null===Z||void 0===Z?void 0:Z.companyId,directorId:"",branchId:"company"===(null===Z||void 0===Z?void 0:Z.userType)||"admin"===(null===Z||void 0===Z?void 0:Z.userType)||"companyDirector"===(null===Z||void 0===Z?void 0:Z.userType)?se:"companyBranch"===(null===Z||void 0===Z?void 0:Z.userType)?null===Z||void 0===Z?void 0:Z._id:null===Z||void 0===Z?void 0:Z.branchId,status:"true"==ce||"false"!=ce&&"",organizationId:ue,organizationIds:[],departmentId:ve,departmentIds:[],industryId:pe,industryIds:[],groupId:me,groupIds:[],text:"",sort:!0,isPagination:e}}};(0,d.useEffect)(()=>{xe(oe)},[le,oe,z]);const xe=()=>{R((0,x.zx)(he(!0)))},[ye,fe]=(0,d.useState)(!1);(0,d.useEffect)(()=>{"company"!==(null===Z||void 0===Z?void 0:Z.userType)&&"companyDirector"!==(null===Z||void 0===Z?void 0:Z.userType)||R((0,r.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===Z||void 0===Z?void 0:Z.userType)?re:"company"===(null===Z||void 0===Z?void 0:Z.userType)?null===Z||void 0===Z?void 0:Z._id:null===Z||void 0===Z?void 0:Z.companyId})),_("startDate",m()().subtract(1,"month")),_("endDate",m()())},[]);const je=async()=>{xe()},ge=[{key:"1",label:(0,F.jsx)("span",{className:"text-white",children:"Advance Filters"}),children:(0,F.jsxs)("div",{className:"bg-[#ececec] space-y-1 2xl:flex justify-between items-center",children:[(0,F.jsxs)("div",{className:"sm:flex  grid grid-cols-1 gap-1.5 sm:flex-wrap text-[14px]",children:[("admin"===(null===Z||void 0===Z?void 0:Z.userType)||"company"===(null===Z||void 0===Z?void 0:Z.userType)||"companyDirector"===(null===Z||void 0===Z?void 0:Z.userType))&&(0,F.jsxs)("div",{className:"",children:[(0,F.jsx)(i.xI,{name:"PDBranchId",control:O,render:e=>{let{field:t}=e;return(0,F.jsxs)(p.A,(0,l.A)((0,l.A)({},t),{},{className:"inputAntdSelectClassNameFilterReport ",placeholder:"Select Branch",showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,F.jsx)(p.A.Option,{value:"",children:"Select Branch"}),null===de||void 0===de?void 0:de.map(e=>(0,F.jsxs)(p.A.Option,{value:null===e||void 0===e?void 0:e._id,children:[" ",null===e||void 0===e?void 0:e.fullName," "]}))]}))}}),P.PDBranchId&&(0,F.jsx)("p",{className:"text-red-500 text-sm",children:P.PDBranchId.message})]}),(0,F.jsx)("div",{children:(0,F.jsx)(i.xI,{control:O,name:"PDOrganizationType",rules:{required:"Organization is required"},render:e=>{let{field:t}=e;return(0,F.jsxs)(p.A,(0,l.A)((0,l.A)({},t),{},{defaultValue:"",className:"inputAntdSelectClassNameFilterReport ",showSearch:!0,onFocus:()=>{null!==te&&void 0!==te&&te.length||R((0,C.XX)({isPagination:!1,text:"",sort:!0,status:!0}))},filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,F.jsx)(p.A.Option,{value:"",children:"Select Organization Type"}),ne?(0,F.jsx)(p.A.Option,{disabled:!0,children:(0,F.jsx)(A.A,{})}):null===te||void 0===te?void 0:te.map(e=>(0,F.jsx)(p.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.name},null===e||void 0===e?void 0:e._id))]}))}})}),(0,F.jsx)("div",{children:(0,F.jsx)(i.xI,{control:O,name:"PDindustrytype",rules:{required:"Industry type is required"},render:e=>{let{field:t}=e;return(0,F.jsxs)(p.A,(0,l.A)((0,l.A)({},t),{},{defaultValue:"",onFocus:()=>{R((0,T.UM)({isPagination:!1,text:"",sort:!0,status:!0}))},showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),className:"inputAntdSelectClassNameFilterReport ",children:[(0,F.jsx)(p.A.Option,{value:"",children:" Select Industry Type"}),ee?(0,F.jsx)(p.A.Option,{disabled:!0,children:(0,F.jsx)(I.A,{})}):null===$||void 0===$?void 0:$.map(e=>(0,F.jsx)(p.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.name},null===e||void 0===e?void 0:e._id))]}))}})}),(0,F.jsx)("div",{children:(0,F.jsx)(i.xI,{name:"department",control:O,render:e=>{var t;let{field:n}=e;return(0,F.jsxs)(p.A,(0,l.A)((0,l.A)({},n),{},{className:"inputAntdSelectClassNameFilterReport",showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),onFocus:()=>{R((0,b.UU)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===Z||void 0===Z?void 0:Z.userType)?re:"company"===(null===Z||void 0===Z?void 0:Z.userType)?null===Z||void 0===Z?void 0:Z._id:null===Z||void 0===Z?void 0:Z.companyId,branchId:["admin","company","companyDirector"].includes(null===Z||void 0===Z?void 0:Z.userType)?se:"companyBranch"===(null===Z||void 0===Z?void 0:Z.userType)?null===Z||void 0===Z?void 0:Z._id:null===Z||void 0===Z?void 0:Z.branchId}))},onChange:e=>{n.onChange(e)},placeholder:"Select Department",children:[(0,F.jsx)(p.A.Option,{value:"",children:"Select Department"}),H?(0,F.jsx)(p.A.Option,{disabled:!0,children:(0,F.jsx)(A.A,{})}):null===(t=(0,a._o)(E))||void 0===t?void 0:t.map(e=>(0,F.jsx)(p.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.name},null===e||void 0===e?void 0:e._id))]}))}})}),(0,F.jsx)("div",{className:"",children:(0,F.jsx)(i.xI,{name:"groupName",control:O,render:e=>{var t;let{field:n}=e;return(0,F.jsxs)(p.A,(0,l.A)((0,l.A)({},n),{},{className:"inputAntdSelectClassNameFilterReport",showSearch:!0,placeholder:"Select Group",onFocus:()=>{R((0,D.J_)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===Z||void 0===Z?void 0:Z.userType)?re:"company"===(null===Z||void 0===Z?void 0:Z.userType)?null===Z||void 0===Z?void 0:Z._id:null===Z||void 0===Z?void 0:Z.companyId,branchId:["admin","company","companyDirector"].includes(null===Z||void 0===Z?void 0:Z.userType)?se:"companyBranch"===(null===Z||void 0===Z?void 0:Z.userType)?null===Z||void 0===Z?void 0:Z._id:null===Z||void 0===Z?void 0:Z.branchId,groupId:""}))},onChange:e=>n.onChange(e),filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,F.jsx)(p.A.Option,{value:"",children:"Select Group"}),K?(0,F.jsx)(p.A.Option,{disabled:!0,children:(0,F.jsx)(A.A,{})}):null===(t=(0,a._o)(G))||void 0===t?void 0:t.map(e=>(0,F.jsxs)(p.A.Option,{value:null===e||void 0===e?void 0:e._id,children:[null===e||void 0===e?void 0:e.fullName," (",null===e||void 0===e?void 0:e.groupName,")"]},null===e||void 0===e?void 0:e._id))]}))}})})]}),(0,F.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,F.jsx)("button",{onClick:()=>{_("PDCompanyId",""),_("PDBranchId",""),_("status",""),_("PDOrganizationType",""),_("PDindustrytype",""),_("department",""),_("groupName",""),je()},className:"bg-header py-2 my-0.5 rounded-md flex px-10 justify-center items-center text-white",children:(0,F.jsx)("span",{className:"text-[12px]",children:"Reset"})}),(0,F.jsx)("button",{onClick:()=>{je()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,F.jsx)("span",{className:"text-[12px]",children:"Submit"})})]})]})}];return(0,F.jsx)(s.A,{onChange:e=>{Q(e)},children:(0,F.jsxs)("div",{className:"bg-grey-100 w-full p-1",children:[(0,F.jsxs)("div",{className:"",children:[(0,F.jsx)(c.A,{className:"custom-collapse",items:ge,defaultActiveKey:[1],expandIcon:e=>{let{isActive:t}=e;return(0,F.jsx)(g.WnU,{size:20,style:{color:"white",transform:t?"rotate(-90deg)":"rotate(0deg)",transition:"transform 0.3s ease"}})}}),(0,F.jsx)("div",{className:"space-y-1.5 flex justify-between items-center pt-1",children:(0,F.jsxs)("div",{className:"flex items-center gap-2",children:[(0,F.jsx)("span",{htmlFor:"pageSize",className:"text-sm font-light text-gray-500",children:"Rows per page:"}),(0,F.jsx)(p.A,{id:"pageSize",value:z,onChange:e=>{B(Number(e)),ie(Number(1))},className:"text-sm font-light text-gray-700 bg-white border border-gray-200 rounded-md px-3 py-1.5 shadow-sm focus:outline-none focus:ring-1 focus:ring-gray-300 transition",children:a.qc.map(e=>(0,F.jsx)(p.A.Option,{value:e,children:e},e))})]})})]}),(0,F.jsxs)("div",{className:"bg-[#ffffff]  w-full overflow-x-auto mt-1 rounded-xl",children:[(0,F.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto",children:[(0,F.jsx)("thead",{children:(0,F.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] capitalize text-[12px] bg-header text-white font-[500] h-[40px]",children:[(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap  w-[5%]",children:"S.No."}),(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Group Name"}),(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Client Name"}),(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"List of Services"})]})}),Y?(0,F.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,F.jsx)("td",{colSpan:15,className:"px-6 py-2 whitespace-nowrap  font-[600] text-sm text-gray-500",children:(0,F.jsx)(f.A,{})})}):(0,F.jsx)("tbody",{children:k&&(null===k||void 0===k?void 0:k.length)>0?null===k||void 0===k?void 0:k.map((e,t)=>{var n;return(0,F.jsxs)("tr",{className:"border-b-[1px] ".concat(t%2===0?"bg-[#e9ecef]/80":"bg-white"," border-[#DDDDDD] text-[#374151] text-[14px]"),children:[(0,F.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:t+1+(le-1)*z}),(0,F.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:null===e||void 0===e?void 0:e.groupName}),(0,F.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:null===e||void 0===e?void 0:e.fullName}),(0,F.jsx)("td",{className:"tableData ",children:(0,F.jsxs)("div",{className:"flex justify-center items-center gap-1",children:[(0,F.jsx)("span",{children:null===e||void 0===e||null===(n=e.departmentData)||void 0===n?void 0:n.length}),(0,F.jsx)("span",{className:"flex justify-center items-center cursor-pointer",children:(0,F.jsx)(S.Ny1,{onClick:()=>(e=>{fe(!0),U(e)})(e),className:" hover:text-[#337ab7] text-[#3c8dbc]",size:14})})]})||"-"})]})}):(0,F.jsx)("tr",{className:"bg-white bg-opacity-5",children:(0,F.jsx)("td",{colSpan:15,className:"px-6 py-2 whitespace-nowrap  font-[600] text-sm text-gray-500",children:"Record Not Found"})})})]}),(0,F.jsxs)(u.A,{className:"antmodalclassName !w-[60%] !h-[50%]",title:"Client / ".concat(null===M||void 0===M?void 0:M.fullName," "),open:ye,onCancel:()=>fe(!1),footer:null,children:[(0,F.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,F.jsxs)("div",{children:[null!==(e=null===M||void 0===M?void 0:M.email)&&void 0!==e?e:"-"," / ",(null===M||void 0===M||null===(t=M.mobile)||void 0===t?void 0:t.code)+(null===M||void 0===M||null===(n=M.mobile)||void 0===n?void 0:n.number)]})}),(0,F.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,F.jsx)("button",{onClick:()=>{(async()=>{var e,t,n,l;const i=new w.uE({orientation:"landscape",unit:"pt"});i.setFontSize(16),i.text("Client  - ".concat(null===M||void 0===M?void 0:M.fullName),40,40),i.text("".concat(null!==(e=null===M||void 0===M?void 0:M.email)&&void 0!==e?e:"-"," / ").concat((null===M||void 0===M||null===(t=M.mobile)||void 0===t?void 0:t.code)+(null===M||void 0===M||null===(n=M.mobile)||void 0===n?void 0:n.number)),40,60);const o=await(null===j.K||void 0===j.K?void 0:j.K.clientServiceReportFunc(he(!1)));if(!k&&!o)return;const a=null===M||void 0===M||null===(l=M.servicesData)||void 0===l?void 0:l.map((e,t)=>[t+1,(null===e||void 0===e?void 0:e.name)||"N/A",(null===e||void 0===e?void 0:e.createdBy)||"N/A",m()(null===e||void 0===e?void 0:e.createdAt).format("DD-MM-YYYY hh:mm")||"N/A"]);(0,N.Ay)(i,{startY:70,head:[["S.No.","Service Name","Created At","Created By"]],body:a,margin:{horizontal:10},styles:{cellPadding:8,fontSize:10,valign:"middle",halign:"left"},headStyles:{fillColor:[211,211,211],textColor:[0,0,0],fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]}}),i.save("ClientServiceReport.pdf")})()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,F.jsx)("span",{className:"text-[12px]",children:"Export PDF"})}),(0,F.jsx)("button",{onClick:()=>{(async()=>{var e;const t=new y.Workbook,n=t.addWorksheet("ClientServiceReport");if(n.columns=[{header:"S.No.",key:"sno",width:10},{header:"Service Name",key:"department",width:25},{header:"Created By",key:"createdBy",width:25},{header:"Created At",key:"createdAt",width:25}],n.getRow(1).eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFB6D7A8"}},e.font={bold:!0},e.alignment={vertical:"middle",horizontal:"center"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),!M&&(null===M||void 0===M||!M.servicesData))return;const l=null===M||void 0===M||null===(e=M.servicesData)||void 0===e?void 0:e.map((e,t)=>({sno:t+1,department:(null===e||void 0===e?void 0:e.name)||"N/A",createdBy:(null===e||void 0===e?void 0:e.createdBy)||"N/A",createdAt:m()(null===e||void 0===e?void 0:e.createdAt).format("DD-MM-YYYY hh:mm")||"N/A"}));null===l||void 0===l||l.forEach(e=>{n.addRow(e).eachCell(e=>{e.alignment={vertical:"middle",horizontal:"left"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),n.autoFilter={from:"A1",to:"I1"},t.xlsx.writeBuffer().then(e=>{const t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),n=document.createElement("a");n.href=URL.createObjectURL(t),n.download="ClientServiceReport.xlsx",n.click()})})()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,F.jsx)("span",{className:"text-[12px]",children:"Export Excel"})})]}),(0,F.jsx)("div",{className:"w-full overflow-auto",children:(0,F.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto",children:[(0,F.jsx)("thead",{children:(0,F.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] capitalize text-[12px] bg-header text-white font-[500] h-[40px]",children:[(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap  w-[5%]",children:"S.No."}),(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Service Name"}),(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Created By"}),(0,F.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Created At"})]})}),Y?(0,F.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,F.jsx)("td",{colSpan:15,className:"px-6 py-2 whitespace-nowrap  font-[600] text-sm text-gray-500",children:(0,F.jsx)(f.A,{})})}):(0,F.jsx)("tbody",{children:null!==M&&void 0!==M&&M.servicesData&&(null===M||void 0===M?void 0:M.servicesData.length)>0?null===M||void 0===M||null===(v=M.servicesData)||void 0===v?void 0:v.map((e,t)=>(0,F.jsxs)("tr",{className:"border-b-[1px] ".concat(t%2===0?"bg-[#e9ecef]/80":"bg-white"," border-[#DDDDDD] text-[#374151] text-[14px]"),children:[(0,F.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:t+1+(le-1)*z}),(0,F.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:null===e||void 0===e?void 0:e.name}),(0,F.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:(null===e||void 0===e?void 0:e.createdBy)||"-"}),(0,F.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:m()(null===e||void 0===e?void 0:e.createdAt).format("DD-MM-YYYY hh:mm a")})]})):(0,F.jsx)("tr",{className:"bg-white bg-opacity-5",children:(0,F.jsx)("td",{colSpan:15,className:"px-6 py-2 whitespace-nowrap  font-[600] text-sm text-gray-500",children:"Record Not Found"})})})]})})]})]}),(0,F.jsx)(h.A,{totalCount:V,pageSize:z,currentPage:le,onChange:e=>{ie(e)}})]})})}}}]);
//# sourceMappingURL=698.a8cbed72.chunk.js.map