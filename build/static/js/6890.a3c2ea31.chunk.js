"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[6890],{56890:(e,a,d)=>{d.r(a),d.d(a,{default:()=>h});var n=d(89379),i=d(65043),t=d(24858),l=d(83003),o=d(73216),c=d(99974),r=(d(78729),d(14118),d(31744),d(33007),d(16210),d(15187)),s=d(83252),v=d(735),u=d(13382),p=d(32513),m=d(85157),f=d(39160),x=d(31174),g=d(89427),A=d(70579);const h=function(){const{register:e,handleSubmit:a,setValue:d,getValue:h,control:_,formState:{errors:y}}=(0,t.mN)(),I=(0,l.wA)(),C=(0,o.Zp)(),[b,D]=(0,i.useState)(!1),{permissionIdEnc:N}=(0,o.g)(),j=(0,x.Yc)(N),{companyList:U}=(0,l.d4)(e=>e.company),[R,k]=(0,i.useState)([]),[w,S]=(0,i.useState)([]),{sidebarListData:E}=(0,l.d4)(e=>e.dynamicSidebar),{sidebarViewData:P}=(0,l.d4)(e=>e.dynamicSidebar),{roleAccessDetails:V}=(0,l.d4)(e=>e.rolePermission),{loading:F}=(0,l.d4)(e=>e.rolePermission),{userCompanyId:H,userBranchId:O,userEmployeId:B,userDepartmentId:K,userType:L}=(0,v.A)(),Z=((0,t.FH)({control:_,name:"companyId",defaultValue:H}),(0,t.FH)({control:_,name:"branchId",defaultValue:O}),(0,t.FH)({control:_,name:"departmentId",defaultValue:K}),(0,t.FH)({control:_,name:"designationName"}));JSON.parse(localStorage.getItem("user_info_".concat(r.AU))),(0,i.useEffect)(()=>{I((0,c.kM)({isPagination:!1})),I((0,s.p6)({_id:j}))},[]),(0,i.useEffect)(()=>{if(E&&V){const e=null===V||void 0===V?void 0:V.permissions,a=null===E||void 0===E?void 0:E.map(a=>{const d=null===e||void 0===e?void 0:e.find(e=>(null===e||void 0===e?void 0:e.pageId)===(null===a||void 0===a?void 0:a._id));return(0,n.A)((0,n.A)({},a),{},{canCreate:null===d||void 0===d?void 0:d.canCreate,canRead:null===d||void 0===d?void 0:d.canRead,canUpdate:null===d||void 0===d?void 0:d.canUpdate,canDelete:null===d||void 0===d?void 0:d.canDelete})});k(a)}},[E,V]),(0,i.useEffect)(()=>{if(b){const e=null===E||void 0===E?void 0:E.map(e=>(0,n.A)((0,n.A)({},e),{},{canCreate:!0,canRead:!0,canUpdate:!0,canDelete:!0}));k(e)}else{const e=null===E||void 0===E?void 0:E.map(e=>(0,n.A)((0,n.A)({},e),{},{canCreate:!1,canRead:!1,canUpdate:!1,canDelete:!1}));k(e)}},[b]),(0,i.useCallback)(e=>{var a,n;const i=e.target.value;d("companyId",i);const t=null===U||void 0===U||null===(a=U.docs)||void 0===a||null===(n=a.find(e=>e._id===i))||void 0===n?void 0:n.name;d("companyName",t),d("stateId",""),d("stateName","")},[U,d]),(0,i.useEffect)(()=>{d("designationName",null===V||void 0===V?void 0:V.designationName)},[V]),(0,i.useEffect)(()=>{if(b){const e=null===E||void 0===E?void 0:E.map(e=>(0,n.A)((0,n.A)({},e),{},{canCreate:!0,canRead:!0,canUpdate:!0,canDelete:!0}));k(e)}else{const e=null===E||void 0===E?void 0:E.map(e=>(0,n.A)((0,n.A)({},e),{},{canCreate:!1,canRead:!1,canUpdate:!1,canDelete:!1}));k(e)}},[b]);const J=(e,a)=>{const d=!(!a||null===R||void 0===R||!R.find(a=>a._id===e))&&(null===R||void 0===R?void 0:R.find(a=>a._id===e)[a]);return"px-3 sm:px-4 py-2 rounded-md text-[9px] sm:text-sm text-nowrap font-medium transition-all duration-300 ".concat(d?"bg-header text-white border-header":"bg-gray-200 text-gray-700 border-gray-300 hover:border-header border-2 hover:text-header")};(0,i.useEffect)(()=>{S((0,r.tZ)(P))},[P]);const M=(e,a)=>{var d;return null===R||void 0===R||null===(d=R.find(a=>a._id===e))||void 0===d?void 0:d[a]},T=[{title:"title",dataIndex:"title",width:300,key:"_id",render:(e,a)=>(0,A.jsx)("div",{className:"text-nowrap",children:e})},{title:(0,A.jsx)("div",{children:(0,A.jsx)(p.A,{onClick:e=>(e=>{D(e.target.checked)})(e)})}),key:"_id",width:100,render:(e,a)=>(0,A.jsx)("div",{children:(0,A.jsx)(p.A,{onClick:e=>((e,a)=>{var d,i;const t=null===R||void 0===R||null===(d=R.find(e=>e._id===a))||void 0===d?void 0:d.parentPageId;t&&k(e=>e.map(e=>e._id===t?(0,n.A)((0,n.A)({},e),{},{canCreate:!0,canRead:!0,canUpdate:!0,canDelete:!0}):e));const l=null===R||void 0===R||null===(i=R.find(e=>e._id===t))||void 0===i?void 0:i.parentPageId;l&&k(e=>e.map(e=>e._id===l?(0,n.A)((0,n.A)({},e),{},{canCreate:!0,canRead:!0,canUpdate:!0,canDelete:!0}):e)),e.target.checked?k(e=>e.map(e=>e._id===a?(0,n.A)((0,n.A)({},e),{},{canCreate:!0,canRead:!0,canUpdate:!0,canDelete:!0}):e)):k(e=>e.map(e=>e._id===a?(0,n.A)((0,n.A)({},e),{},{canCreate:!1,canRead:!1,canUpdate:!1,canDelete:!1}):e))})(e,a._id),checked:M(a._id,"canRead")&&M(a._id,"canCreate")&&M(a._id,"canUpdate")&&M(a._id,"canDelete")})})},{title:(0,A.jsx)("div",{children:"Actions"}),key:"_id",render:(e,a)=>(0,A.jsx)("div",{className:"flex items-center flex-nowrap gap-2",children:["canRead","canCreate","canUpdate","canDelete"].map(e=>(0,A.jsx)(u.Ay,{className:J(a._id,e),type:"button",onClick:d=>((e,a)=>{var d,i;const t=null===R||void 0===R||null===(d=R.find(a=>a._id===e))||void 0===d?void 0:d.parentPageId;t&&k(e=>e.map(e=>e._id===t?(0,n.A)((0,n.A)({},e),{},{canCreate:!0,canRead:!0,canUpdate:!0,canDelete:!0}):e));const l=null===R||void 0===R||null===(i=R.find(e=>e._id===t))||void 0===i?void 0:i.parentPageId;l&&k(e=>e.map(e=>e._id===l?(0,n.A)((0,n.A)({},e),{},{canCreate:!0,canRead:!0,canUpdate:!0,canDelete:!0}):e)),k(d=>d.map(d=>d._id===e?(0,n.A)((0,n.A)({},d),{},{[a]:!d[a]}):d))})(a._id,e),style:{margin:"0 5px"},children:e},e))})}];return(0,A.jsx)(f.A,{children:(0,A.jsxs)("div",{className:"",children:[(0,A.jsxs)("div",{className:"grid gap-2 lg:grid-cols-3 md:grid-cols-2",children:[(0,A.jsx)("input",{className:"".concat(r.id," "),value:null===V||void 0===V?void 0:V.branchName,readOnly:!0}),(0,A.jsx)("input",(0,n.A)((0,n.A)({},e("designationName")),{},{className:r.Ol}))]}),(0,A.jsx)(m.A,{columns:T,pagination:!1,dataSource:w,scroll:{y:450,x:!0},rowKey:"_id"}),(0,A.jsx)("div",{className:"flex justify-end my-2 mx-2",children:(0,A.jsx)("button",{type:"button",onClick:a(e=>{const a=null===R||void 0===R?void 0:R.map(e=>null!==e&&void 0!==e&&e.canCreate||null!==e&&void 0!==e&&e.canRead||null!==e&&void 0!==e&&e.canUpdate||null!==e&&void 0!==e&&e.canDelete?{pageId:null===e||void 0===e?void 0:e._id,canCreate:null===e||void 0===e?void 0:e.canCreate,canRead:null===e||void 0===e?void 0:e.canRead,canUpdate:null===e||void 0===e?void 0:e.canUpdate,canDelete:null===e||void 0===e?void 0:e.canDelete}:null).filter(Boolean),d={_id:null===V||void 0===V?void 0:V._id,companyId:null===V||void 0===V?void 0:V.companyId,directorId:null===V||void 0===V?void 0:V.directorId,branchId:null===V||void 0===V?void 0:V.branchId,departmentId:null===V||void 0===V?void 0:V.departmentId,designationId:null===V||void 0===V?void 0:V.designationId,designationName:Z,permissions:a};I((0,s.KD)(d)).then(e=>{e.error||C(-1)})}),className:"bg-header text-white py-1.5 px-3 text-nowrap text-sm rounded ",children:F?(0,A.jsx)(g.A,{}):"save"})})]})})}}}]);
//# sourceMappingURL=6890.a3c2ea31.chunk.js.map