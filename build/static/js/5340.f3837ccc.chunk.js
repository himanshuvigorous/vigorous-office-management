"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[5340],{5340:(e,a,d)=>{d.r(a),d.d(a,{default:()=>I});var l=d(89379),n=d(24858),i=d(39160),o=d(83003),s=d(73216),t=d(65043),r=d(15187),c=d(65512),u=d(31744),m=d(78729),v=(d(36105),d(30575),d(84480),d(66015)),p=d(42837),x=d(31536),y=d(88967),h=d(27810),j=d(94084),f=d(60446),N=d.n(f),b=d(17995),g=d(89427),A=d(60184),T=d(70579);const I=()=>{const{register:e,handleSubmit:a,control:d,watch:f,formState:{errors:I},setValue:D}=(0,n.mN)(),S=(0,o.wA)(),_=(0,s.Zp)(),{companyList:P,companyListLoading:C}=(0,o.d4)(e=>e.company),{branchList:O,branchListloading:w}=(0,o.d4)(e=>e.branch),B=JSON.parse(localStorage.getItem("user_info_".concat(r.AU))),{employeList:L}=(0,o.d4)(e=>e.employe),{countryListData:q}=(0,o.d4)(e=>e.country),{stateListData:E}=(0,o.d4)(e=>e.states),{cityListData:H}=(0,o.d4)(e=>e.city),{expenseTypeList:Q}=(0,o.d4)(e=>e.expenceHead),k=(0,n.FH)({control:d,name:"PDCompanyId",defaultValue:""}),V=(0,n.FH)({control:d,name:"PDBranchId",defaultValue:""}),[F,G]=(0,t.useState)(!1),[J,M]=(0,t.useState)({attachment:[]}),{loading:R}=(0,o.d4)(e=>e.cashbook);(0,t.useEffect)(()=>{(k||"company"===(null===B||void 0===B?void 0:B.userType)||"companyDirector"===(null===B||void 0===B?void 0:B.userType))&&S((0,u.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===B||void 0===B?void 0:B.userType)?k:"company"===(null===B||void 0===B?void 0:B.userType)?null===B||void 0===B?void 0:B._id:null===B||void 0===B?void 0:B.companyId}))},[k]),(0,t.useEffect)(()=>{"admin"===(null===B||void 0===B?void 0:B.userType)&&S((0,m.Ar)({text:"",sort:!0,status:!0,isPagination:!1}))},[]);return(0,t.useEffect)(()=>{D("totalAmount",Number(f("amount"))+Number(f("gstAmount")))},[f("amount"),f("gstAmount")]),(0,T.jsx)(i.A,{children:(0,T.jsx)("div",{className:"gap-4",children:(0,T.jsxs)("form",{autoComplete:"off",className:"mt-2 md:px-1",onSubmit:a(e=>{var a,d;const l={companyId:"admin"===(null===B||void 0===B?void 0:B.userType)?null===e||void 0===e?void 0:e.PDCompanyId:"company"===(null===B||void 0===B?void 0:B.userType)?null===B||void 0===B?void 0:B._id:null===B||void 0===B?void 0:B.companyId,directorId:"companyDirector"===(null===B||void 0===B?void 0:B.userType)?null===B||void 0===B?void 0:B._id:null===B||void 0===B?void 0:B.directorId,branchId:"admin"===(null===B||void 0===B?void 0:B.userType)||"companyDirector"===(null===B||void 0===B?void 0:B.userType)||"company"===(null===B||void 0===B?void 0:B.userType)?null===e||void 0===e?void 0:e.PDBranchId:"companyBranch"===(null===B||void 0===B?void 0:B.userType)?null===B||void 0===B?void 0:B._id:null===B||void 0===B?void 0:B.branchId,employeId:"employe"!==(null===B||void 0===B?void 0:B.userType)?null===e||void 0===e||null===(a=e.employee)||void 0===a?void 0:a.value:"employe"===(null===B||void 0===B?void 0:B.userType)?null===B||void 0===B?void 0:B._id:null,expenseTypeId:null===e||void 0===e||null===(d=e.expencehead)||void 0===d?void 0:d.value,expenseFor:"Employe",amount:+(null===e||void 0===e?void 0:e.amount),naration:null===e||void 0===e?void 0:e.naration,GSTamount:0,totalAmount:+(null===e||void 0===e?void 0:e.amount),date:(0,r.Tk)(null===e||void 0===e?void 0:e.date),status:"Approved",attachment:null===J||void 0===J?void 0:J.attachment};S((0,h.pn)(l)).then(e=>{e.error||_(-1)})}),children:[(0,T.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 md:gap-4 gap-2 md:my-1 md:mt-4",children:["admin"===(null===B||void 0===B?void 0:B.userType)&&(0,T.jsxs)("div",{className:"",children:[(0,T.jsxs)("label",{className:"".concat(r.Q0),children:["Company ",(0,T.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,T.jsx)(n.xI,{control:d,name:"PDCompanyId",rules:{required:"Company is required"},render:e=>{let{field:a}=e;return(0,T.jsxs)(c.A,(0,l.A)((0,l.A)({},a),{},{defaultValue:"",className:"".concat(r.Hy," "),showSearch:!0,filterOption:(e,a)=>String(null===a||void 0===a?void 0:a.children).toLowerCase().includes(e.toLowerCase()),children:[(0,T.jsx)(c.A.Option,{value:"",children:"Select Company"}),C?(0,T.jsx)(c.A.Option,{disabled:!0,children:(0,T.jsx)(g.A,{})}):null===P||void 0===P?void 0:P.map(e=>(0,T.jsx)(c.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),I.PDCompanyId&&(0,T.jsx)("p",{className:"text-red-500 text-sm",children:I.PDCompanyId.message})]}),("admin"===(null===B||void 0===B?void 0:B.userType)||"company"===(null===B||void 0===B?void 0:B.userType)||"companyDirector"===(null===B||void 0===B?void 0:B.userType))&&(0,T.jsxs)("div",{className:"",children:[(0,T.jsxs)("label",{className:"".concat(r.Q0),children:["Branch ",(0,T.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,T.jsx)(n.xI,{control:d,name:"PDBranchId",rules:{required:"Branch is required"},render:e=>{let{field:a}=e;return(0,T.jsxs)(c.A,(0,l.A)((0,l.A)({},a),{},{defaultValue:"",className:"".concat(r.Hy," "),showSearch:!0,filterOption:(e,a)=>String(null===a||void 0===a?void 0:a.children).toLowerCase().includes(e.toLowerCase()),children:[(0,T.jsx)(c.A.Option,{value:"",children:"Select Branch"}),w?(0,T.jsx)(c.A.Option,{disabled:!0,children:(0,T.jsx)(g.A,{})}):null===O||void 0===O?void 0:O.map(e=>(0,T.jsx)(c.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),I.PDBranchId&&(0,T.jsx)("p",{className:"text-red-500 text-sm",children:I.PDBranchId.message})]}),(0,T.jsxs)("div",{className:"w-full",children:[(0,T.jsxs)("label",{className:"".concat(r.Q0),children:["Expence Head  ",(0,T.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,T.jsx)(n.xI,{name:"expencehead",control:d,rules:{required:"Expence Head is required"},render:e=>{let{field:a}=e;return(0,T.jsx)(v.Ay,(0,l.A)((0,l.A)({onFocus:()=>{const e={directorId:"",companyId:"admin"===(null===B||void 0===B?void 0:B.userType)?k:"company"===(null===B||void 0===B?void 0:B.userType)?null===B||void 0===B?void 0:B._id:null===B||void 0===B?void 0:B.companyId,branchId:"company"===(null===B||void 0===B?void 0:B.userType)||"admin"===(null===B||void 0===B?void 0:B.userType)||"companyDirector"===(null===B||void 0===B?void 0:B.userType)?V:"companyBranch"===(null===B||void 0===B?void 0:B.userType)?null===B||void 0===B?void 0:B._id:null===B||void 0===B?void 0:B.branchId,text:"",sort:!0,status:"",isPagination:!1};S((0,x.dV)(e))}},a),{},{options:null===Q||void 0===Q?void 0:Q.map(e=>({value:null===e||void 0===e?void 0:e._id,label:null===e||void 0===e?void 0:e.name})),classNamePrefix:"react-select",className:"".concat(r.Ph," ").concat(I.expencehead?"border-[1px] ":"border-gray-300"),placeholder:"Select Expence Head"}))}}),I.expencehead&&(0,T.jsx)("p",{className:"text-red-500 text-sm",children:I.expencehead.message})]}),"employe"!==(null===B||void 0===B?void 0:B.userType)&&(0,T.jsxs)("div",{className:"w-full",children:[(0,T.jsxs)("label",{className:"".concat(r.Q0),children:["Employee  ",(0,T.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,T.jsx)(n.xI,{name:"employee",control:d,rules:{required:"Employee is required"},render:e=>{let{field:a}=e;return(0,T.jsx)(v.Ay,(0,l.A)((0,l.A)({},a),{},{onFocus:()=>{const e={text:"",status:!0,sort:!0,isTL:"",isHR:"",isPagination:!1,departmentId:"",designationId:"",companyId:"admin"===(null===B||void 0===B?void 0:B.userType)?k:"company"===(null===B||void 0===B?void 0:B.userType)?null===B||void 0===B?void 0:B._id:null===B||void 0===B?void 0:B.companyId,branchId:"company"===(null===B||void 0===B?void 0:B.userType)||"admin"===(null===B||void 0===B?void 0:B.userType)||"companyDirector"===(null===B||void 0===B?void 0:B.userType)?V:"companyBranch"===(null===B||void 0===B?void 0:B.userType)?null===B||void 0===B?void 0:B._id:null===B||void 0===B?void 0:B.branchId};S((0,p.qV)(e))},options:null===L||void 0===L?void 0:L.map(e=>({value:null===e||void 0===e?void 0:e._id,label:null===e||void 0===e?void 0:e.fullName})),classNamePrefix:"react-select",className:"".concat(r.Ph," ").concat(I.employee?"border-[1px] ":"border-gray-300"),placeholder:"Select Employee"}))}}),I.employee&&(0,T.jsx)("p",{className:"text-red-500 text-sm",children:I.employee.message})]}),(0,T.jsxs)("div",{className:"",children:[(0,T.jsxs)("label",{className:"".concat(r.Q0),children:["Amount ",(0,T.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,T.jsx)("input",(0,l.A)((0,l.A)({type:"number",step:"0.01"},e("amount",{required:"Amount is required"})),{},{className:" ".concat(r.Ol," ").concat(I.amount?"border-[1px] ":"border-gray-300"),placeholder:"Enter Amount"})),I.amount&&(0,T.jsx)("p",{className:"text-red-500 text-sm",children:I.amount.message})]}),(0,T.jsxs)("div",{className:"",children:[(0,T.jsxs)("label",{className:"".concat(r.Q0),children:["Naration ",(0,T.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,T.jsx)("textarea",(0,l.A)((0,l.A)({},e("naration",{required:"Naration is required"})),{},{className:" ".concat(r.Ol," ").concat(I.naration?"border-[1px] ":"border-gray-300"),placeholder:"Enter Naration"})),I.naration&&(0,T.jsx)("p",{className:"text-red-500 text-sm",children:I.naration.message})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("label",{className:"".concat(r.Q0),children:"Bill Date"}),(0,T.jsx)(n.xI,{name:"date",control:d,render:e=>{let{field:a}=e;return(0,T.jsx)(j.A,{field:a,errors:I,disabledDate:e=>{if(!e)return!0;const a=N()().startOf("day"),d=e.startOf("day");if(a.date()<=5){const e=a.subtract(1,"month"),l=e.endOf("month").startOf("day"),n=e.date(l.date()-4).startOf("day"),i=(d.isAfter(n)||d.isSame(n))&&(d.isBefore(l)||d.isSame(l)),o=a.startOf("month"),s=(d.isAfter(o)||d.isSame(o))&&(d.isBefore(a)||d.isSame(a));return!(i||s)}{const e=a.startOf("month");return!((d.isAfter(e)||d.isSame(e))&&(d.isBefore(a)||d.isSame(a)))}}})}}),I.date&&(0,T.jsx)("p",{className:"text-red-500 text-sm",children:"Date is required"})]}),(0,T.jsxs)("div",{className:"",children:[(0,T.jsx)("label",{className:"".concat(r.Q0),children:"Documents"}),F?(0,T.jsx)("div",{className:"space-y-2"}):(0,T.jsxs)("div",{className:"space-y-4",children:[(0,T.jsx)("input",{type:"file",onChange:e=>{const a={filePath:e.target.files[0],isVideo:!1,isMultiple:!1};S((0,y.Sg)(a)).then(e=>{var a;null!==e&&void 0!==e&&null!==(a=e.payload)&&void 0!==a&&a.data&&M(a=>{var d;return(0,l.A)((0,l.A)({},a),{},{attachment:[...a.attachment,null===(d=e.payload)||void 0===d?void 0:d.data]})})})},className:"hidden",id:"file-upload"}),(0,T.jsxs)("label",{htmlFor:"file-upload",className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-600 bg-white cursor-pointer",children:[(0,T.jsx)(A.chT,{className:"mr-2"})," Add Documents"]}),(0,T.jsx)("div",{className:"space-y-2",children:J.attachment.map((e,a)=>(0,T.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-md",children:[(0,T.jsxs)("a",{href:"".concat("https://vigapi.vigorousit.com","/public/").concat(e),className:"flex items-center space-x-2",target:"_blank",rel:"noopener noreferrer",children:[(0,T.jsx)(A.chT,{className:"text-gray-500"}),(0,T.jsx)("span",{className:"text-sm text-gray-600",children:e})]}),(0,T.jsx)("button",{type:"button",onClick:()=>(e=>{M(a=>{const d=a.attachment.filter((a,d)=>d!==e);return(0,l.A)((0,l.A)({},a),{},{attachment:d})})})(a),className:"text-red-500 hover:text-red-700",children:(0,T.jsx)(A.QCr,{})})]},a))})]})]})]}),(0,T.jsx)("div",{className:"flex justify-end",children:(0,T.jsx)("button",{type:"submit",disabled:R,className:"".concat(R?"bg-gray-400":"bg-header"," text-white p-2 px-4 mt-3 rounded"),children:R?(0,T.jsx)(b.A,{}):"Submit"})})]})})})}}}]);
//# sourceMappingURL=5340.f3837ccc.chunk.js.map