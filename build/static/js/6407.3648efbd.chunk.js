"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[6407],{96407:(e,s,t)=>{t.r(s),t.d(s,{default:()=>N});var a=t(89379),n=t(65043),i=t(37490),l=t(13382),r=t(89073),o=t(487),d=t(3427),c=t(85578),m=t(22019),u=t(53913),p=t(60647),A=t(65512),g=t(10898),y=t(85157),k=t(76399),x=t(46237),h=t(30119),j=t(61966),T=t(67407),f=t(4004),D=t(77677),I=t(75337),Y=t(60446),C=t.n(Y),b=t(39160),P=t(70579);const{Option:S}=A.A,{TextArea:M}=c.A,v=e=>{const s=localStorage.getItem(e);return s?JSON.parse(s):[]},w=(e,s)=>{localStorage.setItem(e,JSON.stringify(s))};localStorage.getItem("employees")||w("employees",[{id:1,name:"John Doe",position:"Developer",role:"employee"},{id:2,name:"Jane Smith",position:"Designer",role:"employee"},{id:3,name:"Mike Johnson",position:"Manager",role:"manager"}]),localStorage.getItem("tasks")||w("tasks",[]),localStorage.getItem("taskLogs")||w("taskLogs",[]);const N=e=>{let{currentUser:s}=e;const[t,c]=(0,n.useState)(v("employees")||[{id:1,name:"John Doe",position:"Developer",role:"employee"},{id:2,name:"Jane Smith",position:"Designer",role:"employee"},{id:3,name:"Mike Johnson",position:"Manager",role:"manager"}]),[Y,N]=(0,n.useState)(v("tasks")),[F,q]=(0,n.useState)(v("taskLogs")),[H,J]=(0,n.useState)(!1),[E,z]=(0,n.useState)(!1),[L,O]=(0,n.useState)(null),[U,R]=(0,n.useState)(null),[_]=d.A.useForm(),[B]=d.A.useForm();(0,n.useEffect)(()=>{const e=v("employees"),t=v("tasks"),a=v("taskLogs");c(e),N(t),q(a);const n=t.find(e=>"In Progress"===e.status&&e.assignedTo===(null===s||void 0===s?void 0:s.id));n&&R(n.id)},[s]),(0,n.useEffect)(()=>{w("employees",t),w("tasks",Y),w("taskLogs",F)},[t,Y,F]);const K=e=>{U&&V(U);const s=Y.map(s=>s.id===e?(0,a.A)((0,a.A)({},s),{},{status:"In Progress"}):s);N(s),R(e);const t={id:Date.now(),taskId:e,startTime:C()().format("YYYY-MM-DD HH:mm:ss"),endTime:null,duration:null};q([...F,t]),m.Ay.info("Task started!")},V=e=>{if(!U)return;const s=Y.map(s=>s.id===e?(0,a.A)((0,a.A)({},s),{},{status:"Paused"}):s);N(s),R(null);const t=F.findIndex(s=>s.taskId===e&&null===s.endTime);if(-1!==t){const e=C()(F[t].startTime),s=C()(),n=s.diff(e,"seconds"),i=[...F];i[t]=(0,a.A)((0,a.A)({},i[t]),{},{endTime:s.format("YYYY-MM-DD HH:mm:ss"),duration:n}),q(i)}m.Ay.warning("Task paused!")},G=e=>{const s=Y.map(s=>s.id===e?(0,a.A)((0,a.A)({},s),{},{status:"Completed",completedAt:C()().format("YYYY-MM-DD HH:mm:ss")}):s);N(s),U===e&&V(e),m.Ay.success("Task marked as completed!")},Q=[{title:"Title",dataIndex:"title",key:"title"},{title:"Assigned To",dataIndex:"assignedTo",key:"assignedTo",render:e=>{const s=t.find(s=>s.id===e);return s?s.name:"Unknown"}},{title:"Due Date",dataIndex:"dueDate",key:"dueDate",render:e=>C()(e).format("MMM D, YYYY")},{title:"Status",dataIndex:"status",key:"status",render:(e,s)=>{let t="",a=null;switch(e){case"Pending":t="orange",a=(0,P.jsx)(h.A,{});break;case"In Progress":t="blue",a=(0,P.jsx)(D.A,{});break;case"Paused":t="gold",a=(0,P.jsx)(f.A,{});break;case"Completed":t="purple",a=(0,P.jsx)(x.A,{});break;case"Approved":t="green",a=(0,P.jsx)(x.A,{});break;case"Rejected":t="red",a=(0,P.jsx)(x.A,{});break;default:t="gray"}return(0,P.jsx)(i.A,{dot:"In Progress"===e,color:t,children:(0,P.jsx)(k.A,{icon:a,color:t,children:e})})}},{title:"Time Spent",key:"timeSpent",render:(e,s)=>{const t=(a=s.id,F.filter(e=>e.taskId===a).reduce((e,s)=>e+(s.duration||0),0));var a;const n=Math.floor(t/3600),i=Math.floor(t%3600/60),l=t%60;return"".concat(n,"h ").concat(i,"m ").concat(l,"s")}},{title:"Actions",key:"actions",render:(e,s)=>(0,P.jsxs)(g.A,{children:["Pending"===s.status&&(0,P.jsx)(l.Ay,{type:"primary",icon:(0,P.jsx)(D.A,{}),onClick:()=>K(s.id),children:"Start"}),"In Progress"===s.status&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(l.Ay,{icon:(0,P.jsx)(f.A,{}),onClick:()=>V(s.id),children:"Pause"}),(0,P.jsx)(l.Ay,{type:"primary",icon:(0,P.jsx)(x.A,{}),onClick:()=>G(s.id),children:"Complete"})]}),"Paused"===s.status&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(l.Ay,{type:"primary",icon:(0,P.jsx)(D.A,{}),onClick:()=>{return e=s.id,K(e),void m.Ay.info("Task resumed!");var e},children:"Resume"}),(0,P.jsx)(l.Ay,{icon:(0,P.jsx)(x.A,{}),onClick:()=>G(s.id),children:"Complete"})]}),(0,P.jsx)(l.Ay,{icon:(0,P.jsx)(T.A,{}),onClick:()=>{return O(e=s),B.setFieldsValue({title:e.title,description:e.description,assignedTo:e.assignedTo,dueDate:C()(e.dueDate)}),void z(!0);var e}}),(0,P.jsx)(p.A,{title:"Are you sure to delete this task?",onConfirm:()=>(e=>{const s=Y.filter(s=>s.id!==e);N(s);const t=F.filter(s=>s.taskId!==e);q(t),m.Ay.success("Task deleted successfully!")})(s.id),okText:"Yes",cancelText:"No",children:(0,P.jsx)(l.Ay,{icon:(0,P.jsx)(j.A,{}),danger:!0})})]})}];return(0,P.jsx)(b.A,{children:(0,P.jsxs)("div",{className:"task-management",children:[(0,P.jsx)(r.A,{title:"Task Management",extra:(0,P.jsx)(l.Ay,{type:"primary",icon:(0,P.jsx)(I.A,{}),onClick:()=>{J(!0)},children:"Create Task"}),children:(0,P.jsx)(y.A,{dataSource:Y,columns:Q,rowKey:"id",pagination:{pageSize:10}})}),(0,P.jsx)(u.A,{title:"Create New Task",visible:H,onCancel:()=>{J(!1),_.resetFields()},footer:null,className:"antmodalclassName",children:(0,P.jsxs)(d.A,{form:_,onFinish:e=>{const t={id:Date.now(),title:e.title,description:e.description,assignedTo:e.assignedTo,assignedBy:(null===s||void 0===s?void 0:s.id)||1,dueDate:e.dueDate.format("YYYY-MM-DD"),status:"Pending",createdAt:C()().format("YYYY-MM-DD HH:mm:ss"),completedAt:null,approved:null},a=[...Y,t];N(a),m.Ay.success("Task created successfully!"),J(!1),_.resetFields()},layout:"vertical",children:[(0,P.jsx)(d.A.Item,{name:"title",label:"Task Title",rules:[{required:!0,message:"Please enter task title"}],children:(0,P.jsx)("input",{placeholder:"Enter task title"})}),(0,P.jsx)(d.A.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter task description"}],children:(0,P.jsx)(M,{rows:4,placeholder:"Enter task description"})}),(0,P.jsx)(d.A.Item,{name:"assignedTo",label:"Assign To",rules:[{required:!0,message:"Please select an employee"}],children:(0,P.jsxs)(A.A,{getPopupContainer:()=>document.body,popupClassName:"!z-[1580]",placeholder:"Select employee",children:[console.log(t),t.filter(e=>"employee"===e.role).map(e=>(0,P.jsxs)(S,{value:e.id,children:[e.name," (",e.position,")"]},e.id))]})}),(0,P.jsx)(d.A.Item,{name:"dueDate",label:"Due Date",rules:[{required:!0,message:"Please select due date"}],children:(0,P.jsx)(o.A,{getPopupContainer:()=>document.body,popupClassName:"!z-[1580]",style:{width:"100%"}})}),(0,P.jsx)(d.A.Item,{children:(0,P.jsx)(l.Ay,{type:"primary",htmlType:"submit",children:"Create Task"})})]})}),(0,P.jsx)(u.A,{title:"Edit Task",visible:E,onCancel:()=>{z(!1),B.resetFields()},footer:null,className:"antmodalclassName",children:(0,P.jsxs)(d.A,{form:B,onFinish:e=>{const s=Y.map(s=>s.id===L.id?(0,a.A)((0,a.A)({},s),{},{title:e.title,description:e.description,assignedTo:e.assignedTo,dueDate:e.dueDate.format("YYYY-MM-DD")}):s);N(s),m.Ay.success("Task updated successfully!"),z(!1),B.resetFields()},layout:"vertical",children:[(0,P.jsx)(d.A.Item,{name:"title",label:"Task Title",rules:[{required:!0,message:"Please enter task title"}],children:(0,P.jsx)("input",{placeholder:"Enter task title"})}),(0,P.jsx)(d.A.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter task description"}],children:(0,P.jsx)(M,{rows:4,placeholder:"Enter task description"})}),(0,P.jsx)(d.A.Item,{name:"assignedTo",label:"Assign To",rules:[{required:!0,message:"Please select an employee"}],children:(0,P.jsx)(A.A,{getPopupContainer:()=>document.body,popupClassName:"!z-[1580]",placeholder:"Select employee",children:t.filter(e=>"employee"===e.role).map(e=>(0,P.jsxs)(S,{value:e.id,children:[e.name," (",e.position,")"]},e.id))})}),(0,P.jsx)(d.A.Item,{name:"dueDate",label:"Due Date",rules:[{required:!0,message:"Please select due date"}],children:(0,P.jsx)(o.A,{getPopupContainer:()=>document.body,popupClassName:"!z-[1580]",style:{width:"100%"}})}),(0,P.jsx)(d.A.Item,{children:(0,P.jsx)(l.Ay,{type:"primary",htmlType:"submit",children:"Update Task"})})]})})]})})}}}]);
//# sourceMappingURL=6407.3648efbd.chunk.js.map