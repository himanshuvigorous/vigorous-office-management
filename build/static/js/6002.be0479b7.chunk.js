"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[6002],{76002:(e,t,n)=>{n.r(t),n.d(t,{default:()=>q});var a=n(89379),l=n(65043),s=n(39160),d=n(73216),i=n(83003),r=n(23156),o=n(47196),c=n(30064),u=n.n(c),p=n(31174),m=n(30295),x=n(78227),v=n(15187),h=n(24858),y=n(31744),j=n(78729),b=n(65512),f=n(96651),N=n(4938),g=n(55971),w=n(60446),A=n.n(w),I=n(50423),C=n(53913),D=n(99472),S=n(89427),T=n(70579);const O=e=>{let{openInventryModal:t,setInventryModal:n,onClose:s}=e;const{register:d,control:r,handleSubmit:o,reset:c,setValue:u,watch:p,formState:{errors:x}}=(0,h.mN)(),y=(0,i.wA)();(0,l.useEffect)(()=>{null!==t&&void 0!==t&&t.isOpen&&u("inventry",null!==t&&void 0!==t&&t.default?Array.from({length:null===t||void 0===t?void 0:t.default},()=>({name:"",brand:"",model:"",serialNumber:""})):[])},[t]);const{loading:j}=(0,i.d4)(e=>e.AssetType),{fields:b,append:f,remove:N}=(0,h.jz)({control:r,name:"inventry"}),g=e=>{var n,a,l;const d={companyId:null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.companyId,directorId:"",branchId:null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.branchId,assetNameId:null===t||void 0===t||null===(l=t.data)||void 0===l?void 0:l._id,items:null===e||void 0===e?void 0:e.inventry};y((0,m.cq)(d)).then(e=>{null!==e&&void 0!==e&&e.error||(s(),c())})};return(0,T.jsx)(C.A,{open:null===t||void 0===t?void 0:t.isOpen,onCancel:()=>{s(),c()},title:!1,width:1200,bodyStyle:{maxHeight:"60vh",overflowY:"auto",padding:"16px"},centered:!0,className:"antmodalclassName",footer:(0,T.jsxs)("div",{className:"flex gap-2 justify-center items-center",children:[(null===t||void 0===t?void 0:t.default)>0&&(0,T.jsx)("div",{className:"flex justify-end px-3 pb-2",children:(0,T.jsx)("button",{type:"button",disabled:j,onClick:()=>o(g)(),className:"".concat(j?"bg-gray-400":"bg-header"," text-sm text-white py-2 px-3 rounded mt-4"),children:j?(0,T.jsx)(S.A,{}):"Submit Details"})}),(0,T.jsx)("div",{className:"flex justify-end px-3 pb-2",children:(0,T.jsx)("button",{type:"button",onClick:()=>s(),className:"bg-rose-800 text-sm text-white py-2 px-3 rounded mt-4",children:"Cancel"})})]}),children:(null===t||void 0===t?void 0:t.default)>0?(0,T.jsx)("form",{autoComplete:"off",onSubmit:o(g),children:(0,T.jsx)("div",{children:b.map((e,n)=>{var l,s,i,r,o,c,u,p,m,h,y,j,b,f,g,w;return(0,T.jsxs)("div",{className:" rounded-md py-2 border  ",children:[(0,T.jsxs)("div",{className:"flex justify-between items-center mb-4 bg-header rounded-t-md px-3",children:[(0,T.jsxs)("div",{className:"py-2 text-white font-semibold",children:["Inventry Details - ",n+1]}),(null===t||void 0===t?void 0:t.default)<=n&&(0,T.jsx)("div",{className:"flex justify-end",children:(0,T.jsx)("button",{type:"button",onClick:()=>N(n),className:"text-gray-300 hover:text-gray-400 flex items-center justify-center p-1 rounded-lg",children:(0,T.jsx)("i",{className:"fas fa-trash-alt"})})})]}),(0,T.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 md:gap-8 gap-2 px-3 md:my-4",children:[(0,T.jsx)("div",{className:"flex gap-3",children:(0,T.jsxs)("div",{className:"w-full",children:[(0,T.jsxs)("label",{className:"".concat(v.Q0),children:["Name ",(0,T.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,T.jsx)("input",(0,a.A)((0,a.A)({type:"text"},d("inventry[".concat(n,"].name"),{required:"Name is required"})),{},{className:"".concat(v.Ol," ").concat(null!==(l=x.inventry)&&void 0!==l&&null!==(s=l[n])&&void 0!==s&&s.name?"border-[1px] ":"border-gray-300"),placeholder:"Enter Name"})),(null===(i=x.inventry)||void 0===i||null===(r=i[n])||void 0===r?void 0:r.name)&&(0,T.jsx)("p",{className:"text-red-500 text-sm",children:x.inventry[n].name.message})]})}),(0,T.jsx)("div",{className:"flex gap-3",children:(0,T.jsxs)("div",{className:"w-full",children:[(0,T.jsxs)("label",{className:"".concat(v.Q0),children:["brand ",(0,T.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,T.jsx)("input",(0,a.A)((0,a.A)({type:"text"},d("inventry[".concat(n,"].brand"),{required:"brand is required"})),{},{className:"".concat(v.Ol," ").concat(null!==(o=x.inventry)&&void 0!==o&&null!==(c=o[n])&&void 0!==c&&c.brand?"border-[1px] ":"border-gray-300"),placeholder:"Enter brand"})),(null===(u=x.inventry)||void 0===u||null===(p=u[n])||void 0===p?void 0:p.brand)&&(0,T.jsx)("p",{className:"text-red-500 text-sm",children:x.inventry[n].brand.message})]})}),(0,T.jsx)("div",{className:"flex gap-3",children:(0,T.jsxs)("div",{className:"w-full",children:[(0,T.jsxs)("label",{className:"".concat(v.Q0),children:["model ",(0,T.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,T.jsx)("input",(0,a.A)((0,a.A)({type:"text"},d("inventry[".concat(n,"].model"),{required:"model is required"})),{},{className:"".concat(v.Ol," ").concat(null!==(m=x.inventry)&&void 0!==m&&null!==(h=m[n])&&void 0!==h&&h.model?"border-[1px] ":"border-gray-300"),placeholder:"Enter model"})),(null===(y=x.inventry)||void 0===y||null===(j=y[n])||void 0===j?void 0:j.model)&&(0,T.jsx)("p",{className:"text-red-500 text-sm",children:x.inventry[n].model.message})]})}),(0,T.jsx)("div",{className:"flex gap-3",children:(0,T.jsxs)("div",{className:"w-full",children:[(0,T.jsxs)("label",{className:"".concat(v.Q0),children:["serialNumber ",(0,T.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,T.jsx)("input",(0,a.A)((0,a.A)({type:"text"},d("inventry[".concat(n,"].serialNumber"),{required:"serialNumber is required"})),{},{className:"".concat(v.Ol," ").concat(null!==(b=x.inventry)&&void 0!==b&&null!==(f=b[n])&&void 0!==f&&f.serialNumber?"border-[1px] ":"border-gray-300"),placeholder:"Enter serialNumber"})),(null===(g=x.inventry)||void 0===g||null===(w=g[n])||void 0===w?void 0:w.serialNumber)&&(0,T.jsx)("p",{className:"text-red-500 text-sm",children:x.inventry[n].serialNumber.message})]})})]},e.id)]},n)})})}):(0,T.jsx)(D.A,{})})};var P=n(78973);const q=function(){const{register:e,control:t,formState:{errors:n},setValue:c}=(0,h.mN)(),w=(0,d.Zp)(),C=(0,i.wA)(),{AssetTypeListData:D,totalAssetTypeListCount:S,loading:q}=(0,i.d4)(e=>e.AssetType),B=JSON.parse(localStorage.getItem("user_info_".concat(v.AU))),[_,k]=(0,l.useState)(1),[L,E]=(0,l.useState)(""),{companyList:z}=(0,i.d4)(e=>e.company),{branchList:F}=(0,i.d4)(e=>e.branch),[M,Q]=(0,l.useState)({data:null,default:1,isOpen:!1}),V=(0,h.FH)({control:t,name:"PDCompanyId",defaultValue:""}),Y=(0,h.FH)({control:t,name:"PDBranchId",defaultValue:""}),H=(0,h.FH)({control:t,name:"status",defaultValue:""});(0,l.useEffect)(()=>{V&&c("PDBranchId","")},[V]);const J=[Y,V,H,L].join("-"),[R,U]=(0,l.useState)(!1);(0,l.useEffect)(()=>{R?1===_?G():k(1):U(e=>!0)},[J]),(0,l.useEffect)(()=>{G()},[_]);const G=()=>{const e={currentPage:_,pageSize:10,reqData:{directorId:"",companyId:"admin"===(null===B||void 0===B?void 0:B.userType)?V:"company"===(null===B||void 0===B?void 0:B.userType)?null===B||void 0===B?void 0:B._id:null===B||void 0===B?void 0:B.companyId,branchId:"company"===(null===B||void 0===B?void 0:B.userType)||"admin"===(null===B||void 0===B?void 0:B.userType)||"companyDirector"===(null===B||void 0===B?void 0:B.userType)?Y:"companyBranch"===(null===B||void 0===B?void 0:B.userType)?null===B||void 0===B?void 0:B._id:null===B||void 0===B?void 0:B.branchId,text:L,sort:!0,status:"true"===H||"false"!==H&&"",isPagination:!0}};C((0,m.hu)(e))};(0,l.useEffect)(()=>{(V||"company"===(null===B||void 0===B?void 0:B.userType)||"companyDirector"===(null===B||void 0===B?void 0:B.userType))&&C((0,y.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===B||void 0===B?void 0:B.userType)?V:"company"===(null===B||void 0===B?void 0:B.userType)?null===B||void 0===B?void 0:B._id:null===B||void 0===B?void 0:B.companyId}))},[V]),(0,l.useEffect)(()=>{"admin"===(null===B||void 0===B?void 0:B.userType)&&C((0,j.Ar)({text:"",sort:!0,status:!0,isPagination:!1}))},[]);const{canCreate:W,canRead:Z,canUpdate:K,canDelete:X}=(0,N.A)();return(0,T.jsx)(s.A,{onChange:e=>{E(e)},children:(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{className:"",children:(0,T.jsxs)("div",{class:"sm:flex justify-between items-center py-1 lg:space-y-0 space-y-2 overflow-y-auto",children:[(0,T.jsxs)("div",{className:"grid sm:grid-cols-2 grid-cols-1 lg:grid-cols-2 sm:gap-3 gap-1",children:["admin"===(null===B||void 0===B?void 0:B.userType)&&(0,T.jsxs)("div",{className:"",children:[(0,T.jsx)(h.xI,{name:"PDCompanyId",control:t,rules:{required:"Company is required"},render:e=>{let{field:t}=e;return(0,T.jsxs)(b.A,(0,a.A)((0,a.A)({},t),{},{className:"w-full ".concat(v.OJ," ").concat(n.PDCompanyId?"border-[1px] ":"border-gray-300"),placeholder:"Select Company",showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,T.jsx)(b.A.Option,{value:"",children:"Select Company"}),null===z||void 0===z?void 0:z.map(e=>(0,T.jsx)(b.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),n.PDCompanyId&&(0,T.jsx)("p",{className:"text-red-500 text-sm",children:n.PDCompanyId.message})]}),("admin"===(null===B||void 0===B?void 0:B.userType)||"company"===(null===B||void 0===B?void 0:B.userType)||"companyDirector"===(null===B||void 0===B?void 0:B.userType))&&(0,T.jsxs)("div",{className:"",children:[(0,T.jsx)(h.xI,{name:"PDBranchId",control:t,rules:{required:"Branch is required"},render:e=>{let{field:t}=e;return(0,T.jsxs)(b.A,(0,a.A)((0,a.A)({},t),{},{className:"".concat(v.Lp," ").concat(n.PDBranchId?"border-[1px] ":"border-gray-300"),showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),placeholder:"Select Branch",children:[(0,T.jsx)(b.A.Option,{value:"",children:"Select Branch"}),null===F||void 0===F?void 0:F.map(e=>(0,T.jsx)(b.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),n.PDBranchId&&(0,T.jsx)("p",{className:"text-red-500 text-sm",children:n.PDBranchId.message})]})]}),(0,T.jsxs)("div",{className:"flex justify-end items-center gap-2 ",children:[(0,T.jsx)("button",{onClick:()=>{c("status",""),c("PDBranchId",""),c("PdDepartmentId",""),c("PdCompanyId","")},className:"bg-header   py-[6px]  rounded-md  flex px-5 justify-center items-center  text-white",children:(0,T.jsx)("span",{className:"text-[12px]",children:"Reset"})}),Z&&W&&(0,T.jsx)(f.A,{placement:"topLeft",title:"Add AssetType Type",children:(0,T.jsxs)("button",{onClick:()=>{w("/admin/asset-type/create")},className:"bg-header px-2 py-1.5 rounded-md flex justify-center items-center space-x-2 text-white",children:[(0,T.jsx)(r.OiG,{}),(0,T.jsx)("span",{className:"text-[12px]",children:"Add AssetType Type"})]})})]})]})}),(0,T.jsx)("div",{className:"bg-[#ffffff] w-full overflow-x-auto mt-1 rounded-xl",children:Z&&(0,T.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto ",children:[(0,T.jsx)("thead",{className:"",children:(0,T.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] bg-header capitalize text-[12px] text-[#ffff] font-[500] h-[40px]",children:[(0,T.jsx)("th",{className:"p-2 whitespace-nowrap w-[10%]",children:"S.No."}),(0,T.jsx)("th",{className:"p-2 whitespace-nowrap",children:"Name"}),(0,T.jsx)("th",{className:"p-2 whitespace-nowrap",children:"Quantity"}),(0,T.jsx)("th",{className:"p-2 whitespace-nowrap",children:"openingBalance"}),(0,T.jsx)("th",{className:"p-2 whitespace-nowrap",children:"created At"}),(0,T.jsx)("th",{className:"p-2 whitespace-nowrap",children:"created By"}),(K||X)&&(0,T.jsx)("th",{className:"p-2 whitespace-nowrap w-[10%]",children:"Action"})]})}),q?(0,T.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,T.jsx)("td",{colSpan:10,className:"px-6 py-2 whitespace-nowrap font-[600] text-sm text-gray-500",children:(0,T.jsx)(g.A,{})})}):(0,T.jsx)("tbody",{children:D&&(null===D||void 0===D?void 0:D.length)>0?null===D||void 0===D?void 0:D.map((e,t)=>(0,T.jsxs)("tr",{className:"text-black ".concat(t%2===0?"bg-[#e9ecef]/80":"bg-white"," text-[14px] border-b-[1px] border-[#DDDDDD]"),children:[(0,T.jsx)("td",{className:"whitespace-nowrap p-2",children:t+1+10*(_-1)}),(0,T.jsx)("td",{className:"whitespace-nowrap p-2",children:null===e||void 0===e?void 0:e.name}),(0,T.jsx)("td",{className:"whitespace-nowrap p-2",children:null===e||void 0===e?void 0:e.quantity}),(0,T.jsx)("td",{className:"whitespace-nowrap p-2",children:(0,v.w2)(null===e||void 0===e?void 0:e.openingBalance)}),(0,T.jsx)("td",{className:"whitespace-nowrap p-2",children:A()(null===e||void 0===e?void 0:e.createdAt).format("DD-MM-YYYY hh:mm a")}),(0,T.jsx)("td",{className:"whitespace-nowrap p-2",children:(null===e||void 0===e?void 0:e.createdBy)||"-"}),(K||X)&&(0,T.jsx)("td",{className:"whitespace-nowrap p-2",children:(0,T.jsxs)("span",{className:"py-1.5 flex justify-start items-center space-x-2.5",children:[K&&(0,T.jsx)(f.A,{placement:"topLeft",title:"create Inventry",children:(0,T.jsx)("button",{onClick:()=>{Q({data:e,default:(null===e||void 0===e?void 0:e.quantity)>(null===e||void 0===e?void 0:e.totalInventory.total)?(null===e||void 0===e?void 0:e.quantity)-(null===e||void 0===e?void 0:e.totalInventory.total):0,isOpen:!0})},className:"px-2 py-1.5 text-xs rounded-md bg-transparent border border-muted",type:"button",children:(0,T.jsx)(I.ueF,{className:" hover:text-[#337ab7] text-[#3c8dbc]",size:16})})}),K&&(0,T.jsx)(f.A,{placement:"topLeft",title:"view Inventry",children:(0,T.jsx)("button",{onClick:()=>{w("/admin/asset-inventry/".concat((0,p.w)(null===e||void 0===e?void 0:e._id),"/").concat((0,p.w)(null===e||void 0===e?void 0:e.companyId),"/").concat((0,p.w)(null===e||void 0===e?void 0:e.branchId)))},className:"px-2 py-1.5 text-xs rounded-md bg-transparent border border-muted",type:"button",children:(0,T.jsx)(P.wAh,{className:" hover:text-[#337ab7] text-[#3c8dbc]",size:16})})}),K&&(0,T.jsx)(f.A,{placement:"topLeft",title:"Edit",children:(0,T.jsx)("button",{onClick:()=>{w("/admin/asset-type/edit/".concat((0,p.w)(null===e||void 0===e?void 0:e._id)))},className:"px-2 py-1.5 text-xs rounded-md bg-transparent border border-muted",type:"button",children:(0,T.jsx)(r.Jcp,{className:" hover:text-[#337ab7] text-[#3c8dbc]",size:16})})}),X&&(0,T.jsx)(f.A,{placement:"topLeft",title:"Delete",children:(0,T.jsx)("button",{onClick:()=>(e=>{let t={_id:e};u().fire({title:"Warning",text:"Are you sure you want to delete!",icon:"warning",showCancelButton:!0,cancelButtonText:"No"}).then(e=>{e.isConfirmed&&C((0,m.Ot)(t)).then(e=>{_>1&&1==(null===D||void 0===D?void 0:D.length)?k(Number(_-1)):G()})})})(null===e||void 0===e?void 0:e._id),className:"px-2 py-1.5 rounded-md bg-transparent border border-muted",type:"button",children:(0,T.jsx)(o.tqC,{className:"text-red-600 hover:text-red-500",size:16})})})]})})]})):(0,T.jsx)("tr",{className:"bg-white bg-opacity-5",children:(0,T.jsx)("td",{colSpan:5,className:"px-6 py-2 whitespace-nowrap font-[600] text-sm text-gray-500",children:"Record Not Found"})})})]})}),(null===D||void 0===D?void 0:D.length)>0&&(0,T.jsx)(x.A,{totalCount:S,pageSize:10,currentPage:_,onChange:e=>{k(e)}}),(0,T.jsx)(O,{setInventryModal:Q,openInventryModal:M,onClose:()=>{Q({data:null,isOpen:!1,default:0})}})]})})}}}]);
//# sourceMappingURL=6002.be0479b7.chunk.js.map