"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[7930],{37930:(e,l,d)=>{d.r(l),d.d(l,{default:()=>O});var a=d(89379),n=d(24858),i=d(39160),o=d(83003),s=d(73216),r=d(65043),t=d(15187),c=d(31744),u=(d(78729),d(66015)),m=d(42837),v=d(31536),x=(d(88967),d(71262)),p=d(31174),h=d(86178),N=d.n(h),j=d(12208),y=d(70337),I=d(96603),b=d(65512),f=d(89427),g=d(47196),A=d(94084),q=d(60446),w=d.n(q),H=(d(17995),d(55971)),S=d(70579);const O=()=>{const{register:e,handleSubmit:l,control:d,watch:h,reset:q,formState:{errors:O},setValue:k}=(0,n.mN)(),M=(0,o.wA)(),C=(0,s.Zp)(),{expenseIdEnc:Q}=(0,s.g)(),_=(0,p.Yc)(Q),{expenseDetails:L}=(JSON.parse(localStorage.getItem("user_info_".concat(t.AU))),(0,o.d4)(e=>e.expense)),{clientList:P}=(0,o.d4)(e=>e.client),{branchDetailsData:Y}=(0,o.d4)(e=>e.branch),{employeList:T}=(0,o.d4)(e=>e.employe),{clientGroupList:D,loader:V}=(0,o.d4)(e=>e.clientGroup),{expenseTypeList:E}=(0,o.d4)(e=>e.expenceHead),{fields:G,append:F,remove:z}=(0,n.jz)({control:d,name:"expenceHead"}),[B,J]=(0,r.useState)(!1);console.log(L,"expenseDetails");(0,r.useEffect)(()=>{M((0,x.LR)({_id:_}))},[]);const R=(0,n.FH)({control:d,name:"clientId",defaultValue:""});(0,r.useEffect)(()=>{if(L){if(J(!0),M((0,j.J_)({isPagination:!1,text:"",sort:!0,status:!0,groupId:"",companyId:null===L||void 0===L?void 0:L.companyId,branchId:null===L||void 0===L?void 0:L.branchId})).then(e=>{null!==e&&void 0!==e&&e.error||k("groupName",null===L||void 0===L?void 0:L.clientGroupId)}),M((0,y.Aq)({text:"",status:!0,sort:!0,isPagination:!1,departmentId:"",designationId:"",companyId:null===L||void 0===L?void 0:L.companyId,branchId:null===L||void 0===L?void 0:L.branchId,groupId:null===L||void 0===L?void 0:L.clientGroupId})).then(e=>{null!==e&&void 0!==e&&e.error||k("clientId",null===L||void 0===L?void 0:L.clientId)}),M((0,v.dV)({directorId:"",companyId:null===L||void 0===L?void 0:L.companyId,branchId:null===L||void 0===L?void 0:L.branchId,text:"",sort:!0,status:"",isPagination:!1})).then(e=>{if(null===e||void 0===e||!e.error){var l;const e=null===L||void 0===L||null===(l=L.heads)||void 0===l?void 0:l.map(e=>({expenseTypeId:null===e||void 0===e?void 0:e.headId,isPeriod:null===e||void 0===e?void 0:e.type,financialYear:null===e||void 0===e?void 0:e.financialYear,monthName:null===e||void 0===e?void 0:e.monthName,quarterName:null===e||void 0===e?void 0:e.monthQuaters}));k("expenceHead",e)}}),k("paymentMode",null===L||void 0===L?void 0:L.paymentMode),k("amount",null===L||void 0===L?void 0:L.totalAmount),k("date",w()(null===L||void 0===L?void 0:L.date)),k("naration",null===L||void 0===L?void 0:L.naration),"bank"===(null===L||void 0===L?void 0:L.paymentMode)||"cheque"===(null===L||void 0===L?void 0:L.paymentMode))M((0,c.ZN)({_id:null===L||void 0===L?void 0:L.branchId})).then(e=>{null!==e&&void 0!==e&&e.error||(k("bankId",null===L||void 0===L?void 0:L.bankAccId),k("transactionNo",null===L||void 0===L?void 0:L.transactionNo),k("chequeNo",null===L||void 0===L?void 0:L.chequeNo))});else if("cash"===(null===L||void 0===L?void 0:L.paymentMode)){const e={text:"",status:!0,sort:!0,isTL:"",isHR:"",isPagination:!1,departmentId:"",designationId:"",companyId:null===L||void 0===L?void 0:L.companyId,branchId:null===L||void 0===L?void 0:L.branchId};M((0,m.qV)(e)).then(e=>{if(null===e||void 0===e||!e.error){var l,d,a;const n=null===e||void 0===e||null===(l=e.payload)||void 0===l||null===(d=l.data)||void 0===d||null===(a=d.docs)||void 0===a?void 0:a.find(e=>(null===e||void 0===e?void 0:e._id)===(null===L||void 0===L?void 0:L.employeId));k("employeeId",{value:null===n||void 0===n?void 0:n._id,label:null===n||void 0===n?void 0:n.fullName})}})}J(!1)}},[L]);const Z=()=>{M((0,j.J_)({isPagination:!1,text:"",sort:!0,status:!0,groupId:"",companyId:null===L||void 0===L?void 0:L.companyId,branchId:null===L||void 0===L?void 0:L.branchId}))};return(0,S.jsx)(i.A,{children:B?(0,S.jsx)(H.A,{}):(0,S.jsx)("div",{className:"gap-4",children:(0,S.jsxs)("form",{autoComplete:"off",className:"mt-2 md:px-1",onSubmit:l(e=>{var l,d;const a=null===e||void 0===e||null===(l=e.expenceHead)||void 0===l?void 0:l.map(e=>({headId:null===e||void 0===e?void 0:e.expenseTypeId,type:null===e||void 0===e?void 0:e.isPeriod,financialYear:null===e||void 0===e?void 0:e.financialYear,monthName:"Monthly"===(null===e||void 0===e?void 0:e.isPeriod)?null===e||void 0===e?void 0:e.monthName:"",monthQuaters:"Quaterly"===(null===e||void 0===e?void 0:e.isPeriod)?null===e||void 0===e?void 0:e.quarterName:"",headType:"head",description:"",amount:0})),n={_id:_,companyId:null===L||void 0===L?void 0:L.companyId,directorId:null===L||void 0===L?void 0:L.directorId,branchId:null===L||void 0===L?void 0:L.branchId,clientGroupId:null===e||void 0===e?void 0:e.groupName,employeId:"cash"===(null===e||void 0===e?void 0:e.paymentMode)?null===e||void 0===e||null===(d=e.employeeId)||void 0===d?void 0:d.value:null,bankAccId:"cash"!==(null===e||void 0===e?void 0:e.paymentMode)?null===e||void 0===e?void 0:e.bankId:null,paymentMode:null===e||void 0===e?void 0:e.paymentMode,chequeNo:"cheque"===(null===e||void 0===e?void 0:e.paymentMode)?null===e||void 0===e?void 0:e.chequeNo:null,transactionNo:"bank"===(null===e||void 0===e?void 0:e.paymentMode)?null===e||void 0===e?void 0:e.transactionNo:null,totalAmount:+(null===e||void 0===e?void 0:e.amount),naration:null===e||void 0===e?void 0:e.naration,date:N()(null===e||void 0===e?void 0:e.date).format("YYYY-MM-DD"),expenseTypeId:null,clientId:null===e||void 0===e?void 0:e.clientId,heads:a};M((0,x.eY)(n)).then(e=>{e.error||C(-1)})}),children:[(0,S.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-1 md:gap-8 md:my-1 px-3 md:mt-4",children:[(0,S.jsxs)("div",{className:"w-full",children:[(0,S.jsxs)("label",{className:"".concat(t.Q0),children:["Group Type ",(0,S.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,S.jsx)(n.xI,{control:d,name:"groupName",rules:{required:"Group Name is required"},render:e=>{var l;let{field:d}=e;return(0,S.jsxs)(b.A,(0,a.A)((0,a.A)({},d),{},{onFocus:Z,defaultValue:"",className:"".concat(t.Hy," "),showSearch:!0,filterOption:(e,l)=>String(null===l||void 0===l?void 0:l.children).toLowerCase().includes(e.toLowerCase()),children:[(0,S.jsx)(b.A.Option,{value:"",children:"Select Group Type"}),V?(0,S.jsx)(b.A.Option,{disabled:!0,children:(0,S.jsx)(f.A,{})}):null===(l=(0,t._o)(D,"fullName"))||void 0===l?void 0:l.map(e=>(0,S.jsx)(b.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),O.groupName&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:O.groupName.message})]}),(0,S.jsxs)("div",{className:"w-full",children:[(0,S.jsxs)("label",{className:"".concat(t.Q0),children:["Client",(0,S.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,S.jsx)(n.xI,{control:d,name:"clientId",rules:{required:"client  is required"},render:e=>{var l;let{field:d}=e;return(0,S.jsxs)(b.A,(0,a.A)((0,a.A)({},d),{},{onFocus:()=>{const e={directorId:"",companyId:null===L||void 0===L?void 0:L.companyId,branchId:null===L||void 0===L?void 0:L.branchId,groupId:h("groupName"),text:"",sort:!0,status:"",isPagination:!1};M((0,y.Aq)(e))},defaultValue:"",className:"".concat(t.Hy," "),showSearch:!0,filterOption:(e,l)=>String(null===l||void 0===l?void 0:l.children).toLowerCase().includes(e.toLowerCase()),children:[(0,S.jsx)(b.A.Option,{value:"",children:"Select Client "}),null===(l=(0,t._o)(P,"fullName"))||void 0===l?void 0:l.map(e=>(0,S.jsx)(b.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),O.clientId&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:O.clientId.message})]}),G.map((e,l)=>{var i,o,s,r,c,u,m,v,x,p,N,j,y,I,f,A,q,w,H,k;return(0,S.jsxs)("div",{className:"border border-gray-300 rounded-md",children:[(0,S.jsx)("div",{className:"flex flex-col items-end",children:(0,S.jsx)("div",{className:"w-full bg-header flex justify-end items-center rounded-tl-md rounded-tr-md p-1 min-h-5",children:0!==l&&(0,S.jsx)("button",{type:"button",onClick:()=>z(l),children:(0,S.jsx)(g.tqC,{className:"text-white w-12 hover:text-white",size:20})})})}),(0,S.jsxs)("div",{className:"grid ".concat("Yearly"===h("expenceHead[".concat(l,"].isPeriod"))?"grid-cols-1 md:grid-cols-3":h("expenceHead[".concat(l,"].isPeriod"))?"grid-cols-1 md:grid-cols-4":"grid-cols-1 md:grid-cols-3"," md:gap-4 md:my-1 px-3 md:mt-4"),children:[(0,S.jsxs)("div",{className:"w-full",children:[(0,S.jsxs)("label",{className:"".concat(t.Q0),children:["Department ",(0,S.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,S.jsx)(n.xI,{control:d,placeholder:"Select Department",name:"expenceHead[".concat(l,"].expenseTypeId"),rules:{required:"Department is required"},render:e=>{var l,d;let{field:n}=e;return(0,S.jsxs)(b.A,(0,a.A)((0,a.A)({},n),{},{className:" ".concat(t.Hy," ").concat(O.expenseTypeId?"border-[1px] ":"border-gray-300"),showSearch:!0,filterOption:(e,l)=>String(null===l||void 0===l?void 0:l.children).toLowerCase().includes(e.toLowerCase()),children:[(0,S.jsx)(b.A.Option,{className:"",value:"",children:"Select Department"}),null===(l=P.find(e=>(null===e||void 0===e?void 0:e._id)==R))||void 0===l||null===(d=l.departmentIdList)||void 0===d?void 0:d.map(e=>(0,S.jsx)(b.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.name}))]}))}}),(null===(i=O.expenceHead)||void 0===i||null===(o=i[l])||void 0===o?void 0:o.expenseTypeId)&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:null===(s=O.expenceHead)||void 0===s||null===(r=s[l])||void 0===r?void 0:r.expenseTypeId.message})]}),(0,S.jsxs)("div",{children:[(0,S.jsxs)("label",{className:"".concat(t.Q0),children:["Financial Year ",(0,S.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,S.jsx)(n.xI,{control:d,name:"expenceHead[".concat(l,"].financialYear"),rules:{required:"Financial year is required"},render:e=>{let{field:l}=e;return(0,S.jsxs)(b.A,(0,a.A)((0,a.A)({},l),{},{placeholder:"Select Financial year",className:"".concat(t.Hy," "),showSearch:!0,filterOption:(e,l)=>String(null===l||void 0===l?void 0:l.children).toLowerCase().includes(e.toLowerCase()),children:[(0,S.jsx)(b.A.Option,{value:"",children:"Select Financial year"}),(0,t.vr)().map((e,l)=>(0,S.jsx)(b.A.Option,{value:e,children:e},l))]}))}}),(null===(c=O.expenceHead)||void 0===c||null===(u=c[l])||void 0===u?void 0:u.financialYear)&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:null===(m=O.expenceHead)||void 0===m||null===(v=m[l])||void 0===v?void 0:v.financialYear.message})]}),(0,S.jsxs)("div",{children:[(0,S.jsxs)("label",{className:"".concat(t.Q0),children:["Type ",(0,S.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,S.jsx)(n.xI,{control:d,name:"expenceHead[".concat(l,"].isPeriod"),rules:{required:"Type is required"},render:e=>{let{field:l}=e;return(0,S.jsxs)(b.A,(0,a.A)((0,a.A)({},l),{},{defaultValue:"",className:"".concat(t.Hy," "),showSearch:!0,filterOption:(e,l)=>String(null===l||void 0===l?void 0:l.children).toLowerCase().includes(e.toLowerCase()),children:[(0,S.jsx)(b.A.Option,{value:"",children:"Select Type"}),(0,S.jsx)(b.A.Option,{value:"Quaterly",children:" Quaterly"}),(0,S.jsx)(b.A.Option,{value:"Monthly",children:"Monthly"}),(0,S.jsx)(b.A.Option,{value:"Yearly",children:"Yearly"})]}))}}),(null===(x=O.expenceHead)||void 0===x||null===(p=x[l])||void 0===p?void 0:p.isPeriod)&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:null===(N=O.expenceHead)||void 0===N||null===(j=N[l])||void 0===j?void 0:j.isPeriod.message})]}),"Quaterly"===h("expenceHead[".concat(l,"].isPeriod"))&&(0,S.jsxs)("div",{children:[(0,S.jsxs)("label",{className:"".concat(t.Q0),children:["Quarter ",(0,S.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,S.jsx)(n.xI,{control:d,name:"expenceHead[".concat(l,"].quarterName"),rules:{required:"Reset Month is required"},render:e=>{let{field:l}=e;return(0,S.jsxs)(b.A,(0,a.A)((0,a.A)({},l),{},{defaultValue:"",className:"".concat(t.Hy," "),showSearch:!0,filterOption:(e,l)=>String(null===l||void 0===l?void 0:l.children).toLowerCase().includes(e.toLowerCase()),children:[(0,S.jsx)(b.A.Option,{value:"",children:"Select Quarter"}),t.$G.map(e=>(0,S.jsx)(b.A.Option,{value:e,children:e},e))]}))}}),(null===(y=O.expenceHead)||void 0===y||null===(I=y[l])||void 0===I?void 0:I.quarterName)&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:null===(f=O.expenceHead)||void 0===f||null===(A=f[l])||void 0===A?void 0:A.quarterName.message})]}),"Monthly"===h("expenceHead[".concat(l,"].isPeriod"))&&(0,S.jsxs)("div",{children:[(0,S.jsxs)("label",{className:"".concat(t.Q0),children:["Month ",(0,S.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,S.jsx)(n.xI,{control:d,name:"expenceHead[".concat(l,"].monthName"),rules:{required:"Month is required"},render:e=>{let{field:l}=e;return(0,S.jsxs)(b.A,(0,a.A)((0,a.A)({},l),{},{defaultValue:"",className:"".concat(t.Hy," "),showSearch:!0,filterOption:(e,l)=>String(null===l||void 0===l?void 0:l.children).toLowerCase().includes(e.toLowerCase()),children:[(0,S.jsx)(b.A.Option,{value:"",children:"Select Month"}),t.US.map(e=>(0,S.jsx)(b.A.Option,{value:e,children:e},e))]}))}}),(null===(q=O.expenceHead)||void 0===q||null===(w=q[l])||void 0===w?void 0:w.monthName)&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:null===(H=O.expenceHead)||void 0===H||null===(k=H[l])||void 0===k?void 0:k.monthName.message})]})]})]})}),(0,S.jsx)("button",{type:"button",onClick:()=>F({taskType:"",amount:"",financialYear:(0,t.Yz)()}),className:h("isAlltask")?"hidden":"bg-header text-white p-2 px-4 rounded mt-4",children:"Add Expense Head"}),(0,S.jsx)("div",{children:(0,S.jsxs)("div",{className:"py-2",children:[(0,S.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-1 md:gap-2 md:my-1  md:mt-2",children:[(0,S.jsxs)("div",{className:"",children:[(0,S.jsxs)("div",{className:"flex items-center gap-4",children:[(0,S.jsx)("label",{className:"your-input-label-class",children:(0,S.jsx)(n.xI,{name:"paymentMode",control:d,defaultValue:"cash",rules:{required:"Type is required"},render:e=>{let{field:l}=e;return(0,S.jsxs)(I.Ay.Group,(0,a.A)((0,a.A)({defaultValue:"cash"},l),{},{children:[(0,S.jsx)(I.Ay,{className:"".concat(t.Q0),value:"cash",children:"Cash"}),(0,S.jsx)(I.Ay,{className:"".concat(t.Q0),value:"bank",children:"Bank"})]}))}})}),O.type&&(0,S.jsx)("span",{className:"error-message",children:O.type.message})]}),O.type&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:O.type.message})]}),"cash"!==h("paymentMode")&&(0,S.jsxs)("div",{className:"",children:[(0,S.jsxs)("label",{className:"".concat(t.Q0),children:["Sender Bank",(0,S.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,S.jsx)(n.xI,{control:d,name:"bankId",rules:{required:"bankId is required"},render:e=>{var l,d;let{field:n}=e;return(0,S.jsxs)(b.A,(0,a.A)((0,a.A)({},n),{},{defaultValue:"",className:"".concat(t.Hy," "),onFocus:()=>{M((0,c.ZN)({_id:null===L||void 0===L?void 0:L.branchId}))},children:[(0,S.jsx)(b.A.Option,{value:"",children:"Select Bank"}),(null===Y||void 0===Y||null===(l=Y.data)||void 0===l?void 0:l.bankData)&&(null===Y||void 0===Y||null===(d=Y.data)||void 0===d?void 0:d.bankData.length)>0&&Y.data.bankData.map(e=>(0,S.jsx)(b.A.Option,{value:e._id,children:(0,t.ig)(e)},e._id)),"         "]}))}}),O.bankId&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:O.bankId.message})]}),"cash"===h("paymentMode")&&(0,S.jsxs)("div",{className:"w-full",children:[(0,S.jsx)("label",{className:"".concat(t.Q0),children:"Employee"}),(0,S.jsx)(n.xI,{name:"employeeId",control:d,rules:{required:"Employee is required"},render:e=>{let{field:l}=e;return(0,S.jsx)(u.Ay,(0,a.A)((0,a.A)({},l),{},{options:null===T||void 0===T?void 0:T.map(e=>({value:null===e||void 0===e?void 0:e._id,label:null===e||void 0===e?void 0:e.fullName})),classNamePrefix:"react-select",className:"".concat(t.Ph," ").concat(O.employeeId?"border-[1px] ":"border-gray-300"),placeholder:"Select Employee"}))}}),O.employeeId&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:O.employeeId.message})]}),"cheque"===h("paymentMode")&&(0,S.jsxs)("div",{className:"",children:[(0,S.jsxs)("label",{className:"".concat(t.Q0),children:["Cheque No",(0,S.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,S.jsx)("input",(0,a.A)((0,a.A)({type:""},e("chequeNo",{required:"chequeNo is required"})),{},{className:" ".concat(t.Ol," ").concat(O.chequeNo?"border-[1px] ":"border-gray-300"),placeholder:"Enter Cheque no"})),O.chequeNo&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:O.chequeNo.message})]}),"bank"===h("paymentMode")&&(0,S.jsxs)("div",{className:"",children:[(0,S.jsxs)("label",{className:"".concat(t.Q0),children:["Transaction No",(0,S.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,S.jsx)("input",(0,a.A)((0,a.A)({type:"text"},e("transactionNo",{required:"transaction No is required"})),{},{className:" ".concat(t.Ol," ").concat(O.transactionNo?"border-[1px] ":"border-gray-300"),placeholder:"Enter transaction no"})),O.transactionNo&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:O.transactionNo.message})]})]}),(0,S.jsx)("div",{className:"",children:(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"".concat(t.Q0),children:"Payment Date"}),(0,S.jsx)(n.xI,{name:"date",control:d,render:e=>{let{field:l}=e;return(0,S.jsx)(A.A,{field:l,errors:O})}}),O.date&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:"Date is required"})]})})]})}),(0,S.jsxs)("div",{className:"",children:[(0,S.jsxs)("label",{className:"".concat(t.Q0),children:["Naration",(0,S.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,S.jsx)("textarea",(0,a.A)((0,a.A)({},e("naration",{required:"Naration is required"})),{},{className:" ".concat(t.Ol," ").concat(O.naration?"border-[1px] ":"border-gray-300"),placeholder:"Enter Naration"})),O.naration&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:O.naration.message})]}),(0,S.jsxs)("div",{className:"",children:[(0,S.jsxs)("label",{className:"".concat(t.Q0),children:["Amount",(0,S.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,S.jsx)("input",(0,a.A)((0,a.A)({type:"number",step:"0.01"},e("amount",{required:"Amount is required"})),{},{className:" ".concat(t.Ol," ").concat(O.amount?"border-[1px] ":"border-gray-300"),placeholder:"Enter Amount"})),O.amount&&(0,S.jsx)("p",{className:"text-red-500 text-sm",children:O.amount.message})]})]}),(0,S.jsx)("div",{className:"flex justify-end",children:(0,S.jsx)("button",{type:"submit",className:"bg-header text-white p-2 px-4 rounded mt-4",children:"Submit"})})]})})})}}}]);
//# sourceMappingURL=7930.27b68190.chunk.js.map