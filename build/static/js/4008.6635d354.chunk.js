"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[4008],{94008:(e,n,t)=>{t.r(n),t.d(n,{default:()=>O});var o=t(89379),a=t(73216),l=t(83003),i=t(65043),d=t(30064),r=t.n(d),s=t(24858),c=t(58215),p=t(78729),h=t(15187),u=t(60184),m=t(39160),x=t(23156),v=t(47196),w=t(31174),b=t(78227),j=t(735),y=t(65512),g=t(96651),N=t(4938),f=t(55971),C=t(86178),I=t.n(C),A=(t(33007),t(31744),t(42837)),k=t(89427),D=t(70579);const O=function(){const{canCreate:e,canRead:n,canUpdate:t,canDelete:d}=(0,N.A)(),{setValue:C,control:O}=(0,s.mN)(),{userCompanyId:T,userBranchId:L,userType:S}=(0,j.A)(),{visitorList:P,totalVisitorCount:V,loading:_}=(0,l.d4)(e=>e.visitor),{departmentListData:B,loading:E}=(0,l.d4)(e=>e.department),{branchList:Y,loading:F}=(0,l.d4)(e=>e.branch),z=JSON.parse(localStorage.getItem("user_info_".concat(h.AU))),{employeList:M,loading:H}=(0,l.d4)(e=>e.employe),R=(0,a.Zp)(),q=(0,l.wA)(),[G,J]=(0,i.useState)(""),K=((0,s.FH)({control:O,name:"PDCompanyId",defaultValue:T}),(0,s.FH)({control:O,name:"PDBranchId",defaultValue:L})),U=(0,s.FH)({control:O,name:"PdDepartmentId",defaultValue:""}),W=(0,s.FH)({control:O,name:"employee",defaultValue:""}),Z=(0,s.FH)({control:O,name:"category",defaultValue:""});(0,i.useEffect)(()=>{"admin"===S&&q((0,p.Ar)({text:"",sort:!0,status:!0,isPagination:!1}))},[]);const[Q,X]=(0,i.useState)(1),$=[K,W,U,Z,G].join("-"),[ee,ne]=(0,i.useState)(!1);(0,i.useEffect)(()=>{ee?1===Q?te():X(1):ne(e=>!0)},[$]),(0,i.useEffect)(()=>{"manager"===(null===z||void 0===z?void 0:z.roleKey)&&"employee"===(null===z||void 0===z?void 0:z.userType)&&te()},[Q]);const te=()=>{const e={page:Q,limit:10,reqPayload:{departmentId:null!==z&&void 0!==z&&z.departmentId?null===z||void 0===z?void 0:z.departmentId:"",companyId:null===z||void 0===z?void 0:z.companyId,branchId:null===z||void 0===z?void 0:z.branchId,directorId:"",employeId:W,text:G,sort:!0,status:"",isPagination:!0,category:Z}};q((0,c.NP)(e))};return"manager"!==(null===z||void 0===z?void 0:z.roleKey)||"employee"!==(null===z||void 0===z?void 0:z.userType)?(0,D.jsx)(m.A,{children:(0,D.jsx)("div",{className:"bg-red-100 text-red-800 p-4 rounded-md mt-2",children:(0,D.jsx)("p",{className:"text-center font-semibold",children:"You are not a Manager. This page is viewable for Manager only."})})}):(0,D.jsxs)(m.A,{onChange:e=>{J(e)},children:[(0,D.jsx)("div",{className:"",children:(0,D.jsxs)("div",{class:"xl:flex justify-between items-center py-1 xl:space-y-0 space-y-2 overflow-y-auto",children:[(0,D.jsxs)("div",{className:"grid sm:grid-cols-2 grid-cols-1 md:grid-cols-4 sm:gap-3 gap-1",children:[(0,D.jsx)("div",{className:"",children:(0,D.jsx)(s.xI,{control:O,name:"category",rules:{required:"category is required"},render:e=>{let{field:n}=e;return(0,D.jsxs)(y.A,(0,o.A)((0,o.A)({},n),{},{defaultValue:"",disabled:_,className:" ".concat(h.Lp," "),showSearch:!0,filterOption:(e,n)=>String(null===n||void 0===n?void 0:n.children).toLowerCase().includes(e.toLowerCase()),children:[(0,D.jsx)(y.A.Option,{className:"",value:"",children:"Select Category"}),(0,D.jsx)(y.A.Option,{value:"general",children:"General Visitor"}),(0,D.jsx)(y.A.Option,{value:"existing",children:"Existing Client"}),(0,D.jsx)(y.A.Option,{value:"new",children:"New Client"}),(0,D.jsx)(y.A.Option,{value:"employe",children:"Employe To Client"})]}))}})}),(0,D.jsx)("div",{className:"",children:(0,D.jsx)(s.xI,{name:"employee",control:O,render:e=>{var n;let{field:t}=e;return(0,D.jsxs)(y.A,(0,o.A)((0,o.A)({},t),{},{className:" ".concat(h.Lp," "),popupClassName:"!z-[1580]",placeholder:"Select Employee",disabled:_,showSearch:!0,filterOption:(e,n)=>String(null===n||void 0===n?void 0:n.children).toLowerCase().includes(e.toLowerCase()),optionLabelProp:"children",onFocus:()=>(()=>{const e={text:"",status:!0,sort:!0,isTL:"",isHR:"",isPagination:!1,designationId:"",departmentId:null!==z&&void 0!==z&&z.departmentId?null===z||void 0===z?void 0:z.departmentId:"",companyId:null===z||void 0===z?void 0:z.companyId,branchId:null===z||void 0===z?void 0:z.branchId};q((0,A.qV)(e))})(),children:[(0,D.jsx)(y.A.Option,{value:"",children:"Select Employee"}),H?(0,D.jsx)(y.A.Option,{disabled:!0,children:(0,D.jsx)(k.A,{})}):null===(n=(0,h._o)(M))||void 0===n?void 0:n.map(e=>(0,D.jsx)(y.A.Option,{value:e._id,children:e.fullName},e._id))]}))}})})]}),(0,D.jsxs)("div",{className:"flex justify-end items-center gap-2 ",children:[(0,D.jsx)("button",{onClick:()=>{C("employee",""),C("PDBranchId",""),C("PdDepartmentId",""),C("category",""),C("PdCompanyId","")},className:"bg-header   py-[6px]  rounded-md  flex px-5 justify-center items-center  text-white",children:(0,D.jsx)("span",{className:"text-[12px]",children:"Reset"})}),e&&(0,D.jsx)(g.A,{placement:"topLeft",title:"Add Visitor",children:(0,D.jsxs)("button",{onClick:()=>{R("/admin/visitor/create")},className:"bg-header p-2 rounded-md flex justify-center items-center space-x-2 text-white",children:[(0,D.jsx)(u.OiG,{}),(0,D.jsx)("span",{className:"text-[12px] text-nowrap tracking-wide",children:"Add Visitor"})]})})]})]})}),(0,D.jsx)("div",{className:"bg-[#ffffff]  w-full overflow-x-auto mt-1 rounded-xl",children:n&&(0,D.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto ",children:[(0,D.jsx)("thead",{className:"",children:(0,D.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] capitalize text-[12px] bg-header text-white font-[500] h-[40px]",children:[(0,D.jsx)("th",{className:"border-none p-2 whitespace-nowrap w-[8%]",children:"S.no."}),(0,D.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Visitor Name"}),(0,D.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Client Name"}),(0,D.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Category type"}),(0,D.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Mobile Number"}),(0,D.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Contact Person"}),(0,D.jsx)("th",{className:"border-none !w-12 p-2 whitespace-nowrap",children:"Reason"}),(0,D.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"CheckIn"}),(0,D.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"CheckOut"}),(0,D.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Created By"}),(d||t)&&(0,D.jsx)("th",{className:"border-none p-2 whitespace-nowrap w-[8%]",children:"Action"})]})}),_?(0,D.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,D.jsx)("td",{colSpan:10,className:"px-6 py-2 whitespace-nowrap font-[600] text-sm text-gray-500",children:(0,D.jsx)(f.A,{})})}):(0,D.jsx)("tbody",{children:P&&(null===P||void 0===P?void 0:P.length)>0?null===P||void 0===P?void 0:P.map((e,n)=>{var a,l,i,s,p,h,u;return(0,D.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] ".concat(n%2===0?"bg-[#e9ecef]/80":"bg-white"," text-[#374151] text-[14px]"),children:[(0,D.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:n+1+10*(Q-1)}),(0,D.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==(a=null===e||void 0===e?void 0:e.name)&&void 0!==a?a:"-"}),(0,D.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==(l=null===e||void 0===e?void 0:e.clientName)&&void 0!==l?l:"-"}),(0,D.jsx)("td",{className:"whitespace-nowrap border-none p-2 capitalize ",children:null!==(i=null===e||void 0===e?void 0:e.category)&&void 0!==i?i:"-"}),(0,D.jsx)("td",{className:"whitespace-nowrap border-none p-2",children:(null===e||void 0===e||null===(s=e.mobile)||void 0===s?void 0:s.code)+" "+(null===e||void 0===e||null===(p=e.mobile)||void 0===p?void 0:p.number)||"-"}),(0,D.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==(h=null===e||void 0===e?void 0:e.contactPerson)&&void 0!==h?h:"-"}),(0,D.jsx)("td",{className:"whitespace-nowrap border-none p-2 !w-12 ",children:null!==(u=null===e||void 0===e?void 0:e.visitReasonId)&&void 0!==u?u:"-"}),(0,D.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==e&&void 0!==e&&e.checkInTime?I()(null===e||void 0===e?void 0:e.checkInTime).format("DD-MM-YYYY hh:mm a"):"-"}),(0,D.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==e&&void 0!==e&&e.checkOutTime?I()(null===e||void 0===e?void 0:e.checkOutTime).format("DD-MM-YYYY hh:mm a"):(0,D.jsx)(g.A,{placement:"topLeft",title:"Checkout",children:(0,D.jsx)("button",{onClick:()=>{(e=>{let n=(0,o.A)((0,o.A)({},e),{},{_id:null===e||void 0===e?void 0:e._id,checkOutTime:I()()});r().fire({title:"Warning",text:"Are you sure you want to checkout!",icon:"warning",showCancelButton:!0,cancelButtonText:"No"}).then(e=>{e.isConfirmed&&q((0,c._z)(n)).then(e=>{!e.error&&te()})})})(e)},className:"px-2 py-1.5 text-xs rounded-md bg-header text-white border border-muted",type:"button",children:"CheckOut"})})}),(0,D.jsx)("td",{className:"whitespace-nowrap border-none px-2 py-3",children:(null===e||void 0===e?void 0:e.createdBy)||"-"}),(d||t)&&(0,D.jsx)("td",{className:"whitespace-nowrap border-none p-2",children:(0,D.jsxs)("span",{className:"py-1.5 flex justify-start items-center space-x-2",children:[t&&(0,D.jsx)(g.A,{placement:"topLeft",title:"Edit",children:(0,D.jsx)("button",{disabled:(null===e||void 0===e?void 0:e.checkOutTime)&&(null===e||void 0===e?void 0:e.checkInTime),onClick:()=>{R("/admin/visitor/edit/".concat((0,w.w)(null===e||void 0===e?void 0:e._id)))},className:"px-2 py-1.5 text-xs rounded-md bg-transparent border border-muted",type:"button",children:(0,D.jsx)(x.Jcp,{className:"".concat(null!==e&&void 0!==e&&e.checkOutTime&&null!==e&&void 0!==e&&e.checkInTime?"text-gray-400":"hover:text-[#337ab7] text-[#3c8dbc] "),size:16})})}),d&&(0,D.jsx)(g.A,{placement:"topLeft",title:"Delete",children:(0,D.jsx)("button",{disabled:(null===e||void 0===e?void 0:e.checkOutTime)&&(null===e||void 0===e?void 0:e.checkInTime),onClick:()=>(e=>{let n={_id:e};r().fire({title:"Warning",text:"Are you sure you want to delete!",icon:"warning",showCancelButton:!0,cancelButtonText:"No"}).then(e=>{e.isConfirmed&&q((0,c.EF)(n)).then(e=>{Q>1&&1==(null===P||void 0===P?void 0:P.length)?X(Number(Q-1)):!e.error&&te()})})})(null===e||void 0===e?void 0:e._id),className:"px-2 py-1.5 rounded-md bg-transparent border border-muted",type:"button",children:(0,D.jsx)(v.tqC,{className:"".concat(null!==e&&void 0!==e&&e.checkOutTime&&null!==e&&void 0!==e&&e.checkInTime?"text-gray-400":"text-red-600 hover:text-red-500 "),size:16})})})]})})]})}):(0,D.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,D.jsx)("td",{colSpan:4,className:"px-6 py-2 whitespace-nowrap font-[600] text-sm text-gray-500",children:"Record Not Found"})})})]})}),(null===P||void 0===P?void 0:P.length)>0&&(0,D.jsx)(b.A,{totalCount:V,pageSize:10,currentPage:Q,onChange:e=>{X(e)}})]})}}}]);
//# sourceMappingURL=4008.6635d354.chunk.js.map