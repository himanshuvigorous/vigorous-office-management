"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[614],{80614:(e,t,l)=>{l.r(t),l.d(t,{default:()=>D});var a=l(89379),n=l(24858),i=l(83003),o=l(15187),d=l(65043),r=l(31744),s=l(39160),c=l(97326),u=l(487),p=l(20691),v=(l(86178),l(60446)),m=l.n(v),h=(l(78227),l(12106)),x=(l(42837),l(94084),l(69223)),f=l(55971),b=l(50822),y=l(6720),w=l(37762),N=l(64857),g=(l(11906),l(33007),l(89427),l(70337),l(40088),l(12208),l(27744),l(17995),l(76932),l(73216)),j=l(70579);const D=function(){const{RangePicker:e}=u.A,{control:t,formState:{errors:l},setValue:v,watch:D}=(0,n.mN)(),{ledgerId:C}=(0,g.g)(),[S,k]=(0,d.useState)(10),Y=(0,i.wA)(),{clientGroupStatementReportList:A,clientGroupStatementReportFunc_loading:R,clientGroupStatementCount:F}=(0,i.d4)(e=>e.reports),E=(0,d.useMemo)(()=>{if(null!==A&&void 0!==A&&A.allTransections&&A.allTransections.length>0)return A.allTransections[0].previousBalance},[A]),{departmentListData:T,loading:G}=(0,i.d4)(e=>e.department),[B,_]=(0,d.useState)({}),{taskTypeList:I}=(0,i.d4)(e=>e.taskType),{clientGroupList:M}=(0,i.d4)(e=>e.clientGroup),{clientList:L}=(0,i.d4)(e=>e.client),{employeList:P}=(0,i.d4)(e=>e.employe),[z,K]=(0,d.useState)(""),V=JSON.parse(localStorage.getItem("user_info_".concat(o.AU))),{orgTypeList:H,orgSearchloading:O}=(0,i.d4)(e=>e.orgType),[U,W]=(0,d.useState)(1),[J,q]=(0,d.useState)(""),{branchList:Q}=(0,i.d4)(e=>e.branch),X=(0,n.FH)({control:t,name:"PDCompanyId",defaultValue:""});(0,n.FH)({control:t,name:"PDBranchId",defaultValue:""}),(0,d.useEffect)(()=>{const e=setTimeout(()=>{q(z)},500);return()=>{clearTimeout(e)}},[z]);const[Z,$]=(0,d.useState)(0),ee=e=>{var t,l,a,n;Number(null===e||void 0===e?void 0:e.openingBalance);let i=[];return null===e||void 0===e||null===(t=e.allTransections)||void 0===t||t.forEach((e,t)=>{const l={key:"",entryDate:null!==e&&void 0!==e&&e.createdAt?m()(null===e||void 0===e?void 0:e.createdAt).format("DD-MM-YYYY"):"-",valueDate:null!==e&&void 0!==e&&e.createdAt?m()(null===e||void 0===e?void 0:e.createdAt).format("DD-MM-YYYY"):"-",particulars:("invoice"==(null===e||void 0===e?void 0:e.type)?"invoice Generated":null===e||void 0===e?void 0:e.naration)||"-",refNo:("invoice"==(null===e||void 0===e?void 0:e.typeOf)?null===e||void 0===e?void 0:e.refNumber:"receipt"==(null===e||void 0===e?void 0:e.typeOf)?"Receipt ".concat(null===e||void 0===e?void 0:e.refNumber):"")||(null===e||void 0===e?void 0:e.refNumber),clientName:null===e||void 0===e?void 0:e.clientName,debit:"debit"==(null===e||void 0===e?void 0:e.debit_credit)?null===e||void 0===e?void 0:e.amount:0,credit:"credit"==(null===e||void 0===e?void 0:e.debit_credit)?null===e||void 0===e?void 0:e.amount:0,balance:(null===e||void 0===e?void 0:e.currentBalance)||0};i.push(l)}),null===i||void 0===i||i.push({key:"totalBalance",entryDate:"",valueDate:"",particulars:"Total Balance",refNo:"",clientName:"",debit:null===e||void 0===e||null===(l=e.summary)||void 0===l?void 0:l.totalDebit,credit:null===e||void 0===e||null===(a=e.summary)||void 0===a?void 0:a.totalCredit,balance:null===e||void 0===e||null===(n=e.summary)||void 0===n?void 0:n.closingBalance}),i};(0,d.useEffect)(()=>{$(ee(A))},[A]);const te=(0,n.FH)({control:t,name:"time",defaultValue:[]}),le=function(){return{_id:C,startDate:(null===te||void 0===te?void 0:te.length)>0?m()(te[0]).format("YYYY-MM-DD"):"",endDate:(null===te||void 0===te?void 0:te.length)>0?m()(te[1]).format("YYYY-MM-DD"):""}};(0,d.useEffect)(()=>{ae(J)},[U,J,S]);const ae=()=>{Y((0,h.YC)(le(!0)))};(0,d.useEffect)(()=>{"company"!==(null===V||void 0===V?void 0:V.userType)&&"companyDirector"!==(null===V||void 0===V?void 0:V.userType)||Y((0,r.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===V||void 0===V?void 0:V.userType)?X:"company"===(null===V||void 0===V?void 0:V.userType)?null===V||void 0===V?void 0:V._id:null===V||void 0===V?void 0:V.companyId}))},[]);const ne=async()=>{ae()},ie=[{key:"1",label:(0,j.jsx)("span",{className:"text-white",children:"Advance Filters"}),children:(0,j.jsxs)("div",{className:"bg-[#ececec] space-y-1 sm:flex justify-between items-center",children:[(0,j.jsx)("div",{className:"sm:flex  grid grid-cols-1  gap-2 sm:flex-wrap text-[14px]",children:(0,j.jsx)("div",{className:"",children:(0,j.jsx)(n.xI,{name:"time",control:t,render:t=>{let{field:l}=t;return(0,j.jsx)(e,(0,a.A)((0,a.A)({},l),{},{value:l.value,onChange:e=>l.onChange(e),format:"YYYY-MM-DD",getPopupContainer:()=>document.body,popupClassName:"vertical-range-calendar",className:"custom-range-picker"}))}})})}),(0,j.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,j.jsx)("button",{onClick:()=>{v("time",""),ne()},className:"bg-header py-2 my-0.5 rounded-md flex px-10 justify-center items-center text-white",children:(0,j.jsx)("span",{className:"text-[12px]",children:"Reset"})}),(0,j.jsx)("button",{onClick:()=>{ne()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,j.jsx)("span",{className:"text-[12px]",children:"Submit"})})]})]})}];return(0,j.jsx)(s.A,{onChange:e=>{K(e)},children:(0,j.jsxs)("div",{className:"bg-grey-100 w-full p-1",children:[(0,j.jsxs)("div",{className:"",children:[(0,j.jsx)(c.A,{className:"custom-collapse",items:ie,defaultActiveKey:[1],expandIcon:e=>{let{isActive:t}=e;return(0,j.jsx)(y.WnU,{size:20,style:{color:"white",transform:t?"rotate(-90deg)":"rotate(0deg)",transition:"transform 0.3s ease"}})}}),(0,j.jsxs)("div",{className:"space-y-1.5 flex justify-between items-center md:flex-row flex-col mt-2",children:[(0,j.jsxs)(p.A,{column:2,size:"small",bordered:!0,children:[(0,j.jsx)(p.A.Item,{label:"Group Name",children:(null===A||void 0===A?void 0:A.fullName)||"-"}),(0,j.jsx)(p.A.Item,{label:"Group ID",children:(null===A||void 0===A?void 0:A.groupName)||"-"})]}),(0,j.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,j.jsx)("button",{onClick:()=>{(async()=>{var e;const t=new w.uE({orientation:"landscape",unit:"pt"});t.setFontSize(16),t.text("Client Group Statement Report",40,30);const l=await(null===b.K||void 0===b.K?void 0:b.K.clientGroupStatementReportFunc(le(!1))),a=ee(null===l||void 0===l?void 0:l.data);if(!a||0===a.length)return;Number(E||0);const n=null===(e=ee(null===l||void 0===l?void 0:l.data))||void 0===e?void 0:e.map((e,t)=>[t+1,null===e||void 0===e?void 0:e.entryDate,null===e||void 0===e?void 0:e.valueDate,null===e||void 0===e?void 0:e.particulars,null===e||void 0===e?void 0:e.refNo,null===e||void 0===e?void 0:e.clientName,null!==e&&void 0!==e&&e.debit?Number(null===e||void 0===e?void 0:e.debit).toFixed(2):0,null!==e&&void 0!==e&&e.credit?Number(null===e||void 0===e?void 0:e.credit).toFixed(2):0,(null===e||void 0===e?void 0:e.balance)||0]);(0,N.Ay)(t,{startY:50,head:[["S.No.","Entry Date","Value Date","Particulars","Ref No.","Client Name","Debit","Credit","Balance"]],body:n,margin:{horizontal:10},styles:{cellPadding:8,fontSize:10,valign:"middle",halign:"left"},headStyles:{fillColor:[64,64,64],textColor:[255,255,255],fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]}}),t.save("Client_Group_Statement_Report.pdf")})()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,j.jsx)("span",{className:"text-[12px]",children:"Export PDF"})}),(0,j.jsx)("button",{onClick:()=>{(async()=>{var e;const t=new x.Workbook,l=t.addWorksheet("ClientGroupStatement");l.columns=[{header:"S.No.",key:"sno",width:10},{header:"Entry Date",key:"entryDate",width:20},{header:"Value Date",key:"valueDate",width:20},{header:"Particulars",key:"particulars",width:40},{header:"Ref No.",key:"refNo",width:20},{header:"Client Name",key:"clientName",width:25},{header:"Debit",key:"debit",width:15},{header:"Credit",key:"credit",width:15},{header:"Balance",key:"balance",width:15}],l.getRow(1).eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFB6D7A8"}},e.font={bold:!0},e.alignment={vertical:"middle",horizontal:"center"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});const a=await(null===b.K||void 0===b.K||null===(e=b.K.clientGroupStatementReportFunc)||void 0===e?void 0:e.call(b.K,le(!1))),n=ee(null===a||void 0===a?void 0:a.data)||[];null===n||void 0===n||n.forEach((e,t)=>{l.addRow({sno:t+1,entryDate:null===e||void 0===e?void 0:e.entryDate,valueDate:null===e||void 0===e?void 0:e.valueDate,particulars:null===e||void 0===e?void 0:e.particulars,refNo:null===e||void 0===e?void 0:e.refNo,clientName:null===e||void 0===e?void 0:e.clientName,debit:null!==e&&void 0!==e&&e.debit?Number(null===e||void 0===e?void 0:e.debit).toFixed(2):0,credit:null!==e&&void 0!==e&&e.credit?Number(null===e||void 0===e?void 0:e.credit).toFixed(2):0,balance:null===e||void 0===e?void 0:e.balance})}),l.eachRow({includeEmpty:!1},(e,t)=>{1!==t&&e.eachCell(e=>{e.alignment={vertical:"middle",horizontal:"left"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),l.autoFilter={from:"A1",to:"H1"},t.xlsx.writeBuffer().then(e=>{const t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=document.createElement("a");l.href=URL.createObjectURL(t),l.download="ClientGroupStatement.xlsx",l.click()})})()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,j.jsx)("span",{className:"text-[12px]",children:"Export Excel"})})]})]})]}),(0,j.jsx)("div",{className:"bg-[#ffffff]  w-full overflow-x-auto mt-1 rounded-xl",children:(0,j.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto",children:[(0,j.jsx)("thead",{children:(0,j.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] capitalize text-[12px] bg-header text-white font-[500] h-[40px]",children:[(0,j.jsx)("th",{className:"border-none p-2 whitespace-nowrap  w-[5%]",children:"S.No."}),(0,j.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Entry  Date"}),(0,j.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Value  Date"}),(0,j.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"particulars"}),(0,j.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:" Ref no."}),(0,j.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Client Name"}),(0,j.jsx)("th",{className:"border-none p-2 whitespace-nowrap text-right",children:"Debit"}),(0,j.jsx)("th",{className:"border-none p-2 whitespace-nowrap ext-right",children:"Credit"}),(0,j.jsx)("th",{className:"border-none p-2 whitespace-nowrap text-right",children:"Balance"})]})}),R?(0,j.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,j.jsx)("td",{colSpan:15,className:"px-6 py-2 whitespace-nowrap  font-[600] text-sm text-gray-500",children:(0,j.jsx)(f.A,{})})}):(0,j.jsx)("tbody",{children:Z&&(null===Z||void 0===Z?void 0:Z.length)>0?null===Z||void 0===Z?void 0:Z.map((e,t)=>(0,j.jsxs)("tr",{className:"border-b-[1px] ".concat(t%2===0?"bg-[#e9ecef]/80":"bg-white"," border-[#DDDDDD] text-[#374151] text-[14px]"),children:[(0,j.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:t+1+(U-1)*S}),(0,j.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:null===e||void 0===e?void 0:e.entryDate}),(0,j.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:null===e||void 0===e?void 0:e.valueDate}),(0,j.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:(null===e||void 0===e?void 0:e.particulars)||"-"}),(0,j.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:null===e||void 0===e?void 0:e.refNo}),(0,j.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:(null===e||void 0===e?void 0:e.clientName)||"-"}),(0,j.jsx)("td",{className:"whitespace-nowrap  border-none p-2 text-right",children:(0,o.w2)(null===e||void 0===e?void 0:e.debit)}),(0,j.jsx)("td",{className:"whitespace-nowrap  border-none p-2 text-right",children:(0,o.w2)(null===e||void 0===e?void 0:e.credit)}),(0,j.jsx)("td",{className:"tableData text-right",children:(0,o.w2)(null===e||void 0===e?void 0:e.balance)})]})):(0,j.jsx)("tr",{className:"bg-white bg-opacity-5",children:(0,j.jsx)("td",{colSpan:15,className:"px-6 py-2 whitespace-nowrap  font-[600] text-sm text-gray-500",children:"Record Not Found"})})})]})})]})})}}}]);
//# sourceMappingURL=614.12a5ebd7.chunk.js.map