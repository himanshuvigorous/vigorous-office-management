"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[945],{70945:(e,t,a)=>{a.r(t),a.d(t,{default:()=>j});var l=a(65043),s=a(73216),n=a(35475),d=a(83003),o=a(60184),i=(a(86459),a(65512)),c=a(39160),r=(a(42837),a(31744)),m=a(735),h=a(15187),u=a(55971),x=a(31174),p=a(89427),b=a(78227),v=a(27810),y=a(89707),f=a(69223),g=a(70579);const j=function(){const e=(0,s.Zp)(),t=(0,d.wA)(),{userCompanyId:a,userType:j}=(0,m.A)(),{getCashbookEmployeeListData:N,totalCashbookEmployeeListCount:w,getCashbookEmployeeListLoading:k,getCashbookEmployeeSummry:C}=(0,d.d4)(e=>e.cashbook),{sidebarListData:D}=(0,d.d4)(e=>e.dynamicSidebar),{branchList:E,branchListloading:A}=(0,d.d4)(e=>e.branch),[S,I]=(0,n.ok)(),L=parseInt(S.get("page"))||1,R=S.get("branchId")||"",[B,_]=(0,l.useState)(L),[H,P]=(0,l.useState)(10),[z,F]=(0,l.useState)(""),[O,T]=(0,l.useState)(R);(0,l.useEffect)(()=>{const e=new URLSearchParams;B>1&&e.set("page",B),O&&e.set("branchId",O),I(e)},[B,H,O,z]),(0,l.useEffect)(()=>{U()},[B,H,O,z]);const U=()=>{const e={currentPage:B,pageSize:H,reqData:{text:z,status:!0,isHR:"",isTL:"",sort:!1,isPagination:!0,departmentId:"",designationId:"",companyId:a,branchId:O}};t((0,v.Tn)(e))};return(0,l.useEffect)(()=>{"company"!==j&&"companyDirector"!==j||t((0,r.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:a}))},[]),(0,g.jsxs)(c.A,{onChange:e=>{F(e)},children:[(0,g.jsxs)("div",{className:"flex justify-start items-center my-1",children:[(0,g.jsx)("button",{onClick:()=>{var t;e("/admin/cashbook/".concat((0,x.w)(null===D||void 0===D||null===(t=D.find(e=>"cashbook"===(null===e||void 0===e?void 0:e.slug)))||void 0===t?void 0:t._id)))},className:"text-black px-3 py-2 border rounded-l-md flex justify-center items-center space-x-2",children:(0,g.jsx)("span",{className:"text-[12px]",children:"Approval View"})}),(0,g.jsx)("button",{className:"bg-header border-header text-white px-3 py-2 border rounded-l-md flex justify-center items-center space-x-2",children:(0,g.jsx)("span",{className:"text-[12px]",children:"Employee View"})})]}),(0,g.jsxs)("div",{className:"bg-grey-100 w-full p-1",children:[(0,g.jsx)("div",{className:"w-full",children:(0,g.jsxs)("div",{className:"sm:flex justify-between items-center md:space-y-0 space-y-2 py-1",children:[(0,g.jsx)("div",{className:"grid sm:grid-cols-2 grid-cols-1 lg:grid-cols-3 sm:gap-3 gap-1",children:("admin"===j||"company"===j||"companyDirector"===j)&&(0,g.jsx)("div",{className:"relative md:flex justify-center items-center space-x-2 text-[14px] rounded-md",children:(0,g.jsxs)(i.A,{value:O,onChange:e=>{T(e),_(1)},defaultValue:"",disabled:k,className:"".concat(h.Lp),showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,g.jsx)(i.A.Option,{value:"",children:"Select Branch"}),A?(0,g.jsx)(i.A.Option,{disabled:!0,children:(0,g.jsx)(p.A,{})}):null===E||void 0===E?void 0:E.map(e=>(0,g.jsx)(i.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]})})}),(0,g.jsx)("div",{className:"flex justify-end items-center",children:(0,g.jsx)("button",{onClick:()=>T(""),className:"bg-header py-[6px] rounded-md flex px-5 justify-center items-center text-white",children:(0,g.jsx)("span",{className:"text-[12px]",children:"Reset"})})})]})}),(0,g.jsxs)("div",{className:"flex justify-between items-center mt-2 mb-1",children:[(0,g.jsx)("div",{className:"bg-white shadow-sm px-4 py-2 rounded-md border ",children:(0,g.jsxs)("span",{className:"text-[14px] font-semibold ",children:["Total Amount:\xa0",null!=C?Number(C).toFixed(2):"0.00"]})}),(0,g.jsx)("button",{onClick:()=>{(async()=>{var e,t,l;const s=new f.Workbook,n=s.addWorksheet("Employee Attendance");n.columns=[{header:"S.No",key:"sno",width:10},{header:"Employee Name",key:"name",width:30},{header:"Employee Code",key:"code",width:30},{header:"Closing Balance",key:"balance",width:30}],n.getRow(1).eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFB6D7A8"}},e.font={bold:!0},e.alignment={vertical:"middle",horizontal:"center"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});const d={currentPage:B,pageSize:"",reqData:{text:"",status:!0,isHR:"",isTL:"",sort:!1,isPagination:!1,departmentId:"",designationId:"",companyId:a,branchId:O}},o=await(null===y.h||void 0===y.h?void 0:y.h.getCashbookEmployeeList(d));if(!o)return;const i=null===o||void 0===o||null===(e=o.data)||void 0===e||null===(t=e.result)||void 0===t||null===(l=t.docs)||void 0===l?void 0:l.map((e,t)=>{var a;return{sno:t+1,name:(null===e||void 0===e?void 0:e.fullName)||"-",code:(null===e||void 0===e?void 0:e.userName)||"-",balance:(null===e||void 0===e||null===(a=e.summary)||void 0===a?void 0:a.closingBalance)||"-"}});null===i||void 0===i||i.forEach(e=>{n.addRow(e).eachCell(e=>{e.alignment={vertical:"middle",horizontal:"left"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),n.autoFilter={from:"A1",to:"I1"},s.xlsx.writeBuffer().then(e=>{const t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=document.createElement("a");a.href=URL.createObjectURL(t),a.download="Employee_Attendance_Report.xlsx",a.click()})})()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,g.jsx)("span",{className:"text-[12px]",children:"Export Excel"})})]}),(0,g.jsx)("div",{className:"bg-[#ffffff] w-full overflow-x-auto mt-1 rounded-xl",children:(0,g.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto",children:[(0,g.jsx)("thead",{children:(0,g.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] capitalize bg-header text-white font-[500] h-[40px]",children:[(0,g.jsx)("th",{className:"tableHead w-[5%]",children:"S.No."}),(0,g.jsx)("th",{className:"tableHead w-[10%]",children:"Employe Name"}),(0,g.jsx)("th",{className:"tableHead w-[10%]",children:"Employe Code"}),(0,g.jsx)("th",{className:"tableHead w-[10%]",children:"Closing Balance"}),(0,g.jsx)("th",{className:"tableHead w-[5%]",children:"Action"})]})}),k?(0,g.jsx)("tr",{className:"bg-white bg-opacity-5",children:(0,g.jsx)("td",{colSpan:10,className:"px-6 py-2 whitespace-nowrap text-center font-[600] text-sm text-gray-500",children:(0,g.jsx)(u.A,{})})}):(0,g.jsx)("tbody",{children:N&&(null===N||void 0===N?void 0:N.length)>0?null===N||void 0===N?void 0:N.map((t,a)=>{var l,s;return(0,g.jsxs)("tr",{className:"border-b-[1px] ".concat(a%2===0?"bg-[#e9ecef]/80":"bg-white"," border-[#DDDDDD] text-[#374151]"),children:[(0,g.jsx)("td",{className:"tableData",children:a+1+(B-1)*H}),(0,g.jsx)("td",{className:"tableData",children:(null===t||void 0===t?void 0:t.fullName)||"-"}),(0,g.jsx)("td",{className:"tableData",children:(null===t||void 0===t?void 0:t.userName)||"-"}),(0,g.jsx)("td",{className:"tableData",children:null!=(null===t||void 0===t||null===(l=t.summary)||void 0===l?void 0:l.closingBalance)?Number(null===t||void 0===t||null===(s=t.summary)||void 0===s?void 0:s.closingBalance).toFixed(2):"0.00"}),(0,g.jsx)("td",{className:"tableData",children:(0,g.jsx)("button",{onClick:()=>{e("/admin/cashbook/employee/".concat((0,x.w)(null===t||void 0===t?void 0:t.companyId),"/").concat((0,x.w)(null===t||void 0===t?void 0:t.branchId),"/").concat((0,x.w)(null===t||void 0===t?void 0:t._id)))},className:"px-2 py-2 text-xs rounded-md bg-transparent text-header border border-muted",type:"button",children:(0,g.jsx)(o.Ny1,{className:"hover:text-[#337ab7] text-[#3c8dbc]"})})})]},null===t||void 0===t?void 0:t._id)}):(0,g.jsx)("tr",{className:"bg-white bg-opacity-5",children:(0,g.jsx)("td",{colSpan:9,className:"px-6 py-2 whitespace-nowrap text-center font-[600] text-sm text-gray-500",children:"Record Not Found"})})})]})}),(null===N||void 0===N?void 0:N.length)>0&&(0,g.jsx)(b.A,{totalCount:w,pageSize:H,currentPage:B,onChange:e=>_(e)})]})]})}},86459:()=>{}}]);
//# sourceMappingURL=945.fd5b3f65.chunk.js.map