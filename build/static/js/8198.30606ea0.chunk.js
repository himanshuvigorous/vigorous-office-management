"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[8198],{38198:(e,l,a)=>{a.r(l),a.d(l,{default:()=>w});var s=a(89379),t=a(65043),d=a(24858),n=a(83003),i=a(73216),r=a(15187),o=a(735),c=a(78729),m=a(39160),u=a(31744),v=a(51957),x=a(65512),h=(a(36105),a(30575),a(84480),a(42837)),p=a(70337),g=a(56659),N=(a(86178),a(17995)),j=a(84448),y=a(89427),b=a(33007),f=a(31174),D=a(58215),I=a(94084),A=a(60446),C=a.n(A),P=a(70579);const w=function(){const{register:e,handleSubmit:l,setValue:a,getValues:A,unregister:w,watch:S,control:q,formState:{errors:O}}=(0,d.mN)(),{userCompanyId:L,userDirectorId:M,userBranchId:T,userEmployeId:_,userDepartmentId:H,userDesignationId:E,userType:V}=(0,o.A)(),{clientIdEnc:Y}=(0,i.g)(),{companyList:Q,companyListLoading:F}=((0,f.Yc)(Y),(0,n.d4)(e=>e.company)),{countryListData:k}=(0,n.d4)(e=>e.country),{stateListData:B}=(0,n.d4)(e=>e.states),{cityListData:U}=(0,n.d4)(e=>e.city),{employeList:R,loading:z}=(0,n.d4)(e=>e.employe),{clientList:J,loading:K}=(0,n.d4)(e=>e.client),{departmentListData:Z,loading:$}=(0,n.d4)(e=>e.department),G=(0,i.Zp)(),W=(0,n.wA)(),{branchList:X,branchListloading:ee}=(0,n.d4)(e=>e.branch),{VisitReasonList:le,loading:ae}=(0,n.d4)(e=>e.visitReason),[se,te]=(0,t.useState)([]),[de,ne]=(0,t.useState)(""),[ie,re]=(0,t.useState)(""),oe=(0,d.FH)({control:q,name:"companyId",defaultValue:L}),ce=(0,d.FH)({control:q,name:"branchId",defaultValue:""}),me=(0,d.FH)({control:q,name:"PDPinCode",defaultValue:""}),ue=((0,d.FH)({control:q,name:"PDDepartmentId",defaultValue:""}),(0,d.FH)({control:q,name:"PDState",defaultValue:""}),(0,d.FH)({control:q,name:"PDCountry",defaultValue:""}),(0,d.FH)({control:q,name:"PDDepartmentId",defaultValue:[]})),ve=(0,d.FH)({control:q,name:"category",defaultValue:""}),xe=(0,d.FH)({control:q,name:"clientId",defaultValue:""}),[he,pe]=(0,t.useState)();(0,t.useEffect)(()=>{W((0,j.Ih)({companyId:oe,directorId:"",branchId:ce,text:"",sort:!0,status:!0,isPagination:!1}))},[ce,oe]),(0,t.useEffect)(()=>{var e,l,s,t,d,n,i,r,o,c,m,u;const v=null===J||void 0===J?void 0:J.find(e=>e._id===xe);a("PDAddress",null===v||void 0===v||null===(e=v.addresses)||void 0===e||null===(l=e.primary)||void 0===l?void 0:l.street),a("PDState",null===v||void 0===v||null===(s=v.addresses)||void 0===s||null===(t=s.primary)||void 0===t?void 0:t.state),a("PDCountry",null===v||void 0===v||null===(d=v.addresses)||void 0===d||null===(n=d.primary)||void 0===n?void 0:n.country),a("PDCity",null===v||void 0===v||null===(i=v.addresses)||void 0===i||null===(r=i.primary)||void 0===r?void 0:r.city),a("PDPinCode",null===v||void 0===v||null===(o=v.addresses)||void 0===o||null===(c=o.primary)||void 0===c?void 0:c.pinCode),a("PDMobileCode",null===v||void 0===v||null===(m=v.mobile)||void 0===m?void 0:m.code),a("PDMobileNo",null===v||void 0===v||null===(u=v.mobile)||void 0===u?void 0:u.number)},[xe]),(0,t.useEffect)(()=>{"admin"===V&&W((0,c.Ar)({text:"",sort:!0,status:!0,isPagination:!1}))},[]),(0,t.useEffect)(()=>{(oe||"company"===V||"companyDirector"===V)&&W((0,u.d0)({text:"",sort:!0,status:!0,companyId:oe,isPagination:!1}))},[oe]),(0,t.useEffect)(()=>{W((0,b.UU)({text:"",sort:!0,status:!0,isPagination:!1,companyId:oe,branchId:ce}))},[ce]),(0,t.useEffect)(()=>{me&&me.length>=4&&me.length<=6&&/^\d{6}$/.test(me)&&(0,r.jh)(me).then(e=>{e&&(a("PDCity",e.city),a("PDState",e.state),a("PDCountry",e.country),a("PDMobileCode","+91"))}).catch(e=>{console.error("Error fetching data:",e)})},[me]),JSON.parse(localStorage.getItem("user_info_".concat(r.AU)));const{loading:ge}=(0,n.d4)(e=>e.visitor),[Ne,je]=(0,t.useState)([]),[ye,be]=(0,t.useState)([]),[fe,De]=(0,t.useState)([]),[Ie,Ae]=(0,t.useState)(!1),[Ce,Pe]=(0,t.useState)(!1),we=null===Ne||void 0===Ne?void 0:Ne.map(e=>e.value),Se=null===ye||void 0===ye?void 0:ye.map(e=>e.value),qe="__all__",Oe="__all__",Le=[{label:"Select All",value:qe},...Ne],Me=[{label:"Select All",value:Oe},...Array.isArray(ye)?ye:[]],Te=()=>{W((0,b.UU)({text:"",sort:!0,status:!0,isPagination:!1,companyId:oe,branchId:ce})).then(e=>{var l,a,s;const t=null===e||void 0===e||null===(l=e.payload)||void 0===l||null===(a=l.data)||void 0===a||null===(s=a.docs)||void 0===s?void 0:s.map(e=>{var l;return{label:null===e||void 0===e?void 0:e.name,value:null===e||void 0===e?void 0:e._id,searchText:null===e||void 0===e||null===(l=e.name)||void 0===l?void 0:l.toLowerCase()}});je(t)})},_e=()=>{const e={directorId:"",companyId:oe,branchId:ce,departmentId:ue,text:"",sort:!0,status:"",isPagination:!1,multipleDepartmentId:[]};W((0,h.qV)(e)).then(e=>{var l,a,s;const t=null===e||void 0===e||null===(l=e.payload)||void 0===l||null===(a=l.data)||void 0===a||null===(s=a.docs)||void 0===s?void 0:s.map(e=>{var l;return{label:null===e||void 0===e?void 0:e.fullName,value:null===e||void 0===e?void 0:e._id,searchText:null===e||void 0===e||null===(l=e.fullName)||void 0===l?void 0:l.toLowerCase()}});be(t)})};return(0,P.jsx)(m.A,{children:(0,P.jsx)("div",{className:"gap-4",children:(0,P.jsxs)("form",{autoComplete:"off",className:"mt-1",onSubmit:l(e=>{var l,a,s;const t={companyId:oe||L,directorId:"",branchId:ce||T,departmentIds:null!==e&&void 0!==e&&e.PDDepartmentId?[null===e||void 0===e?void 0:e.PDDepartmentId]:[],employeIds:null!==e&&void 0!==e&&e.contactPersonId?[null===e||void 0===e?void 0:e.contactPersonId]:[],name:null===e||void 0===e?void 0:e.visitorName,reason:null===e||void 0===e?void 0:e.reason,numberOfPerson:Number(null===e||void 0===e?void 0:e.numberOfPerson),clientId:null===e||void 0===e?void 0:e.clientId,employeId:"",category:ve,clientId:null===e||void 0===e?void 0:e.clientId,timeDurationStart:null===e||void 0===e?void 0:e.startTime,timeDurationEnd:null===e||void 0===e?void 0:e.endTime,date:null===e||void 0===e?void 0:e.startTime,address:{street:null!==(l=null===e||void 0===e?void 0:e.PDAddress)&&void 0!==l?l:""},mobile:{number:null!==(a=null===e||void 0===e?void 0:e.PDMobileNo)&&void 0!==a?a:"",code:null!==(s=null===e||void 0===e?void 0:e.PDMobileCode)&&void 0!==s?s:""}};W((0,D.fw)(t)).then(e=>{e.error||G(-1)})}),children:[(0,P.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 md:gap-8 gap-4 md:my-2",children:["admin"===V&&(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsxs)("label",{className:"".concat(r.Q0),children:["Company ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)(d.xI,{control:q,name:"companyId",rules:{required:"Company is required"},render:e=>{let{field:l}=e;return(0,P.jsxs)(x.A,(0,s.A)((0,s.A)({},l),{},{defaultValue:"",className:" ".concat(r.Hy," ").concat(O.companyId?"border-[1px] ":"border-gray-300"),showSearch:!0,filterOption:(e,l)=>String(null===l||void 0===l?void 0:l.children).toLowerCase().includes(e.toLowerCase()),onFocus:()=>{W((0,c.Ar)({text:"",sort:!0,status:"",isPagination:!1}))},children:[(0,P.jsx)(x.A.Option,{value:"",children:"Select Company"}),F?(0,P.jsx)(x.A.Option,{disabled:!0,children:(0,P.jsx)(y.A,{})}):null===Q||void 0===Q?void 0:Q.map(e=>(0,P.jsx)(x.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),O.companyId&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:O.companyId.message})]}),("admin"===V||"company"===V||"companyDirector"===V)&&(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsxs)("label",{className:"".concat(r.Q0),children:["Branch ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)(d.xI,{control:q,name:"branchId",rules:{required:"Branch is required"},render:e=>{let{field:l}=e;return(0,P.jsxs)(x.A,(0,s.A)((0,s.A)({},l),{},{defaultValue:"",className:" ".concat(r.Hy," "),showSearch:!0,filterOption:(e,l)=>String(null===l||void 0===l?void 0:l.children).toLowerCase().includes(e.toLowerCase()),onFocus:()=>{const e={text:"",sort:!0,status:"",isPagination:!1,companyId:oe};W((0,u.d0)(e))},children:[(0,P.jsx)(x.A.Option,{value:"",children:"Select Branch"}),ee?(0,P.jsx)(x.A.Option,{disabled:!0,children:(0,P.jsx)(y.A,{})}):null===X||void 0===X?void 0:X.map(e=>(0,P.jsx)(x.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),O.branchId&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:O.branchId.message})]}),(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsxs)("label",{className:"".concat(r.Q0),children:["Category ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)(d.xI,{control:q,name:"category",rules:{required:"category is required"},render:e=>{let{field:l}=e;return(0,P.jsxs)(x.A,(0,s.A)((0,s.A)({},l),{},{defaultValue:"",className:" ".concat(r.Hy," "),showSearch:!0,filterOption:(e,l)=>String(null===l||void 0===l?void 0:l.children).toLowerCase().includes(e.toLowerCase()),onChange:e=>{l.onChange(e),re(e)},children:[(0,P.jsx)(x.A.Option,{className:"",value:"",children:"Select Category"}),(0,P.jsx)(x.A.Option,{value:"general",children:"Employee Visitor"}),(0,P.jsx)(x.A.Option,{value:"client",children:"client Visitor"})]}))}}),O.category&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:O.category.message})]}),"client"==ve&&(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsxs)("label",{className:"".concat(r.Q0),children:["Client ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)(d.xI,{control:q,name:"clientId",rules:{required:"client is required"},render:e=>{let{field:l}=e;return(0,P.jsxs)(x.A,(0,s.A)((0,s.A)({},l),{},{defaultValue:"",className:" ".concat(r.Hy," "),showSearch:!0,filterOption:(e,l)=>String(null===l||void 0===l?void 0:l.children).toLowerCase().includes(e.toLowerCase()),onFocus:()=>{const e={directorId:"",companyId:oe,branchId:ce,userType:"client",text:"",sort:!0,status:"",isPagination:!1};W((0,p.Aq)(e))},onChange:async e=>{var a,s;l.onChange(e);const t=await W((0,p.wo)({_id:e}));null!==t&&void 0!==t&&null!==(a=t.payload)&&void 0!==a&&null!==(s=a.data)&&void 0!==s&&s.departmentData?te(t.payload.data.departmentData):te([])},children:[(0,P.jsx)(x.A.Option,{className:"",value:"",children:"Select Client"}),K?(0,P.jsx)(x.A.Option,{disabled:!0,children:(0,P.jsx)(y.A,{})}):null===J||void 0===J?void 0:J.map(e=>(0,P.jsx)(x.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName}))]}))}}),O.clientId&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:O.clientId.message})]}),(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsxs)("label",{className:"".concat(r.Q0),children:["Name ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)("input",(0,s.A)((0,s.A)({type:"text"},e("visitorName",{required:"Name is required"})),{},{className:"placeholder: ".concat(r.Ol," ").concat(O.visitorName?"border-[1px] ":"border-gray-300"),placeholder:"Enter Name"})),O.visitorName&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:O.visitorName.message})]}),(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsxs)("label",{className:"".concat(r.Q0),children:["Department ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)(d.xI,{name:"PDDepartmentId",control:q,rules:{required:"At least one Department is required"},render:e=>{let{field:l}=e;return(0,P.jsx)(x.A,{placeholder:"Department",value:l.value||[],onChange:e=>{e.includes(qe)?Ie?(l.onChange([]),Ae(!1)):(l.onChange(we),Ae(!0)):(l.onChange(e),Ae(e.length===we.length))},onFocus:Te,size:"large",style:{width:"100%"},options:Le,className:"inputAntdMultipleSelectClassName",showSearch:!0,filterOption:(e,l)=>String(null===l||void 0===l?void 0:l.children).toLowerCase().includes(e.toLowerCase())})}}),O.PDDepartmentId&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:O.PDDepartmentId.message})]}),(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsxs)("label",{className:"".concat(r.Q0),children:["Employee Name ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)(d.xI,{name:"contactPersonId",control:q,rules:{required:"At least one Contact Person is required"},render:e=>{let{field:l}=e;return(0,P.jsx)(x.A,{placeholder:"Assign To",value:l.value||[],onChange:e=>{if(e.includes(Oe)){var a;(null===(a=l.value)||void 0===a?void 0:a.length)===Se.length?(l.onChange([]),Pe(!1)):(l.onChange(Se),Pe(!0))}else l.onChange(e),Pe(e.length===Se.length)},onFocus:_e,size:"large",style:{width:"100%"},options:Me||[],className:"inputAntdMultipleSelectClassName",showSearch:!0,filterOption:(e,l)=>String(null===l||void 0===l?void 0:l.children).toLowerCase().includes(e.toLowerCase())})}}),O.contactPersonId&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:O.contactPersonId.message})]}),(0,P.jsxs)("div",{className:"",children:[(0,P.jsxs)("label",{className:"".concat(r.Q0),children:["Start Time ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)(d.xI,{name:"startTime",control:q,showTime:!0,rules:{required:"Start Time  is required"},format:"DD/MM/YYYY HH:mm",render:e=>{let{field:l}=e;return(0,P.jsx)(I.A,{field:l,showTime:!0,format:"DD/MM/YYYY HH:mm",errors:O,disabledDate:e=>e&&e.isBefore(C()().endOf("day"),"day")})}}),O.startTime&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:O.startTime.message})]}),(0,P.jsxs)("div",{className:"",children:[(0,P.jsxs)("label",{className:"".concat(r.Q0),children:["End Time ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)(d.xI,{name:"endTime",control:q,showTime:!0,rules:{required:"ENd Time  is required"},format:"DD/MM/YYYY HH:mm",render:e=>{let{field:l}=e;return(0,P.jsx)(I.A,{field:l,showTime:!0,format:"DD/MM/YYYY HH:mm",errors:O,disabledDate:e=>e&&e.isBefore(C()().endOf("day"),"day")})}}),O.endTime&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:O.endTime.message})]}),(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsxs)("label",{className:"".concat(r.Q0),children:["Reason ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)(d.xI,{control:q,name:"reason",rules:{required:"reason is required"},render:e=>{var l;let{field:a}=e;return(0,P.jsx)(v.A,(0,s.A)((0,s.A)({className:"w-full"},a),{},{onChange:e=>{a.onChange(e)},options:null===(l=(0,r._o)(le))||void 0===l?void 0:l.map(e=>({value:null===e||void 0===e?void 0:e.title})),children:(0,P.jsx)("input",{placeholder:"Enter Reason",className:"".concat(r.Ol)})}))}}),O.reason&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:O.reason.message})]}),"employe"===ve&&(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsxs)("label",{className:"".concat(r.Q0),children:["KM ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)("input",(0,s.A)((0,s.A)({type:"number"},e("kilometer",{required:"Number kilometer is required"})),{},{className:"placeholder: ".concat(r.Ol," ").concat(O.kilometer?"border-[1px] ":"border-gray-300"),placeholder:"Enter Number kilometer"})),O.designationName&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:O.kilometer.message})]}),"employe"===ve&&(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsxs)("label",{className:"".concat(r.Q0),children:["Date ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)("input",(0,s.A)((0,s.A)({type:"date",min:(new Date).toISOString().split("T")[0]},e("date",{required:"Date is required"})),{},{className:" ".concat(r.Ol," ").concat(O.date?"border-[1px] ":"border-gray-300"),placeholder:"Enter Date of Birth"})),O.date&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:O.date.message})]})]}),(0,P.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 md:gap-8 md:my-2 my-4",children:(0,P.jsxs)("div",{className:"col-span-2",children:[(0,P.jsxs)("label",{className:"".concat(r.Q0),children:["Address"," ","general"!==ve&&(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)("input",(0,s.A)((0,s.A)({type:"text"},e("PDAddress",{required:"general"!==ve&&"Address is required"})),{},{className:"".concat(r.Ol," ").concat(O.PDAddress?"border-[1px] ":"border-gray-300"),placeholder:"Enter Address "})),O.PDAddress&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:O.PDAddress.message})]})}),(0,P.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 md:gap-8 gap-4 my-3",children:(0,P.jsxs)("div",{className:"flex gap-3",children:[(0,P.jsxs)("div",{className:"w-[150px]",children:[(0,P.jsxs)("label",{className:"".concat(r.Q0),children:["Code ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)(d.xI,{control:q,name:"PDMobileCode",rules:{required:"code is required"},render:e=>{let{field:l}=e;return(0,P.jsx)(g.A,{field:l,errors:O})}}),O.PDMobileCode&&(0,P.jsx)("p",{className:"".concat(r.ci),children:O.PDMobileCode.message})]}),(0,P.jsxs)("div",{className:"w-full",children:[(0,P.jsxs)("label",{className:"".concat(r.Q0),children:["Mobile No ",(0,P.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,P.jsx)("input",(0,s.A)((0,s.A)({type:"number"},e("PDMobileNo",{required:"Mobile No is required",minLength:{value:10,message:"Must be exactly 10 digits"},maxLength:{value:10,message:"Must be exactly 10 digits"}})),{},{className:" ".concat(r.Ol," ").concat(O.PDMobileNo?"border-[1px] ":"border-gray-300"),placeholder:"Enter Mobile No",maxLength:10,onInput:e=>{e.target.value.length>10&&(e.target.value=e.target.value.slice(0,10))}})),O.PDMobileNo&&(0,P.jsx)("p",{className:"text-red-500 text-sm",children:O.PDMobileNo.message})]})]})}),(0,P.jsx)("div",{className:"flex justify-end ",children:(0,P.jsx)("button",{type:"submit",disabled:ge,className:"".concat(ge?"bg-gray-400":"bg-header"," text-white p-2 px-4 rounded mt-3"),children:ge?(0,P.jsx)(N.A,{}):"Submit"})})]})})})}}}]);
//# sourceMappingURL=8198.30606ea0.chunk.js.map