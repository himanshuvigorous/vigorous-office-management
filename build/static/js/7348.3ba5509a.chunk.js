"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[7348],{97348:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Y});var l=a(89379),d=a(65043),s=a(73216),n=a(83003),i=a(23156),o=a(47196),r=a(30064),c=a.n(r),u=a(39160),p=a(26759),m=a(15187),x=a(78227),v=a(60184),h=a(86178),j=a.n(h),f=a(24858),b=a(31744),y=a(78729),N=a(30326),g=a(53913),D=a(65512),w=a(96651),A=a(4938),C=(a(55971),a(60446)),I=a.n(C),S=a(83002),k=a(29542),R=a(42837),T=a(94084),q=(a(33007),a(89427),a(56679)),H=a(16963),O=a(37230),F=a(70579);const Y=function(){var e,t,a,r;const{employeList:h}=(0,n.d4)(e=>e.employe),{departmentListData:C,loading:Y}=(0,n.d4)(e=>e.department),{register:_,handleSubmit:L,control:P,formState:{errors:B},setValue:M}=(0,f.mN)({defaultValues:{status:"Pending"}}),z=((0,s.Zp)(),(0,n.wA)()),{wfhRequestData:V,totalwfhrequestCount:W,loading:E}=(0,n.d4)(e=>e.wfhRequest),{companyList:J}=(0,n.d4)(e=>e.company),[U,G]=(0,d.useState)({isOpen:!1,data:{},wfhRequest:{}}),Z=(0,f.FH)({control:P,name:"startDate",defaultValue:""}),K=(0,f.FH)({control:P,name:"endDate",defaultValue:""}),{branchList:Q}=(0,n.d4)(e=>e.branch),X=(0,f.FH)({control:P,name:"PDCompanyId",defaultValue:""}),$=(0,f.FH)({control:P,name:"department",defaultValue:""}),ee=(0,f.FH)({control:P,name:"PDBranchId",defaultValue:""}),te=(0,f.FH)({control:P,name:"status",defaultValue:"pending"}),[ae,le]=(0,d.useState)(1),[de,se]=(0,d.useState)(!1),[ne,ie]=(0,d.useState)(!1),[oe,re]=(0,d.useState)(null),ce=JSON.parse(localStorage.getItem("user_info_".concat(m.AU))),ue=(0,f.FH)({control:P,defaultValue:"",name:"employeeId"}),[pe,me]=(0,d.useState)(""),xe=[X,ee,pe,te,Z,K,ue,$].join("-"),[ve,he]=(0,d.useState)(!1);(0,d.useEffect)(()=>{ve?1===ae?ge():le(1):he(e=>!0)},[xe]),(0,d.useEffect)(()=>{ge()},[ae]);const{canCreate:je,canRead:fe,canUpdate:be,canDelete:ye}=(0,A.A)(),Ne=()=>{z((0,R.qV)({companyId:"admin"===(null===ce||void 0===ce?void 0:ce.userType)?X:"company"===(null===ce||void 0===ce?void 0:ce.userType)?null===ce||void 0===ce?void 0:ce._id:null===ce||void 0===ce?void 0:ce.companyId,branchId:["admin","company","companyDirector"].includes(null===ce||void 0===ce?void 0:ce.userType)?ee:"companyBranch"===(null===ce||void 0===ce?void 0:ce.userType)?null===ce||void 0===ce?void 0:ce._id:null===ce||void 0===ce?void 0:ce.branchId,departmentId:"",directorId:"",text:"",sort:!0,status:!0,isPagination:!1,isBranch:!0,isDirector:!1}))},ge=()=>{const e={currentPage:ae,pageSize:10,reqData:{companyId:"admin"===(null===ce||void 0===ce?void 0:ce.userType)?X:"company"===(null===ce||void 0===ce?void 0:ce.userType)?null===ce||void 0===ce?void 0:ce._id:null===ce||void 0===ce?void 0:ce.companyId,branchId:"company"===(null===ce||void 0===ce?void 0:ce.userType)||"admin"===(null===ce||void 0===ce?void 0:ce.userType)||"companyDirector"===(null===ce||void 0===ce?void 0:ce.userType)?ee:"companyBranch"===(null===ce||void 0===ce?void 0:ce.userType)?null===ce||void 0===ce?void 0:ce._id:null===ce||void 0===ce?void 0:ce.branchId,text:pe,employeId:ue,departmentId:$,startDate:Z?I()(Z).format("YYYY-MM-DD"):"",endDate:K?I()(K).format("YYYY-MM-DD"):"",sort:!0,status:te,isPagination:!0}};z((0,p.J9)(e))};(0,d.useEffect)(()=>{(X||"company"===(null===ce||void 0===ce?void 0:ce.userType)||"companyDirector"===(null===ce||void 0===ce?void 0:ce.userType))&&z((0,b.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===ce||void 0===ce?void 0:ce.userType)?X:"company"===(null===ce||void 0===ce?void 0:ce.userType)?null===ce||void 0===ce?void 0:ce._id:null===ce||void 0===ce?void 0:ce.companyId}))},[X]),(0,d.useEffect)(()=>{"admin"===(null===ce||void 0===ce?void 0:ce.userType)&&z((0,y.Ar)({text:"",sort:!0,status:!0,isPagination:!1}))},[]);const[De,we]=(0,d.useState)({isOpen:!1,data:null}),Ae=e=>null===e||void 0===e?void 0:e.toLowerCase().endsWith(".pdf"),Ce=e=>[".jpg",".jpeg",".png",".gif",".webp",".bmp",".tiff"].some(t=>null===e||void 0===e?void 0:e.toLowerCase().endsWith(t));return(0,F.jsx)(u.A,{onChange:e=>{me(e)},children:(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(g.A,{className:"antmodalclassName",title:"Attached Docs\tFor ".concat(null===U||void 0===U||null===(e=U.data)||void 0===e?void 0:e.employeName),width:1e3,footer:!1,open:U.isOpen,onOk:()=>G({open:!1,data:{}}),onCancel:()=>G({open:!1,data:{}}),children:(0,F.jsxs)("table",{className:"w-full max-w-full rounded-xl",children:[(0,F.jsx)("thead",{}),(0,F.jsx)("tbody",{children:(0,F.jsx)("tr",{children:(0,F.jsx)("td",{className:"whitespace-nowrap text-center p-2",children:(0,F.jsx)("div",{className:"flex flex-col space-y-4",children:null!==U&&void 0!==U&&null!==(t=U.data)&&void 0!==t&&t.attachment&&Array.isArray(null===U||void 0===U||null===(a=U.data)||void 0===a?void 0:a.attachment)?U.data.attachment.map((e,t)=>{const a="".concat("https://vigapi.vigorousit.com","/public/").concat(e);return Ce(e)?(0,F.jsxs)("div",{className:"flex items-center gap-2",children:[(0,F.jsxs)("p",{className:"font-[500] text-[12px] text-black",children:["(",t+1,")"]}),(0,F.jsx)(k.A,{src:a,alt:"Uploaded ".concat(t+1)})]},t):Ae(e)?(0,F.jsx)(w.A,{placement:"topLeft",title:"PDF Attachment ".concat(t+1),children:(0,F.jsxs)("div",{className:"flex items-center gap-2",children:[(0,F.jsxs)("p",{className:"font-[500] text-[12px] text-black",children:["(",t+1,")"]}),(0,F.jsx)("button",{onClick:()=>window.open(a,"_blank"),className:"px-2 py-1.5 text-xs rounded-md bg-transparent border border-muted hover:border-gray-800",type:"button",children:(0,F.jsx)(v.kl1,{className:"text-red-600 hover:text-red-700",size:26})})]})},t):null}):null!==U&&void 0!==U&&null!==(r=U.data)&&void 0!==r&&r.attachment?(()=>{const e=U.data.attachment,t="".concat("https://vigapi.vigorousit.com","/public/").concat(e);return Ce(e)?(0,F.jsx)(k.A,{src:t,alt:"Uploaded Image"}):Ae(e)?(0,F.jsx)(w.A,{placement:"topLeft",title:"PDF Attachment",children:(0,F.jsx)("button",{onClick:()=>window.open(t,"_blank"),className:"px-2 py-1.5 text-xs rounded-md bg-transparent border border-muted hover:border-gray-800",type:"button",children:(0,F.jsx)(v.kl1,{className:"text-red-600 hover:text-red-700",size:26})})}):null})():(0,F.jsx)("span",{className:"text-gray-600 text-sm text-center",children:"No File Attached"})})})})})]})}),(0,F.jsxs)("div",{className:"",children:[(0,F.jsxs)("div",{class:"2xl:flex justify-between items-center py-1 lg:space-y-0 space-y-2 overflow-y-auto gap-1",children:[(0,F.jsxs)("div",{className:"grid sm:grid-cols-4 grid-cols-1 lg:grid-cols-4 xl:grid-cols-5 sm:gap-3 gap-1",children:["admin"===(null===ce||void 0===ce?void 0:ce.userType)&&(0,F.jsxs)("div",{className:"",children:[(0,F.jsx)(f.xI,{control:P,name:"PDCompanyId",rules:{required:"Company is required"},render:e=>{let{field:t}=e;return(0,F.jsxs)(D.A,(0,l.A)((0,l.A)({},t),{},{defaultValue:"",className:"".concat(m.OJ," "),showSearch:!0,disabled:E,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,F.jsx)(D.A.Option,{value:"",children:"Select Company"}),null===J||void 0===J?void 0:J.map(e=>(0,F.jsx)(D.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),B.PDCompanyId&&(0,F.jsx)("p",{className:"text-red-500 text-sm",children:B.PDCompanyId.message})]}),("admin"===(null===ce||void 0===ce?void 0:ce.userType)||"company"===(null===ce||void 0===ce?void 0:ce.userType)||"companyDirector"===(null===ce||void 0===ce?void 0:ce.userType))&&(0,F.jsxs)("div",{className:"",children:[(0,F.jsx)(f.xI,{control:P,name:"PDBranchId",render:e=>{let{field:t}=e;return(0,F.jsxs)(D.A,(0,l.A)((0,l.A)({},t),{},{defaultValue:"",className:"inputAntdSelectClassNameFilterReport",disabled:E,showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,F.jsx)(D.A.Option,{value:"",children:"Select Branch"}),null===Q||void 0===Q?void 0:Q.map(e=>(0,F.jsx)(D.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),B.PDBranchId&&(0,F.jsx)("p",{className:"text-red-500 text-sm",children:B.PDBranchId.message})]}),(0,F.jsx)("div",{className:"",children:(0,F.jsx)(f.xI,{name:"employeeId",control:P,render:e=>{var t;let{field:a}=e;return(0,F.jsx)(D.A,{allowClear:!0,className:"inputAntdSelectClassNameFilterReport",disabled:E,placeholder:"Select Employee",onFocus:Ne,showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),value:a.value||[],onChange:e=>a.onChange(e),children:null===(t=(0,m._o)(h,"fullName"))||void 0===t?void 0:t.map(e=>(0,F.jsx)(D.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))})}})}),(0,F.jsx)("div",{className:"",children:(0,F.jsx)(f.xI,{name:"startDate",control:P,render:e=>{let{field:t}=e;return(0,F.jsx)(T.A,{size:"middle",disabled:E,report:!0,field:t,errors:B})}})}),(0,F.jsx)("div",{className:"",children:(0,F.jsx)(f.xI,{name:"endDate",control:P,className:"inputAntdSelectClassNameFilterReport",render:e=>{let{field:t}=e;return(0,F.jsx)(T.A,{size:"middle",disabled:E,report:!0,field:t,errors:B})}})}),(0,F.jsx)("div",{className:"",children:(0,F.jsx)(f.xI,{name:"status",control:P,rules:{},render:e=>{let{field:t}=e;return(0,F.jsxs)(D.A,(0,l.A)((0,l.A)({},t),{},{className:"inputAntdSelectClassNameFilterReport",placeholder:"Select Status",disabled:E,showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,F.jsx)(D.A.Option,{value:"",children:"Select Status"}),(0,F.jsx)(D.A.Option,{value:"pending",children:" pending "}),(0,F.jsx)(D.A.Option,{value:"approved",children:" approved "}),(0,F.jsx)(D.A.Option,{value:"rejected",children:" rejected "})]}))}})})]}),(0,F.jsxs)("div",{className:"2xl:flex hidden justify-end items-center gap-2",children:[(0,F.jsx)("button",{onClick:()=>{M("PDBranchId",""),M("PdCompanyId",""),M("endDate",""),M("startDate",""),M("status",""),M("department",""),M("employeeId","")},className:"bg-header  py-1.5 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,F.jsx)("span",{className:"text-[12px]",children:"Reset"})}),je&&(0,F.jsx)(w.A,{placement:"topLeft",title:"Add wfh Request",children:(0,F.jsxs)("button",{onClick:()=>{se(!0)},className:"bg-header px-2 py-1.5 w-44 rounded-md flex justify-center items-center space-x-2 text-white",children:[(0,F.jsx)(i.OiG,{}),(0,F.jsx)("span",{className:"text-[12px]",children:"Add wfh Request"})]})})]})]}),(0,F.jsxs)("div",{className:"flex 2xl:hidden justify-end items-center gap-2",children:[(0,F.jsx)("button",{onClick:()=>{M("PDBranchId",""),M("PdCompanyId",""),M("endDate",""),M("startDate",""),M("status",""),M("department",""),M("employeeId","")},className:"bg-header  py-1.5 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,F.jsx)("span",{className:"text-[12px]",children:"Reset"})}),je&&(0,F.jsx)(w.A,{placement:"topLeft",title:"Add wfh Request",children:(0,F.jsxs)("button",{onClick:()=>{se(!0)},className:"bg-header px-2 py-1.5 w-44 rounded-md flex justify-center items-center space-x-2 text-white",children:[(0,F.jsx)(i.OiG,{}),(0,F.jsx)("span",{className:"text-[12px]",children:"Add wfh Request"})]})})]})]}),(0,F.jsx)("div",{className:"bg-[#ffffff] w-full overflow-x-auto mt-1 rounded-xl",children:(0,F.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto",children:[(0,F.jsx)("thead",{children:(0,F.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] bg-header capitalize text-[#ffff] font-[500] h-[40px]",children:[(0,F.jsx)("th",{className:"tableHead w-[5%]",children:"S.No."}),(0,F.jsx)("th",{className:"tableHead",children:"Name"}),(0,F.jsx)("th",{className:"tableHead",children:"Reason"}),(0,F.jsx)("th",{className:"tableHead",children:"WFH Type"}),(0,F.jsx)("th",{className:"tableHead",children:"Requested days"}),(0,F.jsx)("th",{className:"tableHead",children:"from date"}),(0,F.jsx)("th",{className:"tableHead",children:"to date"}),(0,F.jsx)("th",{className:"tableHead",children:"Requested At"}),(0,F.jsx)("th",{className:"tableHead",children:"approved By"}),(0,F.jsx)("th",{className:"tableHead",children:"approved Date"}),(0,F.jsx)("th",{className:"tableHead",children:"Status"}),(0,F.jsx)("th",{className:"tableHead w-[10%]",children:"Action"})]})}),(0,F.jsx)("tbody",{children:V&&V.length>0?V.map((e,t)=>{var a;return(0,F.jsxs)("tr",{className:"text-black ".concat(t%2===0?"bg-[#e9ecef]/80":"bg-white"," border-b-[1px] border-[#DDDDDD]"),children:[(0,F.jsx)("td",{className:"tableData",children:t+1}),(0,F.jsx)("td",{className:"tableData",children:null===e||void 0===e?void 0:e.employeName}),(0,F.jsx)("td",{className:"tableData",children:(null===e||void 0===e?void 0:e.reason)||"N/A"}),(0,F.jsx)("td",{className:"tableData",children:(null===e||void 0===e||null===(a=e.wfhManagerData)||void 0===a?void 0:a.name)||"N/A"}),(0,F.jsx)("td",{className:"tableData",children:j()(null===e||void 0===e?void 0:e.endDate).diff(j()(null===e||void 0===e?void 0:e.startDate),"days")+1}),(0,F.jsx)("td",{className:"tableData",children:j()(null===e||void 0===e?void 0:e.startDate).format("DD-MM-YYYY")}),(0,F.jsx)("td",{className:"tableData",children:j()(null===e||void 0===e?void 0:e.endDate).format("DD-MM-YYYY")}),(0,F.jsx)("td",{className:"tableData",children:I()(null===e||void 0===e?void 0:e.createdAt).format("DD-MM-YYYY hh:mm a")}),(0,F.jsx)("td",{className:"tableData",children:"pending"!==(null===e||void 0===e?void 0:e.status)?null===e||void 0===e?void 0:e.updatedBy:"-"}),(0,F.jsx)("td",{className:"tableData",children:"pending"!==(null===e||void 0===e?void 0:e.status)?I()(null===e||void 0===e?void 0:e.updatedAt).format("DD-MM-YYYY hh:mm a"):"-"}),(0,F.jsx)("td",{className:"tableData",children:(0,F.jsx)(w.A,{placement:"topLeft",title:"WFH Status - ".concat(null===e||void 0===e?void 0:e.status),children:(0,F.jsx)("span",{className:"".concat("approved"===(null===e||void 0===e?void 0:e.status)?"bg-green-200 border-green-500 text-black":"pending"===(null===e||void 0===e?void 0:e.status)?"bg-yellow-200 border-yellow-500 text-black":"rejected"===(null===e||void 0===e?void 0:e.status)?"bg-red-200 border-red-500 text-black":"bg-gray-200 border-gray-500 text-black"," border-[1px] px-2 py-1.5 rounded-lg text-[12px]"),children:(null===e||void 0===e?void 0:e.status)||"-"})})}),(0,F.jsx)("td",{className:"tableData",children:(0,F.jsx)(N.A,{menu:{items:[{key:"view",label:(0,F.jsxs)("span",{className:"flex items-center text-[#3c8dbc] hover:text-[#337ab7]",children:[(0,F.jsx)(i.Ny1,{className:"mr-2",size:16}),"view Request"]}),onClick:()=>{we({isOpen:!0,data:e})}},{key:"edit",label:(0,F.jsxs)("span",{className:"flex items-center text-[#3c8dbc] hover:text-[#337ab7]",children:[(0,F.jsx)(i.Jcp,{className:"mr-2",size:16}),"Edit Request"]}),disabled:"pending"!==(null===e||void 0===e?void 0:e.status),onClick:()=>{"pending"===(null===e||void 0===e?void 0:e.status)&&(ie(!0),re(null===e||void 0===e?void 0:e._id))}},{key:"reject",label:(0,F.jsxs)("span",{className:"flex items-center text-red-600 hover:text-red-500",children:[(0,F.jsx)(o.tqC,{className:"mr-2",size:16}),"Reject Request"]}),disabled:"pending"!==(null===e||void 0===e?void 0:e.status),onClick:()=>{var t;t=null===e||void 0===e?void 0:e._id,c().fire({title:"Reject WFH Request",showCancelButton:!0,confirmButtonText:"Reject",cancelButtonText:"Cancel"}).then(e=>{e.isConfirmed&&z((0,p.ut)({_id:t,status:"rejected"})).then(e=>{null!==e&&void 0!==e&&e.error?c().fire("Error","There was an issue rejecting the request.","error"):(ge(),c().fire("Rejected!","The WFH request has been rejected.","success"))})})}},{key:"approve",label:(0,F.jsxs)("span",{className:"flex items-center text-green-600 hover:text-green-500",children:[(0,F.jsx)(v.CMH,{className:"mr-2",size:16}),"Approve Request"]}),disabled:"pending"!==(null===e||void 0===e?void 0:e.status),onClick:()=>{var t;t=null===e||void 0===e?void 0:e._id,c().fire({title:"Approve WFH Request",showCancelButton:!0,confirmButtonText:"Approve",cancelButtonText:"Cancel"}).then(e=>{e.isConfirmed&&z((0,p.ut)({_id:t,status:"approved"})).then(e=>{null!==e&&void 0!==e&&e.error?c().fire("Error","There was an issue approving the request.","error"):(ge(),c().fire("Approved!","The WFH request has been approved.","success"))})})}}]},trigger:["click"],children:(0,F.jsx)(w.A,{placement:"topLeft",title:"Actions",children:(0,F.jsx)("button",{className:"px-2 py-1.5 text-xs rounded-md bg-transparent border border-muted",type:"button",children:(0,F.jsx)(S.xWf,{className:"hover:text-[#337ab7] text-[#3c8dbc]",size:16})})})})})]},e._id)}):(0,F.jsx)("tr",{className:"bg-white bg-opacity-5",children:(0,F.jsx)("td",{colSpan:12,className:"px-6 py-2 whitespace-nowrap font-[600] text-sm text-center text-gray-500",children:"Record Not Found"})})})]})}),(0,F.jsx)(x.A,{totalCount:W,pageSize:10,currentPage:ae,onChange:e=>{le(e)}}),(0,F.jsx)(q.A,{isOpen:de,onClose:()=>se(!1),fetchattendanceListData:ge}),(0,F.jsx)(H.A,{isOpen:ne,onClose:()=>{ie(!1),re(null)},wfhRequestId:oe,fetchattendanceListData:ge}),(0,F.jsx)(O.A,{modaldata:De,handleClose:()=>{we({isOpen:!1,data:null})}})]})})}}}]);
//# sourceMappingURL=7348.3ba5509a.chunk.js.map