"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[1016],{1016:(e,a,d)=>{d.r(a),d.d(a,{default:()=>g});var l=d(89379),o=d(24858),n=d(39160),t=d(83003),i=d(73216),s=d(65043),r=d(15187),c=(d(31744),d(78729),d(66015)),m=d(42837),u=d(31536),v=d(88967),p=d(27810),x=d(31174),h=d(94084),y=(d(86178),d(60446)),f=d.n(y),b=d(17995),N=d(60184),j=d(70579);const g=()=>{var e;const{loading:a}=(0,t.d4)(e=>e.cashbook),{register:d,handleSubmit:y,control:g,watch:I,reset:A,formState:{errors:S},setValue:T}=(0,o.mN)(),_=(0,t.wA)(),E=(0,i.Zp)(),{companyList:k}=(0,t.d4)(e=>e.company),{branchList:q}=(0,t.d4)(e=>e.branch),O=JSON.parse(localStorage.getItem("user_info_".concat(r.AU))),{employeList:P}=(0,t.d4)(e=>e.employe),{expenseTypeList:w}=(0,t.d4)(e=>e.expenceHead),D=(0,o.FH)({control:g,name:"PDCompanyId",defaultValue:""}),F=(0,o.FH)({control:g,name:"PDBranchId",defaultValue:""}),[H,C]=(0,s.useState)(!1),[Q,V]=(0,s.useState)({attachments:[]}),{cashbookDetails:L}=(0,t.d4)(e=>e.cashbook),{cashbookIdEnc:B}=(0,i.g)(),G=(0,x.Yc)(B);return(0,s.useEffect)(()=>{_((0,p.ho)({_id:G}))},[]),(0,s.useEffect)(()=>{if(L){T("expenseFor",null===L||void 0===L?void 0:L.expenseFor),T("amount",null===L||void 0===L?void 0:L.amount),T("naration",null===L||void 0===L?void 0:L.naration),T("gstAmount",null===L||void 0===L?void 0:L.GSTamount),T("totalAmount",null===L||void 0===L?void 0:L.totalAmount),T("date",f()(null===L||void 0===L?void 0:L.date)),V({attachments:null===L||void 0===L?void 0:L.attachment});const e={text:"",status:!0,sort:!0,isTL:"",isHR:"",isPagination:!1,departmentId:"",designationId:"",companyId:null===L||void 0===L?void 0:L.companyId,branchId:null===L||void 0===L?void 0:L.branchId};_((0,m.qV)(e)).then(e=>{if(!e.error){var a,d,l;const o=null===e||void 0===e||null===(a=e.payload)||void 0===a||null===(d=a.data)||void 0===d||null===(l=d.docs)||void 0===l?void 0:l.find(e=>(null===L||void 0===L?void 0:L.employeId)===e._id);T("employee",{value:o._id,label:o.fullName})}}),_((0,u.dV)({directorId:"",companyId:null===L||void 0===L?void 0:L.companyId,branchId:null===L||void 0===L?void 0:L.branchId,text:"",sort:!0,status:"",isPagination:!1})).then(e=>{if(!e.error){var a,d,l;const o=null===e||void 0===e||null===(a=e.payload)||void 0===a||null===(d=a.data)||void 0===d||null===(l=d.docs)||void 0===l?void 0:l.find(e=>(null===L||void 0===L?void 0:L.expenseTypeId)===e._id),n={value:null===o||void 0===o?void 0:o._id,label:null===o||void 0===o?void 0:o.name};T("expencehead",n)}})}},[L]),(0,s.useEffect)(()=>{T("totalAmount",Number(I("amount"))+Number(I("gstAmount")))},[I("amount"),I("gstAmount")]),(0,j.jsx)(n.A,{children:(0,j.jsx)("div",{className:"gap-4",children:(0,j.jsxs)("form",{autoComplete:"off",className:"mt-2 md:px-1",onSubmit:y(e=>{var a,d;const l={_id:G,companyId:null===L||void 0===L?void 0:L.companyId,directorId:null===L||void 0===L?void 0:L.directorId,branchId:null===L||void 0===L?void 0:L.branchId,employeId:"employe"!==(null===O||void 0===O?void 0:O.userType)?null===e||void 0===e||null===(a=e.employee)||void 0===a?void 0:a.value:"employe"===(null===O||void 0===O?void 0:O.userType)?null===O||void 0===O?void 0:O._id:null,expenseTypeId:null===e||void 0===e||null===(d=e.expencehead)||void 0===d?void 0:d.value,expenseFor:null===e||void 0===e?void 0:e.expenseFor,amount:+(null===e||void 0===e?void 0:e.amount),naration:null===e||void 0===e?void 0:e.naration,GSTamount:0,totalAmount:+(null===e||void 0===e?void 0:e.amount),date:null===e||void 0===e?void 0:e.date,attachment:null===Q||void 0===Q?void 0:Q.attachments};_((0,p.Yk)(l)).then(e=>{e.error||E(-1)})}),children:[(0,j.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-1 md:gap-8 md:my-1 px-3 md:mt-4",children:[(0,j.jsxs)("div",{className:"w-full",children:[(0,j.jsx)("label",{className:"".concat(r.Q0),children:"Expence Head"}),(0,j.jsx)(o.xI,{name:"expencehead",control:g,rules:{required:"Expence Head is required"},render:e=>{let{field:a}=e;return(0,j.jsx)(c.Ay,(0,l.A)((0,l.A)({},a),{},{options:null===w||void 0===w?void 0:w.map(e=>({value:null===e||void 0===e?void 0:e._id,label:null===e||void 0===e?void 0:e.name})),classNamePrefix:"react-select",className:"".concat(r.Ph," ").concat(S.expencehead?"border-[1px] ":"border-gray-300"),placeholder:"Select Expence Head"}))}}),S.expencehead&&(0,j.jsx)("p",{className:"text-red-500 text-sm",children:S.expencehead.message})]}),"employee"!==(null===O||void 0===O?void 0:O.userType)&&(0,j.jsxs)("div",{className:"w-full",children:[(0,j.jsx)("label",{className:"".concat(r.Q0),children:"Employee"}),(0,j.jsx)(o.xI,{name:"employee",control:g,rules:{required:"Employee is required"},render:e=>{let{field:a}=e;return(0,j.jsx)(c.Ay,(0,l.A)((0,l.A)({},a),{},{onFocus:()=>{const e={text:"",status:!0,sort:!0,isTL:"",isHR:"",isPagination:!1,departmentId:"",designationId:"",companyId:"admin"===(null===O||void 0===O?void 0:O.userType)?D:"company"===(null===O||void 0===O?void 0:O.userType)?null===O||void 0===O?void 0:O._id:null===O||void 0===O?void 0:O.companyId,branchId:"company"===(null===O||void 0===O?void 0:O.userType)||"admin"===(null===O||void 0===O?void 0:O.userType)||"companyDirector"===(null===O||void 0===O?void 0:O.userType)?F:"companyBranch"===(null===O||void 0===O?void 0:O.userType)?null===O||void 0===O?void 0:O._id:null===O||void 0===O?void 0:O.branchId};_((0,m.qV)(e))},options:null===P||void 0===P?void 0:P.map(e=>({value:null===e||void 0===e?void 0:e._id,label:null===e||void 0===e?void 0:e.fullName})),classNamePrefix:"react-select",className:"".concat(r.Ph," ").concat(S.employee?"border-[1px] ":"border-gray-300"),placeholder:"Select Employee"}))}}),S.employee&&(0,j.jsx)("p",{className:"text-red-500 text-sm",children:S.employee.message})]}),(0,j.jsxs)("div",{className:"",children:[(0,j.jsxs)("label",{className:"".concat(r.Q0),children:["Amount",(0,j.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,j.jsx)("input",(0,l.A)((0,l.A)({type:"number",step:"0.01"},d("amount",{required:"Amount is required"})),{},{className:" ".concat(r.Ol," ").concat(S.amount?"border-[1px] ":"border-gray-300"),placeholder:"Enter Amount"})),S.amount&&(0,j.jsx)("p",{className:"text-red-500 text-sm",children:S.amount.message})]}),(0,j.jsxs)("div",{className:"",children:[(0,j.jsxs)("label",{className:"".concat(r.Q0),children:["Naration",(0,j.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,j.jsx)("textarea",(0,l.A)((0,l.A)({},d("naration",{required:"Naration is required"})),{},{className:" ".concat(r.Ol," ").concat(S.naration?"border-[1px] ":"border-gray-300"),placeholder:"Enter Naration"})),S.naration&&(0,j.jsx)("p",{className:"text-red-500 text-sm",children:S.naration.message})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"".concat(r.Q0),children:"Date"}),(0,j.jsx)(o.xI,{name:"date",control:g,render:e=>{let{field:a}=e;return(0,j.jsx)(h.A,{field:a,errors:S,disabledDate:e=>{if(!e)return!0;const a=f()().startOf("day"),d=e.startOf("day");if(a.date()<=5){const e=a.subtract(1,"month"),l=e.endOf("month").startOf("day"),o=e.date(l.date()-4).startOf("day"),n=(d.isAfter(o)||d.isSame(o))&&(d.isBefore(l)||d.isSame(l)),t=a.startOf("month"),i=(d.isAfter(t)||d.isSame(t))&&(d.isBefore(a)||d.isSame(a));return!(n||i)}{const e=a.startOf("month");return!((d.isAfter(e)||d.isSame(e))&&(d.isBefore(a)||d.isSame(a)))}}})}}),S.date&&(0,j.jsx)("p",{className:"text-red-500 text-sm",children:"Date is required"})]}),(0,j.jsxs)("div",{className:"",children:[(0,j.jsx)("label",{className:"".concat(r.Q0),children:"Documents"}),H?(0,j.jsx)("div",{className:"space-y-2"}):(0,j.jsxs)("div",{className:"space-y-4",children:[(0,j.jsx)("input",{type:"file",onChange:e=>{const a={filePath:e.target.files[0],isVideo:!1,isMultiple:!1};_((0,v.Sg)(a)).then(e=>{var a;null!==e&&void 0!==e&&null!==(a=e.payload)&&void 0!==a&&a.data&&V(a=>{var d;return(0,l.A)((0,l.A)({},a),{},{attachments:[...(null===a||void 0===a?void 0:a.attachments)||[],null===e||void 0===e||null===(d=e.payload)||void 0===d?void 0:d.data]})})})},className:"hidden",id:"file-upload"}),(0,j.jsxs)("label",{htmlFor:"file-upload",className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-600 bg-white cursor-pointer",children:[(0,j.jsx)(N.chT,{className:"mr-2"})," Add Documents"]}),(0,j.jsx)("div",{className:"space-y-2",children:null===Q||void 0===Q||null===(e=Q.attachments)||void 0===e?void 0:e.map((e,a)=>(0,j.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-md",children:[(0,j.jsxs)("a",{href:"".concat("https://vigapi.vigorousit.com","/public/").concat(e),className:"flex items-center space-x-2",target:"_blank",rel:"noopener noreferrer",children:[(0,j.jsx)(N.chT,{className:"text-gray-500"}),(0,j.jsx)("span",{className:"text-sm text-gray-600",children:e})]}),(0,j.jsx)("button",{type:"button",onClick:()=>(e=>{V(a=>{const d=null===a||void 0===a?void 0:a.attachments.filter((a,d)=>d!==e);return(0,l.A)((0,l.A)({},a),{},{attachments:d})})})(a),className:"text-red-500 hover:text-red-700",children:(0,j.jsx)(N.QCr,{})})]},a))})]})]})]}),(0,j.jsx)("div",{className:"flex justify-end",children:(0,j.jsx)("button",{type:"submit",disabled:a,className:"".concat(a?"bg-gray-400":"bg-header"," text-white p-2 px-4 rounded mt-3"),children:a?(0,j.jsx)(b.A,{}):"Submit"})})]})})})}}}]);
//# sourceMappingURL=1016.0941f9d1.chunk.js.map