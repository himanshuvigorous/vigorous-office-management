"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[6781],{96781:(e,t,n)=>{n.r(t),n.d(t,{default:()=>g});var a=n(89379),l=n(24858),o=n(83003),i=n(15187),d=n(65043),r=n(31744),s=n(39160),c=n(97326),u=n(487),m=n(60446),p=n.n(m),v=n(12106),h=n(69223),x=n(55971),f=n(50822),b=n(6720),w=n(37762),y=n(64857),N=n(73216),j=(n(78227),n(70579));const g=function(){const{control:e,formState:{errors:t},setValue:n,watch:m}=(0,l.mN)(),{bankId:g}=(0,N.g)(),[D,k]=(0,d.useState)(10),[C,S]=(0,d.useState)(0),Y=(0,o.wA)(),{bankStatementReportList:A,bankStatementReport_loading:R,bankStatementReportCount:B}=(0,o.d4)(e=>e.reports),E=(0,l.FH)({control:e,name:"time",defaultValue:[]}),T=((0,d.useMemo)(()=>{if(null!==A&&void 0!==A&&A.allTransactions&&A.allTransactions.length>0)return A.allTransactions[0].previousBalance},[A]),e=>{var t,n,a,l,o,i;if(!Array.isArray(null===e||void 0===e?void 0:e.allTransactions)||0===(null===e||void 0===e||null===(t=e.allTransactions)||void 0===t?void 0:t.length))return[];n=null===(a=e[0])||void 0===a?void 0:a.openingBalance;let d=[];return null===e||void 0===e||e.allTransactions.forEach(e=>{const t={key:"statement",clientName:null!==e&&void 0!==e&&e.clientName?null===e||void 0===e?void 0:e.clientName:null!==e&&void 0!==e&&e.groupName?null===e||void 0===e?void 0:e.groupName:"-",date:null!==e&&void 0!==e&&e.createdAt?p()(null===e||void 0===e?void 0:e.createdAt).format("DD-MM-YYYY hh:mm a"):"-",dateofValue:null!==e&&void 0!==e&&e.date?p()(null===e||void 0===e?void 0:e.date).format("DD-MM-YYYY hh:mm a"):"-",amountDebit:"debit"==(null===e||void 0===e?void 0:e.debit_credit)?null===e||void 0===e?void 0:e.amount:0,amountCredit:"credit"==(null===e||void 0===e?void 0:e.debit_credit)?null===e||void 0===e?void 0:e.amount:0,acc:null===e||void 0===e?void 0:e.currentBalance,Description:(null===e||void 0===e?void 0:e.naration)||"-",reference:null!==e&&void 0!==e&&e.references?"".concat(null===e||void 0===e?void 0:e.references," ").concat("receipt"===(null===e||void 0===e?void 0:e.references)?null===e||void 0===e?void 0:e.receiptNumber:""):"-"};d.push(t)}),d.push({key:"total",clientName:"Total",date:null,dateofValue:null,amountDebit:null===e||void 0===e||null===(l=e.summary)||void 0===l?void 0:l.totalDebit,amountCredit:null===e||void 0===e||null===(o=e.summary)||void 0===o?void 0:o.totalCredit,acc:null===e||void 0===e||null===(i=e.summary)||void 0===i?void 0:i.closingBalance,Description:"",reference:""}),d});(0,d.useEffect)(()=>{S(T(A))},[A]);const{RangePicker:F}=u.A,[I,M]=(0,d.useState)(""),V=JSON.parse(localStorage.getItem("user_info_".concat(i.AU))),[P,_]=(0,d.useState)(1),[z,K]=(0,d.useState)(""),G=(0,l.FH)({control:e,name:"PDCompanyId",defaultValue:""});(0,d.useEffect)(()=>{const e=setTimeout(()=>{K(I)},500);return()=>{clearTimeout(e)}},[I]);const U=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return{currentPage:P,pageSize:D,reqPayload:{companyId:"",directorId:"",branchId:"",clientIds:[],groupIds:"",bankId:g,startDate:(null===E||void 0===E?void 0:E.length)>0?p()(E[0]).format("YYYY-MM-DD"):"",endDate:(null===E||void 0===E?void 0:E.length)>0?p()(E[1]).format("YYYY-MM-DD"):"",references:"",debit_credit:"",amountFrom:"",amountTo:"",text:"",sort:!1,isPagination:e}}};(0,d.useEffect)(()=>{H(z)},[P,z,D]);const H=()=>{Y((0,v.AT)(U(!0)))};(0,d.useEffect)(()=>{"company"!==(null===V||void 0===V?void 0:V.userType)&&"companyDirector"!==(null===V||void 0===V?void 0:V.userType)||Y((0,r.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===V||void 0===V?void 0:V.userType)?G:"company"===(null===V||void 0===V?void 0:V.userType)?null===V||void 0===V?void 0:V._id:null===V||void 0===V?void 0:V.companyId})),n("startDate",p()().subtract(1,"month")),n("endDate",p()())},[]);const L=async()=>{H()},W=[{key:"1",label:(0,j.jsx)("span",{className:"text-white",children:"Advance Filters"}),children:(0,j.jsxs)("div",{className:"bg-[#ececec]",children:[(0,j.jsx)("div",{className:"sm:flex  grid grid-cols-1  gap-2 sm:flex-wrap text-[14px]",children:(0,j.jsx)(l.xI,{name:"time",control:e,render:e=>{let{field:t}=e;return(0,j.jsx)(F,(0,a.A)((0,a.A)({},t),{},{value:t.value,onChange:e=>t.onChange(e),format:"YYYY-MM-DD",getPopupContainer:()=>document.body,popupClassName:"vertical-range-calendar",className:"custom-range-picker"}))}})}),(0,j.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,j.jsx)("button",{onClick:()=>{n("time",[]),L()},className:"bg-header py-2 my-0.5 rounded-md flex px-10 justify-center items-center text-white",children:(0,j.jsx)("span",{className:"text-[12px]",children:"Reset"})}),(0,j.jsx)("button",{onClick:()=>{L()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,j.jsx)("span",{className:"text-[12px]",children:"Submit"})})]})]})}];return(0,j.jsx)(s.A,{onChange:e=>{M(e)},children:(0,j.jsxs)("div",{className:"bg-grey-100 w-full p-1",children:[(0,j.jsxs)("div",{className:"",children:[(0,j.jsx)(c.A,{className:"custom-collapse",items:W,defaultActiveKey:[1],expandIcon:e=>{let{isActive:t}=e;return(0,j.jsx)(b.WnU,{size:20,style:{color:"white",transform:t?"rotate(-90deg)":"rotate(0deg)",transition:"transform 0.3s ease"}})}}),(0,j.jsx)("div",{className:"space-y-1.5 flex justify-end items-center",children:(0,j.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,j.jsx)("button",{onClick:()=>{(async()=>{var e;const t=new w.uE({orientation:"landscape",unit:"pt"});t.setFontSize(16),t.text("Client Group Statement Report",40,30);const n=await(null===f.K||void 0===f.K?void 0:f.K.bankStatementReportFunc(U(!1))),a=null!==(e=T(null===n||void 0===n?void 0:n.data))&&void 0!==e?e:[],l=null===a||void 0===a?void 0:a.map((e,t)=>{var n,a,l,o,i;return[t+1,null!==(n=null===e||void 0===e?void 0:e.date)&&void 0!==n?n:"-",null!==(a=null===e||void 0===e?void 0:e.dateofValue)&&void 0!==a?a:"-",null!==(l=null===e||void 0===e?void 0:e.clientName)&&void 0!==l?l:"-",null!==(o=null===e||void 0===e?void 0:e.Description)&&void 0!==o?o:"-",null!==(i=null===e||void 0===e?void 0:e.reference)&&void 0!==i?i:"-",null===e||void 0===e?void 0:e.amountDebit,null===e||void 0===e?void 0:e.amountCredit,null===e||void 0===e?void 0:e.acc]});(0,y.Ay)(t,{startY:50,head:[["S.No.","Entry Date","Value Date","Group/Client","Description","Reference","Debit","Credit","Balance"]],body:l,margin:{horizontal:10},styles:{cellPadding:8,fontSize:10,valign:"middle",halign:"left"},headStyles:{fillColor:[64,64,64],textColor:[255,255,255],fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]}}),t.save("BankSummaryDetails.pdf")})()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,j.jsx)("span",{className:"text-[12px]",children:"Export PDF"})}),(0,j.jsx)("button",{onClick:()=>{(async()=>{var e;const t=new h.Workbook,n=t.addWorksheet("BankSummaryDetails");n.columns=[{header:"S.No.",key:"sno",width:10},{header:"Entry Date",key:"entryDate",width:20},{header:"value Date",key:"valueDate",width:20},{header:"Group/Client",key:"groupClient",width:40},{header:"Description",key:"description",width:20},{header:"Reference",key:"reference",width:25},{header:"Debit",key:"debit",width:15},{header:"Credit",key:"credit",width:15},{header:"Balance",key:"balance",width:15}],n.getRow(1).eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFB6D7A8"}},e.font={bold:!0},e.alignment={vertical:"middle",horizontal:"center"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});const a=await(null===f.K||void 0===f.K||null===(e=f.K.bankStatementReportFunc)||void 0===e?void 0:e.call(f.K,U(!1))),l=T(null===a||void 0===a?void 0:a.data)||[];null===l||void 0===l||l.forEach((e,t)=>{var a,l,o,i,d;n.addRow({sno:t+1,entryDate:null!==(a=null===e||void 0===e?void 0:e.date)&&void 0!==a?a:"-",valueDate:null!==(l=null===e||void 0===e?void 0:e.dateofValue)&&void 0!==l?l:"-",groupClient:null!==(o=null===e||void 0===e?void 0:e.clientName)&&void 0!==o?o:"-",description:null!==(i=null===e||void 0===e?void 0:e.Description)&&void 0!==i?i:"-",reference:null!==(d=null===e||void 0===e?void 0:e.reference)&&void 0!==d?d:"-",debit:e.amountDebit,credit:e.amountCredit,balance:e.acc})}),n.eachRow({includeEmpty:!1},(e,t)=>{1!==t&&e.eachCell(e=>{e.alignment={vertical:"middle",horizontal:"left"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),n.autoFilter={from:"A1",to:"H1"},t.xlsx.writeBuffer().then(e=>{const t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),n=document.createElement("a");n.href=URL.createObjectURL(t),n.download="BankSummaryDetails.xlsx",n.click()})})()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,j.jsx)("span",{className:"text-[12px]",children:"Export Excel"})})]})})]}),(0,j.jsxs)("div",{className:"max-w-[300px] rounded overflow-hidden shadow-md p-2 mb-2 bg-white",children:[(0,j.jsx)("h2",{className:"text-md font-semibold mb-1",children:"Bank Details"}),(0,j.jsxs)("div",{className:"mb-1",children:[(0,j.jsx)("span",{className:"font-bold text-[14px] text-header",children:"Bank Name: "}),(0,j.jsx)("span",{className:"text-gray-800 text-[13px]",children:null===A||void 0===A?void 0:A.bankName})]}),(0,j.jsxs)("div",{className:"mb-1",children:[(0,j.jsx)("span",{className:"font-bold text-[14px] text-header",children:"Bankholder: "}),(0,j.jsx)("span",{className:"text-gray-800 text-[13px]",children:null===A||void 0===A?void 0:A.bankholderName})]}),(0,j.jsxs)("div",{className:"mb-1",children:[(0,j.jsx)("span",{className:"font-bold text-[14px] text-header",children:"IFSC: "}),(0,j.jsx)("span",{className:"text-gray-800 text-[13px]",children:null===A||void 0===A?void 0:A.ifscCode})]}),(0,j.jsxs)("div",{className:"mb-1",children:[(0,j.jsx)("span",{className:"font-bold text-[14px] text-header",children:"Branch Name: "}),(0,j.jsx)("span",{className:"text-gray-800 text-[13px]",children:null===A||void 0===A?void 0:A.branchName})]})]}),(0,j.jsx)("div",{className:"bg-[#ffffff]  w-full overflow-x-auto mt-1 rounded-xl",children:(0,j.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto",children:[(0,j.jsx)("thead",{children:(0,j.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] capitalize text-[12px] bg-header text-white font-[500] h-[40px]",children:[(0,j.jsx)("th",{className:"border-none p-2 whitespace-nowrap  w-[5%]",children:"S.No."}),(0,j.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Entry Date"}),(0,j.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Value Date"}),(0,j.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Group/Client"}),(0,j.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Description "}),(0,j.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"References"}),(0,j.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Debit"}),(0,j.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Credit"}),(0,j.jsx)("th",{className:"border-none p-2 whitespace-nowrap ",children:"Balance"})]})}),R?(0,j.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,j.jsx)("td",{colSpan:15,className:"px-6 py-2 whitespace-nowrap  font-[600] text-sm text-gray-500",children:(0,j.jsx)(x.A,{})})}):(0,j.jsx)("tbody",{children:C&&(null===C||void 0===C?void 0:C.length)>0?null===C||void 0===C?void 0:C.map((e,t)=>{var n,a,l,o,d,r;return(0,j.jsxs)("tr",{className:"border-b-[1px] ".concat(t%2===0?"bg-[#e9ecef]/80":"bg-white"," border-[#DDDDDD] text-[#374151] text-[14px]"),children:[(0,j.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:t+1+(P-1)*D}),(0,j.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:null!==(n=null===e||void 0===e?void 0:e.date)&&void 0!==n?n:"-"}),(0,j.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:null!==(a=null===e||void 0===e?void 0:e.dateofValue)&&void 0!==a?a:"-"}),(0,j.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:null!==(l=null===e||void 0===e?void 0:e.clientName)&&void 0!==l?l:"--"}),(0,j.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:(null===e||void 0===e?void 0:e.Description)||"-"}),(0,j.jsx)("td",{className:"whitespace-nowrap  border-none p-2",children:null!==(o=null===e||void 0===e?void 0:e.reference)&&void 0!==o?o:"-"}),(0,j.jsx)("td",{className:"whitespace-nowrap text-center  border-none p-2",children:null!==(d=(0,i.w2)(null===e||void 0===e?void 0:e.amountDebit))&&void 0!==d?d:"-"}),(0,j.jsx)("td",{className:"whitespace-nowrap  text-center border-none p-2",children:null!==(r=(0,i.w2)(null===e||void 0===e?void 0:e.amountCredit))&&void 0!==r?r:"-"}),(0,j.jsx)("td",{className:"whitespace-nowrap  text-center border-none p-2",children:null!==e&&void 0!==e&&e.acc?null===e||void 0===e?void 0:e.acc.toFixed(2):"-"})]})}):(0,j.jsx)("tr",{className:"bg-white bg-opacity-5",children:(0,j.jsx)("td",{colSpan:15,className:"px-6 py-2 whitespace-nowrap  font-[600] text-sm text-gray-500",children:"Record Not Found"})})})]})})]})})}}}]);
//# sourceMappingURL=6781.2e812884.chunk.js.map