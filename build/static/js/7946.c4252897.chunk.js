"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[7946],{17946:(e,a,d)=>{d.r(a),d.d(a,{default:()=>j});var n=d(89379),i=d(65043),l=d(24858),o=d(83003),t=d(73216),c=d(99974),r=d(78729),s=(d(14118),d(31744)),u=(d(33007),d(16210),d(15187)),v=d(83252),m=d(735),p=d(13382),x=d(32513),h=d(65512),y=d(85157),A=d(39160),f=d(89427),g=d(70579);const j=function(){const{register:e,handleSubmit:a,setValue:d,getValue:j,control:b,formState:{errors:I}}=(0,l.mN)(),_=(0,o.wA)(),N=(0,t.Zp)(),[C,D]=(0,i.useState)(!1),{companyList:T,companyListLoading:w}=(0,o.d4)(e=>e.company),{directorLists:R}=(0,o.d4)(e=>e.director),{branchList:S,branchListloading:U}=(0,o.d4)(e=>e.branch),{designationList:k,loading:L}=(0,o.d4)(e=>e.designation),{loading:O}=(0,o.d4)(e=>e.rolePermission),[E,q]=(0,i.useState)([]),[V,B]=(0,i.useState)([]),{sidebarListData:P}=(0,o.d4)(e=>e.dynamicSidebar),{sidebarViewData:H}=(0,o.d4)(e=>e.dynamicSidebar),{userCompanyId:F,userBranchId:Q,userEmployeId:M,userDepartmentId:Z,userDesignationId:J,userType:K}=(0,m.A)(),z=(0,l.FH)({control:b,name:"companyId",defaultValue:F}),G=((0,l.FH)({control:b,name:"branchId",defaultValue:Q}),(0,l.FH)({control:b,name:"departmentId",defaultValue:Z}),(0,l.FH)({control:b,name:"designationId",defaultValue:J}),JSON.parse(localStorage.getItem("user_info_".concat(u.AU))));(0,i.useEffect)(()=>{"admin"===K&&_((0,r.Ar)({userType:"company",text:"",status:!0}))},[]),(0,i.useEffect)(()=>{(z&&"company"===K||z&&"admin"===K||z&&"companyDirector"===K)&&_((0,s.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:z}))},[z]),(0,i.useEffect)(()=>{"admin"===(null===G||void 0===G?void 0:G.userType)&&_((0,r.Ar)({text:"",sort:!0,status:!0})),_((0,c.kM)({isPagination:!1}))},[]),(0,i.useEffect)(()=>{const e=null===P||void 0===P?void 0:P.map(e=>(0,n.A)((0,n.A)({},e),{},{canCreate:!1,canRead:!1,canUpdate:!1,canDelete:!1}));q(e)},[P]),(0,i.useEffect)(()=>{if(C){const e=null===P||void 0===P?void 0:P.map(e=>(0,n.A)((0,n.A)({},e),{},{canCreate:!0,canRead:!0,canUpdate:!0,canDelete:!0}));q(e)}else{const e=null===P||void 0===P?void 0:P.map(e=>(0,n.A)((0,n.A)({},e),{},{canCreate:!1,canRead:!1,canUpdate:!1,canDelete:!1}));q(e)}},[C]);const W=e=>{const a=null===E||void 0===E?void 0:E.map(e=>null!==e&&void 0!==e&&e.canCreate||null!==e&&void 0!==e&&e.canRead||null!==e&&void 0!==e&&e.canUpdate||null!==e&&void 0!==e&&e.canDelete?{pageId:null===e||void 0===e?void 0:e._id,canCreate:null===e||void 0===e?void 0:e.canCreate,canRead:null===e||void 0===e?void 0:e.canRead,canUpdate:null===e||void 0===e?void 0:e.canUpdate,canDelete:null===e||void 0===e?void 0:e.canDelete}:null).filter(Boolean),d={companyId:"admin"===(null===G||void 0===G?void 0:G.userType)?null===e||void 0===e?void 0:e.companyId:"company"===(null===G||void 0===G?void 0:G.userType)?null===G||void 0===G?void 0:G._id:null===G||void 0===G?void 0:G.companyId,directorId:"company"===(null===G||void 0===G?void 0:G.userType)||"admin"===(null===G||void 0===G?void 0:G.userType)?null===e||void 0===e?void 0:e.directorId:"companyDirector"===(null===G||void 0===G?void 0:G.userType)?null===G||void 0===G?void 0:G._id:null===G||void 0===G?void 0:G.directorId,branchId:"company"===(null===G||void 0===G?void 0:G.userType)||"admin"===(null===G||void 0===G?void 0:G.userType)||"companyDirector"===(null===G||void 0===G?void 0:G.userType)?null===e||void 0===e?void 0:e.branchId:"companyBranch"===(null===G||void 0===G?void 0:G.userType)?null===G||void 0===G?void 0:G._id:null===G||void 0===G?void 0:G.branchId,permissions:a,designationId:"",departmentId:"",designationName:null===e||void 0===e?void 0:e.roleTitle};_((0,v.Mg)(d)).then(e=>{e.error||N(-1)})};(0,i.useCallback)(e=>{var a,n;const i=e.target.value;d("companyId",i);const l=null===T||void 0===T||null===(a=T.docs)||void 0===a||null===(n=a.find(e=>e._id===i))||void 0===n?void 0:n.name;d("companyName",l),d("stateId",""),d("stateName","")},[T,d]),(0,i.useEffect)(()=>{if(C){const e=null===P||void 0===P?void 0:P.map(e=>(0,n.A)((0,n.A)({},e),{},{canCreate:!0,canRead:!0,canUpdate:!0,canDelete:!0}));q(e)}else{const e=null===P||void 0===P?void 0:P.map(e=>(0,n.A)((0,n.A)({},e),{},{canCreate:!1,canRead:!1,canUpdate:!1,canDelete:!1}));q(e)}},[C]);const X=(e,a)=>{const d=!(!a||null===E||void 0===E||!E.find(a=>a._id===e))&&(null===E||void 0===E?void 0:E.find(a=>a._id===e)[a]);return"px-3 sm:px-4 py-2 rounded-md text-[9px] sm:text-sm text-nowrap font-medium transition-all duration-300 ".concat(d?"bg-header text-white border-header":"bg-gray-200 text-gray-700 border-gray-300 hover:border-header border-2 hover:text-header")};(0,i.useEffect)(()=>{H&&P&&P.length>0&&H.length>0?B((0,u.tZ)(H)):B([])},[H,P]);const Y=(e,a)=>{var d;return null===E||void 0===E||null===(d=E.find(a=>a._id===e))||void 0===d?void 0:d[a]},$=[{title:"title",dataIndex:"title",width:300,key:"_id",render:(e,a)=>(0,g.jsx)("div",{className:"text-nowrap",children:e})},{title:(0,g.jsx)("div",{children:(0,g.jsx)(x.A,{onClick:e=>(e=>{D(e.target.checked)})(e)})}),key:"_id",width:100,render:(e,a)=>(0,g.jsx)("div",{children:(0,g.jsx)(x.A,{onClick:e=>((e,a)=>{var d,i;const l=null===E||void 0===E||null===(d=E.find(e=>e._id===a))||void 0===d?void 0:d.parentPageId;l&&q(e=>e.map(e=>e._id===l?(0,n.A)((0,n.A)({},e),{},{canCreate:!0,canRead:!0,canUpdate:!0,canDelete:!0}):e));const o=null===E||void 0===E||null===(i=E.find(e=>e._id===l))||void 0===i?void 0:i.parentPageId;o&&q(e=>e.map(e=>e._id===o?(0,n.A)((0,n.A)({},e),{},{canCreate:!0,canRead:!0,canUpdate:!0,canDelete:!0}):e)),e.target.checked?q(e=>e.map(e=>e._id===a?(0,n.A)((0,n.A)({},e),{},{canCreate:!0,canRead:!0,canUpdate:!0,canDelete:!0}):e)):q(e=>e.map(e=>e._id===a?(0,n.A)((0,n.A)({},e),{},{canCreate:!1,canRead:!1,canUpdate:!1,canDelete:!1}):e))})(e,a._id),checked:Y(a._id,"canRead")&&Y(a._id,"canCreate")&&Y(a._id,"canUpdate")&&Y(a._id,"canDelete")})})},{title:(0,g.jsx)("div",{children:"Actions"}),key:"_id",render:(e,a)=>(0,g.jsx)("div",{className:"flex items-center flex-nowrap gap-2",children:["canRead","canCreate","canUpdate","canDelete"].map(e=>(0,g.jsx)(p.Ay,{className:X(a._id,e),type:"button",onClick:d=>((e,a)=>{var d,i;const l=null===E||void 0===E||null===(d=E.find(a=>a._id===e))||void 0===d?void 0:d.parentPageId;l&&q(e=>e.map(e=>e._id===l?(0,n.A)((0,n.A)({},e),{},{canCreate:!0,canRead:!0,canUpdate:!0,canDelete:!0}):e));const o=null===E||void 0===E||null===(i=E.find(e=>e._id===l))||void 0===i?void 0:i.parentPageId;o&&q(e=>e.map(e=>e._id===o?(0,n.A)((0,n.A)({},e),{},{canCreate:!0,canRead:!0,canUpdate:!0,canDelete:!0}):e)),q(d=>d.map(d=>d._id===e?(0,n.A)((0,n.A)({},d),{},{[a]:!d[a]}):d))})(a._id,e),style:{margin:"0 5px"},children:e},e))})}];return(0,g.jsx)(A.A,{children:(0,g.jsxs)("div",{className:"",children:[(0,g.jsxs)("form",{className:"mt-2 grid grid-cols-1 md:grid-cols-4 gap-2 md:my-2 px-2",onSubmit:a(W),children:["admin"===K&&(0,g.jsxs)("div",{className:"",children:[(0,g.jsxs)("label",{className:"".concat(u.Q0),children:["Company ",(0,g.jsx)("span",{className:"text-red-600",children:"* "})]}),(0,g.jsxs)("select",(0,n.A)((0,n.A)({},e("companyId",{required:"Company is required"})),{},{className:" ".concat(u.Ol," ").concat(I.companyId?"border-[1px] ":"border-gray-300"),children:[(0,g.jsx)("option",{className:"",value:"",children:"Select Company"}),null===T||void 0===T?void 0:T.map(e=>(0,g.jsxs)("option",{value:null===e||void 0===e?void 0:e._id,children:[null===e||void 0===e?void 0:e.fullName,"(",null===e||void 0===e?void 0:e.userName,")"]}))]})),(0,g.jsx)(l.xI,{control:b,name:"companyId",rules:{required:"Company is required"},render:e=>{var a;let{field:d}=e;return(0,g.jsxs)(h.A,(0,n.A)((0,n.A)({},d),{},{defaultValue:"",className:"".concat(u.Hy," "),showSearch:!0,filterOption:(e,a)=>String(null===a||void 0===a?void 0:a.children).toLowerCase().includes(e.toLowerCase()),children:[(0,g.jsx)(h.A.Option,{value:"",children:"Select Company"}),w?(0,g.jsx)(h.A.Option,{disabled:!0,children:(0,g.jsx)(f.A,{})}):null===(a=(0,u._o)(T,"fullName"))||void 0===a?void 0:a.map(e=>(0,g.jsx)(h.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}}),I.companyId&&(0,g.jsx)("p",{className:"text-red-500 text-sm",children:I.companyId.message})]}),("admin"===K||"company"===K||"companyDirector"==K)&&(0,g.jsxs)("div",{className:"",children:[(0,g.jsxs)("label",{className:"".concat(u.Q0),children:["Branch ",(0,g.jsx)("span",{className:"text-red-600",children:"* "})]}),(0,g.jsx)(l.xI,{name:"branchId",control:b,rules:{required:"Branch is required"},render:e=>{var a,d;let{field:i}=e;return(0,g.jsxs)(h.A,(0,n.A)((0,n.A)({},i),{},{className:"".concat(u.Hy," ").concat(I.branchId?"border-[1px] ":"border-gray-300"),placeholder:"Select Branch",showSearch:!0,filterOption:(e,a)=>String(null===a||void 0===a?void 0:a.children).toLowerCase().includes(e.toLowerCase()),children:[(0,g.jsx)(h.A.Option,{value:"",children:"Select Branch"}),U?(0,g.jsx)(h.A.Option,{disabled:!0,children:(0,g.jsx)(f.A,{})}):null===(a=(0,u._o)(S,"fullName"))||void 0===a||null===(d=a.filter(e=>(null===e||void 0===e?void 0:e.companyId)===z))||void 0===d?void 0:d.map(e=>(0,g.jsxs)(h.A.Option,{value:null===e||void 0===e?void 0:e._id,children:[" ",null===e||void 0===e?void 0:e.fullName," "]}))]}))}}),I.branchId&&(0,g.jsx)("p",{className:"text-red-500 text-sm",children:I.branchId.message})]}),(0,g.jsxs)("div",{className:"",children:[(0,g.jsxs)("label",{className:"".concat(u.Q0),children:["Role Title ",(0,g.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,g.jsx)("input",(0,n.A)((0,n.A)({type:"text"},e("roleTitle",{required:"Role Title is required"})),{},{className:"placeholder: ".concat(u.Ol," ").concat(I.roleTitle?"border-[1px] ":"border-gray-300"),placeholder:"Enter Role Title"})),I.roleTitle&&(0,g.jsx)("p",{className:"text-red-500 text-sm",children:I.roleTitle.message})]})]}),(0,g.jsx)(y.A,{columns:$,pagination:!1,dataSource:V,scroll:{x:!0},rowKey:"_id"}),(0,g.jsx)("div",{className:"flex justify-end my-2 mx-2",children:(0,g.jsx)("button",{type:"button",disabled:O,onClick:a(W),className:"bg-header text-white py-1.5 px-3 text-nowrap text-sm rounded ",children:O?(0,g.jsx)(f.A,{}):"save"})})]})})}}}]);
//# sourceMappingURL=7946.c4252897.chunk.js.map