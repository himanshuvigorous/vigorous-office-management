"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[3818],{73818:(e,n,t)=>{t.r(n),t.d(n,{default:()=>P});var l=t(89379),o=t(73216),i=t(83003),a=t(65043),d=t(30064),r=t.n(d),s=t(24858),c=t(58215),u=t(78729),p=t(15187),h=t(60184),m=t(39160),x=t(23156),v=t(47196),j=t(31174),w=t(78227),b=t(735),f=t(65512),y=t(96651),N=t(4938),g=t(55971),A=t(86178),C=t.n(A),D=t(33007),I=t(31744),O=t(42837),k=t(89427),T=t(94084),L=t(60446),S=t.n(L),_=t(70579);const P=function(){const{canCreate:e,canRead:n,canUpdate:t,canDelete:d}=(0,N.A)(),{setValue:A,control:L}=(0,s.mN)(),{userCompanyId:P,userBranchId:V,userType:Y}=(0,b.A)(),{visitorList:B,totalVisitorCount:F,loading:q}=(0,i.d4)(e=>e.visitor),{departmentListData:z,loading:E}=(0,i.d4)(e=>e.department),{branchList:M,loading:H}=(0,i.d4)(e=>e.branch),R=JSON.parse(localStorage.getItem("user_info_".concat(p.AU))),{employeList:U,loading:G}=(0,i.d4)(e=>e.employe),J=(0,o.Zp)(),W=(0,i.wA)(),[Z,K]=(0,a.useState)(""),Q=(0,s.FH)({control:L,name:"PDCompanyId",defaultValue:P}),X=(0,s.FH)({control:L,name:"PDBranchId",defaultValue:V}),$=(0,s.FH)({control:L,name:"PdDepartmentId",defaultValue:""}),ee=(0,s.FH)({control:L,name:"employee",defaultValue:""}),ne=(0,s.FH)({control:L,name:"startDate",defaultValue:""}),te=(0,s.FH)({control:L,name:"endDate",defaultValue:""}),le=(0,s.FH)({control:L,name:"category",defaultValue:""});(0,a.useEffect)(()=>{"admin"===Y&&W((0,u.Ar)({text:"",sort:!0,status:!0,isPagination:!1}))},[]);const[oe,ie]=(0,a.useState)(1),ae=[X,ee,$,le,Z,ne,te].join("-"),[de,re]=(0,a.useState)(!1);(0,a.useEffect)(()=>{de?1===oe?se():ie(1):re(e=>!0)},[ae]),(0,a.useEffect)(()=>{se()},[oe]);const se=()=>{var e,n;const t={page:oe,limit:10,reqPayload:{companyId:Q,branchId:X,directorId:"",employeId:ee,departmentId:$,text:Z,sort:!0,status:"",isPagination:!0,category:le,startDate:ne?null===(e=S()(ne))||void 0===e?void 0:e.format("YYYY-MM-DD"):null,endDate:te?null===(n=S()(te))||void 0===n?void 0:n.format("YYYY-MM-DD"):null}};W((0,c.NP)(t))};return(0,_.jsxs)(m.A,{onChange:e=>{K(e)},children:[(0,_.jsx)("div",{className:"",children:(0,_.jsxs)("div",{class:"xl:flex justify-between items-center py-1 xl:space-y-0 space-y-2 overflow-y-auto",children:[(0,_.jsxs)("div",{className:"grid sm:grid-cols-2 grid-cols-1 md:grid-cols-6 sm:gap-3 gap-1",children:[(0,_.jsx)("div",{className:"",children:(0,_.jsx)(s.xI,{control:L,name:"category",rules:{required:"category is required"},render:e=>{let{field:n}=e;return(0,_.jsxs)(f.A,(0,l.A)((0,l.A)({},n),{},{defaultValue:"",disabled:q,className:" ".concat(p.Lp," "),showSearch:!0,filterOption:(e,n)=>String(null===n||void 0===n?void 0:n.children).toLowerCase().includes(e.toLowerCase()),children:[(0,_.jsx)(f.A.Option,{className:"",value:"",children:"Select Category"}),(0,_.jsx)(f.A.Option,{value:"general",children:"General Visitor"}),(0,_.jsx)(f.A.Option,{value:"existing",children:"Existing Client"}),(0,_.jsx)(f.A.Option,{value:"new",children:"New Client"}),(0,_.jsx)(f.A.Option,{value:"employe",children:"Employe To Client"})]}))}})}),("admin"===(null===R||void 0===R?void 0:R.userType)||"company"===(null===R||void 0===R?void 0:R.userType)||"companyDirector"===(null===R||void 0===R?void 0:R.userType))&&(0,_.jsx)("div",{className:"",children:(0,_.jsx)(s.xI,{control:L,name:"PDBranchId",rules:{required:"Branch is required"},render:e=>{var n;let{field:t}=e;return(0,_.jsxs)(f.A,(0,l.A)((0,l.A)({},t),{},{defaultValue:"",disabled:q,onFocus:()=>{W((0,I.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===R||void 0===R?void 0:R.userType)?Q:"company"===(null===R||void 0===R?void 0:R.userType)?null===R||void 0===R?void 0:R._id:null===R||void 0===R?void 0:R.companyId}))},className:"".concat(p.Lp," "),showSearch:!0,filterOption:(e,n)=>String(null===n||void 0===n?void 0:n.children).toLowerCase().includes(e.toLowerCase()),children:[(0,_.jsx)(f.A.Option,{value:"",children:"Select Branch"}),H?(0,_.jsx)(f.A.Option,{disabled:!0,children:(0,_.jsx)(k.A,{})}):null===(n=(0,p._o)(M))||void 0===n?void 0:n.map(e=>(0,_.jsx)(f.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}})}),(0,_.jsx)("div",{className:"",children:(0,_.jsx)(s.xI,{control:L,name:"PdDepartmentId",rules:{required:"Department is required"},render:e=>{var n;let{field:t}=e;return(0,_.jsxs)(f.A,(0,l.A)((0,l.A)({},t),{},{defaultValue:"",disabled:q,onFocus:()=>{W((0,D.UU)({text:"",sort:!0,status:!0,companyId:"admin"===(null===R||void 0===R?void 0:R.userType)?Q:"company"===(null===R||void 0===R?void 0:R.userType)?null===R||void 0===R?void 0:R._id:null===R||void 0===R?void 0:R.companyId,branchId:X,isPagination:!1}))},className:"".concat(p.Lp," "),showSearch:!0,filterOption:(e,n)=>String(null===n||void 0===n?void 0:n.children).toLowerCase().includes(e.toLowerCase()),children:[(0,_.jsx)(f.A.Option,{value:"",children:"Select Department"}),E?(0,_.jsx)(f.A.Option,{disabled:!0,children:(0,_.jsx)(k.A,{})}):null===(n=(0,p._o)(z))||void 0===n?void 0:n.map(e=>(0,_.jsx)(f.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.name},null===e||void 0===e?void 0:e._id))]}))}})}),(0,_.jsx)("div",{className:"",children:(0,_.jsx)(s.xI,{name:"employee",control:L,render:e=>{var n;let{field:t}=e;return(0,_.jsxs)(f.A,(0,l.A)((0,l.A)({},t),{},{className:" ".concat(p.Lp," "),popupClassName:"!z-[1580]",placeholder:"Select Employee",disabled:q,showSearch:!0,filterOption:(e,n)=>String(null===n||void 0===n?void 0:n.children).toLowerCase().includes(e.toLowerCase()),optionLabelProp:"children",onFocus:()=>(()=>{const e={text:"",status:!0,sort:!0,isTL:"",isHR:"",isPagination:!1,designationId:"",departmentId:"",companyId:Q,branchId:X};W((0,O.qV)(e))})(),children:[(0,_.jsx)(f.A.Option,{value:"",children:"Select Employee"}),G?(0,_.jsx)(f.A.Option,{disabled:!0,children:(0,_.jsx)(k.A,{})}):null===(n=(0,p._o)(U))||void 0===n?void 0:n.map(e=>(0,_.jsx)(f.A.Option,{value:e._id,children:e.fullName},e._id))]}))}})}),(0,_.jsx)(s.xI,{name:"startDate",control:L,render:e=>{let{field:n}=e;return(0,_.jsx)(T.A,{report:!0,defaultValue:S()().subtract(1,"month"),size:"middle",field:n})}}),(0,_.jsx)(s.xI,{name:"endDate",control:L,render:e=>{let{field:n}=e;return(0,_.jsx)(T.A,{report:!0,defaultValue:S()(),size:"middle",field:n})}})]}),(0,_.jsxs)("div",{className:"flex justify-end items-center gap-2 ",children:[(0,_.jsx)("button",{onClick:()=>{A("employee",""),A("PDBranchId",""),A("PdDepartmentId",""),A("category",""),A("PdCompanyId",""),A("startDate",null),A("endDate",null)},className:"bg-header   py-[6px]  rounded-md  flex px-5 justify-center items-center  text-white",children:(0,_.jsx)("span",{className:"text-[12px]",children:"Reset"})}),e&&(0,_.jsx)(y.A,{placement:"topLeft",title:"Add Visitor",children:(0,_.jsxs)("button",{onClick:()=>{J("/admin/visitor/create")},className:"bg-header p-2 rounded-md flex justify-center items-center space-x-2 text-white",children:[(0,_.jsx)(h.OiG,{}),(0,_.jsx)("span",{className:"text-[12px] text-nowrap tracking-wide",children:"Add Visitor"})]})})]})]})}),(0,_.jsx)("div",{className:"bg-[#ffffff]  w-full overflow-x-auto mt-1 rounded-xl",children:n&&(0,_.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto ",children:[(0,_.jsx)("thead",{className:"",children:(0,_.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] capitalize text-[12px] bg-header text-white font-[500] h-[40px]",children:[(0,_.jsx)("th",{className:"border-none p-2 whitespace-nowrap w-[8%]",children:"S.no."}),(0,_.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Visitor Name"}),(0,_.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Client Name"}),(0,_.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Category type"}),(0,_.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Mobile Number"}),(0,_.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Contact Person"}),(0,_.jsx)("th",{className:"border-none !w-12 p-2 whitespace-nowrap",children:"Reason"}),(0,_.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"CheckIn"}),(0,_.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"CheckOut"}),(0,_.jsx)("th",{className:"border-none p-2 whitespace-nowrap",children:"Created By"}),(d||t)&&(0,_.jsx)("th",{className:"border-none p-2 whitespace-nowrap w-[8%]",children:"Action"})]})}),q?(0,_.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,_.jsx)("td",{colSpan:10,className:"px-6 py-2 whitespace-nowrap font-[600] text-sm text-gray-500",children:(0,_.jsx)(g.A,{})})}):(0,_.jsx)("tbody",{children:B&&(null===B||void 0===B?void 0:B.length)>0?null===B||void 0===B?void 0:B.map((e,n)=>{var o,i,a,s,u,p,h;return(0,_.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] ".concat(n%2===0?"bg-[#e9ecef]/80":"bg-white"," text-[#374151] text-[14px]"),children:[(0,_.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:n+1+10*(oe-1)}),(0,_.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==(o=null===e||void 0===e?void 0:e.name)&&void 0!==o?o:"-"}),(0,_.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==(i=null===e||void 0===e?void 0:e.clientName)&&void 0!==i?i:"-"}),(0,_.jsx)("td",{className:"whitespace-nowrap border-none p-2 capitalize ",children:null!==(a=null===e||void 0===e?void 0:e.category)&&void 0!==a?a:"-"}),(0,_.jsx)("td",{className:"whitespace-nowrap border-none p-2",children:(null===e||void 0===e||null===(s=e.mobile)||void 0===s?void 0:s.code)+" "+(null===e||void 0===e||null===(u=e.mobile)||void 0===u?void 0:u.number)||"-"}),(0,_.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==(p=null===e||void 0===e?void 0:e.contactPerson)&&void 0!==p?p:"-"}),(0,_.jsx)("td",{className:"whitespace-nowrap border-none p-2 !w-12 ",children:null!==(h=null===e||void 0===e?void 0:e.visitReasonId)&&void 0!==h?h:"-"}),(0,_.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==e&&void 0!==e&&e.checkInTime?C()(null===e||void 0===e?void 0:e.checkInTime).format("DD-MM-YYYY hh:mm a"):"-"}),(0,_.jsx)("td",{className:"whitespace-nowrap border-none p-2 ",children:null!==e&&void 0!==e&&e.checkOutTime?C()(null===e||void 0===e?void 0:e.checkOutTime).format("DD-MM-YYYY hh:mm a"):(0,_.jsx)(y.A,{placement:"topLeft",title:"Checkout",children:(0,_.jsx)("button",{onClick:()=>{(e=>{let n=(0,l.A)((0,l.A)({},e),{},{_id:null===e||void 0===e?void 0:e._id,checkOutTime:C()()});r().fire({title:"Warning",text:"Are you sure you want to checkout!",icon:"warning",showCancelButton:!0,cancelButtonText:"No"}).then(e=>{e.isConfirmed&&W((0,c._z)(n)).then(e=>{!e.error&&se()})})})(e)},className:"px-2 py-1.5 text-xs rounded-md bg-header text-white border border-muted",type:"button",children:"CheckOut"})})}),(0,_.jsx)("td",{className:"whitespace-nowrap border-none px-2 py-3",children:(null===e||void 0===e?void 0:e.createdBy)||"-"}),(d||t)&&(0,_.jsx)("td",{className:"whitespace-nowrap border-none p-2",children:(0,_.jsxs)("span",{className:"py-1.5 flex justify-start items-center space-x-2",children:[t&&(0,_.jsx)(y.A,{placement:"topLeft",title:"Edit",children:(0,_.jsx)("button",{disabled:(null===e||void 0===e?void 0:e.checkOutTime)&&(null===e||void 0===e?void 0:e.checkInTime),onClick:()=>{J("/admin/visitor/edit/".concat((0,j.w)(null===e||void 0===e?void 0:e._id)))},className:"px-2 py-1.5 text-xs rounded-md bg-transparent border border-muted",type:"button",children:(0,_.jsx)(x.Jcp,{className:"".concat(null!==e&&void 0!==e&&e.checkOutTime&&null!==e&&void 0!==e&&e.checkInTime?"text-gray-400":"hover:text-[#337ab7] text-[#3c8dbc] "),size:16})})}),d&&(0,_.jsx)(y.A,{placement:"topLeft",title:"Delete",children:(0,_.jsx)("button",{disabled:(null===e||void 0===e?void 0:e.checkOutTime)&&(null===e||void 0===e?void 0:e.checkInTime),onClick:()=>(e=>{let n={_id:e};r().fire({title:"Warning",text:"Are you sure you want to delete!",icon:"warning",showCancelButton:!0,cancelButtonText:"No"}).then(e=>{e.isConfirmed&&W((0,c.EF)(n)).then(e=>{oe>1&&1==(null===B||void 0===B?void 0:B.length)?ie(Number(oe-1)):!e.error&&se()})})})(null===e||void 0===e?void 0:e._id),className:"px-2 py-1.5 rounded-md bg-transparent border border-muted",type:"button",children:(0,_.jsx)(v.tqC,{className:"".concat(null!==e&&void 0!==e&&e.checkOutTime&&null!==e&&void 0!==e&&e.checkInTime?"text-gray-400":"text-red-600 hover:text-red-500 "),size:16})})})]})})]})}):(0,_.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,_.jsx)("td",{colSpan:4,className:"px-6 py-2 whitespace-nowrap font-[600] text-sm text-gray-500",children:"Record Not Found"})})})]})}),(null===B||void 0===B?void 0:B.length)>0&&(0,_.jsx)(w.A,{totalCount:F,pageSize:10,currentPage:oe,onChange:e=>{ie(e)}})]})}}}]);
//# sourceMappingURL=3818.94b5e4d6.chunk.js.map