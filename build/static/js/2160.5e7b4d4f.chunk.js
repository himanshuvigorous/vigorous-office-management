"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[2160],{72160:(e,t,l)=>{l.r(t),l.d(t,{default:()=>P});var a=l(89379),n=l(24858),o=l(83003),d=l(15187),i=l(65043),r=l(31744),s=l(39160),c=l(97326),p=l(65512),u=l(96651),v=l(86178),m=l.n(v),x=l(60446),h=l.n(x),y=l(78227),f=l(12106),w=l(42837),j=l(94084),g=l(69223),b=l(55971),N=l(50822),D=l(6720),A=l(37762),I=l(64857),S=l(33007),C=l(42044),Y=l(89427),T=l(70579);const P=function(){const{control:e,formState:{errors:t},setValue:l}=(0,n.mN)(),v=(0,o.wA)(),{leaveRequestReportList:x,leaveRequestReportFunc_loading:P,totalleaveRequestReportCount:F}=(0,o.d4)(e=>e.reports),{employeList:R}=(0,o.d4)(e=>e.employe),[M,_]=(0,i.useState)(""),k=JSON.parse(localStorage.getItem("user_info_".concat(d.AU))),{leaveListData:L}=(0,o.d4)(e=>e.leaveType),[E,B]=(0,i.useState)(1),[z,O]=(0,i.useState)(""),{branchList:V}=(0,o.d4)(e=>e.branch),H=(0,n.FH)({control:e,name:"PDCompanyId",defaultValue:""}),U=(0,n.FH)({control:e,name:"PDBranchId",defaultValue:""}),q=(0,n.FH)({control:e,name:"dayType"}),K=(0,n.FH)({control:e,name:"status",defaultValue:""}),W=(0,n.FH)({control:e,name:"leaveType",defaultValue:""}),J=(0,n.FH)({control:e,name:"isPaid",defaultValue:""}),G=(0,n.FH)({control:e,name:"employeeId"}),Q=(0,n.FH)({control:e,name:"departmentId"}),X=(0,n.FH)({control:e,name:"startDate",defaultValue:h()().subtract(1,"month")}),Z=(0,n.FH)({control:e,name:"endDate",defaultValue:h()()}),[$,ee]=(0,i.useState)(10),{departmentListData:te,loading:le}=(0,o.d4)(e=>e.department);(0,i.useEffect)(()=>{"company"!==(null===k||void 0===k?void 0:k.userType)&&"companyDirector"!==(null===k||void 0===k?void 0:k.userType)||v((0,r.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===k||void 0===k?void 0:k.userType)?H:"company"===(null===k||void 0===k?void 0:k.userType)?null===k||void 0===k?void 0:k._id:null===k||void 0===k?void 0:k.companyId})),v((0,S.UU)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"company"===(null===k||void 0===k?void 0:k.userType)?null===k||void 0===k?void 0:k._id:null===k||void 0===k?void 0:k.companyId})),l("startDate",h()().subtract(1,"month")),l("endDate",h()())},[]),(0,i.useEffect)(()=>{de()},[E,z,$]),(0,i.useEffect)(()=>{const e=setTimeout(()=>{O(M)},500);return()=>{clearTimeout(e)}},[M]);const ae=function(){return{currentPage:E,pageSize:$,reqPayload:{text:z,status:K,sort:!0,isPagination:!(arguments.length>0&&void 0!==arguments[0])||arguments[0],companyId:"admin"===(null===k||void 0===k?void 0:k.userType)?H:"company"===(null===k||void 0===k?void 0:k.userType)?null===k||void 0===k?void 0:k._id:null===k||void 0===k?void 0:k.companyId,branchId:"company"===(null===k||void 0===k?void 0:k.userType)||"admin"===(null===k||void 0===k?void 0:k.userType)||"companyDirector"===(null===k||void 0===k?void 0:k.userType)?U:"companyBranch"===(null===k||void 0===k?void 0:k.userType)?null===k||void 0===k?void 0:k._id:null===k||void 0===k?void 0:k.branchId,employeId:"",employeIds:G||[],startDate:X?h()(X).format("YYYY-MM-DD"):"",endDate:Z?h()(Z).format("YYYY-MM-DD"):"",type:q?[q]:[],startDateBreakDown:"",endDateBreakDown:"",departmentIds:Q?[Q]:[],leaveTypeId:"",leaveTypeIds:W&&(null===W||void 0===W?void 0:W.length)>0?W:[],isPaid:"Yes"==J}}},ne=()=>{v((0,w.qV)({companyId:"admin"===(null===k||void 0===k?void 0:k.userType)?H:"company"===(null===k||void 0===k?void 0:k.userType)?null===k||void 0===k?void 0:k._id:null===k||void 0===k?void 0:k.companyId,branchId:["admin","company","companyDirector"].includes(null===k||void 0===k?void 0:k.userType)?U:"companyBranch"===(null===k||void 0===k?void 0:k.userType)?null===k||void 0===k?void 0:k._id:null===k||void 0===k?void 0:k.branchId,departmentId:Q||"",directorId:"",text:"",sort:!0,status:!0,isPagination:!1,isBranch:!0,isDirector:!1}))},oe=()=>{v((0,C.cp)({directorId:"",companyId:"admin"===(null===k||void 0===k?void 0:k.userType)?H:"company"===(null===k||void 0===k?void 0:k.userType)?null===k||void 0===k?void 0:k._id:null===k||void 0===k?void 0:k.companyId,branchId:"company"===(null===k||void 0===k?void 0:k.userType)||"admin"===(null===k||void 0===k?void 0:k.userType)||"companyDirector"===(null===k||void 0===k?void 0:k.userType)?U:"companyBranch"===(null===k||void 0===k?void 0:k.userType)?null===k||void 0===k?void 0:k._id:null===k||void 0===k?void 0:k.branchId,text:"",sort:!0,status:"",isPagination:!1}))},de=()=>{v((0,f.v7)(ae(!0)))},ie=async()=>{de()},re=[{key:"1",label:(0,T.jsx)("span",{className:"text-white",children:"Advance Filters"}),children:(0,T.jsxs)("div",{className:"bg-[#ececec] space-y-1",children:[(0,T.jsxs)("div",{className:"sm:flex  grid grid-cols-1  gap-2 sm:flex-wrap text-[14px]",children:[("admin"===(null===k||void 0===k?void 0:k.userType)||"company"===(null===k||void 0===k?void 0:k.userType)||"companyDirector"===(null===k||void 0===k?void 0:k.userType))&&(0,T.jsxs)("div",{className:"",children:[(0,T.jsx)(n.xI,{name:"PDBranchId",control:e,render:e=>{let{field:t}=e;return(0,T.jsxs)(p.A,(0,a.A)((0,a.A)({},t),{},{className:"inputAntdSelectClassNameFilterReport ",placeholder:"Select Branch",showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,T.jsx)(p.A.Option,{value:"",children:"Select Branch"}),null===V||void 0===V?void 0:V.map(e=>(0,T.jsxs)(p.A.Option,{value:null===e||void 0===e?void 0:e._id,children:[" ",null===e||void 0===e?void 0:e.fullName," "]}))]}))}}),t.PDBranchId&&(0,T.jsx)("p",{className:"text-red-500 text-sm",children:t.PDBranchId.message})]}),(0,T.jsx)("div",{children:(0,T.jsx)(n.xI,{name:"departmentId",control:e,render:e=>{var t;let{field:l}=e;return(0,T.jsxs)(p.A,(0,a.A)((0,a.A)({},l),{},{className:"inputAntdSelectClassNameFilterReport",showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),onFocus:()=>{v((0,S.UU)({text:"",sort:!0,status:!0,isPagination:!1,companyId:"admin"===(null===k||void 0===k?void 0:k.userType)?H:"company"===(null===k||void 0===k?void 0:k.userType)?null===k||void 0===k?void 0:k._id:null===k||void 0===k?void 0:k.companyId,branchId:["admin","company","companyDirector"].includes(null===k||void 0===k?void 0:k.userType)?U:"companyBranch"===(null===k||void 0===k?void 0:k.userType)?null===k||void 0===k?void 0:k._id:null===k||void 0===k?void 0:k.branchId}))},onChange:e=>{l.onChange(e)},placeholder:"Select Department",children:[(0,T.jsx)(p.A.Option,{value:"",children:"Select Department"}),le?(0,T.jsx)(p.A.Option,{disabled:!0,children:(0,T.jsx)(Y.A,{})}):null===(t=(0,d._o)(te))||void 0===t?void 0:t.map(e=>(0,T.jsx)(p.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.name},null===e||void 0===e?void 0:e._id))]}))}})}),(0,T.jsx)("div",{className:"",children:(0,T.jsx)(n.xI,{name:"employeeId",control:e,render:e=>{let{field:t}=e;return(0,T.jsx)(p.A,{mode:"multiple",allowClear:!0,showSearch:!0,filterOption:(e,t)=>{var l;return null===t||void 0===t||null===(l=t.label)||void 0===l?void 0:l.toLowerCase().includes(e.toLowerCase())},className:"inputAntdMultiSelectClassNameFilterReport ",placeholder:"Select Employee",onFocus:ne,options:null===R||void 0===R?void 0:R.map(e=>({label:e.fullName,value:e._id})),value:t.value||[],onChange:e=>t.onChange(e)})}})}),(0,T.jsx)("div",{children:(0,T.jsx)(n.xI,{name:"dayType",control:e,rules:{},render:e=>{let{field:t}=e;return(0,T.jsx)(p.A,(0,a.A)((0,a.A)({},t),{},{allowClear:!0,className:"inputAntdMultiSelectClassNameFilterReport",placeholder:"Select Type",options:[{label:"Multiple Day",value:"Multiple"},{value:"Single",label:"Single Day"}],value:t.value||[],onChange:e=>t.onChange(e)}))}})}),(0,T.jsx)("div",{children:(0,T.jsx)(n.xI,{name:"leaveType",control:e,render:e=>{let{field:t}=e;return(0,T.jsx)(p.A,(0,a.A)((0,a.A)({},t),{},{mode:"multiple",allowClear:!0,className:"inputAntdMultiSelectClassNameFilterReport",placeholder:"Select Leave Type",onFocus:oe,options:null===L||void 0===L?void 0:L.map(e=>({value:null===e||void 0===e?void 0:e._id,label:null===e||void 0===e?void 0:e.name})),value:t.value||[],onChange:e=>t.onChange(e)}))}})}),(0,T.jsx)("div",{children:(0,T.jsx)(n.xI,{name:"status",control:e,render:e=>{let{field:t}=e;return(0,T.jsx)(p.A,(0,a.A)((0,a.A)({},t),{},{mode:"multiple",allowClear:!0,className:"inputAntdMultiSelectClassNameFilterReport",placeholder:"Select status",options:[{value:"Pending",label:"Pending"},{value:"Approved",label:"Approved"},{value:"Rejected",label:"Rejected"},{value:"Cancelled",label:"Cancelled"}],value:t.value||[],onChange:e=>t.onChange(e)}))}})}),(0,T.jsx)("div",{children:(0,T.jsx)(n.xI,{name:"isPaid",control:e,render:e=>{let{field:t}=e;return(0,T.jsx)(p.A,(0,a.A)((0,a.A)({},t),{},{allowClear:!0,className:"inputAntdMultiSelectClassNameFilterReport",placeholder:"Select isPaid",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}],value:t.value||[],onChange:e=>t.onChange(e)}))}})}),(0,T.jsx)("div",{children:(0,T.jsx)(n.xI,{name:"startDate",control:e,render:e=>{let{field:l}=e;return(0,T.jsx)(j.A,{report:!0,defaultValue:h()().subtract(1,"month"),size:"middle",field:l,errors:t})}})}),(0,T.jsx)("div",{children:(0,T.jsx)(n.xI,{name:"endDate",control:e,render:e=>{let{field:l}=e;return(0,T.jsx)(j.A,{report:!0,defaultValue:h()(),size:"middle",field:l,errors:t})}})})]}),(0,T.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,T.jsx)("button",{onClick:()=>{l("PDBranchId",""),l("PdCompanyId",""),l("departmentId",""),l("employeeId",""),l("status",""),l("dayType",""),l("leaveType",""),l("isPaid",""),l("startDate",h()().subtract(1,"month")),l("endDate",h()()),ie()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,T.jsx)("span",{className:"text-[12px]",children:"Reset"})}),(0,T.jsx)("button",{onClick:()=>{ie()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,T.jsx)("span",{className:"text-[12px]",children:"Submit"})})]})]})}];return(0,T.jsx)(s.A,{onChange:e=>{_(e)},children:(0,T.jsxs)("div",{className:"bg-grey-100 w-full p-1",children:[(0,T.jsxs)("div",{className:"",children:[(0,T.jsx)(c.A,{className:"custom-collapse",items:re,defaultActiveKey:[1],expandIcon:e=>{let{isActive:t}=e;return(0,T.jsx)(D.WnU,{size:20,style:{color:"white",transform:t?"rotate(-90deg)":"rotate(0deg)",transition:"transform 0.3s ease"}})}}),(0,T.jsxs)("div",{className:"space-y-1.5 sm:flex grid grid-cols-1 justify-between items-center",children:[(0,T.jsxs)("div",{className:"flex py-1 items-center gap-2",children:[(0,T.jsx)("span",{htmlFor:"pageSize",className:"text-sm font-light text-gray-500",children:"Rows per page:"}),(0,T.jsx)(p.A,{id:"pageSize",value:$,onChange:e=>{ee(Number(e)),B(Number(1))},className:"text-sm font-light text-gray-700 bg-white border border-gray-200 rounded-md px-3 py-1.5 shadow-sm focus:outline-none focus:ring-1 focus:ring-gray-300 transition",children:d.qc.map(e=>(0,T.jsx)(p.A.Option,{value:e,children:e},e))})]}),(0,T.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,T.jsx)("button",{onClick:()=>{(async()=>{var e,t;const l=new A.uE({orientation:"landscape",unit:"pt"});l.setFontSize(16);const a=await(null===N.K||void 0===N.K?void 0:N.K.leaveRequestReportFunc(ae(!1)));if(!x&&!a)return;const n=null===a||void 0===a||null===(e=a.data)||void 0===e||null===(t=e.docs)||void 0===t?void 0:t.map((e,t)=>{var l;return[t+1,h()(null===e||void 0===e?void 0:e.createdAt).format("DD-MM-YYYY hh:mm a"),(null===e||void 0===e||null===(l=e.employeData)||void 0===l?void 0:l.fullName)||"-",null===e||void 0===e?void 0:e.leaveType,h()(null===e||void 0===e?void 0:e.startDate).format("DD-MM-YYYY"),h()(null===e||void 0===e?void 0:e.endDate).format("DD-MM-YYYY"),null!==e&&void 0!==e&&e.isPaid?"Yes":"No",null===e||void 0===e?void 0:e.status]});(0,I.Ay)(l,{startY:40,head:[["S.No.","Date Of Application","Employee Name","Leave Type","Start Date","End Date","Paid","Status"]],body:n,margin:{horizontal:10},styles:{cellPadding:8,fontSize:10,valign:"middle",halign:"left"},headStyles:{fillColor:[211,211,211],textColor:[0,0,0],fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]}}),l.save("Leave_Report.pdf")})()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,T.jsx)("span",{className:"text-[12px]",children:"Export PDF"})}),(0,T.jsx)("button",{onClick:()=>{(async()=>{var e,t;const l=new g.Workbook,a=l.addWorksheet("Employee Attendance");a.columns=[{header:"S.No",key:"sno",width:10},{header:"Date of Application",key:"createdAt",width:10},{header:"Employee Name",key:"name",width:30},{header:"Leave Type",key:"leaveType",width:20},{header:"Start Date",key:"startDate",width:20},{header:"End Date",key:"enddate",width:20},{header:"Paid",key:"isPaid",width:20},{header:"Status",key:"status",width:15}],a.getRow(1).eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFB6D7A8"}},e.font={bold:!0},e.alignment={vertical:"middle",horizontal:"center"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});const n=await(null===N.K||void 0===N.K?void 0:N.K.leaveRequestReportFunc(ae(!1)));if(!x&&!n)return;const o=null===n||void 0===n||null===(e=n.data)||void 0===e||null===(t=e.docs)||void 0===t?void 0:t.map((e,t)=>{var l;return{sno:t+1,createdAt:h()(null===e||void 0===e?void 0:e.createdAt).format("DD-MM-YYYY hh:mm a"),name:(null===e||void 0===e||null===(l=e.employeData)||void 0===l?void 0:l.fullName)||"-",leaveType:null===e||void 0===e?void 0:e.leaveType,startDate:h()(null===e||void 0===e?void 0:e.startDate).format("DD-MM-YYYY"),enddate:h()(null===e||void 0===e?void 0:e.endDate).format("DD-MM-YYYY"),isPaid:null!==e&&void 0!==e&&e.isPaid?"Yes":"No",status:null===e||void 0===e?void 0:e.status}});null===o||void 0===o||o.forEach(e=>{a.addRow(e).eachCell(e=>{e.alignment={vertical:"middle",horizontal:"left"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),a.autoFilter={from:"A1",to:"I1"},l.xlsx.writeBuffer().then(e=>{const t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=document.createElement("a");l.href=URL.createObjectURL(t),l.download="Employee_Leave_Report.xlsx",l.click()})})()},className:"bg-header  py-2 my-0.5 rounded-md flex px-10 justify-center items-center  text-white",children:(0,T.jsx)("span",{className:"text-[12px]",children:"Export Excel"})})]})]})]}),(0,T.jsx)("div",{className:"bg-white w-full overflow-x-auto mt-1 rounded-xl shadow-sm",children:(0,T.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto border-collapse",children:[(0,T.jsx)("thead",{children:(0,T.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] capitalize text-[13px] bg-header text-white font-[600] h-[45px]",children:[(0,T.jsx)("th",{className:"border-none px-4 py-3 whitespace-nowrap text-center w-[60px]",children:"S.No."}),(0,T.jsx)("th",{className:"border-none px-4 py-3 whitespace-nowrap text-left w-[140px]",children:(0,T.jsx)("div",{className:"flex items-center",children:(0,T.jsx)("span",{children:"Date Of Application"})})}),(0,T.jsx)("th",{className:"border-none px-4 py-3 whitespace-nowrap text-left min-w-[180px]",children:"Employee Name"}),(0,T.jsx)("th",{className:"border-none px-4 py-3 whitespace-nowrap text-left min-w-[140px]",children:"Leave Type"}),(0,T.jsx)("th",{className:"border-none px-4 py-3 whitespace-nowrap text-center min-w-[120px]",children:"Start Date"}),(0,T.jsx)("th",{className:"border-none px-4 py-3 whitespace-nowrap text-center min-w-[120px]",children:"End Date"}),(0,T.jsx)("th",{className:"border-none px-4 py-3 whitespace-nowrap text-left w-[250px] min-w-[250px] max-w-[250px]",children:(0,T.jsx)("div",{className:"flex items-center",children:(0,T.jsx)("span",{children:"Reason"})})}),(0,T.jsx)("th",{className:"border-none px-4 py-3 whitespace-nowrap text-center min-w-[100px]",children:"Paid / UnPaid"}),(0,T.jsx)("th",{className:"border-none px-4 py-3 whitespace-nowrap text-center min-w-[100px]",children:"Status"})]})}),P?(0,T.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,T.jsx)("td",{colSpan:10,className:"px-6 py-2 whitespace-nowrap text-center font-[600] text-sm text-gray-500",children:(0,T.jsx)(b.A,{})})}):(0,T.jsx)("tbody",{children:x&&(null===x||void 0===x?void 0:x.length)>0?null===x||void 0===x?void 0:x.map((e,t)=>{var l;return(0,T.jsxs)("tr",{className:"border-b-[1px] hover:bg-gray-50 ".concat(t%2===0?"bg-[#f8f9fa]":"bg-white"," border-[#DDDDDD] text-[#374151] text-[14px]"),children:[(0,T.jsx)("td",{className:"whitespace-nowrap text-center border-none px-4 py-3",children:t+1+(E-1)*$}),(0,T.jsx)("td",{className:"whitespace-nowrap text-left border-none px-4 py-3",children:h()(null===e||void 0===e?void 0:e.createdAt).format("DD-MM-YYYY hh:mm a")||"N/A"}),(0,T.jsx)("td",{className:"whitespace-nowrap text-left border-none px-4 py-3 font-medium",children:(null===e||void 0===e||null===(l=e.employeData)||void 0===l?void 0:l.fullName)||"N/A"}),(0,T.jsx)("td",{className:"whitespace-nowrap text-left border-none px-4 py-3",children:(null===e||void 0===e?void 0:e.leaveType)||"N/A"}),(0,T.jsx)("td",{className:"whitespace-nowrap text-center border-none px-4 py-3",children:m()(null===e||void 0===e?void 0:e.startDate).format("DD-MM-YYYY")||"N/A"}),(0,T.jsx)("td",{className:"whitespace-nowrap text-center border-none px-4 py-3",children:m()(null===e||void 0===e?void 0:e.endDate).format("DD-MM-YYYY")||"N/A"}),(0,T.jsx)("td",{className:"w-[250px] min-w-[250px] max-w-[250px] text-left border-none px-4 py-3",children:(0,T.jsx)(u.A,{title:(null===e||void 0===e?void 0:e.reason)||"N/A",placement:"topLeft",overlayStyle:{maxWidth:"500px"},children:(0,T.jsx)("div",{className:"truncate cursor-help",children:(null===e||void 0===e?void 0:e.reason)||"N/A"})})}),(0,T.jsx)("td",{className:"whitespace-nowrap text-center border-none px-4 py-3",children:(0,T.jsx)("span",{className:"".concat(null!==e&&void 0!==e&&e.isPaid?"text-green-600":"text-red-600"," font-medium"),children:(null!==e&&void 0!==e&&e.isPaid?"Paid":"UnPaid")||"N/A"})}),(0,T.jsx)("td",{className:"whitespace-nowrap text-center border-none px-4 py-3",children:(0,T.jsx)("span",{className:"".concat("Approved"===(null===e||void 0===e?void 0:e.status)?"bg-green-100 text-green-800 border-green-200":"Pending"===(null===e||void 0===e?void 0:e.status)?"bg-yellow-100 text-yellow-800 border-yellow-200":"Rejected"===(null===e||void 0===e?void 0:e.status)?"bg-red-100 text-red-800 border-red-200":(null===e||void 0===e||e.status,"bg-gray-100 text-gray-800 border-gray-200")," border px-3 py-1 rounded-full text-xs font-medium"),children:null!==e&&void 0!==e&&e.status?e.status:"N/A"})})]})}):(0,T.jsx)("tr",{className:"bg-white bg-opacity-5",children:(0,T.jsx)("td",{colSpan:9,className:"px-6 py-2 whitespace-nowrap text-center font-[600] text-sm text-gray-500",children:"Record Not Found"})})})]})}),(0,T.jsx)(y.A,{totalCount:F,pageSize:$,currentPage:E,onChange:e=>{B(e)}})]})})}}}]);
//# sourceMappingURL=2160.5e7b4d4f.chunk.js.map