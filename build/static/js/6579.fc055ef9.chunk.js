"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[6579],{86579:(e,l,a)=>{a.r(l),a.d(l,{default:()=>g});var t=a(89379),i=a(24858),d=a(39160),s=a(83003),n=a(73216),o=a(31174),c=a(65043),r=a(15187),m=a(42837),u=a(92823),p=a.n(u),v=a(96712),h=a(88967),x=a(60184),y=a(70579);const g=()=>{const{register:e,handleSubmit:l,control:a,setValue:u,formState:{errors:g}}=(0,i.mN)(),b=(0,s.wA)(),j=(0,n.Zp)(),{policyIdEnc:f}=(0,n.g)(),N=JSON.parse(localStorage.getItem("user_info_".concat(r.AU))),{companyList:A}=(0,s.d4)(e=>e.company),{branchList:C}=(0,s.d4)(e=>e.branch),I=(0,o.Yc)(f),{policyDetails:S}=(0,s.d4)(e=>e.policy),[T,k]=(0,c.useState)(""),[_,D]=(0,c.useState)(""),[P,q]=(0,c.useState)([]),[w,E]=(0,c.useState)(!1),[L,O]=(0,c.useState)({attachments:[]});(0,c.useEffect)(()=>{b((0,m.qV)())},[]),(0,c.useEffect)(()=>{let e={_id:I};b((0,v.NY)(e))},[]),(0,c.useEffect)(()=>{S&&(u("title",null===S||void 0===S?void 0:S.title),k(null===S||void 0===S?void 0:S.content))},[S]);return(0,y.jsx)(d.A,{children:(0,y.jsx)("div",{className:"gap-4",children:(0,y.jsxs)("form",{autoComplete:"off",className:"mt-2 md:px-1",onSubmit:l(e=>{const l={_id:I,companyId:"admin"===(null===N||void 0===N?void 0:N.userType)?null===e||void 0===e?void 0:e.PDCompanyId:"company"===(null===N||void 0===N?void 0:N.userType)?null===N||void 0===N?void 0:N._id:null===N||void 0===N?void 0:N.companyId,directorId:"companyDirector"===(null===N||void 0===N?void 0:N.userType)?null===N||void 0===N?void 0:N._id:null===N||void 0===N?void 0:N.directorId,branchId:"admin"===(null===N||void 0===N?void 0:N.userType)||"companyDirector"===(null===N||void 0===N?void 0:N.userType)||"company"===(null===N||void 0===N?void 0:N.userType)?null===e||void 0===e?void 0:e.PDBranchId:"companyBranch"===(null===N||void 0===N?void 0:N.userType)?null===N||void 0===N?void 0:N._id:null===N||void 0===N?void 0:N.branchId,title:null===e||void 0===e?void 0:e.title,content:T};b((0,v.Ly)(l)).then(e=>{e.error||j("/admin/policy")})}),children:[(0,y.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 md:gap-8 gap-3 md:my-2",children:["admin"===(null===N||void 0===N?void 0:N.userType)&&(0,y.jsxs)("div",{className:"",children:[(0,y.jsxs)("label",{className:"".concat(r.Q0),children:["Company ",(0,y.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,y.jsxs)("select",(0,t.A)((0,t.A)({},e("PDCompanyId",{required:"company is required"})),{},{className:" ".concat(r.Ol," ").concat(g.PDCompanyId?"border-[1px] ":"border-gray-300"),children:[(0,y.jsx)("option",{className:"",value:"",children:"Select Comapany"}),null===A||void 0===A?void 0:A.map(e=>(0,y.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName}))]})),g.PDCompanyId&&(0,y.jsx)("p",{className:"text-red-500 text-sm",children:g.PDCompanyId.message})]}),(0,y.jsxs)("div",{className:"",children:[(0,y.jsx)("label",{className:"".concat(r.Q0),children:"Title"}),(0,y.jsx)("input",(0,t.A)((0,t.A)({type:"text"},e("title",{required:"Title is required"})),{},{className:"".concat(r.Ol," ").concat(g.title?"border-[1px] ":"border-gray-300"),placeholder:"Enter Title"})),g.title&&(0,y.jsx)("p",{className:"text-red-500 text-sm",children:g.title.message})]}),(0,y.jsx)("div",{className:"mt-4 col-span-2",children:(0,y.jsx)(p(),{value:T,onChange:e=>{k(e)},placeholder:"Write the email body here",modules:{toolbar:[[{header:"1"},{header:"2"},{font:[]}],[{list:"ordered"},{list:"bullet"}],["bold","italic","underline","strike"],[{align:[]}],["link","image","video"],["blockquote","code-block"],["clean"]]},formats:["header","font","list","bold","italic","underline","link","align","clean"]})})]}),(0,y.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 md:gap-8 gap-3 md:my-2",children:(0,y.jsxs)("div",{className:"pt-0 mt-6",children:[(0,y.jsx)("div",{className:"font-medium mb-2",children:"Attachments:"}),w?(0,y.jsx)("div",{className:"space-y-2"}):(0,y.jsxs)("div",{className:"space-y-4",children:[(0,y.jsx)("input",{type:"file",onChange:e=>{const l={filePath:e.target.files[0],isVideo:!1,isMultiple:!1};b((0,h.Sg)(l)).then(e=>{var l;null!==e&&void 0!==e&&null!==(l=e.payload)&&void 0!==l&&l.data&&O(l=>{var a;return(0,t.A)((0,t.A)({},l),{},{attachments:[...l.attachments,null===(a=e.payload)||void 0===a?void 0:a.data]})})})},className:"hidden",id:"file-upload"}),(0,y.jsxs)("label",{htmlFor:"file-upload",className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white cursor-pointer",children:[(0,y.jsx)(x.chT,{className:"mr-2"})," Add Attachments"]}),(0,y.jsx)("div",{className:"space-y-2",children:L.attachments.map((e,l)=>(0,y.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-md",children:[(0,y.jsxs)("a",{href:"".concat("https://vigapi.vigorousit.com","/public/").concat(e),className:"flex items-center space-x-2",target:"_blank",rel:"noopener noreferrer",children:[(0,y.jsx)(x.chT,{className:"text-gray-500"}),(0,y.jsx)("span",{className:"text-sm text-gray-600",children:e})]}),(0,y.jsx)("button",{type:"button",onClick:()=>(e=>{O(l=>{const a=l.attachments.filter((l,a)=>a!==e);return(0,t.A)((0,t.A)({},l),{},{attachments:a})})})(l),className:"text-red-500 hover:text-red-700",children:(0,y.jsx)(x.QCr,{})})]},l))})]})]})}),(0,y.jsx)("div",{className:"flex justify-end",children:(0,y.jsx)("button",{type:"submit",className:"bg-header text-white p-2 px-4 rounded mt-4",children:"Submit"})})]})})})}}}]);
//# sourceMappingURL=6579.fc055ef9.chunk.js.map