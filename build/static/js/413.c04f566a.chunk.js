"use strict";(self.webpackChunkca_admin=self.webpackChunkca_admin||[]).push([[413],{70413:(e,t,a)=>{a.r(t),a.d(t,{default:()=>_});var l=a(89379),s=a(65043),d=a(39160),n=a(73216),i=a(83003),o=a(23156),r=a(47196),c=a(30064),u=a.n(c),p=a(31174),m=a(78227),x=a(15187),v=a(24858),h=a(31744),b=a(78729),j=a(78973),f=a(30326),g=a(53913),N=a(65512),y=a(96651),C=a(735),A=a(89388),w=a(31462),D=a(6720),k=a(86178),S=a.n(k),R=a(55971),Y=a(4938),q=a(60184),P=a(83002),I=a(29542),L=a(89427),O=a(70579);const _=function(){var e,t,a,c;const{register:k,control:_,setValue:M,formState:{errors:z}}=(0,v.mN)(),{userCompanyId:F,userBranchId:B,userType:H}=(0,C.A)(),V=(0,n.Zp)(),E=(0,i.wA)(),{resignationData:T,totalresignCount:U,loading:W}=(0,i.d4)(e=>e.resignation),[J,Z]=(0,s.useState)(""),[G,Q]=(JSON.parse(localStorage.getItem("user_info_".concat(x.AU))),(0,s.useState)(1)),[X,K]=(0,s.useState)({isOpen:!1,data:{},resignation:{}}),{canCreate:$,canRead:ee,canUpdate:te,canDelete:ae}=(0,Y.A)(),{companyList:le}=(0,i.d4)(e=>e.company),{branchList:se,branchListloading:de}=(0,i.d4)(e=>e.branch),ne=(0,v.FH)({control:_,name:"PDCompanyId",defaultValue:F}),ie=(0,v.FH)({control:_,name:"PDBranchId",defaultValue:B}),oe=(0,v.FH)({control:_,name:"status",defaultValue:""}),re=[ie,ne,J,oe].join("-"),[ce,ue]=(0,s.useState)(!1);(0,s.useEffect)(()=>{ce?1===G?pe():Q(1):ue(e=>!0)},[re]),(0,s.useEffect)(()=>{pe()},[G]);const pe=()=>{const e={currentPage:G,pageSize:10,reqData:{directorId:"",companyId:ne||"",branchId:ie||"",text:J,sort:!0,status:oe,isPagination:!0,type:"resignation"}};E((0,A.u2)(e))};(0,s.useEffect)(()=>{(ne||"company"===H||"companyDirector"===H)&&E((0,h.d0)({text:"",sort:!0,status:!0,isPagination:!1,companyId:ne}))},[ne]),(0,s.useEffect)(()=>{"admin"===H&&E((0,b.Ar)({text:"",sort:!0,status:!0,isPagination:!1}))},[]);const[me,xe]=(0,s.useState)(!1),[ve,he]=(0,s.useState)(null),be=()=>{xe(!1),he(null)},je=(e,t)=>{u().fire({title:"Provide feedback & date",input:"textarea",inputLabel:"Feedback (optional)",inputPlaceholder:"Type your feedback here...",showCancelButton:!0,confirmButtonText:"Update as ".concat(t),cancelButtonText:"Cancel",inputValidator:e=>e&&""!==e.trim()?null:"Feedback cannot be empty",html:"Approved"===t?'\n          <div style="margin-top: 1rem;">\n            <label for="custom-date-picker">Select Date:</label>\n            <input \n               type="date" \n               id="custom-date-picker" \n               min="'.concat(S()().format("YYYY-MM-DD"),'"\n               style="\n                 width: 100%;\n                 margin-top: 0.5rem;\n                 padding: 4px 11px;\n                 height: 40px;\n                 font-size: 14px;\n                 line-height: 1.5715;\n                 color: rgba(0, 0, 0, 0.85);\n                 background-color: #fff;\n                 border: 1px solid #d9d9d9;\n                 border-radius: 6px;\n                 transition: all 0.3s;\n                 box-sizing: border-box;\n               "\n             />\n          </div>'):"",preConfirm:()=>{var e,a;const l=u().getPopup(),s=null===(e=l.querySelector("textarea"))||void 0===e?void 0:e.value.trim(),d=null===(a=l.querySelector("#custom-date-picker"))||void 0===a?void 0:a.value;if(!s)return u().showValidationMessage("Feedback is required"),!1;if(!d&&"Approved"===t)return u().showValidationMessage("Please select a future date"),!1;return d<=S()().format("YYYY-MM-DD")?(u().showValidationMessage("The selected date must be in the future"),!1):{feedback:s,date:d}}}).then(a=>{if(a.isConfirmed){const{feedback:l,date:s}=a.value;E((0,A.Fc)({_id:null===e||void 0===e?void 0:e._id,status:t,reason:l,approvalDate:"Approved"===t?s:"Completed"===t?null===e||void 0===e?void 0:e.approvalDate:""})).then(e=>{null!==e&&void 0!==e&&e.error||(pe(),u().fire("Success","Status updated","success"))})}})},fe=e=>e.toLowerCase().endsWith(".pdf"),ge=e=>[".jpg",".jpeg",".png",".gif",".webp",".bmp",".tiff"].some(t=>e.toLowerCase().endsWith(t));return(0,O.jsxs)(d.A,{onChange:e=>{Z(e)},children:[(0,O.jsx)(g.A,{className:"antmodalclassName",title:"Attached Docs\tFor ".concat(null===X||void 0===X||null===(e=X.data)||void 0===e?void 0:e.employeName),width:1e3,footer:!1,open:X.isOpen,onOk:()=>K({open:!1,data:{}}),onCancel:()=>K({open:!1,data:{}}),children:(0,O.jsxs)("table",{className:"w-full max-w-full rounded-xl",children:[(0,O.jsx)("thead",{}),(0,O.jsx)("tbody",{children:(0,O.jsx)("tr",{children:(0,O.jsx)("td",{className:"tableData",children:(0,O.jsx)("div",{className:"flex flex-col space-y-4",children:null!==X&&void 0!==X&&null!==(t=X.data)&&void 0!==t&&t.attachment&&Array.isArray(null===X||void 0===X||null===(a=X.data)||void 0===a?void 0:a.attachment)?X.data.attachment.map((e,t)=>{const a="".concat("https://vigapi.vigorousit.com","/public/").concat(e);return ge(e)?(0,O.jsxs)("div",{className:"flex items-center gap-2",children:[(0,O.jsxs)("p",{className:"font-[500] text-[12px] text-black",children:["(",t+1,")"]}),(0,O.jsx)(I.A,{src:a,alt:"Uploaded ".concat(t+1)})]},t):fe(e)?(0,O.jsx)(y.A,{placement:"topLeft",title:"PDF Attachment ".concat(t+1),children:(0,O.jsxs)("div",{className:"flex items-center gap-2",children:[(0,O.jsxs)("p",{className:"font-[500] text-[12px] text-black",children:["(",t+1,")"]}),(0,O.jsx)("button",{onClick:()=>window.open(a,"_blank"),className:"px-2 py-1.5 text-xs rounded-md bg-transparent border border-muted hover:border-gray-800",type:"button",children:(0,O.jsx)(q.kl1,{className:"text-red-600 hover:text-red-700",size:26})})]})},t):null}):null!==X&&void 0!==X&&null!==(c=X.data)&&void 0!==c&&c.attachment?(()=>{const e=X.data.attachment,t="".concat("https://vigapi.vigorousit.com","/public/").concat(e);return ge(e)?(0,O.jsx)(I.A,{src:t,alt:"Uploaded Image"}):fe(e)?(0,O.jsx)(y.A,{placement:"topLeft",title:"PDF Attachment",children:(0,O.jsx)("button",{onClick:()=>window.open(t,"_blank"),className:"px-2 py-1.5 text-xs rounded-md bg-transparent border border-muted hover:border-gray-800",type:"button",children:(0,O.jsx)(q.kl1,{className:"text-red-600 hover:text-red-700",size:26})})}):null})():(0,O.jsx)("span",{className:"text-gray-600 text-sm text-center",children:"No File Attached"})})})})})]})}),(0,O.jsx)("div",{className:"",children:(0,O.jsxs)("div",{className:"md:flex justify-between items-center md:space-y-0 space-y-1.5 py-1",children:[(0,O.jsxs)("div",{className:"grid sm:grid-cols-2 grid-cols-1 sm:space-x-2 sm:space-y-0 space-y-1",children:["admin"===H&&(0,O.jsx)("div",{className:"flex justify-center items-center space-x-2 text-[14px] rounded-md",children:(0,O.jsx)(v.xI,{control:_,name:"PDCompanyId",rules:{required:"Company is required"},render:e=>{let{field:t}=e;return(0,O.jsxs)(N.A,(0,l.A)((0,l.A)({},t),{},{defaultValue:"",disabled:W,className:"".concat(x.Lp," "),showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,O.jsx)(N.A.Option,{value:"",children:"Select Company"}),null===le||void 0===le?void 0:le.map(e=>(0,O.jsx)(N.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}})}),("admin"===H||"company"===H||"companyDirector"===H)&&(0,O.jsx)("div",{className:"flex justify-center items-center space-x-2 text-[14px] rounded-md",children:(0,O.jsx)(v.xI,{control:_,name:"PDBranchId",rules:{required:"Branch is required"},render:e=>{let{field:t}=e;return(0,O.jsxs)(N.A,(0,l.A)((0,l.A)({},t),{},{defaultValue:"",disabled:W,className:"".concat(x.Lp," "),showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,O.jsx)(N.A.Option,{value:"",children:"Select Branch"}),de?(0,O.jsx)(N.A.Option,{disabled:!0,children:(0,O.jsx)(L.A,{})}):null===se||void 0===se?void 0:se.map(e=>(0,O.jsx)(N.A.Option,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.fullName},null===e||void 0===e?void 0:e._id))]}))}})}),(0,O.jsx)("div",{className:"",children:(0,O.jsx)(v.xI,{control:_,name:"status",rules:{required:"Status is required"},render:e=>{let{field:t}=e;return(0,O.jsxs)(N.A,(0,l.A)((0,l.A)({},t),{},{defaultValue:"",disabled:W,className:"".concat(x.Lp," "),showSearch:!0,filterOption:(e,t)=>String(null===t||void 0===t?void 0:t.children).toLowerCase().includes(e.toLowerCase()),children:[(0,O.jsx)(N.A.Option,{value:"",children:"Select Status"}),(0,O.jsx)(N.A.Option,{value:"Requested",children:"Requested"}),(0,O.jsx)(N.A.Option,{value:"Approved",children:"Approved"}),(0,O.jsx)(N.A.Option,{value:"Rejected",children:"Rejected"}),(0,O.jsx)(N.A.Option,{value:"Completed",children:"Completed"})]}))}})})]}),$&&(0,O.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,O.jsx)("button",{onClick:()=>{M("PDBranchId",""),M("PDCompanyId",""),M("status","")},className:"bg-header   py-[6px]  rounded-md  flex px-5 justify-center items-center  text-white",children:(0,O.jsx)("span",{className:"text-[12px]",children:"Reset"})}),(0,O.jsxs)("button",{onClick:()=>{V("/admin/resignation/create")},className:"bg-header px-2 py-1.5 rounded-md flex justify-center items-center space-x-2 text-white",children:[(0,O.jsx)(o.OiG,{}),(0,O.jsx)("span",{className:"text-[12px]",children:"Add Resignation"})]})]})]})}),(0,O.jsxs)("div",{className:"w-full",children:[(0,O.jsx)("div",{className:"bg-[#ffffff] w-full overflow-x-auto mt-1 rounded-xl",children:(0,O.jsxs)("table",{className:"w-full max-w-full rounded-xl overflow-x-auto",children:[(0,O.jsx)("thead",{children:(0,O.jsxs)("tr",{className:"border-b-[1px] border-[#DDDDDD] bg-header capitalize text-[#ffff] font-[500] h-[40px]",children:[(0,O.jsx)("th",{className:"tableHead w-[5%]",children:"S.No."}),(0,O.jsx)("th",{className:"tableHead",children:"Employee Name"}),(0,O.jsx)("th",{className:"tableHead",children:"Apply Date"}),(0,O.jsx)("th",{className:"tableHead",children:"Approval Date"}),(0,O.jsx)("th",{className:"tableHead",children:"Notice Period(days)"}),(0,O.jsx)("th",{className:"tableHead",children:"Completed Date"}),(0,O.jsx)("th",{className:" tableHead",children:"Created At"}),(0,O.jsx)("th",{className:" tableHead",children:"Created By"}),(0,O.jsx)("th",{className:"tableHead",children:"Status"}),(0,O.jsx)("th",{className:"tableHead",children:"Action"})]})}),W?(0,O.jsx)("tr",{className:"bg-white bg-opacity-5 ",children:(0,O.jsx)("td",{colSpan:10,className:"px-6 py-2 whitespace-nowrap text-center font-[600] text-sm text-gray-500",children:(0,O.jsx)(R.A,{})})}):(0,O.jsx)("tbody",{children:T&&(null===T||void 0===T?void 0:T.length)>0?null===T||void 0===T?void 0:T.map((e,t)=>{var a,l,d;return(0,O.jsx)(s.Fragment,{children:(0,O.jsxs)("tr",{className:"text-black ".concat(t%2===0?"bg-[#e9ecef]/80":"bg-white"," border-b-[1px] border-[#DDDDDD]"),children:[(0,O.jsx)("td",{className:"tableData",children:t+1+10*(G-1)}),(0,O.jsx)("td",{className:"tableData",children:null!==(a=null===e||void 0===e?void 0:e.employeName)&&void 0!==a?a:"-"}),(0,O.jsx)("td",{className:"tableData",children:S()(null===e||void 0===e?void 0:e.applyDate).format("DD-MM-YYYY")}),(0,O.jsx)("td",{className:"tableData",children:null!==e&&void 0!==e&&e.approvalDate?S()(null===e||void 0===e?void 0:e.approvalDate).format("DD-MM-YYYY"):"-"}),(0,O.jsx)("td",{className:"tableData",children:null===e||void 0===e?void 0:e.noticePeriod}),(0,O.jsx)("td",{className:"tableData",children:null!==e&&void 0!==e&&e.completeDate?S()(null===e||void 0===e?void 0:e.completeDate).format("DD-MM-YYYY"):"-"}),(0,O.jsx)("td",{className:"tableData",children:S()(null===e||void 0===e?void 0:e.createdAt).format("DD-MM-YYYY hh:mm a")}),(0,O.jsx)("td",{className:"tableData",children:null===e||void 0===e?void 0:e.createdBy}),(0,O.jsx)("td",{className:"tableData  border-none",children:(0,O.jsx)("span",{className:"border-[1px] px-2 py-1.5 rounded-lg text-[12px] text-black ".concat("Completed"===(null===e||void 0===e?void 0:e.status)?"bg-[#E0FFBE] border-green-600":"Requested"===(null===e||void 0===e?void 0:e.status)?"bg-blue-100 border-blue-500":"Approved"===(null===e||void 0===e?void 0:e.status)?"bg-yellow-100 border-yellow-500":"Rejected"===(null===e||void 0===e?void 0:e.status)?"bg-red-200 border-red-500":"bg-gray-100 border-gray-300"),children:null===e||void 0===e?void 0:e.status})}),(0,O.jsx)("td",{className:"whitespace-nowrap text-center p-2",children:(0,O.jsx)(f.A,{menu:{items:[ee&&{key:"view-doc",label:(0,O.jsxs)("span",{onClick:()=>{var t;return(null===e||void 0===e||null===(t=e.attachment)||void 0===t?void 0:t.length)>0&&K({isOpen:!0,data:e,resignation:{}})},className:"flex items-center ".concat((null===e||void 0===e||null===(l=e.attachment)||void 0===l?void 0:l.length)>0?"text-rose-700 hover:text-rose-700":"text-gray-400 cursor-not-allowed"),children:[(0,O.jsx)(q.kQE,{className:"mr-2",size:16}),"View Document"]}),disabled:!((null===e||void 0===e||null===(d=e.attachment)||void 0===d?void 0:d.length)>0)},ee&&{key:"view-comment",label:(0,O.jsxs)("span",{onClick:()=>(0,x.v2)((null===e||void 0===e?void 0:e.reason)||"Data not available"),className:"flex items-center text-blue-800 hover:text-blue-700",children:[(0,O.jsx)(j.qSe,{className:"mr-2",size:16}),"View Comment"]})},{key:"view-desc",label:(0,O.jsxs)("span",{onClick:()=>(0,x.v2)((null===e||void 0===e?void 0:e.description)||"Data not available"),className:"flex items-center text-blue-800 hover:text-blue-700",children:[(0,O.jsx)(j.qSe,{className:"mr-2",size:16}),"View Description"]})},te&&{key:"reject",label:(0,O.jsxs)("span",{onClick:()=>!["Completed","Rejected","Approved"].includes(null===e||void 0===e?void 0:e.status)&&je(e,"Rejected"),className:"flex items-center ".concat(["Completed","Rejected","Approved"].includes(null===e||void 0===e?void 0:e.status)?"text-gray-300 cursor-not-allowed":"text-red-500 hover:text-red-500"),children:[(0,O.jsx)(D.qSu,{className:"mr-2",size:16}),"Reject"]}),disabled:["Completed","Rejected","Approved"].includes(null===e||void 0===e?void 0:e.status)},te&&{key:"approve",label:(0,O.jsxs)("span",{onClick:()=>!["Completed","Rejected","Approved"].includes(null===e||void 0===e?void 0:e.status)&&je(e,"Approved"),className:"flex items-center ".concat(["Completed","Rejected","Approved"].includes(null===e||void 0===e?void 0:e.status)?"text-gray-300 cursor-not-allowed":"text-teal-500 hover:text-teal-500"),children:[(0,O.jsx)(w.aXZ,{className:"mr-2",size:16}),"Approve"]}),disabled:["Completed","Rejected","Approved"].includes(null===e||void 0===e?void 0:e.status)},te&&{key:"complete",label:(0,O.jsxs)("span",{onClick:()=>!["Completed","Rejected","Requested"].includes(null===e||void 0===e?void 0:e.status)&&je(e,"Completed"),className:"flex items-center ".concat(["Completed","Rejected","Requested"].includes(null===e||void 0===e?void 0:e.status)?"text-gray-300 cursor-not-allowed":"text-green-500 hover:text-green-500"),children:[(0,O.jsx)(D.Mcx,{className:"mr-2",size:16}),"Complete"]}),disabled:["Completed","Rejected","Requested"].includes(null===e||void 0===e?void 0:e.status)},te&&{key:"edit",label:(0,O.jsxs)("span",{onClick:()=>!["Completed","Rejected","Approved"].includes(null===e||void 0===e?void 0:e.status)&&V("/admin/resignation/edit/".concat((0,p.w)(null===e||void 0===e?void 0:e._id))),className:"flex items-center ".concat(["Completed","Rejected","Approved"].includes(null===e||void 0===e?void 0:e.status)?"text-gray-300 cursor-not-allowed":"text-[#3c8dbc] hover:text-[#337ab7]"),children:[(0,O.jsx)(o.Jcp,{className:"mr-2",size:16}),"Edit"]}),disabled:["Completed","Rejected","Approved"].includes(null===e||void 0===e?void 0:e.status)},ae&&{key:"delete",label:(0,O.jsxs)("span",{onClick:()=>!["Completed","Rejected","Approved"].includes(null===e||void 0===e?void 0:e.status)&&(e=>{let t={_id:e};u().fire({title:"Warning",text:"Are you sure you want to delete!",icon:"warning",showCancelButton:!0,cancelButtonText:"No"}).then(e=>{e.isConfirmed&&E((0,A._0)(t)).then(e=>{G>1&&1==(null===T||void 0===T?void 0:T.length)?Q(Number(G-1)):pe()})})})(null===e||void 0===e?void 0:e._id),className:"flex items-center ".concat(["Completed","Rejected","Approved"].includes(null===e||void 0===e?void 0:e.status)?"text-gray-300 cursor-not-allowed":"text-red-600 hover:text-red-500"),children:[(0,O.jsx)(r.tqC,{className:"mr-2",size:16}),"Delete"]}),disabled:["Completed","Rejected","Approved"].includes(null===e||void 0===e?void 0:e.status)}]},trigger:["click"],children:(0,O.jsx)(y.A,{placement:"topLeft",title:"More Actions",children:(0,O.jsx)("button",{className:"px-2 py-1.5 text-xs rounded-md bg-transparent border border-muted",type:"button",children:(0,O.jsx)(P.xWf,{className:"hover:text-[#337ab7] text-[#3c8dbc]",size:16})})})})})]})},null===e||void 0===e?void 0:e._id)}):(0,O.jsx)("tr",{className:"bg-white bg-opacity-5",children:(0,O.jsx)("td",{colSpan:10,className:"px-6 py-2 whitespace-nowrap text-center font-[600] text-sm text-gray-500",children:"Record Not Found"})})})]})}),(null===T||void 0===T?void 0:T.length)>0&&(0,O.jsx)(m.A,{totalCount:U,pageSize:10,currentPage:G,onChange:e=>{Q(e)}})]}),me&&ve&&(0,O.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[1501]",onClick:be,children:(0,O.jsxs)("div",{className:"animate-slideInFromTop bg-white rounded-lg px-6 pt-6 pb-3 w-[800px] max-h-[70vh] overflow-y-hidden",onClick:e=>e.stopPropagation(),children:[(0,O.jsx)("div",{className:"mt-4",children:(0,O.jsx)("div",{dangerouslySetInnerHTML:{__html:null===ve||void 0===ve?void 0:ve.content}})}),(0,O.jsx)("div",{className:"mt-4 flex justify-end",children:(0,O.jsx)("button",{onClick:be,className:"px-4 py-2 text-white bg-header rounded-md",children:"Close"})})]})})]})}}}]);
//# sourceMappingURL=413.c04f566a.chunk.js.map